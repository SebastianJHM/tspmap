var q3=Object.defineProperty,K3=Object.defineProperties;var Y3=Object.getOwnPropertyDescriptors;var aw=Object.getOwnPropertySymbols;var J3=Object.prototype.hasOwnProperty,Q3=Object.prototype.propertyIsEnumerable;var sw=(e,r,n)=>r in e?q3(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n,Pa=(e,r)=>{for(var n in r||(r={}))J3.call(r,n)&&sw(e,n,r[n]);if(aw)for(var n of aw(r))Q3.call(r,n)&&sw(e,n,r[n]);return e},La=(e,r)=>K3(e,Y3(r));const eI=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const m of u)if(m.type==="childList")for(const x of m.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&l(x)}).observe(document,{childList:!0,subtree:!0});function n(u){const m={};return u.integrity&&(m.integrity=u.integrity),u.referrerpolicy&&(m.referrerPolicy=u.referrerpolicy),u.crossorigin==="use-credentials"?m.credentials="include":u.crossorigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(u){if(u.ep)return;u.ep=!0;const m=n(u);fetch(u.href,m)}};eI();var tI=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Tr={exports:{}},yr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qd=Symbol.for("react.element"),rI=Symbol.for("react.portal"),nI=Symbol.for("react.fragment"),iI=Symbol.for("react.strict_mode"),aI=Symbol.for("react.profiler"),sI=Symbol.for("react.provider"),oI=Symbol.for("react.context"),lI=Symbol.for("react.forward_ref"),cI=Symbol.for("react.suspense"),uI=Symbol.for("react.memo"),hI=Symbol.for("react.lazy"),ow=Symbol.iterator;function fI(e){return e===null||typeof e!="object"?null:(e=ow&&e[ow]||e["@@iterator"],typeof e=="function"?e:null)}var CE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},IE=Object.assign,ME={};function gh(e,r,n){this.props=e,this.context=r,this.refs=ME,this.updater=n||CE}gh.prototype.isReactComponent={};gh.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};gh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function DE(){}DE.prototype=gh.prototype;function P1(e,r,n){this.props=e,this.context=r,this.refs=ME,this.updater=n||CE}var L1=P1.prototype=new DE;L1.constructor=P1;IE(L1,gh.prototype);L1.isPureReactComponent=!0;var lw=Array.isArray,FE=Object.prototype.hasOwnProperty,R1={current:null},PE={key:!0,ref:!0,__self:!0,__source:!0};function LE(e,r,n){var l,u={},m=null,x=null;if(r!=null)for(l in r.ref!==void 0&&(x=r.ref),r.key!==void 0&&(m=""+r.key),r)FE.call(r,l)&&!PE.hasOwnProperty(l)&&(u[l]=r[l]);var o=arguments.length-2;if(o===1)u.children=n;else if(1<o){for(var S=Array(o),A=0;A<o;A++)S[A]=arguments[A+2];u.children=S}if(e&&e.defaultProps)for(l in o=e.defaultProps,o)u[l]===void 0&&(u[l]=o[l]);return{$$typeof:qd,type:e,key:m,ref:x,props:u,_owner:R1.current}}function dI(e,r){return{$$typeof:qd,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function z1(e){return typeof e=="object"&&e!==null&&e.$$typeof===qd}function pI(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return r[n]})}var cw=/\/+/g;function Hg(e,r){return typeof e=="object"&&e!==null&&e.key!=null?pI(""+e.key):r.toString(36)}function am(e,r,n,l,u){var m=typeof e;(m==="undefined"||m==="boolean")&&(e=null);var x=!1;if(e===null)x=!0;else switch(m){case"string":case"number":x=!0;break;case"object":switch(e.$$typeof){case qd:case rI:x=!0}}if(x)return x=e,u=u(x),e=l===""?"."+Hg(x,0):l,lw(u)?(n="",e!=null&&(n=e.replace(cw,"$&/")+"/"),am(u,r,n,"",function(A){return A})):u!=null&&(z1(u)&&(u=dI(u,n+(!u.key||x&&x.key===u.key?"":(""+u.key).replace(cw,"$&/")+"/")+e)),r.push(u)),1;if(x=0,l=l===""?".":l+":",lw(e))for(var o=0;o<e.length;o++){m=e[o];var S=l+Hg(m,o);x+=am(m,r,n,S,u)}else if(S=fI(e),typeof S=="function")for(e=S.call(e),o=0;!(m=e.next()).done;)m=m.value,S=l+Hg(m,o++),x+=am(m,r,n,S,u);else if(m==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return x}function M0(e,r,n){if(e==null)return e;var l=[],u=0;return am(e,l,"","",function(m){return r.call(n,m,u++)}),l}function mI(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var Gi={current:null},sm={transition:null},_I={ReactCurrentDispatcher:Gi,ReactCurrentBatchConfig:sm,ReactCurrentOwner:R1};yr.Children={map:M0,forEach:function(e,r,n){M0(e,function(){r.apply(this,arguments)},n)},count:function(e){var r=0;return M0(e,function(){r++}),r},toArray:function(e){return M0(e,function(r){return r})||[]},only:function(e){if(!z1(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};yr.Component=gh;yr.Fragment=nI;yr.Profiler=aI;yr.PureComponent=P1;yr.StrictMode=iI;yr.Suspense=cI;yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_I;yr.cloneElement=function(e,r,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var l=IE({},e.props),u=e.key,m=e.ref,x=e._owner;if(r!=null){if(r.ref!==void 0&&(m=r.ref,x=R1.current),r.key!==void 0&&(u=""+r.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(S in r)FE.call(r,S)&&!PE.hasOwnProperty(S)&&(l[S]=r[S]===void 0&&o!==void 0?o[S]:r[S])}var S=arguments.length-2;if(S===1)l.children=n;else if(1<S){o=Array(S);for(var A=0;A<S;A++)o[A]=arguments[A+2];l.children=o}return{$$typeof:qd,type:e.type,key:u,ref:m,props:l,_owner:x}};yr.createContext=function(e){return e={$$typeof:oI,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:sI,_context:e},e.Consumer=e};yr.createElement=LE;yr.createFactory=function(e){var r=LE.bind(null,e);return r.type=e,r};yr.createRef=function(){return{current:null}};yr.forwardRef=function(e){return{$$typeof:lI,render:e}};yr.isValidElement=z1;yr.lazy=function(e){return{$$typeof:hI,_payload:{_status:-1,_result:e},_init:mI}};yr.memo=function(e,r){return{$$typeof:uI,type:e,compare:r===void 0?null:r}};yr.startTransition=function(e){var r=sm.transition;sm.transition={};try{e()}finally{sm.transition=r}};yr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};yr.useCallback=function(e,r){return Gi.current.useCallback(e,r)};yr.useContext=function(e){return Gi.current.useContext(e)};yr.useDebugValue=function(){};yr.useDeferredValue=function(e){return Gi.current.useDeferredValue(e)};yr.useEffect=function(e,r){return Gi.current.useEffect(e,r)};yr.useId=function(){return Gi.current.useId()};yr.useImperativeHandle=function(e,r,n){return Gi.current.useImperativeHandle(e,r,n)};yr.useInsertionEffect=function(e,r){return Gi.current.useInsertionEffect(e,r)};yr.useLayoutEffect=function(e,r){return Gi.current.useLayoutEffect(e,r)};yr.useMemo=function(e,r){return Gi.current.useMemo(e,r)};yr.useReducer=function(e,r,n){return Gi.current.useReducer(e,r,n)};yr.useRef=function(e){return Gi.current.useRef(e)};yr.useState=function(e){return Gi.current.useState(e)};yr.useSyncExternalStore=function(e,r,n){return Gi.current.useSyncExternalStore(e,r,n)};yr.useTransition=function(){return Gi.current.useTransition()};yr.version="18.0.0-fc46dba67-20220329";Tr.exports=yr;var Ln=Tr.exports,Cx={},RE={exports:{}},Sa={},zE={exports:{}},OE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(gt,Be){var Tt=gt.length;gt.push(Be);e:for(;0<Tt;){var Dt=Tt-1>>>1,Ee=gt[Dt];if(0<u(Ee,Be))gt[Dt]=Be,gt[Tt]=Ee,Tt=Dt;else break e}}function n(gt){return gt.length===0?null:gt[0]}function l(gt){if(gt.length===0)return null;var Be=gt[0],Tt=gt.pop();if(Tt!==Be){gt[0]=Tt;e:for(var Dt=0,Ee=gt.length,He=Ee>>>1;Dt<He;){var Re=2*(Dt+1)-1,Oe=gt[Re],at=Re+1,bt=gt[at];if(0>u(Oe,Tt))at<Ee&&0>u(bt,Oe)?(gt[Dt]=bt,gt[at]=Tt,Dt=at):(gt[Dt]=Oe,gt[Re]=Tt,Dt=Re);else if(at<Ee&&0>u(bt,Tt))gt[Dt]=bt,gt[at]=Tt,Dt=at;else break e}}return Be}function u(gt,Be){var Tt=gt.sortIndex-Be.sortIndex;return Tt!==0?Tt:gt.id-Be.id}if(typeof performance=="object"&&typeof performance.now=="function"){var m=performance;e.unstable_now=function(){return m.now()}}else{var x=Date,o=x.now();e.unstable_now=function(){return x.now()-o}}var S=[],A=[],I=1,D=null,L=3,B=!1,U=!1,V=!1,Y=typeof setTimeout=="function"?setTimeout:null,X=typeof clearTimeout=="function"?clearTimeout:null,K=typeof setImmediate!="undefined"?setImmediate:null;typeof navigator!="undefined"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function G(gt){for(var Be=n(A);Be!==null;){if(Be.callback===null)l(A);else if(Be.startTime<=gt)l(A),Be.sortIndex=Be.expirationTime,r(S,Be);else break;Be=n(A)}}function me(gt){if(V=!1,G(gt),!U)if(n(S)!==null)U=!0,Bt(Ae);else{var Be=n(A);Be!==null&&zt(me,Be.startTime-gt)}}function Ae(gt,Be){U=!1,V&&(V=!1,X(ke),ke=-1),B=!0;var Tt=L;try{for(G(Be),D=n(S);D!==null&&(!(D.expirationTime>Be)||gt&&!$e());){var Dt=D.callback;if(typeof Dt=="function"){D.callback=null,L=D.priorityLevel;var Ee=Dt(D.expirationTime<=Be);Be=e.unstable_now(),typeof Ee=="function"?D.callback=Ee:D===n(S)&&l(S),G(Be)}else l(S);D=n(S)}if(D!==null)var He=!0;else{var Re=n(A);Re!==null&&zt(me,Re.startTime-Be),He=!1}return He}finally{D=null,L=Tt,B=!1}}var ge=!1,se=null,ke=-1,Ie=5,Xe=-1;function $e(){return!(e.unstable_now()-Xe<Ie)}function We(){if(se!==null){var gt=e.unstable_now();Xe=gt;var Be=!0;try{Be=se(!0,gt)}finally{Be?dt():(ge=!1,se=null)}}else ge=!1}var dt;if(typeof K=="function")dt=function(){K(We)};else if(typeof MessageChannel!="undefined"){var Ut=new MessageChannel,kt=Ut.port2;Ut.port1.onmessage=We,dt=function(){kt.postMessage(null)}}else dt=function(){Y(We,0)};function Bt(gt){se=gt,ge||(ge=!0,dt())}function zt(gt,Be){ke=Y(function(){gt(e.unstable_now())},Be)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(gt){gt.callback=null},e.unstable_continueExecution=function(){U||B||(U=!0,Bt(Ae))},e.unstable_forceFrameRate=function(gt){0>gt||125<gt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ie=0<gt?Math.floor(1e3/gt):5},e.unstable_getCurrentPriorityLevel=function(){return L},e.unstable_getFirstCallbackNode=function(){return n(S)},e.unstable_next=function(gt){switch(L){case 1:case 2:case 3:var Be=3;break;default:Be=L}var Tt=L;L=Be;try{return gt()}finally{L=Tt}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(gt,Be){switch(gt){case 1:case 2:case 3:case 4:case 5:break;default:gt=3}var Tt=L;L=gt;try{return Be()}finally{L=Tt}},e.unstable_scheduleCallback=function(gt,Be,Tt){var Dt=e.unstable_now();switch(typeof Tt=="object"&&Tt!==null?(Tt=Tt.delay,Tt=typeof Tt=="number"&&0<Tt?Dt+Tt:Dt):Tt=Dt,gt){case 1:var Ee=-1;break;case 2:Ee=250;break;case 5:Ee=1073741823;break;case 4:Ee=1e4;break;default:Ee=5e3}return Ee=Tt+Ee,gt={id:I++,callback:Be,priorityLevel:gt,startTime:Tt,expirationTime:Ee,sortIndex:-1},Tt>Dt?(gt.sortIndex=Tt,r(A,gt),n(S)===null&&gt===n(A)&&(V?(X(ke),ke=-1):V=!0,zt(me,Tt-Dt))):(gt.sortIndex=Ee,r(S,gt),U||B||(U=!0,Bt(Ae))),gt},e.unstable_shouldYield=$e,e.unstable_wrapCallback=function(gt){var Be=L;return function(){var Tt=L;L=Be;try{return gt.apply(this,arguments)}finally{L=Tt}}}})(OE);zE.exports=OE;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BE=Tr.exports,Ea=zE.exports;function Et(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)r+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var NE=new Set,Ed={};function Dc(e,r){oh(e,r),oh(e+"Capture",r)}function oh(e,r){for(Ed[e]=r,e=0;e<r.length;e++)NE.add(r[e])}var vo=!(typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"),Ix=Object.prototype.hasOwnProperty,gI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,uw={},hw={};function xI(e){return Ix.call(hw,e)?!0:Ix.call(uw,e)?!1:gI.test(e)?hw[e]=!0:(uw[e]=!0,!1)}function yI(e,r,n,l){if(n!==null&&n.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return l?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function vI(e,r,n,l){if(r===null||typeof r=="undefined"||yI(e,r,n,l))return!0;if(l)return!1;if(n!==null)switch(n.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function $i(e,r,n,l,u,m,x){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=l,this.attributeNamespace=u,this.mustUseProperty=n,this.propertyName=e,this.type=r,this.sanitizeURL=m,this.removeEmptyString=x}var ri={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){ri[e]=new $i(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];ri[r]=new $i(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){ri[e]=new $i(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){ri[e]=new $i(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){ri[e]=new $i(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){ri[e]=new $i(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){ri[e]=new $i(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){ri[e]=new $i(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){ri[e]=new $i(e,5,!1,e.toLowerCase(),null,!1,!1)});var O1=/[\-:]([a-z])/g;function B1(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(O1,B1);ri[r]=new $i(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(O1,B1);ri[r]=new $i(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(O1,B1);ri[r]=new $i(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){ri[e]=new $i(e,1,!1,e.toLowerCase(),null,!1,!1)});ri.xlinkHref=new $i("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){ri[e]=new $i(e,1,!1,e.toLowerCase(),null,!0,!0)});function N1(e,r,n,l){var u=ri.hasOwnProperty(r)?ri[r]:null;(u!==null?u.type!==0:l||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(vI(r,n,u,l)&&(n=null),l||u===null?xI(r)&&(n===null?e.removeAttribute(r):e.setAttribute(r,""+n)):u.mustUseProperty?e[u.propertyName]=n===null?u.type===3?!1:"":n:(r=u.attributeName,l=u.attributeNamespace,n===null?e.removeAttribute(r):(u=u.type,n=u===3||u===4&&n===!0?"":""+n,l?e.setAttributeNS(l,r,n):e.setAttribute(r,n))))}var bo=BE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D0=Symbol.for("react.element"),Uu=Symbol.for("react.portal"),Vu=Symbol.for("react.fragment"),U1=Symbol.for("react.strict_mode"),Mx=Symbol.for("react.profiler"),UE=Symbol.for("react.provider"),VE=Symbol.for("react.context"),V1=Symbol.for("react.forward_ref"),Dx=Symbol.for("react.suspense"),Fx=Symbol.for("react.suspense_list"),j1=Symbol.for("react.memo"),nl=Symbol.for("react.lazy"),jE=Symbol.for("react.offscreen"),fw=Symbol.iterator;function jf(e){return e===null||typeof e!="object"?null:(e=fw&&e[fw]||e["@@iterator"],typeof e=="function"?e:null)}var un=Object.assign,Xg;function Yf(e){if(Xg===void 0)try{throw Error()}catch(n){var r=n.stack.trim().match(/\n( *(at )?)/);Xg=r&&r[1]||""}return`
`+Xg+e}var qg=!1;function Kg(e,r){if(!e||qg)return"";qg=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(A){var l=A}Reflect.construct(e,[],r)}else{try{r.call()}catch(A){l=A}e.call(r.prototype)}else{try{throw Error()}catch(A){l=A}e()}}catch(A){if(A&&l&&typeof A.stack=="string"){for(var u=A.stack.split(`
`),m=l.stack.split(`
`),x=u.length-1,o=m.length-1;1<=x&&0<=o&&u[x]!==m[o];)o--;for(;1<=x&&0<=o;x--,o--)if(u[x]!==m[o]){if(x!==1||o!==1)do if(x--,o--,0>o||u[x]!==m[o]){var S=`
`+u[x].replace(" at new "," at ");return e.displayName&&S.includes("<anonymous>")&&(S=S.replace("<anonymous>",e.displayName)),S}while(1<=x&&0<=o);break}}}finally{qg=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Yf(e):""}function wI(e){switch(e.tag){case 5:return Yf(e.type);case 16:return Yf("Lazy");case 13:return Yf("Suspense");case 19:return Yf("SuspenseList");case 0:case 2:case 15:return e=Kg(e.type,!1),e;case 11:return e=Kg(e.type.render,!1),e;case 1:return e=Kg(e.type,!0),e;default:return""}}function Px(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Vu:return"Fragment";case Uu:return"Portal";case Mx:return"Profiler";case U1:return"StrictMode";case Dx:return"Suspense";case Fx:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case VE:return(e.displayName||"Context")+".Consumer";case UE:return(e._context.displayName||"Context")+".Provider";case V1:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case j1:return r=e.displayName||null,r!==null?r:Px(e.type)||"Memo";case nl:r=e._payload,e=e._init;try{return Px(e(r))}catch{}}return null}function TI(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Px(r);case 8:return r===U1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function wl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function GE(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function EI(e){var r=GE(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),l=""+e[r];if(!e.hasOwnProperty(r)&&typeof n!="undefined"&&typeof n.get=="function"&&typeof n.set=="function"){var u=n.get,m=n.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return u.call(this)},set:function(x){l=""+x,m.call(this,x)}}),Object.defineProperty(e,r,{enumerable:n.enumerable}),{getValue:function(){return l},setValue:function(x){l=""+x},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function F0(e){e._valueTracker||(e._valueTracker=EI(e))}function $E(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var n=r.getValue(),l="";return e&&(l=GE(e)?e.checked?"true":"false":e.value),e=l,e!==n?(r.setValue(e),!0):!1}function gm(e){if(e=e||(typeof document!="undefined"?document:void 0),typeof e=="undefined")return null;try{return e.activeElement||e.body}catch{return e.body}}function Lx(e,r){var n=r.checked;return un({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n!=null?n:e._wrapperState.initialChecked})}function dw(e,r){var n=r.defaultValue==null?"":r.defaultValue,l=r.checked!=null?r.checked:r.defaultChecked;n=wl(r.value!=null?r.value:n),e._wrapperState={initialChecked:l,initialValue:n,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function WE(e,r){r=r.checked,r!=null&&N1(e,"checked",r,!1)}function Rx(e,r){WE(e,r);var n=wl(r.value),l=r.type;if(n!=null)l==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(l==="submit"||l==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?zx(e,r.type,n):r.hasOwnProperty("defaultValue")&&zx(e,r.type,wl(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function pw(e,r,n){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var l=r.type;if(!(l!=="submit"&&l!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,n||r===e.value||(e.value=r),e.defaultValue=r}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function zx(e,r,n){(r!=="number"||gm(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Jf=Array.isArray;function Ju(e,r,n,l){if(e=e.options,r){r={};for(var u=0;u<n.length;u++)r["$"+n[u]]=!0;for(n=0;n<e.length;n++)u=r.hasOwnProperty("$"+e[n].value),e[n].selected!==u&&(e[n].selected=u),u&&l&&(e[n].defaultSelected=!0)}else{for(n=""+wl(n),r=null,u=0;u<e.length;u++){if(e[u].value===n){e[u].selected=!0,l&&(e[u].defaultSelected=!0);return}r!==null||e[u].disabled||(r=e[u])}r!==null&&(r.selected=!0)}}function Ox(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(Et(91));return un({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function mw(e,r){var n=r.value;if(n==null){if(n=r.children,r=r.defaultValue,n!=null){if(r!=null)throw Error(Et(92));if(Jf(n)){if(1<n.length)throw Error(Et(93));n=n[0]}r=n}r==null&&(r=""),n=r}e._wrapperState={initialValue:wl(n)}}function ZE(e,r){var n=wl(r.value),l=wl(r.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),r.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),l!=null&&(e.defaultValue=""+l)}function _w(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function HE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Bx(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?HE(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var P0,XE=function(e){return typeof MSApp!="undefined"&&MSApp.execUnsafeLocalFunction?function(r,n,l,u){MSApp.execUnsafeLocalFunction(function(){return e(r,n,l,u)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(P0=P0||document.createElement("div"),P0.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=P0.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function bd(e,r){if(r){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=r;return}}e.textContent=r}var sd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bI=["Webkit","ms","Moz","O"];Object.keys(sd).forEach(function(e){bI.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),sd[r]=sd[e]})});function qE(e,r,n){return r==null||typeof r=="boolean"||r===""?"":n||typeof r!="number"||r===0||sd.hasOwnProperty(e)&&sd[e]?(""+r).trim():r+"px"}function KE(e,r){e=e.style;for(var n in r)if(r.hasOwnProperty(n)){var l=n.indexOf("--")===0,u=qE(n,r[n],l);n==="float"&&(n="cssFloat"),l?e.setProperty(n,u):e[n]=u}}var SI=un({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nx(e,r){if(r){if(SI[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(Et(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(Et(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(Et(61))}if(r.style!=null&&typeof r.style!="object")throw Error(Et(62))}}function Ux(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Vx=null;function G1(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var jx=null,Qu=null,eh=null;function gw(e){if(e=Jd(e)){if(typeof jx!="function")throw Error(Et(280));var r=e.stateNode;r&&(r=i_(r),jx(e.stateNode,e.type,r))}}function YE(e){Qu?eh?eh.push(e):eh=[e]:Qu=e}function JE(){if(Qu){var e=Qu,r=eh;if(eh=Qu=null,gw(e),r)for(e=0;e<r.length;e++)gw(r[e])}}function QE(e,r){return e(r)}function eb(){}var Yg=!1;function tb(e,r,n){if(Yg)return e(r,n);Yg=!0;try{return QE(e,r,n)}finally{Yg=!1,(Qu!==null||eh!==null)&&(eb(),JE())}}function Sd(e,r){var n=e.stateNode;if(n===null)return null;var l=i_(n);if(l===null)return null;n=l[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(l=!l.disabled)||(e=e.type,l=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!l;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Et(231,r,typeof n));return n}var Gx=!1;if(vo)try{var Gf={};Object.defineProperty(Gf,"passive",{get:function(){Gx=!0}}),window.addEventListener("test",Gf,Gf),window.removeEventListener("test",Gf,Gf)}catch{Gx=!1}function kI(e,r,n,l,u,m,x,o,S){var A=Array.prototype.slice.call(arguments,3);try{r.apply(n,A)}catch(I){this.onError(I)}}var od=!1,xm=null,ym=!1,$x=null,AI={onError:function(e){od=!0,xm=e}};function CI(e,r,n,l,u,m,x,o,S){od=!1,xm=null,kI.apply(AI,arguments)}function II(e,r,n,l,u,m,x,o,S){if(CI.apply(this,arguments),od){if(od){var A=xm;od=!1,xm=null}else throw Error(Et(198));ym||(ym=!0,$x=A)}}function Fc(e){var r=e,n=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,(r.flags&4098)!==0&&(n=r.return),e=r.return;while(e)}return r.tag===3?n:null}function rb(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function xw(e){if(Fc(e)!==e)throw Error(Et(188))}function MI(e){var r=e.alternate;if(!r){if(r=Fc(e),r===null)throw Error(Et(188));return r!==e?null:e}for(var n=e,l=r;;){var u=n.return;if(u===null)break;var m=u.alternate;if(m===null){if(l=u.return,l!==null){n=l;continue}break}if(u.child===m.child){for(m=u.child;m;){if(m===n)return xw(u),e;if(m===l)return xw(u),r;m=m.sibling}throw Error(Et(188))}if(n.return!==l.return)n=u,l=m;else{for(var x=!1,o=u.child;o;){if(o===n){x=!0,n=u,l=m;break}if(o===l){x=!0,l=u,n=m;break}o=o.sibling}if(!x){for(o=m.child;o;){if(o===n){x=!0,n=m,l=u;break}if(o===l){x=!0,l=m,n=u;break}o=o.sibling}if(!x)throw Error(Et(189))}}if(n.alternate!==l)throw Error(Et(190))}if(n.tag!==3)throw Error(Et(188));return n.stateNode.current===n?e:r}function nb(e){return e=MI(e),e!==null?ib(e):null}function ib(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=ib(e);if(r!==null)return r;e=e.sibling}return null}var ab=Ea.unstable_scheduleCallback,yw=Ea.unstable_cancelCallback,DI=Ea.unstable_shouldYield,FI=Ea.unstable_requestPaint,kn=Ea.unstable_now,PI=Ea.unstable_getCurrentPriorityLevel,$1=Ea.unstable_ImmediatePriority,sb=Ea.unstable_UserBlockingPriority,vm=Ea.unstable_NormalPriority,LI=Ea.unstable_LowPriority,ob=Ea.unstable_IdlePriority,e_=null,Ns=null;function RI(e){if(Ns&&typeof Ns.onCommitFiberRoot=="function")try{Ns.onCommitFiberRoot(e_,e,void 0,(e.current.flags&128)===128)}catch{}}var hs=Math.clz32?Math.clz32:BI,zI=Math.log,OI=Math.LN2;function BI(e){return e>>>=0,e===0?32:31-(zI(e)/OI|0)|0}var L0=64,R0=4194304;function Qf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function wm(e,r){var n=e.pendingLanes;if(n===0)return 0;var l=0,u=e.suspendedLanes,m=e.pingedLanes,x=n&268435455;if(x!==0){var o=x&~u;o!==0?l=Qf(o):(m&=x,m!==0&&(l=Qf(m)))}else x=n&~u,x!==0?l=Qf(x):m!==0&&(l=Qf(m));if(l===0)return 0;if(r!==0&&r!==l&&(r&u)===0&&(u=l&-l,m=r&-r,u>=m||u===16&&(m&4194240)!==0))return r;if((l&4)!==0&&(l|=n&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=l;0<r;)n=31-hs(r),u=1<<n,l|=e[n],r&=~u;return l}function NI(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function UI(e,r){for(var n=e.suspendedLanes,l=e.pingedLanes,u=e.expirationTimes,m=e.pendingLanes;0<m;){var x=31-hs(m),o=1<<x,S=u[x];S===-1?((o&n)===0||(o&l)!==0)&&(u[x]=NI(o,r)):S<=r&&(e.expiredLanes|=o),m&=~o}}function Wx(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Jg(e){for(var r=[],n=0;31>n;n++)r.push(e);return r}function Kd(e,r,n){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-hs(r),e[r]=n}function VI(e,r){var n=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var l=e.eventTimes;for(e=e.expirationTimes;0<n;){var u=31-hs(n),m=1<<u;r[u]=0,l[u]=-1,e[u]=-1,n&=~m}}function W1(e,r){var n=e.entangledLanes|=r;for(e=e.entanglements;n;){var l=31-hs(n),u=1<<l;u&r|e[l]&r&&(e[l]|=r),n&=~u}}var Br=0;function lb(e){return e&=-e,1<e?4<e?(e&268435455)!==0?16:536870912:4:1}var cb,Z1,ub,hb,fb,Zx=!1,z0=[],dl=null,pl=null,ml=null,kd=new Map,Ad=new Map,al=[],jI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vw(e,r){switch(e){case"focusin":case"focusout":dl=null;break;case"dragenter":case"dragleave":pl=null;break;case"mouseover":case"mouseout":ml=null;break;case"pointerover":case"pointerout":kd.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ad.delete(r.pointerId)}}function $f(e,r,n,l,u,m){return e===null||e.nativeEvent!==m?(e={blockedOn:r,domEventName:n,eventSystemFlags:l,nativeEvent:m,targetContainers:[u]},r!==null&&(r=Jd(r),r!==null&&Z1(r)),e):(e.eventSystemFlags|=l,r=e.targetContainers,u!==null&&r.indexOf(u)===-1&&r.push(u),e)}function GI(e,r,n,l,u){switch(r){case"focusin":return dl=$f(dl,e,r,n,l,u),!0;case"dragenter":return pl=$f(pl,e,r,n,l,u),!0;case"mouseover":return ml=$f(ml,e,r,n,l,u),!0;case"pointerover":var m=u.pointerId;return kd.set(m,$f(kd.get(m)||null,e,r,n,l,u)),!0;case"gotpointercapture":return m=u.pointerId,Ad.set(m,$f(Ad.get(m)||null,e,r,n,l,u)),!0}return!1}function db(e){var r=mc(e.target);if(r!==null){var n=Fc(r);if(n!==null){if(r=n.tag,r===13){if(r=rb(n),r!==null){e.blockedOn=r,fb(e.priority,function(){ub(n)});return}}else if(r===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function om(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var n=Hx(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var l=new n.constructor(n.type,n);Vx=l,n.target.dispatchEvent(l),Vx=null}else return r=Jd(n),r!==null&&Z1(r),e.blockedOn=n,!1;r.shift()}return!0}function ww(e,r,n){om(e)&&n.delete(r)}function $I(){Zx=!1,dl!==null&&om(dl)&&(dl=null),pl!==null&&om(pl)&&(pl=null),ml!==null&&om(ml)&&(ml=null),kd.forEach(ww),Ad.forEach(ww)}function Wf(e,r){e.blockedOn===r&&(e.blockedOn=null,Zx||(Zx=!0,Ea.unstable_scheduleCallback(Ea.unstable_NormalPriority,$I)))}function Cd(e){function r(u){return Wf(u,e)}if(0<z0.length){Wf(z0[0],e);for(var n=1;n<z0.length;n++){var l=z0[n];l.blockedOn===e&&(l.blockedOn=null)}}for(dl!==null&&Wf(dl,e),pl!==null&&Wf(pl,e),ml!==null&&Wf(ml,e),kd.forEach(r),Ad.forEach(r),n=0;n<al.length;n++)l=al[n],l.blockedOn===e&&(l.blockedOn=null);for(;0<al.length&&(n=al[0],n.blockedOn===null);)db(n),n.blockedOn===null&&al.shift()}var th=bo.ReactCurrentBatchConfig;function WI(e,r,n,l){var u=Br,m=th.transition;th.transition=null;try{Br=1,H1(e,r,n,l)}finally{Br=u,th.transition=m}}function ZI(e,r,n,l){var u=Br,m=th.transition;th.transition=null;try{Br=4,H1(e,r,n,l)}finally{Br=u,th.transition=m}}function H1(e,r,n,l){var u=Hx(e,r,n,l);if(u===null)lx(e,r,l,Tm,n),vw(e,l);else if(GI(u,e,r,n,l))l.stopPropagation();else if(vw(e,l),r&4&&-1<jI.indexOf(e)){for(;u!==null;){var m=Jd(u);if(m!==null&&cb(m),m=Hx(e,r,n,l),m===null&&lx(e,r,l,Tm,n),m===u)break;u=m}u!==null&&l.stopPropagation()}else lx(e,r,l,null,n)}var Tm=null;function Hx(e,r,n,l){if(Tm=null,e=G1(l),e=mc(e),e!==null)if(r=Fc(e),r===null)e=null;else if(n=r.tag,n===13){if(e=rb(r),e!==null)return e;e=null}else if(n===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return Tm=e,null}function pb(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(PI()){case $1:return 1;case sb:return 4;case vm:case LI:return 16;case ob:return 536870912;default:return 16}default:return 16}}var cl=null,X1=null,lm=null;function mb(){if(lm)return lm;var e,r=X1,n=r.length,l,u="value"in cl?cl.value:cl.textContent,m=u.length;for(e=0;e<n&&r[e]===u[e];e++);var x=n-e;for(l=1;l<=x&&r[n-l]===u[m-l];l++);return lm=u.slice(e,1<l?1-l:void 0)}function cm(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function O0(){return!0}function Tw(){return!1}function ka(e){function r(n,l,u,m,x){this._reactName=n,this._targetInst=u,this.type=l,this.nativeEvent=m,this.target=x,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(m):m[o]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?O0:Tw,this.isPropagationStopped=Tw,this}return un(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=O0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=O0)},persist:function(){},isPersistent:O0}),r}var xh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},q1=ka(xh),Yd=un({},xh,{view:0,detail:0}),HI=ka(Yd),Qg,ex,Zf,t_=un({},Yd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:K1,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Zf&&(Zf&&e.type==="mousemove"?(Qg=e.screenX-Zf.screenX,ex=e.screenY-Zf.screenY):ex=Qg=0,Zf=e),Qg)},movementY:function(e){return"movementY"in e?e.movementY:ex}}),Ew=ka(t_),XI=un({},t_,{dataTransfer:0}),qI=ka(XI),KI=un({},Yd,{relatedTarget:0}),tx=ka(KI),YI=un({},xh,{animationName:0,elapsedTime:0,pseudoElement:0}),JI=ka(YI),QI=un({},xh,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),e4=ka(QI),t4=un({},xh,{data:0}),bw=ka(t4),r4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},n4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},i4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function a4(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=i4[e])?!!r[e]:!1}function K1(){return a4}var s4=un({},Yd,{key:function(e){if(e.key){var r=r4[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=cm(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?n4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:K1,charCode:function(e){return e.type==="keypress"?cm(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?cm(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),o4=ka(s4),l4=un({},t_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Sw=ka(l4),c4=un({},Yd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:K1}),u4=ka(c4),h4=un({},xh,{propertyName:0,elapsedTime:0,pseudoElement:0}),f4=ka(h4),d4=un({},t_,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),p4=ka(d4),m4=[9,13,27,32],Y1=vo&&"CompositionEvent"in window,ld=null;vo&&"documentMode"in document&&(ld=document.documentMode);var _4=vo&&"TextEvent"in window&&!ld,_b=vo&&(!Y1||ld&&8<ld&&11>=ld),kw=String.fromCharCode(32),Aw=!1;function gb(e,r){switch(e){case"keyup":return m4.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xb(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var ju=!1;function g4(e,r){switch(e){case"compositionend":return xb(r);case"keypress":return r.which!==32?null:(Aw=!0,kw);case"textInput":return e=r.data,e===kw&&Aw?null:e;default:return null}}function x4(e,r){if(ju)return e==="compositionend"||!Y1&&gb(e,r)?(e=mb(),lm=X1=cl=null,ju=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return _b&&r.locale!=="ko"?null:r.data;default:return null}}var y4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Cw(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!y4[e.type]:r==="textarea"}function yb(e,r,n,l){YE(l),r=Em(r,"onChange"),0<r.length&&(n=new q1("onChange","change",null,n,l),e.push({event:n,listeners:r}))}var cd=null,Id=null;function v4(e){Mb(e,0)}function r_(e){var r=Wu(e);if($E(r))return e}function w4(e,r){if(e==="change")return r}var vb=!1;if(vo){var rx;if(vo){var nx="oninput"in document;if(!nx){var Iw=document.createElement("div");Iw.setAttribute("oninput","return;"),nx=typeof Iw.oninput=="function"}rx=nx}else rx=!1;vb=rx&&(!document.documentMode||9<document.documentMode)}function Mw(){cd&&(cd.detachEvent("onpropertychange",wb),Id=cd=null)}function wb(e){if(e.propertyName==="value"&&r_(Id)){var r=[];yb(r,Id,e,G1(e)),tb(v4,r)}}function T4(e,r,n){e==="focusin"?(Mw(),cd=r,Id=n,cd.attachEvent("onpropertychange",wb)):e==="focusout"&&Mw()}function E4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return r_(Id)}function b4(e,r){if(e==="click")return r_(r)}function S4(e,r){if(e==="input"||e==="change")return r_(r)}function k4(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var Vs=typeof Object.is=="function"?Object.is:k4;function Md(e,r){if(Vs(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var n=Object.keys(e),l=Object.keys(r);if(n.length!==l.length)return!1;for(l=0;l<n.length;l++){var u=n[l];if(!Ix.call(r,u)||!Vs(e[u],r[u]))return!1}return!0}function Dw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Fw(e,r){var n=Dw(e);e=0;for(var l;n;){if(n.nodeType===3){if(l=e+n.textContent.length,e<=r&&l>=r)return{node:n,offset:r-e};e=l}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Dw(n)}}function Tb(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?Tb(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function Eb(){for(var e=window,r=gm();r instanceof e.HTMLIFrameElement;){try{var n=typeof r.contentWindow.location.href=="string"}catch{n=!1}if(n)e=r.contentWindow;else break;r=gm(e.document)}return r}function J1(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function A4(e){var r=Eb(),n=e.focusedElem,l=e.selectionRange;if(r!==n&&n&&n.ownerDocument&&Tb(n.ownerDocument.documentElement,n)){if(l!==null&&J1(n)){if(r=l.start,e=l.end,e===void 0&&(e=r),"selectionStart"in n)n.selectionStart=r,n.selectionEnd=Math.min(e,n.value.length);else if(e=(r=n.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var u=n.textContent.length,m=Math.min(l.start,u);l=l.end===void 0?m:Math.min(l.end,u),!e.extend&&m>l&&(u=l,l=m,m=u),u=Fw(n,m);var x=Fw(n,l);u&&x&&(e.rangeCount!==1||e.anchorNode!==u.node||e.anchorOffset!==u.offset||e.focusNode!==x.node||e.focusOffset!==x.offset)&&(r=r.createRange(),r.setStart(u.node,u.offset),e.removeAllRanges(),m>l?(e.addRange(r),e.extend(x.node,x.offset)):(r.setEnd(x.node,x.offset),e.addRange(r)))}}for(r=[],e=n;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<r.length;n++)e=r[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var C4=vo&&"documentMode"in document&&11>=document.documentMode,Gu=null,Xx=null,ud=null,qx=!1;function Pw(e,r,n){var l=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;qx||Gu==null||Gu!==gm(l)||(l=Gu,"selectionStart"in l&&J1(l)?l={start:l.selectionStart,end:l.selectionEnd}:(l=(l.ownerDocument&&l.ownerDocument.defaultView||window).getSelection(),l={anchorNode:l.anchorNode,anchorOffset:l.anchorOffset,focusNode:l.focusNode,focusOffset:l.focusOffset}),ud&&Md(ud,l)||(ud=l,l=Em(Xx,"onSelect"),0<l.length&&(r=new q1("onSelect","select",null,r,n),e.push({event:r,listeners:l}),r.target=Gu)))}function B0(e,r){var n={};return n[e.toLowerCase()]=r.toLowerCase(),n["Webkit"+e]="webkit"+r,n["Moz"+e]="moz"+r,n}var $u={animationend:B0("Animation","AnimationEnd"),animationiteration:B0("Animation","AnimationIteration"),animationstart:B0("Animation","AnimationStart"),transitionend:B0("Transition","TransitionEnd")},ix={},bb={};vo&&(bb=document.createElement("div").style,"AnimationEvent"in window||(delete $u.animationend.animation,delete $u.animationiteration.animation,delete $u.animationstart.animation),"TransitionEvent"in window||delete $u.transitionend.transition);function n_(e){if(ix[e])return ix[e];if(!$u[e])return e;var r=$u[e],n;for(n in r)if(r.hasOwnProperty(n)&&n in bb)return ix[e]=r[n];return e}var Sb=n_("animationend"),kb=n_("animationiteration"),Ab=n_("animationstart"),Cb=n_("transitionend"),Ib=new Map,Lw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function kl(e,r){Ib.set(e,r),Dc(r,[e])}for(var ax=0;ax<Lw.length;ax++){var sx=Lw[ax],I4=sx.toLowerCase(),M4=sx[0].toUpperCase()+sx.slice(1);kl(I4,"on"+M4)}kl(Sb,"onAnimationEnd");kl(kb,"onAnimationIteration");kl(Ab,"onAnimationStart");kl("dblclick","onDoubleClick");kl("focusin","onFocus");kl("focusout","onBlur");kl(Cb,"onTransitionEnd");oh("onMouseEnter",["mouseout","mouseover"]);oh("onMouseLeave",["mouseout","mouseover"]);oh("onPointerEnter",["pointerout","pointerover"]);oh("onPointerLeave",["pointerout","pointerover"]);Dc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Dc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Dc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Dc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Dc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ed="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),D4=new Set("cancel close invalid load scroll toggle".split(" ").concat(ed));function Rw(e,r,n){var l=e.type||"unknown-event";e.currentTarget=n,II(l,r,void 0,e),e.currentTarget=null}function Mb(e,r){r=(r&4)!==0;for(var n=0;n<e.length;n++){var l=e[n],u=l.event;l=l.listeners;e:{var m=void 0;if(r)for(var x=l.length-1;0<=x;x--){var o=l[x],S=o.instance,A=o.currentTarget;if(o=o.listener,S!==m&&u.isPropagationStopped())break e;Rw(u,o,A),m=S}else for(x=0;x<l.length;x++){if(o=l[x],S=o.instance,A=o.currentTarget,o=o.listener,S!==m&&u.isPropagationStopped())break e;Rw(u,o,A),m=S}}}if(ym)throw e=$x,ym=!1,$x=null,e}function Jr(e,r){var n=r[Qx];n===void 0&&(n=r[Qx]=new Set);var l=e+"__bubble";n.has(l)||(Db(r,e,2,!1),n.add(l))}function ox(e,r,n){var l=0;r&&(l|=4),Db(n,e,l,r)}var N0="_reactListening"+Math.random().toString(36).slice(2);function Dd(e){if(!e[N0]){e[N0]=!0,NE.forEach(function(n){n!=="selectionchange"&&(D4.has(n)||ox(n,!1,e),ox(n,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[N0]||(r[N0]=!0,ox("selectionchange",!1,r))}}function Db(e,r,n,l){switch(pb(r)){case 1:var u=WI;break;case 4:u=ZI;break;default:u=H1}n=u.bind(null,r,n,e),u=void 0,!Gx||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(u=!0),l?u!==void 0?e.addEventListener(r,n,{capture:!0,passive:u}):e.addEventListener(r,n,!0):u!==void 0?e.addEventListener(r,n,{passive:u}):e.addEventListener(r,n,!1)}function lx(e,r,n,l,u){var m=l;if((r&1)===0&&(r&2)===0&&l!==null)e:for(;;){if(l===null)return;var x=l.tag;if(x===3||x===4){var o=l.stateNode.containerInfo;if(o===u||o.nodeType===8&&o.parentNode===u)break;if(x===4)for(x=l.return;x!==null;){var S=x.tag;if((S===3||S===4)&&(S=x.stateNode.containerInfo,S===u||S.nodeType===8&&S.parentNode===u))return;x=x.return}for(;o!==null;){if(x=mc(o),x===null)return;if(S=x.tag,S===5||S===6){l=m=x;continue e}o=o.parentNode}}l=l.return}tb(function(){var A=m,I=G1(n),D=[];e:{var L=Ib.get(e);if(L!==void 0){var B=q1,U=e;switch(e){case"keypress":if(cm(n)===0)break e;case"keydown":case"keyup":B=o4;break;case"focusin":U="focus",B=tx;break;case"focusout":U="blur",B=tx;break;case"beforeblur":case"afterblur":B=tx;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":B=Ew;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":B=qI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":B=u4;break;case Sb:case kb:case Ab:B=JI;break;case Cb:B=f4;break;case"scroll":B=HI;break;case"wheel":B=p4;break;case"copy":case"cut":case"paste":B=e4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":B=Sw}var V=(r&4)!==0,Y=!V&&e==="scroll",X=V?L!==null?L+"Capture":null:L;V=[];for(var K=A,G;K!==null;){G=K;var me=G.stateNode;if(G.tag===5&&me!==null&&(G=me,X!==null&&(me=Sd(K,X),me!=null&&V.push(Fd(K,me,G)))),Y)break;K=K.return}0<V.length&&(L=new B(L,U,null,n,I),D.push({event:L,listeners:V}))}}if((r&7)===0){e:{if(L=e==="mouseover"||e==="pointerover",B=e==="mouseout"||e==="pointerout",L&&n!==Vx&&(U=n.relatedTarget||n.fromElement)&&(mc(U)||U[wo]))break e;if((B||L)&&(L=I.window===I?I:(L=I.ownerDocument)?L.defaultView||L.parentWindow:window,B?(U=n.relatedTarget||n.toElement,B=A,U=U?mc(U):null,U!==null&&(Y=Fc(U),U!==Y||U.tag!==5&&U.tag!==6)&&(U=null)):(B=null,U=A),B!==U)){if(V=Ew,me="onMouseLeave",X="onMouseEnter",K="mouse",(e==="pointerout"||e==="pointerover")&&(V=Sw,me="onPointerLeave",X="onPointerEnter",K="pointer"),Y=B==null?L:Wu(B),G=U==null?L:Wu(U),L=new V(me,K+"leave",B,n,I),L.target=Y,L.relatedTarget=G,me=null,mc(I)===A&&(V=new V(X,K+"enter",U,n,I),V.target=G,V.relatedTarget=Y,me=V),Y=me,B&&U)t:{for(V=B,X=U,K=0,G=V;G;G=Ou(G))K++;for(G=0,me=X;me;me=Ou(me))G++;for(;0<K-G;)V=Ou(V),K--;for(;0<G-K;)X=Ou(X),G--;for(;K--;){if(V===X||X!==null&&V===X.alternate)break t;V=Ou(V),X=Ou(X)}V=null}else V=null;B!==null&&zw(D,L,B,V,!1),U!==null&&Y!==null&&zw(D,Y,U,V,!0)}}e:{if(L=A?Wu(A):window,B=L.nodeName&&L.nodeName.toLowerCase(),B==="select"||B==="input"&&L.type==="file")var Ae=w4;else if(Cw(L))if(vb)Ae=S4;else{Ae=E4;var ge=T4}else(B=L.nodeName)&&B.toLowerCase()==="input"&&(L.type==="checkbox"||L.type==="radio")&&(Ae=b4);if(Ae&&(Ae=Ae(e,A))){yb(D,Ae,n,I);break e}ge&&ge(e,L,A),e==="focusout"&&(ge=L._wrapperState)&&ge.controlled&&L.type==="number"&&zx(L,"number",L.value)}switch(ge=A?Wu(A):window,e){case"focusin":(Cw(ge)||ge.contentEditable==="true")&&(Gu=ge,Xx=A,ud=null);break;case"focusout":ud=Xx=Gu=null;break;case"mousedown":qx=!0;break;case"contextmenu":case"mouseup":case"dragend":qx=!1,Pw(D,n,I);break;case"selectionchange":if(C4)break;case"keydown":case"keyup":Pw(D,n,I)}var se;if(Y1)e:{switch(e){case"compositionstart":var ke="onCompositionStart";break e;case"compositionend":ke="onCompositionEnd";break e;case"compositionupdate":ke="onCompositionUpdate";break e}ke=void 0}else ju?gb(e,n)&&(ke="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ke="onCompositionStart");ke&&(_b&&n.locale!=="ko"&&(ju||ke!=="onCompositionStart"?ke==="onCompositionEnd"&&ju&&(se=mb()):(cl=I,X1="value"in cl?cl.value:cl.textContent,ju=!0)),ge=Em(A,ke),0<ge.length&&(ke=new bw(ke,e,null,n,I),D.push({event:ke,listeners:ge}),se?ke.data=se:(se=xb(n),se!==null&&(ke.data=se)))),(se=_4?g4(e,n):x4(e,n))&&(A=Em(A,"onBeforeInput"),0<A.length&&(I=new bw("onBeforeInput","beforeinput",null,n,I),D.push({event:I,listeners:A}),I.data=se))}Mb(D,r)})}function Fd(e,r,n){return{instance:e,listener:r,currentTarget:n}}function Em(e,r){for(var n=r+"Capture",l=[];e!==null;){var u=e,m=u.stateNode;u.tag===5&&m!==null&&(u=m,m=Sd(e,n),m!=null&&l.unshift(Fd(e,m,u)),m=Sd(e,r),m!=null&&l.push(Fd(e,m,u))),e=e.return}return l}function Ou(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function zw(e,r,n,l,u){for(var m=r._reactName,x=[];n!==null&&n!==l;){var o=n,S=o.alternate,A=o.stateNode;if(S!==null&&S===l)break;o.tag===5&&A!==null&&(o=A,u?(S=Sd(n,m),S!=null&&x.unshift(Fd(n,S,o))):u||(S=Sd(n,m),S!=null&&x.push(Fd(n,S,o)))),n=n.return}x.length!==0&&e.push({event:r,listeners:x})}var F4=/\r\n?/g,P4=/\u0000|\uFFFD/g;function Ow(e){return(typeof e=="string"?e:""+e).replace(F4,`
`).replace(P4,"")}function U0(e,r,n){if(r=Ow(r),Ow(e)!==r&&n)throw Error(Et(425))}function bm(){}var Kx=null;function Yx(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var Jx=typeof setTimeout=="function"?setTimeout:void 0,L4=typeof clearTimeout=="function"?clearTimeout:void 0,Bw=typeof Promise=="function"?Promise:void 0,R4=typeof queueMicrotask=="function"?queueMicrotask:typeof Bw!="undefined"?function(e){return Bw.resolve(null).then(e).catch(z4)}:Jx;function z4(e){setTimeout(function(){throw e})}function cx(e,r){var n=r,l=0;do{var u=n.nextSibling;if(e.removeChild(n),u&&u.nodeType===8)if(n=u.data,n==="/$"){if(l===0){e.removeChild(u),Cd(r);return}l--}else n!=="$"&&n!=="$?"&&n!=="$!"||l++;n=u}while(n);Cd(r)}function fo(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function Nw(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(r===0)return e;r--}else n==="/$"&&r++}e=e.previousSibling}return null}var yh=Math.random().toString(36).slice(2),Os="__reactFiber$"+yh,Pd="__reactProps$"+yh,wo="__reactContainer$"+yh,Qx="__reactEvents$"+yh,O4="__reactListeners$"+yh,B4="__reactHandles$"+yh;function mc(e){var r=e[Os];if(r)return r;for(var n=e.parentNode;n;){if(r=n[wo]||n[Os]){if(n=r.alternate,r.child!==null||n!==null&&n.child!==null)for(e=Nw(e);e!==null;){if(n=e[Os])return n;e=Nw(e)}return r}e=n,n=e.parentNode}return null}function Jd(e){return e=e[Os]||e[wo],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Wu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Et(33))}function i_(e){return e[Pd]||null}var e1=[],Zu=-1;function Al(e){return{current:e}}function Qr(e){0>Zu||(e.current=e1[Zu],e1[Zu]=null,Zu--)}function Zr(e,r){Zu++,e1[Zu]=e.current,e.current=r}var Tl={},yi=Al(Tl),la=Al(!1),Sc=Tl;function lh(e,r){var n=e.type.contextTypes;if(!n)return Tl;var l=e.stateNode;if(l&&l.__reactInternalMemoizedUnmaskedChildContext===r)return l.__reactInternalMemoizedMaskedChildContext;var u={},m;for(m in n)u[m]=r[m];return l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=u),u}function ca(e){return e=e.childContextTypes,e!=null}function Sm(){Qr(la),Qr(yi)}function Uw(e,r,n){if(yi.current!==Tl)throw Error(Et(168));Zr(yi,r),Zr(la,n)}function Fb(e,r,n){var l=e.stateNode;if(r=r.childContextTypes,typeof l.getChildContext!="function")return n;l=l.getChildContext();for(var u in l)if(!(u in r))throw Error(Et(108,TI(e)||"Unknown",u));return un({},n,l)}function km(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Tl,Sc=yi.current,Zr(yi,e),Zr(la,la.current),!0}function Vw(e,r,n){var l=e.stateNode;if(!l)throw Error(Et(169));n?(e=Fb(e,r,Sc),l.__reactInternalMemoizedMergedChildContext=e,Qr(la),Qr(yi),Zr(yi,e)):Qr(la),Zr(la,n)}var ho=null,a_=!1,ux=!1;function Pb(e){ho===null?ho=[e]:ho.push(e)}function N4(e){a_=!0,Pb(e)}function Cl(){if(!ux&&ho!==null){ux=!0;var e=0,r=Br;try{var n=ho;for(Br=1;e<n.length;e++){var l=n[e];do l=l(!0);while(l!==null)}ho=null,a_=!1}catch(u){throw ho!==null&&(ho=ho.slice(e+1)),ab($1,Cl),u}finally{Br=r,ux=!1}}return null}var U4=bo.ReactCurrentBatchConfig;function ss(e,r){if(e&&e.defaultProps){r=un({},r),e=e.defaultProps;for(var n in e)r[n]===void 0&&(r[n]=e[n]);return r}return r}var Am=Al(null),Cm=null,Hu=null,Q1=null;function ey(){Q1=Hu=Cm=null}function ty(e){var r=Am.current;Qr(Am),e._currentValue=r}function t1(e,r,n){for(;e!==null;){var l=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,l!==null&&(l.childLanes|=r)):l!==null&&(l.childLanes&r)!==r&&(l.childLanes|=r),e===n)break;e=e.return}}function rh(e,r){Cm=e,Q1=Hu=null,e=e.dependencies,e!==null&&e.firstContext!==null&&((e.lanes&r)!==0&&(wa=!0),e.firstContext=null)}function $a(e){var r=e._currentValue;if(Q1!==e)if(e={context:e,memoizedValue:r,next:null},Hu===null){if(Cm===null)throw Error(Et(308));Hu=e,Cm.dependencies={lanes:0,firstContext:e}}else Hu=Hu.next=e;return r}var Bs=null,il=!1;function ry(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Lb(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function go(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function _l(e,r){var n=e.updateQueue;n!==null&&(n=n.shared,Rn!==null&&(e.mode&1)!==0&&(Er&2)===0?(e=n.interleaved,e===null?(r.next=r,Bs===null?Bs=[n]:Bs.push(n)):(r.next=e.next,e.next=r),n.interleaved=r):(e=n.pending,e===null?r.next=r:(r.next=e.next,e.next=r),n.pending=r))}function um(e,r,n){if(r=r.updateQueue,r!==null&&(r=r.shared,(n&4194240)!==0)){var l=r.lanes;l&=e.pendingLanes,n|=l,r.lanes=n,W1(e,n)}}function jw(e,r){var n=e.updateQueue,l=e.alternate;if(l!==null&&(l=l.updateQueue,n===l)){var u=null,m=null;if(n=n.firstBaseUpdate,n!==null){do{var x={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};m===null?u=m=x:m=m.next=x,n=n.next}while(n!==null);m===null?u=m=r:m=m.next=r}else u=m=r;n={baseState:l.baseState,firstBaseUpdate:u,lastBaseUpdate:m,shared:l.shared,effects:l.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=r:e.next=r,n.lastBaseUpdate=r}function Im(e,r,n,l){var u=e.updateQueue;il=!1;var m=u.firstBaseUpdate,x=u.lastBaseUpdate,o=u.shared.pending;if(o!==null){u.shared.pending=null;var S=o,A=S.next;S.next=null,x===null?m=A:x.next=A,x=S;var I=e.alternate;I!==null&&(I=I.updateQueue,o=I.lastBaseUpdate,o!==x&&(o===null?I.firstBaseUpdate=A:o.next=A,I.lastBaseUpdate=S))}if(m!==null){var D=u.baseState;x=0,I=A=S=null,o=m;do{var L=o.lane,B=o.eventTime;if((l&L)===L){I!==null&&(I=I.next={eventTime:B,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var U=e,V=o;switch(L=r,B=n,V.tag){case 1:if(U=V.payload,typeof U=="function"){D=U.call(B,D,L);break e}D=U;break e;case 3:U.flags=U.flags&-65537|128;case 0:if(U=V.payload,L=typeof U=="function"?U.call(B,D,L):U,L==null)break e;D=un({},D,L);break e;case 2:il=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,L=u.effects,L===null?u.effects=[o]:L.push(o))}else B={eventTime:B,lane:L,tag:o.tag,payload:o.payload,callback:o.callback,next:null},I===null?(A=I=B,S=D):I=I.next=B,x|=L;if(o=o.next,o===null){if(o=u.shared.pending,o===null)break;L=o,o=L.next,L.next=null,u.lastBaseUpdate=L,u.shared.pending=null}}while(1);if(I===null&&(S=D),u.baseState=S,u.firstBaseUpdate=A,u.lastBaseUpdate=I,r=u.shared.interleaved,r!==null){u=r;do x|=u.lane,u=u.next;while(u!==r)}else m===null&&(u.shared.lanes=0);dh|=x,e.lanes=x,e.memoizedState=D}}function Gw(e,r,n){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var l=e[r],u=l.callback;if(u!==null){if(l.callback=null,l=n,typeof u!="function")throw Error(Et(191,u));u.call(l)}}}var Rb=new BE.Component().refs;function r1(e,r,n,l){r=e.memoizedState,n=n(l,r),n=n==null?r:un({},r,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var s_={isMounted:function(e){return(e=e._reactInternals)?Fc(e)===e:!1},enqueueSetState:function(e,r,n){e=e._reactInternals;var l=Ui(),u=xl(e),m=go(l,u);m.payload=r,n!=null&&(m.callback=n),_l(e,m),r=Ga(e,u,l),r!==null&&um(r,e,u)},enqueueReplaceState:function(e,r,n){e=e._reactInternals;var l=Ui(),u=xl(e),m=go(l,u);m.tag=1,m.payload=r,n!=null&&(m.callback=n),_l(e,m),r=Ga(e,u,l),r!==null&&um(r,e,u)},enqueueForceUpdate:function(e,r){e=e._reactInternals;var n=Ui(),l=xl(e),u=go(n,l);u.tag=2,r!=null&&(u.callback=r),_l(e,u),r=Ga(e,l,n),r!==null&&um(r,e,l)}};function $w(e,r,n,l,u,m,x){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(l,m,x):r.prototype&&r.prototype.isPureReactComponent?!Md(n,l)||!Md(u,m):!0}function zb(e,r,n){var l=!1,u=Tl,m=r.contextType;return typeof m=="object"&&m!==null?m=$a(m):(u=ca(r)?Sc:yi.current,l=r.contextTypes,m=(l=l!=null)?lh(e,u):Tl),r=new r(n,m),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=s_,e.stateNode=r,r._reactInternals=e,l&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=u,e.__reactInternalMemoizedMaskedChildContext=m),r}function Ww(e,r,n,l){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(n,l),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(n,l),r.state!==e&&s_.enqueueReplaceState(r,r.state,null)}function n1(e,r,n,l){var u=e.stateNode;u.props=n,u.state=e.memoizedState,u.refs=Rb,ry(e);var m=r.contextType;typeof m=="object"&&m!==null?u.context=$a(m):(m=ca(r)?Sc:yi.current,u.context=lh(e,m)),u.state=e.memoizedState,m=r.getDerivedStateFromProps,typeof m=="function"&&(r1(e,r,m,n),u.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof u.getSnapshotBeforeUpdate=="function"||typeof u.UNSAFE_componentWillMount!="function"&&typeof u.componentWillMount!="function"||(r=u.state,typeof u.componentWillMount=="function"&&u.componentWillMount(),typeof u.UNSAFE_componentWillMount=="function"&&u.UNSAFE_componentWillMount(),r!==u.state&&s_.enqueueReplaceState(u,u.state,null),Im(e,n,u,l),u.state=e.memoizedState),typeof u.componentDidMount=="function"&&(e.flags|=4194308)}var Xu=[],qu=0,Mm=null,Dm=0,Ba=[],Na=0,kc=null,po=1,mo="";function fc(e,r){Xu[qu++]=Dm,Xu[qu++]=Mm,Mm=e,Dm=r}function Ob(e,r,n){Ba[Na++]=po,Ba[Na++]=mo,Ba[Na++]=kc,kc=e;var l=po;e=mo;var u=32-hs(l)-1;l&=~(1<<u),n+=1;var m=32-hs(r)+u;if(30<m){var x=u-u%5;m=(l&(1<<x)-1).toString(32),l>>=x,u-=x,po=1<<32-hs(r)+u|n<<u|l,mo=m+e}else po=1<<m|n<<u|l,mo=e}function ny(e){e.return!==null&&(fc(e,1),Ob(e,1,0))}function iy(e){for(;e===Mm;)Mm=Xu[--qu],Xu[qu]=null,Dm=Xu[--qu],Xu[qu]=null;for(;e===kc;)kc=Ba[--Na],Ba[Na]=null,mo=Ba[--Na],Ba[Na]=null,po=Ba[--Na],Ba[Na]=null}var Ta=null,sa=null,nn=!1,os=null;function Bb(e,r){var n=Ua(5,null,null,0);n.elementType="DELETED",n.stateNode=r,n.return=e,r=e.deletions,r===null?(e.deletions=[n],e.flags|=16):r.push(n)}function Zw(e,r){switch(e.tag){case 5:var n=e.type;return r=r.nodeType!==1||n.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,Ta=e,sa=fo(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,Ta=e,sa=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(n=kc!==null?{id:po,overflow:mo}:null,e.memoizedState={dehydrated:r,treeContext:n,retryLane:1073741824},n=Ua(18,null,null,0),n.stateNode=r,n.return=e,e.child=n,Ta=e,sa=null,!0):!1;default:return!1}}function i1(e){return(e.mode&1)!==0&&(e.flags&128)===0}function a1(e){if(nn){var r=sa;if(r){var n=r;if(!Zw(e,r)){if(i1(e))throw Error(Et(418));r=fo(n.nextSibling);var l=Ta;r&&Zw(e,r)?Bb(l,n):(e.flags=e.flags&-4097|2,nn=!1,Ta=e)}}else{if(i1(e))throw Error(Et(418));e.flags=e.flags&-4097|2,nn=!1,Ta=e}}}function Hw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Ta=e}function Hf(e){if(e!==Ta)return!1;if(!nn)return Hw(e),nn=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!Yx(e.type,e.memoizedProps)),r&&(r=sa)){if(i1(e)){for(e=sa;e;)e=fo(e.nextSibling);throw Error(Et(418))}for(;r;)Bb(e,r),r=fo(r.nextSibling)}if(Hw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Et(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(r===0){sa=fo(e.nextSibling);break e}r--}else n!=="$"&&n!=="$!"&&n!=="$?"||r++}e=e.nextSibling}sa=null}}else sa=Ta?fo(e.stateNode.nextSibling):null;return!0}function ch(){sa=Ta=null,nn=!1}function ay(e){os===null?os=[e]:os.push(e)}function Xf(e,r,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Et(309));var l=n.stateNode}if(!l)throw Error(Et(147,e));var u=l,m=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===m?r.ref:(r=function(x){var o=u.refs;o===Rb&&(o=u.refs={}),x===null?delete o[m]:o[m]=x},r._stringRef=m,r)}if(typeof e!="string")throw Error(Et(284));if(!n._owner)throw Error(Et(290,e))}return e}function V0(e,r){throw e=Object.prototype.toString.call(r),Error(Et(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function Xw(e){var r=e._init;return r(e._payload)}function Nb(e){function r(X,K){if(e){var G=X.deletions;G===null?(X.deletions=[K],X.flags|=16):G.push(K)}}function n(X,K){if(!e)return null;for(;K!==null;)r(X,K),K=K.sibling;return null}function l(X,K){for(X=new Map;K!==null;)K.key!==null?X.set(K.key,K):X.set(K.index,K),K=K.sibling;return X}function u(X,K){return X=El(X,K),X.index=0,X.sibling=null,X}function m(X,K,G){return X.index=G,e?(G=X.alternate,G!==null?(G=G.index,G<K?(X.flags|=2,K):G):(X.flags|=2,K)):(X.flags|=1048576,K)}function x(X){return e&&X.alternate===null&&(X.flags|=2),X}function o(X,K,G,me){return K===null||K.tag!==6?(K=_x(G,X.mode,me),K.return=X,K):(K=u(K,G),K.return=X,K)}function S(X,K,G,me){var Ae=G.type;return Ae===Vu?I(X,K,G.props.children,me,G.key):K!==null&&(K.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===nl&&Xw(Ae)===K.type)?(me=u(K,G.props),me.ref=Xf(X,K,G),me.return=X,me):(me=mm(G.type,G.key,G.props,null,X.mode,me),me.ref=Xf(X,K,G),me.return=X,me)}function A(X,K,G,me){return K===null||K.tag!==4||K.stateNode.containerInfo!==G.containerInfo||K.stateNode.implementation!==G.implementation?(K=gx(G,X.mode,me),K.return=X,K):(K=u(K,G.children||[]),K.return=X,K)}function I(X,K,G,me,Ae){return K===null||K.tag!==7?(K=Tc(G,X.mode,me,Ae),K.return=X,K):(K=u(K,G),K.return=X,K)}function D(X,K,G){if(typeof K=="string"&&K!==""||typeof K=="number")return K=_x(""+K,X.mode,G),K.return=X,K;if(typeof K=="object"&&K!==null){switch(K.$$typeof){case D0:return G=mm(K.type,K.key,K.props,null,X.mode,G),G.ref=Xf(X,null,K),G.return=X,G;case Uu:return K=gx(K,X.mode,G),K.return=X,K;case nl:var me=K._init;return D(X,me(K._payload),G)}if(Jf(K)||jf(K))return K=Tc(K,X.mode,G,null),K.return=X,K;V0(X,K)}return null}function L(X,K,G,me){var Ae=K!==null?K.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return Ae!==null?null:o(X,K,""+G,me);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case D0:return G.key===Ae?S(X,K,G,me):null;case Uu:return G.key===Ae?A(X,K,G,me):null;case nl:return Ae=G._init,L(X,K,Ae(G._payload),me)}if(Jf(G)||jf(G))return Ae!==null?null:I(X,K,G,me,null);V0(X,G)}return null}function B(X,K,G,me,Ae){if(typeof me=="string"&&me!==""||typeof me=="number")return X=X.get(G)||null,o(K,X,""+me,Ae);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case D0:return X=X.get(me.key===null?G:me.key)||null,S(K,X,me,Ae);case Uu:return X=X.get(me.key===null?G:me.key)||null,A(K,X,me,Ae);case nl:var ge=me._init;return B(X,K,G,ge(me._payload),Ae)}if(Jf(me)||jf(me))return X=X.get(G)||null,I(K,X,me,Ae,null);V0(K,me)}return null}function U(X,K,G,me){for(var Ae=null,ge=null,se=K,ke=K=0,Ie=null;se!==null&&ke<G.length;ke++){se.index>ke?(Ie=se,se=null):Ie=se.sibling;var Xe=L(X,se,G[ke],me);if(Xe===null){se===null&&(se=Ie);break}e&&se&&Xe.alternate===null&&r(X,se),K=m(Xe,K,ke),ge===null?Ae=Xe:ge.sibling=Xe,ge=Xe,se=Ie}if(ke===G.length)return n(X,se),nn&&fc(X,ke),Ae;if(se===null){for(;ke<G.length;ke++)se=D(X,G[ke],me),se!==null&&(K=m(se,K,ke),ge===null?Ae=se:ge.sibling=se,ge=se);return nn&&fc(X,ke),Ae}for(se=l(X,se);ke<G.length;ke++)Ie=B(se,X,ke,G[ke],me),Ie!==null&&(e&&Ie.alternate!==null&&se.delete(Ie.key===null?ke:Ie.key),K=m(Ie,K,ke),ge===null?Ae=Ie:ge.sibling=Ie,ge=Ie);return e&&se.forEach(function($e){return r(X,$e)}),nn&&fc(X,ke),Ae}function V(X,K,G,me){var Ae=jf(G);if(typeof Ae!="function")throw Error(Et(150));if(G=Ae.call(G),G==null)throw Error(Et(151));for(var ge=Ae=null,se=K,ke=K=0,Ie=null,Xe=G.next();se!==null&&!Xe.done;ke++,Xe=G.next()){se.index>ke?(Ie=se,se=null):Ie=se.sibling;var $e=L(X,se,Xe.value,me);if($e===null){se===null&&(se=Ie);break}e&&se&&$e.alternate===null&&r(X,se),K=m($e,K,ke),ge===null?Ae=$e:ge.sibling=$e,ge=$e,se=Ie}if(Xe.done)return n(X,se),nn&&fc(X,ke),Ae;if(se===null){for(;!Xe.done;ke++,Xe=G.next())Xe=D(X,Xe.value,me),Xe!==null&&(K=m(Xe,K,ke),ge===null?Ae=Xe:ge.sibling=Xe,ge=Xe);return nn&&fc(X,ke),Ae}for(se=l(X,se);!Xe.done;ke++,Xe=G.next())Xe=B(se,X,ke,Xe.value,me),Xe!==null&&(e&&Xe.alternate!==null&&se.delete(Xe.key===null?ke:Xe.key),K=m(Xe,K,ke),ge===null?Ae=Xe:ge.sibling=Xe,ge=Xe);return e&&se.forEach(function(We){return r(X,We)}),nn&&fc(X,ke),Ae}function Y(X,K,G,me){if(typeof G=="object"&&G!==null&&G.type===Vu&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case D0:e:{for(var Ae=G.key,ge=K;ge!==null;){if(ge.key===Ae){if(Ae=G.type,Ae===Vu){if(ge.tag===7){n(X,ge.sibling),K=u(ge,G.props.children),K.return=X,X=K;break e}}else if(ge.elementType===Ae||typeof Ae=="object"&&Ae!==null&&Ae.$$typeof===nl&&Xw(Ae)===ge.type){n(X,ge.sibling),K=u(ge,G.props),K.ref=Xf(X,ge,G),K.return=X,X=K;break e}n(X,ge);break}else r(X,ge);ge=ge.sibling}G.type===Vu?(K=Tc(G.props.children,X.mode,me,G.key),K.return=X,X=K):(me=mm(G.type,G.key,G.props,null,X.mode,me),me.ref=Xf(X,K,G),me.return=X,X=me)}return x(X);case Uu:e:{for(ge=G.key;K!==null;){if(K.key===ge)if(K.tag===4&&K.stateNode.containerInfo===G.containerInfo&&K.stateNode.implementation===G.implementation){n(X,K.sibling),K=u(K,G.children||[]),K.return=X,X=K;break e}else{n(X,K);break}else r(X,K);K=K.sibling}K=gx(G,X.mode,me),K.return=X,X=K}return x(X);case nl:return ge=G._init,Y(X,K,ge(G._payload),me)}if(Jf(G))return U(X,K,G,me);if(jf(G))return V(X,K,G,me);V0(X,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,K!==null&&K.tag===6?(n(X,K.sibling),K=u(K,G),K.return=X,X=K):(n(X,K),K=_x(G,X.mode,me),K.return=X,X=K),x(X)):n(X,K)}return Y}var uh=Nb(!0),Ub=Nb(!1),Qd={},Us=Al(Qd),Ld=Al(Qd),Rd=Al(Qd);function _c(e){if(e===Qd)throw Error(Et(174));return e}function sy(e,r){switch(Zr(Rd,r),Zr(Ld,e),Zr(Us,Qd),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:Bx(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=Bx(r,e)}Qr(Us),Zr(Us,r)}function hh(){Qr(Us),Qr(Ld),Qr(Rd)}function Vb(e){_c(Rd.current);var r=_c(Us.current),n=Bx(r,e.type);r!==n&&(Zr(Ld,e),Zr(Us,n))}function oy(e){Ld.current===e&&(Qr(Us),Qr(Ld))}var cn=Al(0);function Fm(e){for(var r=e;r!==null;){if(r.tag===13){var n=r.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var hx=[];function ly(){for(var e=0;e<hx.length;e++)hx[e]._workInProgressVersionPrimary=null;hx.length=0}var hm=bo.ReactCurrentDispatcher,Va=bo.ReactCurrentBatchConfig,fh=0,vn=null,pi=null,qn=null,Pm=!1,hd=!1,zd=0,V4=0;function hi(){throw Error(Et(321))}function cy(e,r){if(r===null)return!1;for(var n=0;n<r.length&&n<e.length;n++)if(!Vs(e[n],r[n]))return!1;return!0}function uy(e,r,n,l,u,m){if(fh=m,vn=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,hm.current=e===null||e.memoizedState===null?W4:Z4,e=n(l,u),hd){m=0;do{if(hd=!1,zd=0,25<=m)throw Error(Et(301));m+=1,qn=pi=null,r.updateQueue=null,hm.current=H4,e=n(l,u)}while(hd)}if(hm.current=Lm,r=pi!==null&&pi.next!==null,fh=0,qn=pi=vn=null,Pm=!1,r)throw Error(Et(300));return e}function hy(){var e=zd!==0;return zd=0,e}function uo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return qn===null?vn.memoizedState=qn=e:qn=qn.next=e,qn}function Gs(){if(pi===null){var e=vn.alternate;e=e!==null?e.memoizedState:null}else e=pi.next;var r=qn===null?vn.memoizedState:qn.next;if(r!==null)qn=r,pi=e;else{if(e===null)throw Error(Et(310));pi=e,e={memoizedState:pi.memoizedState,baseState:pi.baseState,baseQueue:pi.baseQueue,queue:pi.queue,next:null},qn===null?vn.memoizedState=qn=e:qn=qn.next=e}return qn}function vc(e,r){return typeof r=="function"?r(e):r}function j0(e){var r=Gs(),n=r.queue;if(n===null)throw Error(Et(311));n.lastRenderedReducer=e;var l=pi,u=l.baseQueue,m=n.pending;if(m!==null){if(u!==null){var x=u.next;u.next=m.next,m.next=x}l.baseQueue=u=m,n.pending=null}if(u!==null){m=u.next,l=l.baseState;var o=x=null,S=null,A=m;do{var I=A.lane;if((fh&I)===I)S!==null&&(S=S.next={lane:0,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null}),l=A.hasEagerState?A.eagerState:e(l,A.action);else{var D={lane:I,action:A.action,hasEagerState:A.hasEagerState,eagerState:A.eagerState,next:null};S===null?(o=S=D,x=l):S=S.next=D,vn.lanes|=I,dh|=I}A=A.next}while(A!==null&&A!==m);S===null?x=l:S.next=o,Vs(l,r.memoizedState)||(wa=!0),r.memoizedState=l,r.baseState=x,r.baseQueue=S,n.lastRenderedState=l}if(e=n.interleaved,e!==null){u=e;do m=u.lane,vn.lanes|=m,dh|=m,u=u.next;while(u!==e)}else u===null&&(n.lanes=0);return[r.memoizedState,n.dispatch]}function G0(e){var r=Gs(),n=r.queue;if(n===null)throw Error(Et(311));n.lastRenderedReducer=e;var l=n.dispatch,u=n.pending,m=r.memoizedState;if(u!==null){n.pending=null;var x=u=u.next;do m=e(m,x.action),x=x.next;while(x!==u);Vs(m,r.memoizedState)||(wa=!0),r.memoizedState=m,r.baseQueue===null&&(r.baseState=m),n.lastRenderedState=m}return[m,l]}function jb(){}function Gb(e,r){var n=vn,l=Gs(),u=r(),m=!Vs(l.memoizedState,u);if(m&&(l.memoizedState=u,wa=!0),l=l.queue,Bd(Zb.bind(null,n,l,e),[e]),l.getSnapshot!==r||m||qn!==null&&qn.memoizedState.tag&1){if(n.flags|=2048,Od(9,Wb.bind(null,n,l,u,r),void 0,null),Rn===null)throw Error(Et(349));(fh&30)!==0||$b(n,r,u)}return u}function $b(e,r,n){e.flags|=16384,e={getSnapshot:r,value:n},r=vn.updateQueue,r===null?(r={lastEffect:null,stores:null},vn.updateQueue=r,r.stores=[e]):(n=r.stores,n===null?r.stores=[e]:n.push(e))}function Wb(e,r,n,l){r.value=n,r.getSnapshot=l,Hb(r)&&Ga(e,1,-1)}function Zb(e,r,n){return n(function(){Hb(r)&&Ga(e,1,-1)})}function Hb(e){var r=e.getSnapshot;e=e.value;try{var n=r();return!Vs(e,n)}catch{return!0}}function fx(e){var r=uo();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:vc,lastRenderedState:e},r.queue=e,e=e.dispatch=$4.bind(null,vn,e),[r.memoizedState,e]}function Od(e,r,n,l){return e={tag:e,create:r,destroy:n,deps:l,next:null},r=vn.updateQueue,r===null?(r={lastEffect:null,stores:null},vn.updateQueue=r,r.lastEffect=e.next=e):(n=r.lastEffect,n===null?r.lastEffect=e.next=e:(l=n.next,n.next=e,e.next=l,r.lastEffect=e)),e}function Xb(){return Gs().memoizedState}function fm(e,r,n,l){var u=uo();vn.flags|=e,u.memoizedState=Od(1|r,n,void 0,l===void 0?null:l)}function o_(e,r,n,l){var u=Gs();l=l===void 0?null:l;var m=void 0;if(pi!==null){var x=pi.memoizedState;if(m=x.destroy,l!==null&&cy(l,x.deps)){u.memoizedState=Od(r,n,m,l);return}}vn.flags|=e,u.memoizedState=Od(1|r,n,m,l)}function dx(e,r){return fm(8390656,8,e,r)}function Bd(e,r){return o_(2048,8,e,r)}function qb(e,r){return o_(4,2,e,r)}function Kb(e,r){return o_(4,4,e,r)}function Yb(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function Jb(e,r,n){return n=n!=null?n.concat([e]):null,o_(4,4,Yb.bind(null,r,e),n)}function fy(){}function Qb(e,r){var n=Gs();r=r===void 0?null:r;var l=n.memoizedState;return l!==null&&r!==null&&cy(r,l[1])?l[0]:(n.memoizedState=[e,r],e)}function eS(e,r){var n=Gs();r=r===void 0?null:r;var l=n.memoizedState;return l!==null&&r!==null&&cy(r,l[1])?l[0]:(e=e(),n.memoizedState=[e,r],e)}function j4(e,r){var n=Br;Br=n!==0&&4>n?n:4,e(!0);var l=Va.transition;Va.transition={};try{e(!1),r()}finally{Br=n,Va.transition=l}}function tS(){return Gs().memoizedState}function G4(e,r,n){var l=xl(e);n={lane:l,action:n,hasEagerState:!1,eagerState:null,next:null},rS(e)?nS(r,n):(iS(e,r,n),n=Ui(),e=Ga(e,l,n),e!==null&&aS(e,r,l))}function $4(e,r,n){var l=xl(e),u={lane:l,action:n,hasEagerState:!1,eagerState:null,next:null};if(rS(e))nS(r,u);else{iS(e,r,u);var m=e.alternate;if(e.lanes===0&&(m===null||m.lanes===0)&&(m=r.lastRenderedReducer,m!==null))try{var x=r.lastRenderedState,o=m(x,n);if(u.hasEagerState=!0,u.eagerState=o,Vs(o,x))return}catch{}finally{}n=Ui(),e=Ga(e,l,n),e!==null&&aS(e,r,l)}}function rS(e){var r=e.alternate;return e===vn||r!==null&&r===vn}function nS(e,r){hd=Pm=!0;var n=e.pending;n===null?r.next=r:(r.next=n.next,n.next=r),e.pending=r}function iS(e,r,n){Rn!==null&&(e.mode&1)!==0&&(Er&2)===0?(e=r.interleaved,e===null?(n.next=n,Bs===null?Bs=[r]:Bs.push(r)):(n.next=e.next,e.next=n),r.interleaved=n):(e=r.pending,e===null?n.next=n:(n.next=e.next,e.next=n),r.pending=n)}function aS(e,r,n){if((n&4194240)!==0){var l=r.lanes;l&=e.pendingLanes,n|=l,r.lanes=n,W1(e,n)}}var Lm={readContext:$a,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useInsertionEffect:hi,useLayoutEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useMutableSource:hi,useSyncExternalStore:hi,useId:hi,unstable_isNewReconciler:!1},W4={readContext:$a,useCallback:function(e,r){return uo().memoizedState=[e,r===void 0?null:r],e},useContext:$a,useEffect:dx,useImperativeHandle:function(e,r,n){return n=n!=null?n.concat([e]):null,fm(4194308,4,Yb.bind(null,r,e),n)},useLayoutEffect:function(e,r){return fm(4194308,4,e,r)},useInsertionEffect:function(e,r){return fm(4,2,e,r)},useMemo:function(e,r){var n=uo();return r=r===void 0?null:r,e=e(),n.memoizedState=[e,r],e},useReducer:function(e,r,n){var l=uo();return r=n!==void 0?n(r):r,l.memoizedState=l.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},l.queue=e,e=e.dispatch=G4.bind(null,vn,e),[l.memoizedState,e]},useRef:function(e){var r=uo();return e={current:e},r.memoizedState=e},useState:fx,useDebugValue:fy,useDeferredValue:function(e){var r=fx(e),n=r[0],l=r[1];return dx(function(){var u=Va.transition;Va.transition={};try{l(e)}finally{Va.transition=u}},[e]),n},useTransition:function(){var e=fx(!1),r=e[0];return e=j4.bind(null,e[1]),uo().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,n){var l=vn,u=uo();if(nn){if(n===void 0)throw Error(Et(407));n=n()}else{if(n=r(),Rn===null)throw Error(Et(349));(fh&30)!==0||$b(l,r,n)}u.memoizedState=n;var m={value:n,getSnapshot:r};return u.queue=m,dx(Zb.bind(null,l,m,e),[e]),l.flags|=2048,Od(9,Wb.bind(null,l,m,n,r),void 0,null),n},useId:function(){var e=uo(),r=Rn.identifierPrefix;if(nn){var n=mo,l=po;n=(l&~(1<<32-hs(l)-1)).toString(32)+n,r=":"+r+"R"+n,n=zd++,0<n&&(r+="H"+n.toString(32)),r+=":"}else n=V4++,r=":"+r+"r"+n.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},Z4={readContext:$a,useCallback:Qb,useContext:$a,useEffect:Bd,useImperativeHandle:Jb,useInsertionEffect:qb,useLayoutEffect:Kb,useMemo:eS,useReducer:j0,useRef:Xb,useState:function(){return j0(vc)},useDebugValue:fy,useDeferredValue:function(e){var r=j0(vc),n=r[0],l=r[1];return Bd(function(){var u=Va.transition;Va.transition={};try{l(e)}finally{Va.transition=u}},[e]),n},useTransition:function(){var e=j0(vc)[0],r=Gs().memoizedState;return[e,r]},useMutableSource:jb,useSyncExternalStore:Gb,useId:tS,unstable_isNewReconciler:!1},H4={readContext:$a,useCallback:Qb,useContext:$a,useEffect:Bd,useImperativeHandle:Jb,useInsertionEffect:qb,useLayoutEffect:Kb,useMemo:eS,useReducer:G0,useRef:Xb,useState:function(){return G0(vc)},useDebugValue:fy,useDeferredValue:function(e){var r=G0(vc),n=r[0],l=r[1];return Bd(function(){var u=Va.transition;Va.transition={};try{l(e)}finally{Va.transition=u}},[e]),n},useTransition:function(){var e=G0(vc)[0],r=Gs().memoizedState;return[e,r]},useMutableSource:jb,useSyncExternalStore:Gb,useId:tS,unstable_isNewReconciler:!1};function dy(e,r){try{var n="",l=r;do n+=wI(l),l=l.return;while(l);var u=n}catch(m){u=`
Error generating stack: `+m.message+`
`+m.stack}return{value:e,source:r,stack:u}}function s1(e,r){try{console.error(r.value)}catch(n){setTimeout(function(){throw n})}}var X4=typeof WeakMap=="function"?WeakMap:Map;function sS(e,r,n){n=go(-1,n),n.tag=3,n.payload={element:null};var l=r.value;return n.callback=function(){Om||(Om=!0,m1=l),s1(e,r)},n}function oS(e,r,n){n=go(-1,n),n.tag=3;var l=e.type.getDerivedStateFromError;if(typeof l=="function"){var u=r.value;n.payload=function(){return l(u)},n.callback=function(){s1(e,r)}}var m=e.stateNode;return m!==null&&typeof m.componentDidCatch=="function"&&(n.callback=function(){s1(e,r),typeof l!="function"&&(gl===null?gl=new Set([this]):gl.add(this));var x=r.stack;this.componentDidCatch(r.value,{componentStack:x!==null?x:""})}),n}function qw(e,r,n){var l=e.pingCache;if(l===null){l=e.pingCache=new X4;var u=new Set;l.set(r,u)}else u=l.get(r),u===void 0&&(u=new Set,l.set(r,u));u.has(n)||(u.add(n),e=lM.bind(null,e,r,n),r.then(e,e))}function Kw(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function Yw(e,r,n,l,u){return(e.mode&1)===0?(e===r?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(r=go(-1,1),r.tag=2,_l(n,r))),n.lanes|=1),e):(e.flags|=65536,e.lanes=u,e)}var lS,o1,cS,uS;lS=function(e,r){for(var n=r.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===r)break;for(;n.sibling===null;){if(n.return===null||n.return===r)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};o1=function(){};cS=function(e,r,n,l){var u=e.memoizedProps;if(u!==l){e=r.stateNode,_c(Us.current);var m=null;switch(n){case"input":u=Lx(e,u),l=Lx(e,l),m=[];break;case"select":u=un({},u,{value:void 0}),l=un({},l,{value:void 0}),m=[];break;case"textarea":u=Ox(e,u),l=Ox(e,l),m=[];break;default:typeof u.onClick!="function"&&typeof l.onClick=="function"&&(e.onclick=bm)}Nx(n,l);var x;n=null;for(A in u)if(!l.hasOwnProperty(A)&&u.hasOwnProperty(A)&&u[A]!=null)if(A==="style"){var o=u[A];for(x in o)o.hasOwnProperty(x)&&(n||(n={}),n[x]="")}else A!=="dangerouslySetInnerHTML"&&A!=="children"&&A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&A!=="autoFocus"&&(Ed.hasOwnProperty(A)?m||(m=[]):(m=m||[]).push(A,null));for(A in l){var S=l[A];if(o=u!=null?u[A]:void 0,l.hasOwnProperty(A)&&S!==o&&(S!=null||o!=null))if(A==="style")if(o){for(x in o)!o.hasOwnProperty(x)||S&&S.hasOwnProperty(x)||(n||(n={}),n[x]="");for(x in S)S.hasOwnProperty(x)&&o[x]!==S[x]&&(n||(n={}),n[x]=S[x])}else n||(m||(m=[]),m.push(A,n)),n=S;else A==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,o=o?o.__html:void 0,S!=null&&o!==S&&(m=m||[]).push(A,S)):A==="children"?typeof S!="string"&&typeof S!="number"||(m=m||[]).push(A,""+S):A!=="suppressContentEditableWarning"&&A!=="suppressHydrationWarning"&&(Ed.hasOwnProperty(A)?(S!=null&&A==="onScroll"&&Jr("scroll",e),m||o===S||(m=[])):(m=m||[]).push(A,S))}n&&(m=m||[]).push("style",n);var A=m;(r.updateQueue=A)&&(r.flags|=4)}};uS=function(e,r,n,l){n!==l&&(r.flags|=4)};function qf(e,r){if(!nn)switch(e.tailMode){case"hidden":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var l=null;n!==null;)n.alternate!==null&&(l=n),n=n.sibling;l===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:l.sibling=null}}function fi(e){var r=e.alternate!==null&&e.alternate.child===e.child,n=0,l=0;if(r)for(var u=e.child;u!==null;)n|=u.lanes|u.childLanes,l|=u.subtreeFlags&14680064,l|=u.flags&14680064,u.return=e,u=u.sibling;else for(u=e.child;u!==null;)n|=u.lanes|u.childLanes,l|=u.subtreeFlags,l|=u.flags,u.return=e,u=u.sibling;return e.subtreeFlags|=l,e.childLanes=n,r}function q4(e,r,n){var l=r.pendingProps;switch(iy(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return fi(r),null;case 1:return ca(r.type)&&Sm(),fi(r),null;case 3:return l=r.stateNode,hh(),Qr(la),Qr(yi),ly(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(e===null||e.child===null)&&(Hf(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,os!==null&&(x1(os),os=null))),o1(e,r),fi(r),null;case 5:oy(r);var u=_c(Rd.current);if(n=r.type,e!==null&&r.stateNode!=null)cS(e,r,n,l,u),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!l){if(r.stateNode===null)throw Error(Et(166));return fi(r),null}if(e=_c(Us.current),Hf(r)){l=r.stateNode,n=r.type;var m=r.memoizedProps;switch(l[Os]=r,l[Pd]=m,e=(r.mode&1)!==0,n){case"dialog":Jr("cancel",l),Jr("close",l);break;case"iframe":case"object":case"embed":Jr("load",l);break;case"video":case"audio":for(u=0;u<ed.length;u++)Jr(ed[u],l);break;case"source":Jr("error",l);break;case"img":case"image":case"link":Jr("error",l),Jr("load",l);break;case"details":Jr("toggle",l);break;case"input":dw(l,m),Jr("invalid",l);break;case"select":l._wrapperState={wasMultiple:!!m.multiple},Jr("invalid",l);break;case"textarea":mw(l,m),Jr("invalid",l)}Nx(n,m),u=null;for(var x in m)if(m.hasOwnProperty(x)){var o=m[x];x==="children"?typeof o=="string"?l.textContent!==o&&(U0(l.textContent,o,e),u=["children",o]):typeof o=="number"&&l.textContent!==""+o&&(U0(l.textContent,o,e),u=["children",""+o]):Ed.hasOwnProperty(x)&&o!=null&&x==="onScroll"&&Jr("scroll",l)}switch(n){case"input":F0(l),pw(l,m,!0);break;case"textarea":F0(l),_w(l);break;case"select":case"option":break;default:typeof m.onClick=="function"&&(l.onclick=bm)}l=u,r.updateQueue=l,l!==null&&(r.flags|=4)}else{x=u.nodeType===9?u:u.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=HE(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=x.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof l.is=="string"?e=x.createElement(n,{is:l.is}):(e=x.createElement(n),n==="select"&&(x=e,l.multiple?x.multiple=!0:l.size&&(x.size=l.size))):e=x.createElementNS(e,n),e[Os]=r,e[Pd]=l,lS(e,r,!1,!1),r.stateNode=e;e:{switch(x=Ux(n,l),n){case"dialog":Jr("cancel",e),Jr("close",e),u=l;break;case"iframe":case"object":case"embed":Jr("load",e),u=l;break;case"video":case"audio":for(u=0;u<ed.length;u++)Jr(ed[u],e);u=l;break;case"source":Jr("error",e),u=l;break;case"img":case"image":case"link":Jr("error",e),Jr("load",e),u=l;break;case"details":Jr("toggle",e),u=l;break;case"input":dw(e,l),u=Lx(e,l),Jr("invalid",e);break;case"option":u=l;break;case"select":e._wrapperState={wasMultiple:!!l.multiple},u=un({},l,{value:void 0}),Jr("invalid",e);break;case"textarea":mw(e,l),u=Ox(e,l),Jr("invalid",e);break;default:u=l}Nx(n,u),o=u;for(m in o)if(o.hasOwnProperty(m)){var S=o[m];m==="style"?KE(e,S):m==="dangerouslySetInnerHTML"?(S=S?S.__html:void 0,S!=null&&XE(e,S)):m==="children"?typeof S=="string"?(n!=="textarea"||S!=="")&&bd(e,S):typeof S=="number"&&bd(e,""+S):m!=="suppressContentEditableWarning"&&m!=="suppressHydrationWarning"&&m!=="autoFocus"&&(Ed.hasOwnProperty(m)?S!=null&&m==="onScroll"&&Jr("scroll",e):S!=null&&N1(e,m,S,x))}switch(n){case"input":F0(e),pw(e,l,!1);break;case"textarea":F0(e),_w(e);break;case"option":l.value!=null&&e.setAttribute("value",""+wl(l.value));break;case"select":e.multiple=!!l.multiple,m=l.value,m!=null?Ju(e,!!l.multiple,m,!1):l.defaultValue!=null&&Ju(e,!!l.multiple,l.defaultValue,!0);break;default:typeof u.onClick=="function"&&(e.onclick=bm)}switch(n){case"button":case"input":case"select":case"textarea":l=!!l.autoFocus;break e;case"img":l=!0;break e;default:l=!1}}l&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return fi(r),null;case 6:if(e&&r.stateNode!=null)uS(e,r,e.memoizedProps,l);else{if(typeof l!="string"&&r.stateNode===null)throw Error(Et(166));if(n=_c(Rd.current),_c(Us.current),Hf(r)){if(l=r.stateNode,n=r.memoizedProps,l[Os]=r,(m=l.nodeValue!==n)&&(e=Ta,e!==null))switch(x=(e.mode&1)!==0,e.tag){case 3:U0(l.nodeValue,n,x);break;case 5:e.memoizedProps[void 0]!==!0&&U0(l.nodeValue,n,x)}m&&(r.flags|=4)}else l=(n.nodeType===9?n:n.ownerDocument).createTextNode(l),l[Os]=r,r.stateNode=l}return fi(r),null;case 13:if(Qr(cn),l=r.memoizedState,nn&&sa!==null&&(r.mode&1)!==0&&(r.flags&128)===0){for(l=sa;l;)l=fo(l.nextSibling);return ch(),r.flags|=98560,r}if(l!==null&&l.dehydrated!==null){if(l=Hf(r),e===null){if(!l)throw Error(Et(318));if(l=r.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(Et(317));l[Os]=r}else ch(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;return fi(r),null}return os!==null&&(x1(os),os=null),(r.flags&128)!==0?(r.lanes=n,r):(l=l!==null,n=!1,e===null?Hf(r):n=e.memoizedState!==null,l&&!n&&(r.child.flags|=8192,(r.mode&1)!==0&&(e===null||(cn.current&1)!==0?Vn===0&&(Vn=3):yy())),r.updateQueue!==null&&(r.flags|=4),fi(r),null);case 4:return hh(),o1(e,r),e===null&&Dd(r.stateNode.containerInfo),fi(r),null;case 10:return ty(r.type._context),fi(r),null;case 17:return ca(r.type)&&Sm(),fi(r),null;case 19:if(Qr(cn),m=r.memoizedState,m===null)return fi(r),null;if(l=(r.flags&128)!==0,x=m.rendering,x===null)if(l)qf(m,!1);else{if(Vn!==0||e!==null&&(e.flags&128)!==0)for(e=r.child;e!==null;){if(x=Fm(e),x!==null){for(r.flags|=128,qf(m,!1),l=x.updateQueue,l!==null&&(r.updateQueue=l,r.flags|=4),r.subtreeFlags=0,l=n,n=r.child;n!==null;)m=n,e=l,m.flags&=14680066,x=m.alternate,x===null?(m.childLanes=0,m.lanes=e,m.child=null,m.subtreeFlags=0,m.memoizedProps=null,m.memoizedState=null,m.updateQueue=null,m.dependencies=null,m.stateNode=null):(m.childLanes=x.childLanes,m.lanes=x.lanes,m.child=x.child,m.subtreeFlags=0,m.deletions=null,m.memoizedProps=x.memoizedProps,m.memoizedState=x.memoizedState,m.updateQueue=x.updateQueue,m.type=x.type,e=x.dependencies,m.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Zr(cn,cn.current&1|2),r.child}e=e.sibling}m.tail!==null&&kn()>ph&&(r.flags|=128,l=!0,qf(m,!1),r.lanes=4194304)}else{if(!l)if(e=Fm(x),e!==null){if(r.flags|=128,l=!0,n=e.updateQueue,n!==null&&(r.updateQueue=n,r.flags|=4),qf(m,!0),m.tail===null&&m.tailMode==="hidden"&&!x.alternate&&!nn)return fi(r),null}else 2*kn()-m.renderingStartTime>ph&&n!==1073741824&&(r.flags|=128,l=!0,qf(m,!1),r.lanes=4194304);m.isBackwards?(x.sibling=r.child,r.child=x):(n=m.last,n!==null?n.sibling=x:r.child=x,m.last=x)}return m.tail!==null?(r=m.tail,m.rendering=r,m.tail=r.sibling,m.renderingStartTime=kn(),r.sibling=null,n=cn.current,Zr(cn,l?n&1|2:n&1),r):(fi(r),null);case 22:case 23:return xy(),l=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==l&&(r.flags|=8192),l&&(r.mode&1)!==0?(xa&1073741824)!==0&&(fi(r),r.subtreeFlags&6&&(r.flags|=8192)):fi(r),null;case 24:return null;case 25:return null}throw Error(Et(156,r.tag))}var K4=bo.ReactCurrentOwner,wa=!1;function zi(e,r,n,l){r.child=e===null?Ub(r,null,n,l):uh(r,e.child,n,l)}function Jw(e,r,n,l,u){n=n.render;var m=r.ref;return rh(r,u),l=uy(e,r,n,l,m,u),n=hy(),e!==null&&!wa?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~u,To(e,r,u)):(nn&&n&&ny(r),r.flags|=1,zi(e,r,l,u),r.child)}function Qw(e,r,n,l,u){if(e===null){var m=n.type;return typeof m=="function"&&!vy(m)&&m.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(r.tag=15,r.type=m,hS(e,r,m,l,u)):(e=mm(n.type,null,l,r,r.mode,u),e.ref=r.ref,e.return=r,r.child=e)}if(m=e.child,(e.lanes&u)===0){var x=m.memoizedProps;if(n=n.compare,n=n!==null?n:Md,n(x,l)&&e.ref===r.ref)return To(e,r,u)}return r.flags|=1,e=El(m,l),e.ref=r.ref,e.return=r,r.child=e}function hS(e,r,n,l,u){if(e!==null&&Md(e.memoizedProps,l)&&e.ref===r.ref)if(wa=!1,(e.lanes&u)!==0)(e.flags&131072)!==0&&(wa=!0);else return r.lanes=e.lanes,To(e,r,u);return l1(e,r,n,l,u)}function fS(e,r,n){var l=r.pendingProps,u=l.children,m=e!==null?e.memoizedState:null;if(l.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null},Zr(Ku,xa),xa|=n;else if((n&1073741824)!==0)r.memoizedState={baseLanes:0,cachePool:null},l=m!==null?m.baseLanes:n,Zr(Ku,xa),xa|=l;else return e=m!==null?m.baseLanes|n:n,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null},r.updateQueue=null,Zr(Ku,xa),xa|=e,null;else m!==null?(l=m.baseLanes|n,r.memoizedState=null):l=n,Zr(Ku,xa),xa|=l;return zi(e,r,u,n),r.child}function dS(e,r){var n=r.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(r.flags|=512,r.flags|=2097152)}function l1(e,r,n,l,u){var m=ca(n)?Sc:yi.current;return m=lh(r,m),rh(r,u),n=uy(e,r,n,l,m,u),l=hy(),e!==null&&!wa?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~u,To(e,r,u)):(nn&&l&&ny(r),r.flags|=1,zi(e,r,n,u),r.child)}function eT(e,r,n,l,u){if(ca(n)){var m=!0;km(r)}else m=!1;if(rh(r,u),r.stateNode===null)e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2),zb(r,n,l),n1(r,n,l,u),l=!0;else if(e===null){var x=r.stateNode,o=r.memoizedProps;x.props=o;var S=x.context,A=n.contextType;typeof A=="object"&&A!==null?A=$a(A):(A=ca(n)?Sc:yi.current,A=lh(r,A));var I=n.getDerivedStateFromProps,D=typeof I=="function"||typeof x.getSnapshotBeforeUpdate=="function";D||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(o!==l||S!==A)&&Ww(r,x,l,A),il=!1;var L=r.memoizedState;x.state=L,Im(r,l,x,u),S=r.memoizedState,o!==l||L!==S||la.current||il?(typeof I=="function"&&(r1(r,n,I,l),S=r.memoizedState),(o=il||$w(r,n,o,l,L,S,A))?(D||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(r.flags|=4194308)):(typeof x.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=l,r.memoizedState=S),x.props=l,x.state=S,x.context=A,l=o):(typeof x.componentDidMount=="function"&&(r.flags|=4194308),l=!1)}else{x=r.stateNode,Lb(e,r),o=r.memoizedProps,A=r.type===r.elementType?o:ss(r.type,o),x.props=A,D=r.pendingProps,L=x.context,S=n.contextType,typeof S=="object"&&S!==null?S=$a(S):(S=ca(n)?Sc:yi.current,S=lh(r,S));var B=n.getDerivedStateFromProps;(I=typeof B=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(o!==D||L!==S)&&Ww(r,x,l,S),il=!1,L=r.memoizedState,x.state=L,Im(r,l,x,u);var U=r.memoizedState;o!==D||L!==U||la.current||il?(typeof B=="function"&&(r1(r,n,B,l),U=r.memoizedState),(A=il||$w(r,n,A,l,L,U,S)||!1)?(I||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(l,U,S),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(l,U,S)),typeof x.componentDidUpdate=="function"&&(r.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof x.componentDidUpdate!="function"||o===e.memoizedProps&&L===e.memoizedState||(r.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&L===e.memoizedState||(r.flags|=1024),r.memoizedProps=l,r.memoizedState=U),x.props=l,x.state=U,x.context=S,l=A):(typeof x.componentDidUpdate!="function"||o===e.memoizedProps&&L===e.memoizedState||(r.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&L===e.memoizedState||(r.flags|=1024),l=!1)}return c1(e,r,n,l,m,u)}function c1(e,r,n,l,u,m){dS(e,r);var x=(r.flags&128)!==0;if(!l&&!x)return u&&Vw(r,n,!1),To(e,r,m);l=r.stateNode,K4.current=r;var o=x&&typeof n.getDerivedStateFromError!="function"?null:l.render();return r.flags|=1,e!==null&&x?(r.child=uh(r,e.child,null,m),r.child=uh(r,null,o,m)):zi(e,r,o,m),r.memoizedState=l.state,u&&Vw(r,n,!0),r.child}function pS(e){var r=e.stateNode;r.pendingContext?Uw(e,r.pendingContext,r.pendingContext!==r.context):r.context&&Uw(e,r.context,!1),sy(e,r.containerInfo)}function tT(e,r,n,l,u){return ch(),ay(u),r.flags|=256,zi(e,r,n,l),r.child}var $0={dehydrated:null,treeContext:null,retryLane:0};function W0(e){return{baseLanes:e,cachePool:null}}function mS(e,r,n){var l=r.pendingProps,u=cn.current,m=!1,x=(r.flags&128)!==0,o;if((o=x)||(o=e!==null&&e.memoizedState===null?!1:(u&2)!==0),o?(m=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(u|=1),Zr(cn,u&1),e===null)return a1(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?((r.mode&1)===0?r.lanes=1:e.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(u=l.children,e=l.fallback,m?(l=r.mode,m=r.child,u={mode:"hidden",children:u},(l&1)===0&&m!==null?(m.childLanes=0,m.pendingProps=u):m=Um(u,l,0,null),e=Tc(e,l,n,null),m.return=r,e.return=r,m.sibling=e,r.child=m,r.child.memoizedState=W0(n),r.memoizedState=$0,e):u1(r,u));if(u=e.memoizedState,u!==null){if(o=u.dehydrated,o!==null){if(x)return r.flags&256?(r.flags&=-257,Z0(e,r,n,Error(Et(422)))):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(m=l.fallback,u=r.mode,l=Um({mode:"visible",children:l.children},u,0,null),m=Tc(m,u,n,null),m.flags|=2,l.return=r,m.return=r,l.sibling=m,r.child=l,(r.mode&1)!==0&&uh(r,e.child,null,n),r.child.memoizedState=W0(n),r.memoizedState=$0,m);if((r.mode&1)===0)r=Z0(e,r,n,null);else if(o.data==="$!")r=Z0(e,r,n,Error(Et(419)));else if(l=(n&e.childLanes)!==0,wa||l){if(l=Rn,l!==null){switch(n&-n){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}l=(m&(l.suspendedLanes|n))!==0?0:m,l!==0&&l!==u.retryLane&&(u.retryLane=l,Ga(e,l,-1))}yy(),r=Z0(e,r,n,Error(Et(421)))}else o.data==="$?"?(r.flags|=128,r.child=e.child,r=cM.bind(null,e),o._reactRetry=r,r=null):(n=u.treeContext,sa=fo(o.nextSibling),Ta=r,nn=!0,os=null,n!==null&&(Ba[Na++]=po,Ba[Na++]=mo,Ba[Na++]=kc,po=n.id,mo=n.overflow,kc=r),r=u1(r,r.pendingProps.children),r.flags|=4096);return r}return m?(l=nT(e,r,l.children,l.fallback,n),m=r.child,u=e.child.memoizedState,m.memoizedState=u===null?W0(n):{baseLanes:u.baseLanes|n,cachePool:null},m.childLanes=e.childLanes&~n,r.memoizedState=$0,l):(n=rT(e,r,l.children,n),r.memoizedState=null,n)}return m?(l=nT(e,r,l.children,l.fallback,n),m=r.child,u=e.child.memoizedState,m.memoizedState=u===null?W0(n):{baseLanes:u.baseLanes|n,cachePool:null},m.childLanes=e.childLanes&~n,r.memoizedState=$0,l):(n=rT(e,r,l.children,n),r.memoizedState=null,n)}function u1(e,r){return r=Um({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function rT(e,r,n,l){var u=e.child;return e=u.sibling,n=El(u,{mode:"visible",children:n}),(r.mode&1)===0&&(n.lanes=l),n.return=r,n.sibling=null,e!==null&&(l=r.deletions,l===null?(r.deletions=[e],r.flags|=16):l.push(e)),r.child=n}function nT(e,r,n,l,u){var m=r.mode;e=e.child;var x=e.sibling,o={mode:"hidden",children:n};return(m&1)===0&&r.child!==e?(n=r.child,n.childLanes=0,n.pendingProps=o,r.deletions=null):(n=El(e,o),n.subtreeFlags=e.subtreeFlags&14680064),x!==null?l=El(x,l):(l=Tc(l,m,u,null),l.flags|=2),l.return=r,n.return=r,n.sibling=l,r.child=n,l}function Z0(e,r,n,l){return l!==null&&ay(l),uh(r,e.child,null,n),e=u1(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function iT(e,r,n){e.lanes|=r;var l=e.alternate;l!==null&&(l.lanes|=r),t1(e.return,r,n)}function px(e,r,n,l,u){var m=e.memoizedState;m===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:l,tail:n,tailMode:u}:(m.isBackwards=r,m.rendering=null,m.renderingStartTime=0,m.last=l,m.tail=n,m.tailMode=u)}function _S(e,r,n){var l=r.pendingProps,u=l.revealOrder,m=l.tail;if(zi(e,r,l.children,n),l=cn.current,(l&2)!==0)l=l&1|2,r.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&iT(e,n,r);else if(e.tag===19)iT(e,n,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}l&=1}if(Zr(cn,l),(r.mode&1)===0)r.memoizedState=null;else switch(u){case"forwards":for(n=r.child,u=null;n!==null;)e=n.alternate,e!==null&&Fm(e)===null&&(u=n),n=n.sibling;n=u,n===null?(u=r.child,r.child=null):(u=n.sibling,n.sibling=null),px(r,!1,u,n,m);break;case"backwards":for(n=null,u=r.child,r.child=null;u!==null;){if(e=u.alternate,e!==null&&Fm(e)===null){r.child=u;break}e=u.sibling,u.sibling=n,n=u,u=e}px(r,!0,n,null,m);break;case"together":px(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function To(e,r,n){if(e!==null&&(r.dependencies=e.dependencies),dh|=r.lanes,(n&r.childLanes)===0)return null;if(e!==null&&r.child!==e.child)throw Error(Et(153));if(r.child!==null){for(e=r.child,n=El(e,e.pendingProps),r.child=n,n.return=r;e.sibling!==null;)e=e.sibling,n=n.sibling=El(e,e.pendingProps),n.return=r;n.sibling=null}return r.child}function Y4(e,r,n){switch(r.tag){case 3:pS(r),ch();break;case 5:Vb(r);break;case 1:ca(r.type)&&km(r);break;case 4:sy(r,r.stateNode.containerInfo);break;case 10:var l=r.type._context,u=r.memoizedProps.value;Zr(Am,l._currentValue),l._currentValue=u;break;case 13:if(l=r.memoizedState,l!==null)return l.dehydrated!==null?(Zr(cn,cn.current&1),r.flags|=128,null):(n&r.child.childLanes)!==0?mS(e,r,n):(Zr(cn,cn.current&1),e=To(e,r,n),e!==null?e.sibling:null);Zr(cn,cn.current&1);break;case 19:if(l=(n&r.childLanes)!==0,(e.flags&128)!==0){if(l)return _S(e,r,n);r.flags|=128}if(u=r.memoizedState,u!==null&&(u.rendering=null,u.tail=null,u.lastEffect=null),Zr(cn,cn.current),l)break;return null;case 22:case 23:return r.lanes=0,fS(e,r,n)}return To(e,r,n)}function J4(e,r){switch(iy(r),r.tag){case 1:return ca(r.type)&&Sm(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return hh(),Qr(la),Qr(yi),ly(),e=r.flags,(e&65536)!==0&&(e&128)===0?(r.flags=e&-65537|128,r):null;case 5:return oy(r),null;case 13:if(Qr(cn),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(Et(340));ch()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Qr(cn),null;case 4:return hh(),null;case 10:return ty(r.type._context),null;case 22:case 23:return xy(),null;case 24:return null;default:return null}}var H0=!1,gc=!1,Q4=typeof WeakSet=="function"?WeakSet:Set,Vt=null;function Rm(e,r){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(l){oa(e,r,l)}else n.current=null}function h1(e,r,n){try{n()}catch(l){oa(e,r,l)}}var aT=!1;function eM(e,r){if(e=Eb(),J1(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var l=n.getSelection&&n.getSelection();if(l&&l.rangeCount!==0){n=l.anchorNode;var u=l.anchorOffset,m=l.focusNode;l=l.focusOffset;try{n.nodeType,m.nodeType}catch{n=null;break e}var x=0,o=-1,S=-1,A=0,I=0,D=e,L=null;t:for(;;){for(var B;D!==n||u!==0&&D.nodeType!==3||(o=x+u),D!==m||l!==0&&D.nodeType!==3||(S=x+l),D.nodeType===3&&(x+=D.nodeValue.length),(B=D.firstChild)!==null;)L=D,D=B;for(;;){if(D===e)break t;if(L===n&&++A===u&&(o=x),L===m&&++I===l&&(S=x),(B=D.nextSibling)!==null)break;D=L,L=D.parentNode}D=B}n=o===-1||S===-1?null:{start:o,end:S}}else n=null}n=n||{start:0,end:0}}else n=null;for(Kx={focusedElem:e,selectionRange:n},Vt=r;Vt!==null;)if(r=Vt,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Vt=e;else for(;Vt!==null;){r=Vt;try{var U=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(U!==null){var V=U.memoizedProps,Y=U.memoizedState,X=r.stateNode,K=X.getSnapshotBeforeUpdate(r.elementType===r.type?V:ss(r.type,V),Y);X.__reactInternalSnapshotBeforeUpdate=K}break;case 3:var G=r.stateNode.containerInfo;if(G.nodeType===1)G.textContent="";else if(G.nodeType===9){var me=G.body;me!=null&&(me.textContent="")}break;case 5:case 6:case 4:case 17:break;default:throw Error(Et(163))}}catch(Ae){oa(r,r.return,Ae)}if(e=r.sibling,e!==null){e.return=r.return,Vt=e;break}Vt=r.return}return U=aT,aT=!1,U}function Nd(e,r,n){var l=r.updateQueue;if(l=l!==null?l.lastEffect:null,l!==null){var u=l=l.next;do{if((u.tag&e)===e){var m=u.destroy;u.destroy=void 0,m!==void 0&&h1(r,n,m)}u=u.next}while(u!==l)}}function l_(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var n=r=r.next;do{if((n.tag&e)===e){var l=n.create;n.destroy=l()}n=n.next}while(n!==r)}}function f1(e){var r=e.ref;if(r!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof r=="function"?r(e):r.current=e}}function sT(e,r,n){if(Ns&&typeof Ns.onCommitFiberUnmount=="function")try{Ns.onCommitFiberUnmount(e_,r)}catch{}switch(r.tag){case 0:case 11:case 14:case 15:if(e=r.updateQueue,e!==null&&(e=e.lastEffect,e!==null)){var l=e=e.next;do{var u=l,m=u.destroy;u=u.tag,m!==void 0&&((u&2)!==0||(u&4)!==0)&&h1(r,n,m),l=l.next}while(l!==e)}break;case 1:if(Rm(r,n),e=r.stateNode,typeof e.componentWillUnmount=="function")try{e.props=r.memoizedProps,e.state=r.memoizedState,e.componentWillUnmount()}catch(x){oa(r,n,x)}break;case 5:Rm(r,n);break;case 4:yS(e,r,n)}}function gS(e){var r=e.alternate;r!==null&&(e.alternate=null,gS(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Os],delete r[Pd],delete r[Qx],delete r[O4],delete r[B4])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function xS(e){return e.tag===5||e.tag===3||e.tag===4}function oT(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||xS(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function lT(e){e:{for(var r=e.return;r!==null;){if(xS(r))break e;r=r.return}throw Error(Et(160))}var n=r;switch(n.tag){case 5:r=n.stateNode,n.flags&32&&(bd(r,""),n.flags&=-33),n=oT(e),p1(e,n,r);break;case 3:case 4:r=n.stateNode.containerInfo,n=oT(e),d1(e,n,r);break;default:throw Error(Et(161))}}function d1(e,r,n){var l=e.tag;if(l===5||l===6)e=e.stateNode,r?n.nodeType===8?n.parentNode.insertBefore(e,r):n.insertBefore(e,r):(n.nodeType===8?(r=n.parentNode,r.insertBefore(e,n)):(r=n,r.appendChild(e)),n=n._reactRootContainer,n!=null||r.onclick!==null||(r.onclick=bm));else if(l!==4&&(e=e.child,e!==null))for(d1(e,r,n),e=e.sibling;e!==null;)d1(e,r,n),e=e.sibling}function p1(e,r,n){var l=e.tag;if(l===5||l===6)e=e.stateNode,r?n.insertBefore(e,r):n.appendChild(e);else if(l!==4&&(e=e.child,e!==null))for(p1(e,r,n),e=e.sibling;e!==null;)p1(e,r,n),e=e.sibling}function yS(e,r,n){for(var l=r,u=!1,m,x;;){if(!u){u=l.return;e:for(;;){if(u===null)throw Error(Et(160));switch(m=u.stateNode,u.tag){case 5:x=!1;break e;case 3:m=m.containerInfo,x=!0;break e;case 4:m=m.containerInfo,x=!0;break e}u=u.return}u=!0}if(l.tag===5||l.tag===6){e:for(var o=e,S=l,A=n,I=S;;)if(sT(o,I,A),I.child!==null&&I.tag!==4)I.child.return=I,I=I.child;else{if(I===S)break e;for(;I.sibling===null;){if(I.return===null||I.return===S)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}x?(o=m,S=l.stateNode,o.nodeType===8?o.parentNode.removeChild(S):o.removeChild(S)):m.removeChild(l.stateNode)}else if(l.tag===18)x?(o=m,S=l.stateNode,o.nodeType===8?cx(o.parentNode,S):o.nodeType===1&&cx(o,S),Cd(o)):cx(m,l.stateNode);else if(l.tag===4){if(l.child!==null){m=l.stateNode.containerInfo,x=!0,l.child.return=l,l=l.child;continue}}else if(sT(e,l,n),l.child!==null){l.child.return=l,l=l.child;continue}if(l===r)break;for(;l.sibling===null;){if(l.return===null||l.return===r)return;l=l.return,l.tag===4&&(u=!1)}l.sibling.return=l.return,l=l.sibling}}function mx(e,r){switch(r.tag){case 0:case 11:case 14:case 15:Nd(3,r,r.return),l_(3,r),Nd(5,r,r.return);return;case 1:return;case 5:var n=r.stateNode;if(n!=null){var l=r.memoizedProps,u=e!==null?e.memoizedProps:l;e=r.type;var m=r.updateQueue;if(r.updateQueue=null,m!==null){for(e==="input"&&l.type==="radio"&&l.name!=null&&WE(n,l),Ux(e,u),r=Ux(e,l),u=0;u<m.length;u+=2){var x=m[u],o=m[u+1];x==="style"?KE(n,o):x==="dangerouslySetInnerHTML"?XE(n,o):x==="children"?bd(n,o):N1(n,x,o,r)}switch(e){case"input":Rx(n,l);break;case"textarea":ZE(n,l);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!l.multiple,m=l.value,m!=null?Ju(n,!!l.multiple,m,!1):e!==!!l.multiple&&(l.defaultValue!=null?Ju(n,!!l.multiple,l.defaultValue,!0):Ju(n,!!l.multiple,l.multiple?[]:"",!1))}n[Pd]=l}}return;case 6:if(r.stateNode===null)throw Error(Et(162));r.stateNode.nodeValue=r.memoizedProps;return;case 3:e!==null&&e.memoizedState.isDehydrated&&Cd(r.stateNode.containerInfo);return;case 12:return;case 13:cT(r);return;case 19:cT(r);return;case 17:return}throw Error(Et(163))}function cT(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new Q4),r.forEach(function(l){var u=uM.bind(null,e,l);n.has(l)||(n.add(l),l.then(u,u))})}}function tM(e,r){for(Vt=r;Vt!==null;){r=Vt;var n=r.deletions;if(n!==null)for(var l=0;l<n.length;l++){var u=n[l];try{yS(e,u,r);var m=u.alternate;m!==null&&(m.return=null),u.return=null}catch(ke){oa(u,r,ke)}}if(n=r.child,(r.subtreeFlags&12854)!==0&&n!==null)n.return=r,Vt=n;else for(;Vt!==null;){r=Vt;try{var x=r.flags;if(x&32&&bd(r.stateNode,""),x&512){var o=r.alternate;if(o!==null){var S=o.ref;S!==null&&(typeof S=="function"?S(null):S.current=null)}}if(x&8192)switch(r.tag){case 13:if(r.memoizedState!==null){var A=r.alternate;(A===null||A.memoizedState===null)&&(_y=kn())}break;case 22:var I=r.memoizedState!==null,D=r.alternate,L=D!==null&&D.memoizedState!==null;n=r;e:{l=n,u=I;for(var B=null,U=l;;){if(U.tag===5){if(B===null){B=U;var V=U.stateNode;if(u){var Y=V.style;typeof Y.setProperty=="function"?Y.setProperty("display","none","important"):Y.display="none"}else{var X=U.stateNode,K=U.memoizedProps.style,G=K!=null&&K.hasOwnProperty("display")?K.display:null;X.style.display=qE("display",G)}}}else if(U.tag===6)B===null&&(U.stateNode.nodeValue=u?"":U.memoizedProps);else if((U.tag!==22&&U.tag!==23||U.memoizedState===null||U===l)&&U.child!==null){U.child.return=U,U=U.child;continue}if(U===l)break;for(;U.sibling===null;){if(U.return===null||U.return===l)break e;B===U&&(B=null),U=U.return}B===U&&(B=null),U.sibling.return=U.return,U=U.sibling}}if(I&&!L&&(n.mode&1)!==0){Vt=n;for(var me=n.child;me!==null;){for(n=Vt=me;Vt!==null;){l=Vt;var Ae=l.child;switch(l.tag){case 0:case 11:case 14:case 15:Nd(4,l,l.return);break;case 1:Rm(l,l.return);var ge=l.stateNode;if(typeof ge.componentWillUnmount=="function"){var se=l.return;try{ge.props=l.memoizedProps,ge.state=l.memoizedState,ge.componentWillUnmount()}catch(ke){oa(l,se,ke)}}break;case 5:Rm(l,l.return);break;case 22:if(l.memoizedState!==null){hT(n);continue}}Ae!==null?(Ae.return=l,Vt=Ae):hT(n)}me=me.sibling}}}switch(x&4102){case 2:lT(r),r.flags&=-3;break;case 6:lT(r),r.flags&=-3,mx(r.alternate,r);break;case 4096:r.flags&=-4097;break;case 4100:r.flags&=-4097,mx(r.alternate,r);break;case 4:mx(r.alternate,r)}}catch(ke){oa(r,r.return,ke)}if(n=r.sibling,n!==null){n.return=r.return,Vt=n;break}Vt=r.return}}}function rM(e,r,n){Vt=e,vS(e)}function vS(e,r,n){for(var l=(e.mode&1)!==0;Vt!==null;){var u=Vt,m=u.child;if(u.tag===22&&l){var x=u.memoizedState!==null||H0;if(!x){var o=u.alternate,S=o!==null&&o.memoizedState!==null||gc;o=H0;var A=gc;if(H0=x,(gc=S)&&!A)for(Vt=u;Vt!==null;)x=Vt,S=x.child,x.tag===22&&x.memoizedState!==null?fT(u):S!==null?(S.return=x,Vt=S):fT(u);for(;m!==null;)Vt=m,vS(m),m=m.sibling;Vt=u,H0=o,gc=A}uT(e)}else(u.subtreeFlags&8772)!==0&&m!==null?(m.return=u,Vt=m):uT(e)}}function uT(e){for(;Vt!==null;){var r=Vt;if((r.flags&8772)!==0){var n=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:gc||l_(5,r);break;case 1:var l=r.stateNode;if(r.flags&4&&!gc)if(n===null)l.componentDidMount();else{var u=r.elementType===r.type?n.memoizedProps:ss(r.type,n.memoizedProps);l.componentDidUpdate(u,n.memoizedState,l.__reactInternalSnapshotBeforeUpdate)}var m=r.updateQueue;m!==null&&Gw(r,m,l);break;case 3:var x=r.updateQueue;if(x!==null){if(n=null,r.child!==null)switch(r.child.tag){case 5:n=r.child.stateNode;break;case 1:n=r.child.stateNode}Gw(r,x,n)}break;case 5:var o=r.stateNode;if(n===null&&r.flags&4){n=o;var S=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":S.autoFocus&&n.focus();break;case"img":S.src&&(n.src=S.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var A=r.alternate;if(A!==null){var I=A.memoizedState;if(I!==null){var D=I.dehydrated;D!==null&&Cd(D)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(Et(163))}gc||r.flags&512&&f1(r)}catch(L){oa(r,r.return,L)}}if(r===e){Vt=null;break}if(n=r.sibling,n!==null){n.return=r.return,Vt=n;break}Vt=r.return}}function hT(e){for(;Vt!==null;){var r=Vt;if(r===e){Vt=null;break}var n=r.sibling;if(n!==null){n.return=r.return,Vt=n;break}Vt=r.return}}function fT(e){for(;Vt!==null;){var r=Vt;try{switch(r.tag){case 0:case 11:case 15:var n=r.return;try{l_(4,r)}catch(S){oa(r,n,S)}break;case 1:var l=r.stateNode;if(typeof l.componentDidMount=="function"){var u=r.return;try{l.componentDidMount()}catch(S){oa(r,u,S)}}var m=r.return;try{f1(r)}catch(S){oa(r,m,S)}break;case 5:var x=r.return;try{f1(r)}catch(S){oa(r,x,S)}}}catch(S){oa(r,r.return,S)}if(r===e){Vt=null;break}var o=r.sibling;if(o!==null){o.return=r.return,Vt=o;break}Vt=r.return}}var nM=Math.ceil,zm=bo.ReactCurrentDispatcher,py=bo.ReactCurrentOwner,ja=bo.ReactCurrentBatchConfig,Er=0,Rn=null,Pn=null,Qn=0,xa=0,Ku=Al(0),Vn=0,Ud=null,dh=0,c_=0,my=0,fd=null,aa=null,_y=0,ph=1/0,Om=!1,m1=null,gl=null,X0=!1,ul=null,Bm=0,dd=0,_1=null,dm=-1,pm=0;function Ui(){return(Er&6)!==0?kn():dm!==-1?dm:dm=kn()}function xl(e){return(e.mode&1)===0?1:(Er&2)!==0&&Qn!==0?Qn&-Qn:U4.transition!==null?(pm===0&&(e=L0,L0<<=1,(L0&4194240)===0&&(L0=64),pm=e),pm):(e=Br,e!==0||(e=window.event,e=e===void 0?16:pb(e.type)),e)}function Ga(e,r,n){if(50<dd)throw dd=0,_1=null,Error(Et(185));var l=u_(e,r);return l===null?null:(Kd(l,r,n),((Er&2)===0||l!==Rn)&&(l===Rn&&((Er&2)===0&&(c_|=r),Vn===4&&sl(l,Qn)),ua(l,n),r===1&&Er===0&&(e.mode&1)===0&&(ph=kn()+500,a_&&Cl())),l)}function u_(e,r){e.lanes|=r;var n=e.alternate;for(n!==null&&(n.lanes|=r),n=e,e=e.return;e!==null;)e.childLanes|=r,n=e.alternate,n!==null&&(n.childLanes|=r),n=e,e=e.return;return n.tag===3?n.stateNode:null}function ua(e,r){var n=e.callbackNode;UI(e,r);var l=wm(e,e===Rn?Qn:0);if(l===0)n!==null&&yw(n),e.callbackNode=null,e.callbackPriority=0;else if(r=l&-l,e.callbackPriority!==r){if(n!=null&&yw(n),r===1)e.tag===0?N4(dT.bind(null,e)):Pb(dT.bind(null,e)),R4(function(){Er===0&&Cl()}),n=null;else{switch(lb(l)){case 1:n=$1;break;case 4:n=sb;break;case 16:n=vm;break;case 536870912:n=ob;break;default:n=vm}n=CS(n,wS.bind(null,e))}e.callbackPriority=r,e.callbackNode=n}}function wS(e,r){if(dm=-1,pm=0,(Er&6)!==0)throw Error(Et(327));var n=e.callbackNode;if(nh()&&e.callbackNode!==n)return null;var l=wm(e,e===Rn?Qn:0);if(l===0)return null;if((l&30)!==0||(l&e.expiredLanes)!==0||r)r=Nm(e,l);else{r=l;var u=Er;Er|=2;var m=ES();(Rn!==e||Qn!==r)&&(ph=kn()+500,wc(e,r));do try{sM();break}catch(o){TS(e,o)}while(1);ey(),zm.current=m,Er=u,Pn!==null?r=0:(Rn=null,Qn=0,r=Vn)}if(r!==0){if(r===2&&(u=Wx(e),u!==0&&(l=u,r=g1(e,u))),r===1)throw n=Ud,wc(e,0),sl(e,l),ua(e,kn()),n;if(r===6)sl(e,l);else{if(u=e.current.alternate,(l&30)===0&&!iM(u)&&(r=Nm(e,l),r===2&&(m=Wx(e),m!==0&&(l=m,r=g1(e,m))),r===1))throw n=Ud,wc(e,0),sl(e,l),ua(e,kn()),n;switch(e.finishedWork=u,e.finishedLanes=l,r){case 0:case 1:throw Error(Et(345));case 2:dc(e,aa);break;case 3:if(sl(e,l),(l&130023424)===l&&(r=_y+500-kn(),10<r)){if(wm(e,0)!==0)break;if(u=e.suspendedLanes,(u&l)!==l){Ui(),e.pingedLanes|=e.suspendedLanes&u;break}e.timeoutHandle=Jx(dc.bind(null,e,aa),r);break}dc(e,aa);break;case 4:if(sl(e,l),(l&4194240)===l)break;for(r=e.eventTimes,u=-1;0<l;){var x=31-hs(l);m=1<<x,x=r[x],x>u&&(u=x),l&=~m}if(l=u,l=kn()-l,l=(120>l?120:480>l?480:1080>l?1080:1920>l?1920:3e3>l?3e3:4320>l?4320:1960*nM(l/1960))-l,10<l){e.timeoutHandle=Jx(dc.bind(null,e,aa),l);break}dc(e,aa);break;case 5:dc(e,aa);break;default:throw Error(Et(329))}}}return ua(e,kn()),e.callbackNode===n?wS.bind(null,e):null}function g1(e,r){var n=fd;return e.current.memoizedState.isDehydrated&&(wc(e,r).flags|=256),e=Nm(e,r),e!==2&&(r=aa,aa=n,r!==null&&x1(r)),e}function x1(e){aa===null?aa=e:aa.push.apply(aa,e)}function iM(e){for(var r=e;;){if(r.flags&16384){var n=r.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var l=0;l<n.length;l++){var u=n[l],m=u.getSnapshot;u=u.value;try{if(!Vs(m(),u))return!1}catch{return!1}}}if(n=r.child,r.subtreeFlags&16384&&n!==null)n.return=r,r=n;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function sl(e,r){for(r&=~my,r&=~c_,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var n=31-hs(r),l=1<<n;e[n]=-1,r&=~l}}function dT(e){if((Er&6)!==0)throw Error(Et(327));nh();var r=wm(e,0);if((r&1)===0)return ua(e,kn()),null;var n=Nm(e,r);if(e.tag!==0&&n===2){var l=Wx(e);l!==0&&(r=l,n=g1(e,l))}if(n===1)throw n=Ud,wc(e,0),sl(e,r),ua(e,kn()),n;if(n===6)throw Error(Et(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,dc(e,aa),ua(e,kn()),null}function gy(e,r){var n=Er;Er|=1;try{return e(r)}finally{Er=n,Er===0&&(ph=kn()+500,a_&&Cl())}}function Ac(e){ul!==null&&ul.tag===0&&(Er&6)===0&&nh();var r=Er;Er|=1;var n=ja.transition,l=Br;try{if(ja.transition=null,Br=1,e)return e()}finally{Br=l,ja.transition=n,Er=r,(Er&6)===0&&Cl()}}function xy(){xa=Ku.current,Qr(Ku)}function wc(e,r){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,L4(n)),Pn!==null)for(n=Pn.return;n!==null;){var l=n;switch(iy(l),l.tag){case 1:l=l.type.childContextTypes,l!=null&&Sm();break;case 3:hh(),Qr(la),Qr(yi),ly();break;case 5:oy(l);break;case 4:hh();break;case 13:Qr(cn);break;case 19:Qr(cn);break;case 10:ty(l.type._context);break;case 22:case 23:xy()}n=n.return}if(Rn=e,Pn=e=El(e.current,null),Qn=xa=r,Vn=0,Ud=null,my=c_=dh=0,aa=fd=null,Bs!==null){for(r=0;r<Bs.length;r++)if(n=Bs[r],l=n.interleaved,l!==null){n.interleaved=null;var u=l.next,m=n.pending;if(m!==null){var x=m.next;m.next=u,l.next=x}n.pending=l}Bs=null}return e}function TS(e,r){do{var n=Pn;try{if(ey(),hm.current=Lm,Pm){for(var l=vn.memoizedState;l!==null;){var u=l.queue;u!==null&&(u.pending=null),l=l.next}Pm=!1}if(fh=0,qn=pi=vn=null,hd=!1,zd=0,py.current=null,n===null||n.return===null){Vn=1,Ud=r,Pn=null;break}e:{var m=e,x=n.return,o=n,S=r;if(r=Qn,o.flags|=32768,S!==null&&typeof S=="object"&&typeof S.then=="function"){var A=S,I=o,D=I.tag;if((I.mode&1)===0&&(D===0||D===11||D===15)){var L=I.alternate;L?(I.updateQueue=L.updateQueue,I.memoizedState=L.memoizedState,I.lanes=L.lanes):(I.updateQueue=null,I.memoizedState=null)}var B=Kw(x);if(B!==null){B.flags&=-257,Yw(B,x,o,m,r),B.mode&1&&qw(m,A,r),r=B,S=A;var U=r.updateQueue;if(U===null){var V=new Set;V.add(S),r.updateQueue=V}else U.add(S);break e}else{if((r&1)===0){qw(m,A,r),yy();break e}S=Error(Et(426))}}else if(nn&&o.mode&1){var Y=Kw(x);if(Y!==null){(Y.flags&65536)===0&&(Y.flags|=256),Yw(Y,x,o,m,r),ay(S);break e}}m=S,Vn!==4&&(Vn=2),fd===null?fd=[m]:fd.push(m),S=dy(S,o),o=x;do{switch(o.tag){case 3:o.flags|=65536,r&=-r,o.lanes|=r;var X=sS(o,S,r);jw(o,X);break e;case 1:m=S;var K=o.type,G=o.stateNode;if((o.flags&128)===0&&(typeof K.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(gl===null||!gl.has(G)))){o.flags|=65536,r&=-r,o.lanes|=r;var me=oS(o,m,r);jw(o,me);break e}}o=o.return}while(o!==null)}SS(n)}catch(Ae){r=Ae,Pn===n&&n!==null&&(Pn=n=n.return);continue}break}while(1)}function ES(){var e=zm.current;return zm.current=Lm,e===null?Lm:e}function yy(){(Vn===0||Vn===3||Vn===2)&&(Vn=4),Rn===null||(dh&268435455)===0&&(c_&268435455)===0||sl(Rn,Qn)}function Nm(e,r){var n=Er;Er|=2;var l=ES();Rn===e&&Qn===r||wc(e,r);do try{aM();break}catch(u){TS(e,u)}while(1);if(ey(),Er=n,zm.current=l,Pn!==null)throw Error(Et(261));return Rn=null,Qn=0,Vn}function aM(){for(;Pn!==null;)bS(Pn)}function sM(){for(;Pn!==null&&!DI();)bS(Pn)}function bS(e){var r=AS(e.alternate,e,xa);e.memoizedProps=e.pendingProps,r===null?SS(e):Pn=r,py.current=null}function SS(e){var r=e;do{var n=r.alternate;if(e=r.return,(r.flags&32768)===0){if(n=q4(n,r,xa),n!==null){Pn=n;return}}else{if(n=J4(n,r),n!==null){n.flags&=32767,Pn=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Vn=6,Pn=null;return}}if(r=r.sibling,r!==null){Pn=r;return}Pn=r=e}while(r!==null);Vn===0&&(Vn=5)}function dc(e,r){var n=Br,l=ja.transition;try{ja.transition=null,Br=1,oM(e,r,n)}finally{ja.transition=l,Br=n}return null}function oM(e,r,n){do nh();while(ul!==null);if((Er&6)!==0)throw Error(Et(327));var l=e.finishedWork,u=e.finishedLanes;if(l===null)return null;if(e.finishedWork=null,e.finishedLanes=0,l===e.current)throw Error(Et(177));e.callbackNode=null,e.callbackPriority=0;var m=l.lanes|l.childLanes;if(VI(e,m),e===Rn&&(Pn=Rn=null,Qn=0),(l.subtreeFlags&2064)===0&&(l.flags&2064)===0||X0||(X0=!0,CS(vm,function(){return nh(),null})),m=(l.flags&15990)!==0,(l.subtreeFlags&15990)!==0||m){m=ja.transition,ja.transition=null;var x=Br;Br=1;var o=Er;Er|=4,py.current=null,eM(e,l),tM(e,l),A4(Kx),Kx=null,e.current=l,rM(l),FI(),Er=o,Br=x,ja.transition=m}else e.current=l;if(X0&&(X0=!1,ul=e,Bm=u),m=e.pendingLanes,m===0&&(gl=null),RI(l.stateNode),ua(e,kn()),r!==null)for(n=e.onRecoverableError,l=0;l<r.length;l++)n(r[l]);if(Om)throw Om=!1,e=m1,m1=null,e;return(Bm&1)!==0&&e.tag!==0&&nh(),m=e.pendingLanes,(m&1)!==0?e===_1?dd++:(dd=0,_1=e):dd=0,Cl(),null}function nh(){if(ul!==null){var e=lb(Bm),r=ja.transition,n=Br;try{if(ja.transition=null,Br=16>e?16:e,ul===null)var l=!1;else{if(e=ul,ul=null,Bm=0,(Er&6)!==0)throw Error(Et(331));var u=Er;for(Er|=4,Vt=e.current;Vt!==null;){var m=Vt,x=m.child;if((Vt.flags&16)!==0){var o=m.deletions;if(o!==null){for(var S=0;S<o.length;S++){var A=o[S];for(Vt=A;Vt!==null;){var I=Vt;switch(I.tag){case 0:case 11:case 15:Nd(8,I,m)}var D=I.child;if(D!==null)D.return=I,Vt=D;else for(;Vt!==null;){I=Vt;var L=I.sibling,B=I.return;if(gS(I),I===A){Vt=null;break}if(L!==null){L.return=B,Vt=L;break}Vt=B}}}var U=m.alternate;if(U!==null){var V=U.child;if(V!==null){U.child=null;do{var Y=V.sibling;V.sibling=null,V=Y}while(V!==null)}}Vt=m}}if((m.subtreeFlags&2064)!==0&&x!==null)x.return=m,Vt=x;else e:for(;Vt!==null;){if(m=Vt,(m.flags&2048)!==0)switch(m.tag){case 0:case 11:case 15:Nd(9,m,m.return)}var X=m.sibling;if(X!==null){X.return=m.return,Vt=X;break e}Vt=m.return}}var K=e.current;for(Vt=K;Vt!==null;){x=Vt;var G=x.child;if((x.subtreeFlags&2064)!==0&&G!==null)G.return=x,Vt=G;else e:for(x=K;Vt!==null;){if(o=Vt,(o.flags&2048)!==0)try{switch(o.tag){case 0:case 11:case 15:l_(9,o)}}catch(Ae){oa(o,o.return,Ae)}if(o===x){Vt=null;break e}var me=o.sibling;if(me!==null){me.return=o.return,Vt=me;break e}Vt=o.return}}if(Er=u,Cl(),Ns&&typeof Ns.onPostCommitFiberRoot=="function")try{Ns.onPostCommitFiberRoot(e_,e)}catch{}l=!0}return l}finally{Br=n,ja.transition=r}}return!1}function pT(e,r,n){r=dy(n,r),r=sS(e,r,1),_l(e,r),r=Ui(),e=u_(e,1),e!==null&&(Kd(e,1,r),ua(e,r))}function oa(e,r,n){if(e.tag===3)pT(e,e,n);else for(;r!==null;){if(r.tag===3){pT(r,e,n);break}else if(r.tag===1){var l=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof l.componentDidCatch=="function"&&(gl===null||!gl.has(l))){e=dy(n,e),e=oS(r,e,1),_l(r,e),e=Ui(),r=u_(r,1),r!==null&&(Kd(r,1,e),ua(r,e));break}}r=r.return}}function lM(e,r,n){var l=e.pingCache;l!==null&&l.delete(r),r=Ui(),e.pingedLanes|=e.suspendedLanes&n,Rn===e&&(Qn&n)===n&&(Vn===4||Vn===3&&(Qn&130023424)===Qn&&500>kn()-_y?wc(e,0):my|=n),ua(e,r)}function kS(e,r){r===0&&((e.mode&1)===0?r=1:(r=R0,R0<<=1,(R0&130023424)===0&&(R0=4194304)));var n=Ui();e=u_(e,r),e!==null&&(Kd(e,r,n),ua(e,n))}function cM(e){var r=e.memoizedState,n=0;r!==null&&(n=r.retryLane),kS(e,n)}function uM(e,r){var n=0;switch(e.tag){case 13:var l=e.stateNode,u=e.memoizedState;u!==null&&(n=u.retryLane);break;case 19:l=e.stateNode;break;default:throw Error(Et(314))}l!==null&&l.delete(r),kS(e,n)}var AS;AS=function(e,r,n){if(e!==null)if(e.memoizedProps!==r.pendingProps||la.current)wa=!0;else{if((e.lanes&n)===0&&(r.flags&128)===0)return wa=!1,Y4(e,r,n);wa=(e.flags&131072)!==0}else wa=!1,nn&&(r.flags&1048576)!==0&&Ob(r,Dm,r.index);switch(r.lanes=0,r.tag){case 2:var l=r.type;e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2),e=r.pendingProps;var u=lh(r,yi.current);rh(r,n),u=uy(null,r,l,e,u,n);var m=hy();return r.flags|=1,typeof u=="object"&&u!==null&&typeof u.render=="function"&&u.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,ca(l)?(m=!0,km(r)):m=!1,r.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,ry(r),u.updater=s_,r.stateNode=u,u._reactInternals=r,n1(r,l,e,n),r=c1(null,r,l,!0,m,n)):(r.tag=0,nn&&m&&ny(r),zi(null,r,u,n),r=r.child),r;case 16:l=r.elementType;e:{switch(e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2),e=r.pendingProps,u=l._init,l=u(l._payload),r.type=l,u=r.tag=fM(l),e=ss(l,e),u){case 0:r=l1(null,r,l,e,n);break e;case 1:r=eT(null,r,l,e,n);break e;case 11:r=Jw(null,r,l,e,n);break e;case 14:r=Qw(null,r,l,ss(l.type,e),n);break e}throw Error(Et(306,l,""))}return r;case 0:return l=r.type,u=r.pendingProps,u=r.elementType===l?u:ss(l,u),l1(e,r,l,u,n);case 1:return l=r.type,u=r.pendingProps,u=r.elementType===l?u:ss(l,u),eT(e,r,l,u,n);case 3:e:{if(pS(r),e===null)throw Error(Et(387));l=r.pendingProps,m=r.memoizedState,u=m.element,Lb(e,r),Im(r,l,null,n);var x=r.memoizedState;if(l=x.element,m.isDehydrated)if(m={element:l,isDehydrated:!1,cache:x.cache,transitions:x.transitions},r.updateQueue.baseState=m,r.memoizedState=m,r.flags&256){u=Error(Et(423)),r=tT(e,r,l,n,u);break e}else if(l!==u){u=Error(Et(424)),r=tT(e,r,l,n,u);break e}else for(sa=fo(r.stateNode.containerInfo.firstChild),Ta=r,nn=!0,os=null,n=Ub(r,null,l,n),r.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ch(),l===u){r=To(e,r,n);break e}zi(e,r,l,n)}r=r.child}return r;case 5:return Vb(r),e===null&&a1(r),l=r.type,u=r.pendingProps,m=e!==null?e.memoizedProps:null,x=u.children,Yx(l,u)?x=null:m!==null&&Yx(l,m)&&(r.flags|=32),dS(e,r),zi(e,r,x,n),r.child;case 6:return e===null&&a1(r),null;case 13:return mS(e,r,n);case 4:return sy(r,r.stateNode.containerInfo),l=r.pendingProps,e===null?r.child=uh(r,null,l,n):zi(e,r,l,n),r.child;case 11:return l=r.type,u=r.pendingProps,u=r.elementType===l?u:ss(l,u),Jw(e,r,l,u,n);case 7:return zi(e,r,r.pendingProps,n),r.child;case 8:return zi(e,r,r.pendingProps.children,n),r.child;case 12:return zi(e,r,r.pendingProps.children,n),r.child;case 10:e:{if(l=r.type._context,u=r.pendingProps,m=r.memoizedProps,x=u.value,Zr(Am,l._currentValue),l._currentValue=x,m!==null)if(Vs(m.value,x)){if(m.children===u.children&&!la.current){r=To(e,r,n);break e}}else for(m=r.child,m!==null&&(m.return=r);m!==null;){var o=m.dependencies;if(o!==null){x=m.child;for(var S=o.firstContext;S!==null;){if(S.context===l){if(m.tag===1){S=go(-1,n&-n),S.tag=2;var A=m.updateQueue;if(A!==null){A=A.shared;var I=A.pending;I===null?S.next=S:(S.next=I.next,I.next=S),A.pending=S}}m.lanes|=n,S=m.alternate,S!==null&&(S.lanes|=n),t1(m.return,n,r),o.lanes|=n;break}S=S.next}}else if(m.tag===10)x=m.type===r.type?null:m.child;else if(m.tag===18){if(x=m.return,x===null)throw Error(Et(341));x.lanes|=n,o=x.alternate,o!==null&&(o.lanes|=n),t1(x,n,r),x=m.sibling}else x=m.child;if(x!==null)x.return=m;else for(x=m;x!==null;){if(x===r){x=null;break}if(m=x.sibling,m!==null){m.return=x.return,x=m;break}x=x.return}m=x}zi(e,r,u.children,n),r=r.child}return r;case 9:return u=r.type,l=r.pendingProps.children,rh(r,n),u=$a(u),l=l(u),r.flags|=1,zi(e,r,l,n),r.child;case 14:return l=r.type,u=ss(l,r.pendingProps),u=ss(l.type,u),Qw(e,r,l,u,n);case 15:return hS(e,r,r.type,r.pendingProps,n);case 17:return l=r.type,u=r.pendingProps,u=r.elementType===l?u:ss(l,u),e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2),r.tag=1,ca(l)?(e=!0,km(r)):e=!1,rh(r,n),zb(r,l,u),n1(r,l,u,n),c1(null,r,l,!0,e,n);case 19:return _S(e,r,n);case 22:return fS(e,r,n)}throw Error(Et(156,r.tag))};function CS(e,r){return ab(e,r)}function hM(e,r,n,l){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=l,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ua(e,r,n,l){return new hM(e,r,n,l)}function vy(e){return e=e.prototype,!(!e||!e.isReactComponent)}function fM(e){if(typeof e=="function")return vy(e)?1:0;if(e!=null){if(e=e.$$typeof,e===V1)return 11;if(e===j1)return 14}return 2}function El(e,r){var n=e.alternate;return n===null?(n=Ua(e.tag,r,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=r,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,r=e.dependencies,n.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function mm(e,r,n,l,u,m){var x=2;if(l=e,typeof e=="function")vy(e)&&(x=1);else if(typeof e=="string")x=5;else e:switch(e){case Vu:return Tc(n.children,u,m,r);case U1:x=8,u|=8;break;case Mx:return e=Ua(12,n,r,u|2),e.elementType=Mx,e.lanes=m,e;case Dx:return e=Ua(13,n,r,u),e.elementType=Dx,e.lanes=m,e;case Fx:return e=Ua(19,n,r,u),e.elementType=Fx,e.lanes=m,e;case jE:return Um(n,u,m,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case UE:x=10;break e;case VE:x=9;break e;case V1:x=11;break e;case j1:x=14;break e;case nl:x=16,l=null;break e}throw Error(Et(130,e==null?e:typeof e,""))}return r=Ua(x,n,r,u),r.elementType=e,r.type=l,r.lanes=m,r}function Tc(e,r,n,l){return e=Ua(7,e,l,r),e.lanes=n,e}function Um(e,r,n,l){return e=Ua(22,e,l,r),e.elementType=jE,e.lanes=n,e.stateNode={},e}function _x(e,r,n){return e=Ua(6,e,null,r),e.lanes=n,e}function gx(e,r,n){return r=Ua(4,e.children!==null?e.children:[],e.key,r),r.lanes=n,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function dM(e,r,n,l,u){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Jg(0),this.expirationTimes=Jg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Jg(0),this.identifierPrefix=l,this.onRecoverableError=u,this.mutableSourceEagerHydrationData=null}function wy(e,r,n,l,u,m,x,o,S){return e=new dM(e,r,n,o,S),r===1?(r=1,m===!0&&(r|=8)):r=0,m=Ua(3,null,null,r),e.current=m,m.stateNode=e,m.memoizedState={element:l,isDehydrated:n,cache:null,transitions:null},ry(m),e}function pM(e,r,n){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Uu,key:l==null?null:""+l,children:e,containerInfo:r,implementation:n}}function IS(e){if(!e)return Tl;e=e._reactInternals;e:{if(Fc(e)!==e||e.tag!==1)throw Error(Et(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(ca(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(Et(171))}if(e.tag===1){var n=e.type;if(ca(n))return Fb(e,n,r)}return r}function MS(e,r,n,l,u,m,x,o,S){return e=wy(n,l,!0,e,u,m,x,o,S),e.context=IS(null),n=e.current,l=Ui(),u=xl(n),m=go(l,u),m.callback=r!=null?r:null,_l(n,m),e.current.lanes=u,Kd(e,u,l),ua(e,l),e}function h_(e,r,n,l){var u=r.current,m=Ui(),x=xl(u);return n=IS(n),r.context===null?r.context=n:r.pendingContext=n,r=go(m,x),r.payload={element:e},l=l===void 0?null:l,l!==null&&(r.callback=l),_l(u,r),e=Ga(u,x,m),e!==null&&um(e,u,x),x}function Vm(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function mT(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<r?n:r}}function Ty(e,r){mT(e,r),(e=e.alternate)&&mT(e,r)}function mM(){return null}var DS=typeof reportError=="function"?reportError:function(e){console.error(e)};function Ey(e){this._internalRoot=e}f_.prototype.render=Ey.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(Et(409));h_(e,r,null,null)};f_.prototype.unmount=Ey.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;Ac(function(){h_(null,e,null,null)}),r[wo]=null}};function f_(e){this._internalRoot=e}f_.prototype.unstable_scheduleHydration=function(e){if(e){var r=hb();e={blockedOn:null,target:e,priority:r};for(var n=0;n<al.length&&r!==0&&r<al[n].priority;n++);al.splice(n,0,e),n===0&&db(e)}};function by(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function d_(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function _T(){}function _M(e,r,n,l,u){if(u){if(typeof l=="function"){var m=l;l=function(){var A=Vm(x);m.call(A)}}var x=MS(r,l,e,0,null,!1,!1,"",_T);return e._reactRootContainer=x,e[wo]=x.current,Dd(e.nodeType===8?e.parentNode:e),Ac(),x}for(;u=e.lastChild;)e.removeChild(u);if(typeof l=="function"){var o=l;l=function(){var A=Vm(S);o.call(A)}}var S=wy(e,0,!1,null,null,!1,!1,"",_T);return e._reactRootContainer=S,e[wo]=S.current,Dd(e.nodeType===8?e.parentNode:e),Ac(function(){h_(r,S,n,l)}),S}function p_(e,r,n,l,u){var m=n._reactRootContainer;if(m){var x=m;if(typeof u=="function"){var o=u;u=function(){var S=Vm(x);o.call(S)}}h_(r,x,e,u)}else x=_M(n,r,e,u,l);return Vm(x)}cb=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var n=Qf(r.pendingLanes);n!==0&&(W1(r,n|1),ua(r,kn()),(Er&6)===0&&(ph=kn()+500,Cl()))}break;case 13:var l=Ui();Ac(function(){return Ga(e,1,l)}),Ty(e,1)}};Z1=function(e){if(e.tag===13){var r=Ui();Ga(e,134217728,r),Ty(e,134217728)}};ub=function(e){if(e.tag===13){var r=Ui(),n=xl(e);Ga(e,n,r),Ty(e,n)}};hb=function(){return Br};fb=function(e,r){var n=Br;try{return Br=e,r()}finally{Br=n}};jx=function(e,r,n){switch(r){case"input":if(Rx(e,n),r=n.name,n.type==="radio"&&r!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<n.length;r++){var l=n[r];if(l!==e&&l.form===e.form){var u=i_(l);if(!u)throw Error(Et(90));$E(l),Rx(l,u)}}}break;case"textarea":ZE(e,n);break;case"select":r=n.value,r!=null&&Ju(e,!!n.multiple,r,!1)}};QE=gy;eb=Ac;var gM={usingClientEntryPoint:!1,Events:[Jd,Wu,i_,YE,JE,gy]},Kf={findFiberByHostInstance:mc,bundleType:0,version:"18.0.0-fc46dba67-20220329",rendererPackageName:"react-dom"},xM={bundleType:Kf.bundleType,version:Kf.version,rendererPackageName:Kf.rendererPackageName,rendererConfig:Kf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:bo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=nb(e),e===null?null:e.stateNode},findFiberByHostInstance:Kf.findFiberByHostInstance||mM,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__!="undefined"){var q0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!q0.isDisabled&&q0.supportsFiber)try{e_=q0.inject(xM),Ns=q0}catch{}}Sa.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gM;Sa.createPortal=function(e,r){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!by(r))throw Error(Et(200));return pM(e,r,null,n)};Sa.createRoot=function(e,r){if(!by(e))throw Error(Et(299));var n=!1,l="",u=DS;return r!=null&&(r.unstable_strictMode===!0&&(n=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(u=r.onRecoverableError)),r=wy(e,1,!1,null,null,n,!1,l,u),e[wo]=r.current,Dd(e.nodeType===8?e.parentNode:e),new Ey(r)};Sa.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(Et(188)):(e=Object.keys(e).join(","),Error(Et(268,e)));return e=nb(r),e=e===null?null:e.stateNode,e};Sa.flushSync=function(e){return Ac(e)};Sa.hydrate=function(e,r,n){if(!d_(r))throw Error(Et(200));return p_(null,e,r,!0,n)};Sa.hydrateRoot=function(e,r,n){if(!by(e))throw Error(Et(405));var l=n!=null&&n.hydratedSources||null,u=!1,m="",x=DS;if(n!=null&&(n.unstable_strictMode===!0&&(u=!0),n.identifierPrefix!==void 0&&(m=n.identifierPrefix),n.onRecoverableError!==void 0&&(x=n.onRecoverableError)),r=MS(r,null,e,1,n!=null?n:null,u,!1,m,x),e[wo]=r.current,Dd(e),l)for(e=0;e<l.length;e++)n=l[e],u=n._getVersion,u=u(n._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[n,u]:r.mutableSourceEagerHydrationData.push(n,u);return new f_(r)};Sa.render=function(e,r,n){if(!d_(r))throw Error(Et(200));return p_(null,e,r,!1,n)};Sa.unmountComponentAtNode=function(e){if(!d_(e))throw Error(Et(40));return e._reactRootContainer?(Ac(function(){p_(null,null,e,!1,function(){e._reactRootContainer=null,e[wo]=null})}),!0):!1};Sa.unstable_batchedUpdates=gy;Sa.unstable_renderSubtreeIntoContainer=function(e,r,n,l){if(!d_(n))throw Error(Et(200));if(e==null||e._reactInternals===void 0)throw Error(Et(38));return p_(e,r,n,!1,l)};Sa.version="18.0.0-fc46dba67-20220329";function FS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__=="undefined"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(FS)}catch(e){console.error(e)}}FS(),RE.exports=Sa;var gT=RE.exports;Cx.createRoot=gT.createRoot,Cx.hydrateRoot=gT.hydrateRoot;const So=Ln.createContext({});function yM(e,r){switch(r.type){case"setCoordData":return La(Pa({},e),{coordData:r.payload});case"setDistanceMatrix":return La(Pa({},e),{distanceMatrix:r.payload});case"setTimeMatrix":return La(Pa({},e),{timeMatrix:r.payload});case"setPlaces":return La(Pa({},e),{places:r.payload});case"setSolvingModel":return La(Pa({},e),{solvingModel:r.payload});case"setSolutionCplex":return La(Pa({},e),{solutionCplex:r.payload});case"setSolutionCBC":return La(Pa({},e),{solutionCBC:r.payload});case"setCoordinatesRoute":return La(Pa({},e),{coordinatesRoute:r.payload});default:return e}}var m_={exports:{}},__={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vM=Tr.exports,wM=Symbol.for("react.element"),TM=Symbol.for("react.fragment"),EM=Object.prototype.hasOwnProperty,bM=vM.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,SM={key:!0,ref:!0,__self:!0,__source:!0};function PS(e,r,n){var l,u={},m=null,x=null;n!==void 0&&(m=""+n),r.key!==void 0&&(m=""+r.key),r.ref!==void 0&&(x=r.ref);for(l in r)EM.call(r,l)&&!SM.hasOwnProperty(l)&&(u[l]=r[l]);if(e&&e.defaultProps)for(l in r=e.defaultProps,r)u[l]===void 0&&(u[l]=r[l]);return{$$typeof:wM,type:e,key:m,ref:x,props:u,_owner:bM.current}}__.Fragment=TM;__.jsx=PS;__.jsxs=PS;m_.exports=__;const Xt=m_.exports.jsx,Sn=m_.exports.jsxs,_m=m_.exports.Fragment;function kM(e){const r={coordData:{},distanceMatrix:[],timeMatrix:[],places:[],solvingModel:!1,solutionCplex:null,solutionCBC:null,coordinatesRoute:null},[n,l]=Ln.useReducer(yM,r);function u(L){l({type:"setCoordData",payload:L})}function m(L){l({type:"setDistanceMatrix",payload:L})}function x(L){l({type:"setTimeMatrix",payload:L})}function o(L){l({type:"setPlaces",payload:L})}function S(L){l({type:"setSolvingModel",payload:L})}function A(L){l({type:"setSolutionCplex",payload:L})}function I(L){l({type:"setSolutionCBC",payload:L})}function D(L){l({type:"setCoordinatesRoute",payload:L})}return Xt(So.Provider,{value:La(Pa({},n),{setCoordinatesData:u,setDistanceMatrix:m,setTimeMatrix:x,setPlaces:o,setSolvingModel:S,setSolutionCplex:A,setSolutionCBC:I,setCoordinatesRoute:D}),children:e.children})}const g_=Ln.createContext({});function AM(e,r){switch(r.type){case"setMap":return La(Pa({},e),{isMapReady:!0,map:r.payload});default:return e}}function CM(e){const r={isMapReady:!1,map:void 0},[n,l]=Ln.useReducer(AM,r);Ln.useContext(So);function u(m){l({type:"setMap",payload:m})}return Xt(g_.Provider,{value:La(Pa({},n),{setMap:u}),children:e.children})}function jm(){return jm=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},jm.apply(this,arguments)}var xc;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(xc||(xc={}));var xT=function(e){return e},yT="beforeunload",IM="popstate";function MM(e){e===void 0&&(e={});var r=e,n=r.window,l=n===void 0?document.defaultView:n,u=l.history;function m(){var se=l.location,ke=se.pathname,Ie=se.search,Xe=se.hash,$e=u.state||{};return[$e.idx,xT({pathname:ke,search:Ie,hash:Xe,state:$e.usr||null,key:$e.key||"default"})]}var x=null;function o(){if(x)B.call(x),x=null;else{var se=xc.Pop,ke=m(),Ie=ke[0],Xe=ke[1];if(B.length){if(Ie!=null){var $e=I-Ie;$e&&(x={action:se,location:Xe,retry:function(){Ae($e*-1)}},Ae($e))}}else K(se)}}l.addEventListener(IM,o);var S=xc.Pop,A=m(),I=A[0],D=A[1],L=wT(),B=wT();I==null&&(I=0,u.replaceState(jm({},u.state,{idx:I}),""));function U(se){return typeof se=="string"?se:y1(se)}function V(se,ke){return ke===void 0&&(ke=null),xT(jm({pathname:D.pathname,hash:"",search:""},typeof se=="string"?Pc(se):se,{state:ke,key:DM()}))}function Y(se,ke){return[{usr:se.state,key:se.key,idx:ke},U(se)]}function X(se,ke,Ie){return!B.length||(B.call({action:se,location:ke,retry:Ie}),!1)}function K(se){S=se;var ke=m();I=ke[0],D=ke[1],L.call({action:S,location:D})}function G(se,ke){var Ie=xc.Push,Xe=V(se,ke);function $e(){G(se,ke)}if(X(Ie,Xe,$e)){var We=Y(Xe,I+1),dt=We[0],Ut=We[1];try{u.pushState(dt,"",Ut)}catch{l.location.assign(Ut)}K(Ie)}}function me(se,ke){var Ie=xc.Replace,Xe=V(se,ke);function $e(){me(se,ke)}if(X(Ie,Xe,$e)){var We=Y(Xe,I),dt=We[0],Ut=We[1];u.replaceState(dt,"",Ut),K(Ie)}}function Ae(se){u.go(se)}var ge={get action(){return S},get location(){return D},createHref:U,push:G,replace:me,go:Ae,back:function(){Ae(-1)},forward:function(){Ae(1)},listen:function(ke){return L.push(ke)},block:function(ke){var Ie=B.push(ke);return B.length===1&&l.addEventListener(yT,vT),function(){Ie(),B.length||l.removeEventListener(yT,vT)}}};return ge}function vT(e){e.preventDefault(),e.returnValue=""}function wT(){var e=[];return{get length(){return e.length},push:function(n){return e.push(n),function(){e=e.filter(function(l){return l!==n})}},call:function(n){e.forEach(function(l){return l&&l(n)})}}}function DM(){return Math.random().toString(36).substr(2,8)}function y1(e){var r=e.pathname,n=r===void 0?"/":r,l=e.search,u=l===void 0?"":l,m=e.hash,x=m===void 0?"":m;return u&&u!=="?"&&(n+=u.charAt(0)==="?"?u:"?"+u),x&&x!=="#"&&(n+=x.charAt(0)==="#"?x:"#"+x),n}function Pc(e){var r={};if(e){var n=e.indexOf("#");n>=0&&(r.hash=e.substr(n),e=e.substr(0,n));var l=e.indexOf("?");l>=0&&(r.search=e.substr(l),e=e.substr(0,l)),e&&(r.pathname=e)}return r}/**
 * React Router v6.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const Sy=Tr.exports.createContext(null),ky=Tr.exports.createContext(null),x_=Tr.exports.createContext({outlet:null,matches:[]});function ds(e,r){if(!e)throw new Error(r)}function FM(e,r,n){n===void 0&&(n="/");let l=typeof r=="string"?Pc(r):r,u=zS(l.pathname||"/",n);if(u==null)return null;let m=LS(e);PM(m);let x=null;for(let o=0;x==null&&o<m.length;++o)x=jM(m[o],u);return x}function LS(e,r,n,l){return r===void 0&&(r=[]),n===void 0&&(n=[]),l===void 0&&(l=""),e.forEach((u,m)=>{let x={relativePath:u.path||"",caseSensitive:u.caseSensitive===!0,childrenIndex:m,route:u};x.relativePath.startsWith("/")&&(x.relativePath.startsWith(l)||ds(!1),x.relativePath=x.relativePath.slice(l.length));let o=yl([l,x.relativePath]),S=n.concat(x);u.children&&u.children.length>0&&(u.index===!0&&ds(!1),LS(u.children,r,S,o)),!(u.path==null&&!u.index)&&r.push({path:o,score:UM(o,u.index),routesMeta:S})}),r}function PM(e){e.sort((r,n)=>r.score!==n.score?n.score-r.score:VM(r.routesMeta.map(l=>l.childrenIndex),n.routesMeta.map(l=>l.childrenIndex)))}const LM=/^:\w+$/,RM=3,zM=2,OM=1,BM=10,NM=-2,TT=e=>e==="*";function UM(e,r){let n=e.split("/"),l=n.length;return n.some(TT)&&(l+=NM),r&&(l+=zM),n.filter(u=>!TT(u)).reduce((u,m)=>u+(LM.test(m)?RM:m===""?OM:BM),l)}function VM(e,r){return e.length===r.length&&e.slice(0,-1).every((l,u)=>l===r[u])?e[e.length-1]-r[r.length-1]:0}function jM(e,r){let{routesMeta:n}=e,l={},u="/",m=[];for(let x=0;x<n.length;++x){let o=n[x],S=x===n.length-1,A=u==="/"?r:r.slice(u.length)||"/",I=GM({path:o.relativePath,caseSensitive:o.caseSensitive,end:S},A);if(!I)return null;Object.assign(l,I.params);let D=o.route;m.push({params:l,pathname:yl([u,I.pathname]),pathnameBase:OS(yl([u,I.pathnameBase])),route:D}),I.pathnameBase!=="/"&&(u=yl([u,I.pathnameBase]))}return m}function GM(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,l]=$M(e.path,e.caseSensitive,e.end),u=r.match(n);if(!u)return null;let m=u[0],x=m.replace(/(.)\/+$/,"$1"),o=u.slice(1);return{params:l.reduce((A,I,D)=>{if(I==="*"){let L=o[D]||"";x=m.slice(0,m.length-L.length).replace(/(.)\/+$/,"$1")}return A[I]=WM(o[D]||""),A},{}),pathname:m,pathnameBase:x,pattern:e}}function $M(e,r,n){r===void 0&&(r=!1),n===void 0&&(n=!0);let l=[],u="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/:(\w+)/g,(x,o)=>(l.push(o),"([^\\/]+)"));return e.endsWith("*")?(l.push("*"),u+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):u+=n?"\\/*$":"(?:(?=[.~-]|%[0-9A-F]{2})|\\b|\\/|$)",[new RegExp(u,r?void 0:"i"),l]}function WM(e,r){try{return decodeURIComponent(e)}catch{return e}}function ZM(e,r){r===void 0&&(r="/");let{pathname:n,search:l="",hash:u=""}=typeof e=="string"?Pc(e):e;return{pathname:n?n.startsWith("/")?n:HM(n,r):r,search:qM(l),hash:KM(u)}}function HM(e,r){let n=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(u=>{u===".."?n.length>1&&n.pop():u!=="."&&n.push(u)}),n.length>1?n.join("/"):"/"}function RS(e,r,n){let l=typeof e=="string"?Pc(e):e,u=e===""||l.pathname===""?"/":l.pathname,m;if(u==null)m=n;else{let o=r.length-1;if(u.startsWith("..")){let S=u.split("/");for(;S[0]==="..";)S.shift(),o-=1;l.pathname=S.join("/")}m=o>=0?r[o]:"/"}let x=ZM(l,m);return u&&u!=="/"&&u.endsWith("/")&&!x.pathname.endsWith("/")&&(x.pathname+="/"),x}function XM(e){return e===""||e.pathname===""?"/":typeof e=="string"?Pc(e).pathname:e.pathname}function zS(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let n=e.charAt(r.length);return n&&n!=="/"?null:e.slice(r.length)||"/"}const yl=e=>e.join("/").replace(/\/\/+/g,"/"),OS=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),qM=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,KM=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function YM(e){vh()||ds(!1);let{basename:r,navigator:n}=Tr.exports.useContext(Sy),{hash:l,pathname:u,search:m}=NS(e),x=u;if(r!=="/"){let o=XM(e),S=o!=null&&o.endsWith("/");x=u==="/"?r+(S?"/":""):yl([r,u])}return n.createHref({pathname:x,search:m,hash:l})}function vh(){return Tr.exports.useContext(ky)!=null}function y_(){return vh()||ds(!1),Tr.exports.useContext(ky).location}function BS(){vh()||ds(!1);let{basename:e,navigator:r}=Tr.exports.useContext(Sy),{matches:n}=Tr.exports.useContext(x_),{pathname:l}=y_(),u=JSON.stringify(n.map(o=>o.pathnameBase)),m=Tr.exports.useRef(!1);return Tr.exports.useEffect(()=>{m.current=!0}),Tr.exports.useCallback(function(o,S){if(S===void 0&&(S={}),!m.current)return;if(typeof o=="number"){r.go(o);return}let A=RS(o,JSON.parse(u),l);e!=="/"&&(A.pathname=yl([e,A.pathname])),(S.replace?r.replace:r.push)(A,S.state)},[e,r,u,l])}function NS(e){let{matches:r}=Tr.exports.useContext(x_),{pathname:n}=y_(),l=JSON.stringify(r.map(u=>u.pathnameBase));return Tr.exports.useMemo(()=>RS(e,JSON.parse(l),n),[e,l,n])}function JM(e,r){vh()||ds(!1);let{matches:n}=Tr.exports.useContext(x_),l=n[n.length-1],u=l?l.params:{};l&&l.pathname;let m=l?l.pathnameBase:"/";l&&l.route;let x=y_(),o;if(r){var S;let L=typeof r=="string"?Pc(r):r;m==="/"||((S=L.pathname)==null?void 0:S.startsWith(m))||ds(!1),o=L}else o=x;let A=o.pathname||"/",I=m==="/"?A:A.slice(m.length)||"/",D=FM(e,{pathname:I});return QM(D&&D.map(L=>Object.assign({},L,{params:Object.assign({},u,L.params),pathname:yl([m,L.pathname]),pathnameBase:L.pathnameBase==="/"?m:yl([m,L.pathnameBase])})),n)}function QM(e,r){return r===void 0&&(r=[]),e==null?null:e.reduceRight((n,l,u)=>Tr.exports.createElement(x_.Provider,{children:l.route.element!==void 0?l.route.element:n,value:{outlet:n,matches:r.concat(e.slice(0,u+1))}}),null)}function ET(e){let{to:r,replace:n,state:l}=e;vh()||ds(!1);let u=BS();return Tr.exports.useEffect(()=>{u(r,{replace:n,state:l})}),null}function td(e){ds(!1)}function eD(e){let{basename:r="/",children:n=null,location:l,navigationType:u=xc.Pop,navigator:m,static:x=!1}=e;vh()&&ds(!1);let o=OS(r),S=Tr.exports.useMemo(()=>({basename:o,navigator:m,static:x}),[o,m,x]);typeof l=="string"&&(l=Pc(l));let{pathname:A="/",search:I="",hash:D="",state:L=null,key:B="default"}=l,U=Tr.exports.useMemo(()=>{let V=zS(A,o);return V==null?null:{pathname:V,search:I,hash:D,state:L,key:B}},[o,A,I,D,L,B]);return U==null?null:Tr.exports.createElement(Sy.Provider,{value:S},Tr.exports.createElement(ky.Provider,{children:n,value:{location:U,navigationType:u}}))}function tD(e){let{children:r,location:n}=e;return JM(v1(r),n)}function v1(e){let r=[];return Tr.exports.Children.forEach(e,n=>{if(!Tr.exports.isValidElement(n))return;if(n.type===Tr.exports.Fragment){r.push.apply(r,v1(n.props.children));return}n.type!==td&&ds(!1);let l={caseSensitive:n.props.caseSensitive,element:n.props.element,index:n.props.index,path:n.props.path};n.props.children&&(l.children=v1(n.props.children)),r.push(l)}),r}/**
 * React Router DOM v6.3.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function w1(){return w1=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(e[l]=n[l])}return e},w1.apply(this,arguments)}function rD(e,r){if(e==null)return{};var n={},l=Object.keys(e),u,m;for(m=0;m<l.length;m++)u=l[m],!(r.indexOf(u)>=0)&&(n[u]=e[u]);return n}const nD=["onClick","reloadDocument","replace","state","target","to"];function iD(e){let{basename:r,children:n,window:l}=e,u=Tr.exports.useRef();u.current==null&&(u.current=MM({window:l}));let m=u.current,[x,o]=Tr.exports.useState({action:m.action,location:m.location});return Tr.exports.useLayoutEffect(()=>m.listen(o),[m]),Tr.exports.createElement(eD,{basename:r,children:n,location:x.location,navigationType:x.action,navigator:m})}function aD(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}const bT=Tr.exports.forwardRef(function(r,n){let{onClick:l,reloadDocument:u,replace:m=!1,state:x,target:o,to:S}=r,A=rD(r,nD),I=YM(S),D=sD(S,{replace:m,state:x,target:o});function L(B){l&&l(B),!B.defaultPrevented&&!u&&D(B)}return Tr.exports.createElement("a",w1({},A,{href:I,onClick:L,ref:n,target:o}))});function sD(e,r){let{target:n,replace:l,state:u}=r===void 0?{}:r,m=BS(),x=y_(),o=NS(e);return Tr.exports.useCallback(S=>{if(S.button===0&&(!n||n==="_self")&&!aD(S)){S.preventDefault();let A=!!l||y1(x)===y1(o);m(e,{replace:A,state:u})}},[x,m,o,l,u,n,e])}function oD(){const{distanceMatrix:e,timeMatrix:r,coordData:n,setSolvingModel:l,setSolutionCBC:u,setCoordinatesRoute:m}=Ln.useContext(So),{map:x}=Ln.useContext(g_);async function o(){l(!0);try{const A=performance.now(),D=await(await fetch("https://optfastapi.herokuapp.com/cbc",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({Places:[...Array(e.length).keys()],Matrix:e}),mode:"cors"})).json(),L=performance.now();console.log(D),console.log("tiempo de ejecuci\xF3n: ",(L-A)/1e3),S(D),u(D)}catch(A){console.log(A),alert("Error en la ejecuci\xF3n del modelo")}l(!1)}async function S(A){const I=A.route.map(me=>`${n[me].Longitud}%2C${n[me].Latitud}`).join("%3B");console.log(I);const L=await(await fetch(`https://api.mapbox.com/directions/v5/mapbox/driving/${I}?alternatives=false&geometries=geojson&overview=simplified&steps=false&access_token=pk.eyJ1Ijoic2ViYXN0aWFuam9zZSIsImEiOiJjbDJjdDd2azgwc2RuM2pvMjF6YmsxYThoIn0.CS_kAa8atE7dyFWkz1X7Lw`)).json();console.log(L);const{distance:B,duration:U,geometry:V}=L.routes[0],{coordinates:Y}=V;m(Y);const X=Math.round(B/1e3*100)/100,K=Math.floor(U/60);console.log({kms:X,minutes:K});const G={type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:Y}}]}};x!=null&&x.getLayer("RouteString")&&(x.removeLayer("RouteString"),x.removeSource("RouteString")),x==null||x.addSource("RouteString",G),x==null||x.addLayer({id:"RouteString",type:"line",source:"RouteString",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"black","line-width":3}})}return Xt("button",{onClick:o,disabled:e.length===0,children:"Ejecutar Modelo"})}function US(){const{coordData:e,setDistanceMatrix:r,setTimeMatrix:n,setPlaces:l}=Ln.useContext(So);async function u(x,o){const[S,A]=x,[I,D]=o,B=await(await fetch(`https://api.mapbox.com/directions/v5/mapbox/driving/${A}%2C${S}%3B${D}%2C${I}?alternatives=false&geometries=geojson&overview=simplified&steps=false&access_token=pk.eyJ1Ijoic2ViYXN0aWFuam9zZSIsImEiOiJjbDJjdDd2azgwc2RuM2pvMjF6YmsxYThoIn0.CS_kAa8atE7dyFWkz1X7Lw`)).json(),U=B.routes[0].distance/1e3,V=B.routes[0].duration/60;return{distance_km:U,duration_min:V}}async function m(){console.log(e);const x=e.map(I=>I.Lugar);l(x);const o=e.map(I=>[I.Latitud,I.Longitud]);console.log(o);const S=[],A=[];for(const I in o){const D=[],L=[];for(const B in o){const{distance_km:U,duration_min:V}=await u(o[I],o[B]);D.push(U),L.push(V)}S.push(D),A.push(L)}r(S),n(A),console.log(S),console.log(A)}return Xt("button",{onClick:m,children:"Procesar Datos"})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var VS=1252,lD=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Ay={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Cy=function(e){lD.indexOf(e)!=-1&&(VS=Ay[0]=e)};function cD(){Cy(1252)}var cs=function(e){Cy(e)};function jS(){cs(1200),cD()}function ST(e){for(var r=[],n=0,l=e.length;n<l;++n)r[n]=e.charCodeAt(n);return r}function uD(e){for(var r=[],n=0;n<e.length>>1;++n)r[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return r.join("")}function GS(e){for(var r=[],n=0;n<e.length>>1;++n)r[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return r.join("")}var rd=function(e){var r=e.charCodeAt(0),n=e.charCodeAt(1);return r==255&&n==254?uD(e.slice(2)):r==254&&n==255?GS(e.slice(2)):r==65279?e.slice(1):e},K0=function(r){return String.fromCharCode(r)},kT=function(r){return String.fromCharCode(r)},ol,hl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function AT(e){for(var r="",n=0,l=0,u=0,m=0,x=0,o=0,S=0,A=0;A<e.length;)n=e.charCodeAt(A++),m=n>>2,l=e.charCodeAt(A++),x=(n&3)<<4|l>>4,u=e.charCodeAt(A++),o=(l&15)<<2|u>>6,S=u&63,isNaN(l)?o=S=64:isNaN(u)&&(S=64),r+=hl.charAt(m)+hl.charAt(x)+hl.charAt(o)+hl.charAt(S);return r}function ba(e){var r="",n=0,l=0,u=0,m=0,x=0,o=0,S=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var A=0;A<e.length;)m=hl.indexOf(e.charAt(A++)),x=hl.indexOf(e.charAt(A++)),n=m<<2|x>>4,r+=String.fromCharCode(n),o=hl.indexOf(e.charAt(A++)),l=(x&15)<<4|o>>2,o!==64&&(r+=String.fromCharCode(l)),S=hl.indexOf(e.charAt(A++)),u=(o&3)<<6|S,S!==64&&(r+=String.fromCharCode(u));return r}var vr=function(){return typeof Buffer!="undefined"&&typeof process!="undefined"&&typeof process.versions!="undefined"&&!!process.versions.node}(),Lc=function(){if(typeof Buffer!="undefined"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(r,n){return n?new Buffer(r,n):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function bl(e){return vr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}function CT(e){return vr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array!="undefined"?new Uint8Array(e):new Array(e)}var ls=function(r){return vr?Lc(r,"binary"):r.split("").map(function(n){return n.charCodeAt(0)&255})};function Rc(e){if(Array.isArray(e))return e.map(function(l){return String.fromCharCode(l)}).join("");for(var r=[],n=0;n<e.length;++n)r[n]=String.fromCharCode(e[n]);return r.join("")}function Iy(e){if(typeof ArrayBuffer=="undefined")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Iy(new Uint8Array(e));for(var r=new Array(e.length),n=0;n<e.length;++n)r[n]=e[n];return r}var ll=vr?function(e){return Buffer.concat(e.map(function(r){return Buffer.isBuffer(r)?r:Lc(r)}))}:function(e){if(typeof Uint8Array!="undefined"){var r=0,n=0;for(r=0;r<e.length;++r)n+=e[r].length;var l=new Uint8Array(n),u=0;for(r=0,n=0;r<e.length;n+=u,++r)if(u=e[r].length,e[r]instanceof Uint8Array)l.set(e[r],n);else{if(typeof e[r]=="string")throw"wtf";l.set(new Uint8Array(e[r]),n)}return l}return[].concat.apply([],e.map(function(m){return Array.isArray(m)?m:[].slice.call(m)}))};function hD(e){for(var r=[],n=0,l=e.length+250,u=bl(e.length+255),m=0;m<e.length;++m){var x=e.charCodeAt(m);if(x<128)u[n++]=x;else if(x<2048)u[n++]=192|x>>6&31,u[n++]=128|x&63;else if(x>=55296&&x<57344){x=(x&1023)+64;var o=e.charCodeAt(++m)&1023;u[n++]=240|x>>8&7,u[n++]=128|x>>2&63,u[n++]=128|o>>6&15|(x&3)<<4,u[n++]=128|o&63}else u[n++]=224|x>>12&15,u[n++]=128|x>>6&63,u[n++]=128|x&63;n>l&&(r.push(u.slice(0,n)),n=0,u=bl(65535),l=65530)}return r.push(u.slice(0,n)),ll(r)}var Vi=/\u0000/g,nd=/[\u0001-\u0006]/g;function ih(e){for(var r="",n=e.length-1;n>=0;)r+=e.charAt(n--);return r}function us(e,r){var n=""+e;return n.length>=r?n:yn("0",r-n.length)+n}function My(e,r){var n=""+e;return n.length>=r?n:yn(" ",r-n.length)+n}function Gm(e,r){var n=""+e;return n.length>=r?n:n+yn(" ",r-n.length)}function fD(e,r){var n=""+Math.round(e);return n.length>=r?n:yn("0",r-n.length)+n}function dD(e,r){var n=""+e;return n.length>=r?n:yn("0",r-n.length)+n}var IT=Math.pow(2,32);function Bu(e,r){if(e>IT||e<-IT)return fD(e,r);var n=Math.round(e);return dD(n,r)}function $m(e,r){return r=r||0,e.length>=7+r&&(e.charCodeAt(r)|32)===103&&(e.charCodeAt(r+1)|32)===101&&(e.charCodeAt(r+2)|32)===110&&(e.charCodeAt(r+3)|32)===101&&(e.charCodeAt(r+4)|32)===114&&(e.charCodeAt(r+5)|32)===97&&(e.charCodeAt(r+6)|32)===108}var MT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],xx=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function pD(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "',e}var hr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"\u4E0A\u5348/\u4E0B\u5348 "hh"\u6642"mm"\u5206"ss"\u79D2 "'},DT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},mD={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Wm(e,r,n){for(var l=e<0?-1:1,u=e*l,m=0,x=1,o=0,S=1,A=0,I=0,D=Math.floor(u);A<r&&(D=Math.floor(u),o=D*x+m,I=D*A+S,!(u-D<5e-8));)u=1/(u-D),m=x,x=o,S=A,A=I;if(I>r&&(A>r?(I=S,o=m):(I=A,o=x)),!n)return[0,l*o,I];var L=Math.floor(l*o/I);return[L,l*o-L*I,I]}function yc(e,r,n){if(e>2958465||e<0)return null;var l=e|0,u=Math.floor(86400*(e-l)),m=0,x=[],o={D:l,T:u,u:86400*(e-l)-u,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),r&&r.date1904&&(l+=1462),o.u>.9999&&(o.u=0,++u==86400&&(o.T=u=0,++l,++o.D)),l===60)x=n?[1317,10,29]:[1900,2,29],m=3;else if(l===0)x=n?[1317,8,29]:[1900,1,0],m=6;else{l>60&&--l;var S=new Date(1900,0,1);S.setDate(S.getDate()+l-1),x=[S.getFullYear(),S.getMonth()+1,S.getDate()],m=S.getDay(),l<60&&(m=(m+6)%7),n&&(m=wD(S,x))}return o.y=x[0],o.m=x[1],o.d=x[2],o.S=u%60,u=Math.floor(u/60),o.M=u%60,u=Math.floor(u/60),o.H=u,o.q=m,o}var $S=new Date(1899,11,31,0,0,0),_D=$S.getTime(),gD=new Date(1900,2,1,0,0,0);function WS(e,r){var n=e.getTime();return r?n-=1461*24*60*60*1e3:e>=gD&&(n+=24*60*60*1e3),(n-(_D+(e.getTimezoneOffset()-$S.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Dy(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function xD(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function yD(e){var r=e<0?12:11,n=Dy(e.toFixed(12));return n.length<=r||(n=e.toPrecision(10),n.length<=r)?n:e.toExponential(5)}function vD(e){var r=Dy(e.toFixed(11));return r.length>(e<0?12:11)||r==="0"||r==="-0"?e.toPrecision(6):r}function Vd(e){var r=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return r>=-4&&r<=-1?n=e.toPrecision(10+r):Math.abs(r)<=9?n=yD(e):r===10?n=e.toFixed(10).substr(0,12):n=vD(e),Dy(xD(n.toUpperCase()))}function Cc(e,r){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):Vd(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Wa(14,WS(e,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+e)}function wD(e,r){r[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function TD(e,r,n,l){var u="",m=0,x=0,o=n.y,S,A=0;switch(e){case 98:o=n.y+543;case 121:switch(r.length){case 1:case 2:S=o%100,A=2;break;default:S=o%1e4,A=4;break}break;case 109:switch(r.length){case 1:case 2:S=n.m,A=r.length;break;case 3:return xx[n.m-1][1];case 5:return xx[n.m-1][0];default:return xx[n.m-1][2]}break;case 100:switch(r.length){case 1:case 2:S=n.d,A=r.length;break;case 3:return MT[n.q][0];default:return MT[n.q][1]}break;case 104:switch(r.length){case 1:case 2:S=1+(n.H+11)%12,A=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:S=n.H,A=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:S=n.M,A=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return n.u===0&&(r=="s"||r=="ss")?us(n.S,r.length):(l>=2?x=l===3?1e3:100:x=l===1?10:1,m=Math.round(x*(n.S+n.u)),m>=60*x&&(m=0),r==="s"?m===0?"0":""+m/x:(u=us(m,2+l),r==="ss"?u.substr(0,2):"."+u.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":S=n.D*24+n.H;break;case"[m]":case"[mm]":S=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":S=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+r}A=r.length===3?1:2;break;case 101:S=o,A=1;break}var I=A>0?us(S,A):"";return I}function fl(e){var r=3;if(e.length<=r)return e;for(var n=e.length%r,l=e.substr(0,n);n!=e.length;n+=r)l+=(l.length>0?",":"")+e.substr(n,r);return l}var ZS=/%/g;function ED(e,r,n){var l=r.replace(ZS,""),u=r.length-l.length;return xo(e,l,n*Math.pow(10,2*u))+yn("%",u)}function bD(e,r,n){for(var l=r.length-1;r.charCodeAt(l-1)===44;)--l;return xo(e,r.substr(0,l),n/Math.pow(10,3*(r.length-l)))}function HS(e,r){var n,l=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+HS(e,-r);var u=e.indexOf(".");u===-1&&(u=e.indexOf("E"));var m=Math.floor(Math.log(r)*Math.LOG10E)%u;if(m<0&&(m+=u),n=(r/Math.pow(10,m)).toPrecision(l+1+(u+m)%u),n.indexOf("e")===-1){var x=Math.floor(Math.log(r)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(x-n.length+m):n+="E+"+(x-m);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,u)+"."+n.substr(2+u),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,S,A,I){return S+A+I.substr(0,(u+m)%u)+"."+I.substr(m)+"E"})}else n=r.toExponential(l);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var XS=/# (\?+)( ?)\/( ?)(\d+)/;function SD(e,r,n){var l=parseInt(e[4],10),u=Math.round(r*l),m=Math.floor(u/l),x=u-m*l,o=l;return n+(m===0?"":""+m)+" "+(x===0?yn(" ",e[1].length+1+e[4].length):My(x,e[1].length)+e[2]+"/"+e[3]+us(o,e[4].length))}function kD(e,r,n){return n+(r===0?"":""+r)+yn(" ",e[1].length+2+e[4].length)}var qS=/^#*0*\.([0#]+)/,KS=/\).*[0#]/,YS=/\(###\) ###\\?-####/;function Oi(e){for(var r="",n,l=0;l!=e.length;++l)switch(n=e.charCodeAt(l)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(n)}return r}function FT(e,r){var n=Math.pow(10,r);return""+Math.round(e*n)/n}function PT(e,r){var n=e-Math.floor(e),l=Math.pow(10,r);return r<(""+Math.round(n*l)).length?0:Math.round(n*l)}function AD(e,r){return r<(""+Math.round((e-Math.floor(e))*Math.pow(10,r))).length?1:0}function CD(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function za(e,r,n){if(e.charCodeAt(0)===40&&!r.match(KS)){var l=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?za("n",l,n):"("+za("n",l,-n)+")"}if(r.charCodeAt(r.length-1)===44)return bD(e,r,n);if(r.indexOf("%")!==-1)return ED(e,r,n);if(r.indexOf("E")!==-1)return HS(r,n);if(r.charCodeAt(0)===36)return"$"+za(e,r.substr(r.charAt(1)==" "?2:1),n);var u,m,x,o,S=Math.abs(n),A=n<0?"-":"";if(r.match(/^00+$/))return A+Bu(S,r.length);if(r.match(/^[#?]+$/))return u=Bu(n,0),u==="0"&&(u=""),u.length>r.length?u:Oi(r.substr(0,r.length-u.length))+u;if(m=r.match(XS))return SD(m,S,A);if(r.match(/^#+0+$/))return A+Bu(S,r.length-r.indexOf("0"));if(m=r.match(qS))return u=FT(n,m[1].length).replace(/^([^\.]+)$/,"$1."+Oi(m[1])).replace(/\.$/,"."+Oi(m[1])).replace(/\.(\d*)$/,function(U,V){return"."+V+yn("0",Oi(m[1]).length-V.length)}),r.indexOf("0.")!==-1?u:u.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),m=r.match(/^(0*)\.(#*)$/))return A+FT(S,m[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,m[1].length?"0.":".");if(m=r.match(/^#{1,3},##0(\.?)$/))return A+fl(Bu(S,0));if(m=r.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+za(e,r,-n):fl(""+(Math.floor(n)+AD(n,m[1].length)))+"."+us(PT(n,m[1].length),m[1].length);if(m=r.match(/^#,#*,#0/))return za(e,r.replace(/^#,#*,/,""),n);if(m=r.match(/^([0#]+)(\\?-([0#]+))+$/))return u=ih(za(e,r.replace(/[\\-]/g,""),n)),x=0,ih(ih(r.replace(/\\/g,"")).replace(/[0#]/g,function(U){return x<u.length?u.charAt(x++):U==="0"?"0":""}));if(r.match(YS))return u=za(e,"##########",n),"("+u.substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var I="";if(m=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(m[4].length,7),o=Wm(S,Math.pow(10,x)-1,!1),u=""+A,I=xo("n",m[1],o[1]),I.charAt(I.length-1)==" "&&(I=I.substr(0,I.length-1)+"0"),u+=I+m[2]+"/"+m[3],I=Gm(o[2],x),I.length<m[4].length&&(I=Oi(m[4].substr(m[4].length-I.length))+I),u+=I,u;if(m=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(Math.max(m[1].length,m[4].length),7),o=Wm(S,Math.pow(10,x)-1,!0),A+(o[0]||(o[1]?"":"0"))+" "+(o[1]?My(o[1],x)+m[2]+"/"+m[3]+Gm(o[2],x):yn(" ",2*x+1+m[2].length+m[3].length));if(m=r.match(/^[#0?]+$/))return u=Bu(n,0),r.length<=u.length?u:Oi(r.substr(0,r.length-u.length))+u;if(m=r.match(/^([#0?]+)\.([#0]+)$/)){u=""+n.toFixed(Math.min(m[2].length,10)).replace(/([^0])0+$/,"$1"),x=u.indexOf(".");var D=r.indexOf(".")-x,L=r.length-u.length-D;return Oi(r.substr(0,D)+u+r.substr(r.length-L))}if(m=r.match(/^00,000\.([#0]*0)$/))return x=PT(n,m[1].length),n<0?"-"+za(e,r,-n):fl(CD(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(U){return"00,"+(U.length<3?us(0,3-U.length):"")+U})+"."+us(x,m[1].length);switch(r){case"###,##0.00":return za(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var B=fl(Bu(S,0));return B!=="0"?A+B:"";case"###,###.00":return za(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return za(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function ID(e,r,n){for(var l=r.length-1;r.charCodeAt(l-1)===44;)--l;return xo(e,r.substr(0,l),n/Math.pow(10,3*(r.length-l)))}function MD(e,r,n){var l=r.replace(ZS,""),u=r.length-l.length;return xo(e,l,n*Math.pow(10,2*u))+yn("%",u)}function JS(e,r){var n,l=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+JS(e,-r);var u=e.indexOf(".");u===-1&&(u=e.indexOf("E"));var m=Math.floor(Math.log(r)*Math.LOG10E)%u;if(m<0&&(m+=u),n=(r/Math.pow(10,m)).toPrecision(l+1+(u+m)%u),!n.match(/[Ee]/)){var x=Math.floor(Math.log(r)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(x-n.length+m):n+="E+"+(x-m),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,S,A,I){return S+A+I.substr(0,(u+m)%u)+"."+I.substr(m)+"E"})}else n=r.toExponential(l);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function zs(e,r,n){if(e.charCodeAt(0)===40&&!r.match(KS)){var l=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?zs("n",l,n):"("+zs("n",l,-n)+")"}if(r.charCodeAt(r.length-1)===44)return ID(e,r,n);if(r.indexOf("%")!==-1)return MD(e,r,n);if(r.indexOf("E")!==-1)return JS(r,n);if(r.charCodeAt(0)===36)return"$"+zs(e,r.substr(r.charAt(1)==" "?2:1),n);var u,m,x,o,S=Math.abs(n),A=n<0?"-":"";if(r.match(/^00+$/))return A+us(S,r.length);if(r.match(/^[#?]+$/))return u=""+n,n===0&&(u=""),u.length>r.length?u:Oi(r.substr(0,r.length-u.length))+u;if(m=r.match(XS))return kD(m,S,A);if(r.match(/^#+0+$/))return A+us(S,r.length-r.indexOf("0"));if(m=r.match(qS))return u=(""+n).replace(/^([^\.]+)$/,"$1."+Oi(m[1])).replace(/\.$/,"."+Oi(m[1])),u=u.replace(/\.(\d*)$/,function(U,V){return"."+V+yn("0",Oi(m[1]).length-V.length)}),r.indexOf("0.")!==-1?u:u.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),m=r.match(/^(0*)\.(#*)$/))return A+(""+S).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,m[1].length?"0.":".");if(m=r.match(/^#{1,3},##0(\.?)$/))return A+fl(""+S);if(m=r.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+zs(e,r,-n):fl(""+n)+"."+yn("0",m[1].length);if(m=r.match(/^#,#*,#0/))return zs(e,r.replace(/^#,#*,/,""),n);if(m=r.match(/^([0#]+)(\\?-([0#]+))+$/))return u=ih(zs(e,r.replace(/[\\-]/g,""),n)),x=0,ih(ih(r.replace(/\\/g,"")).replace(/[0#]/g,function(U){return x<u.length?u.charAt(x++):U==="0"?"0":""}));if(r.match(YS))return u=zs(e,"##########",n),"("+u.substr(0,3)+") "+u.substr(3,3)+"-"+u.substr(6);var I="";if(m=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(m[4].length,7),o=Wm(S,Math.pow(10,x)-1,!1),u=""+A,I=xo("n",m[1],o[1]),I.charAt(I.length-1)==" "&&(I=I.substr(0,I.length-1)+"0"),u+=I+m[2]+"/"+m[3],I=Gm(o[2],x),I.length<m[4].length&&(I=Oi(m[4].substr(m[4].length-I.length))+I),u+=I,u;if(m=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return x=Math.min(Math.max(m[1].length,m[4].length),7),o=Wm(S,Math.pow(10,x)-1,!0),A+(o[0]||(o[1]?"":"0"))+" "+(o[1]?My(o[1],x)+m[2]+"/"+m[3]+Gm(o[2],x):yn(" ",2*x+1+m[2].length+m[3].length));if(m=r.match(/^[#0?]+$/))return u=""+n,r.length<=u.length?u:Oi(r.substr(0,r.length-u.length))+u;if(m=r.match(/^([#0]+)\.([#0]+)$/)){u=""+n.toFixed(Math.min(m[2].length,10)).replace(/([^0])0+$/,"$1"),x=u.indexOf(".");var D=r.indexOf(".")-x,L=r.length-u.length-D;return Oi(r.substr(0,D)+u+r.substr(r.length-L))}if(m=r.match(/^00,000\.([#0]*0)$/))return n<0?"-"+zs(e,r,-n):fl(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(U){return"00,"+(U.length<3?us(0,3-U.length):"")+U})+"."+us(0,m[1].length);switch(r){case"###,###":case"##,###":case"#,###":var B=fl(""+S);return B!=="0"?A+B:"";default:if(r.match(/\.[0#?]*$/))return zs(e,r.slice(0,r.lastIndexOf(".")),n)+Oi(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function xo(e,r,n){return(n|0)===n?zs(e,r,n):za(e,r,n)}function DD(e){for(var r=[],n=!1,l=0,u=0;l<e.length;++l)switch(e.charCodeAt(l)){case 34:n=!n;break;case 95:case 42:case 92:++l;break;case 59:r[r.length]=e.substr(u,l-u),u=l+1}if(r[r.length]=e.substr(u),n===!0)throw new Error("Format |"+e+"| unterminated string ");return r}var QS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function wh(e){for(var r=0,n="",l="";r<e.length;)switch(n=e.charAt(r)){case"G":$m(e,r)&&(r+=6),r++;break;case'"':for(;e.charCodeAt(++r)!==34&&r<e.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(e.charAt(r+1)==="1"||e.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"\u4E0A":if(e.substr(r,3).toUpperCase()==="A/P"||e.substr(r,5).toUpperCase()==="AM/PM"||e.substr(r,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348")return!0;++r;break;case"[":for(l=n;e.charAt(r++)!=="]"&&r<e.length;)l+=e.charAt(r);if(l.match(QS))return!0;break;case".":case"0":case"#":for(;r<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++r))>-1||n=="\\"&&e.charAt(r+1)=="-"&&"0#".indexOf(e.charAt(r+2))>-1););break;case"?":for(;e.charAt(++r)===n;);break;case"*":++r,(e.charAt(r)==" "||e.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<e.length&&"0123456789".indexOf(e.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function FD(e,r,n,l){for(var u=[],m="",x=0,o="",S="t",A,I,D,L="H";x<e.length;)switch(o=e.charAt(x)){case"G":if(!$m(e,x))throw new Error("unrecognized character "+o+" in "+e);u[u.length]={t:"G",v:"General"},x+=7;break;case'"':for(m="";(D=e.charCodeAt(++x))!==34&&x<e.length;)m+=String.fromCharCode(D);u[u.length]={t:"t",v:m},++x;break;case"\\":var B=e.charAt(++x),U=B==="("||B===")"?B:"t";u[u.length]={t:U,v:B},++x;break;case"_":u[u.length]={t:"t",v:" "},x+=2;break;case"@":u[u.length]={t:"T",v:r},++x;break;case"B":case"b":if(e.charAt(x+1)==="1"||e.charAt(x+1)==="2"){if(A==null&&(A=yc(r,n,e.charAt(x+1)==="2"),A==null))return"";u[u.length]={t:"X",v:e.substr(x,2)},S=o,x+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||A==null&&(A=yc(r,n),A==null))return"";for(m=o;++x<e.length&&e.charAt(x).toLowerCase()===o;)m+=o;o==="m"&&S.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=L),u[u.length]={t:o,v:m},S=o;break;case"A":case"a":case"\u4E0A":var V={t:o,v:o};if(A==null&&(A=yc(r,n)),e.substr(x,3).toUpperCase()==="A/P"?(A!=null&&(V.v=A.H>=12?"P":"A"),V.t="T",L="h",x+=3):e.substr(x,5).toUpperCase()==="AM/PM"?(A!=null&&(V.v=A.H>=12?"PM":"AM"),V.t="T",x+=5,L="h"):e.substr(x,5).toUpperCase()==="\u4E0A\u5348/\u4E0B\u5348"?(A!=null&&(V.v=A.H>=12?"\u4E0B\u5348":"\u4E0A\u5348"),V.t="T",x+=5,L="h"):(V.t="t",++x),A==null&&V.t==="T")return"";u[u.length]=V,S=o;break;case"[":for(m=o;e.charAt(x++)!=="]"&&x<e.length;)m+=e.charAt(x);if(m.slice(-1)!=="]")throw'unterminated "[" block: |'+m+"|";if(m.match(QS)){if(A==null&&(A=yc(r,n),A==null))return"";u[u.length]={t:"Z",v:m.toLowerCase()},S=m.charAt(1)}else m.indexOf("$")>-1&&(m=(m.match(/\$([^-\[\]]*)/)||[])[1]||"$",wh(e)||(u[u.length]={t:"t",v:m}));break;case".":if(A!=null){for(m=o;++x<e.length&&(o=e.charAt(x))==="0";)m+=o;u[u.length]={t:"s",v:m};break}case"0":case"#":for(m=o;++x<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(x))>-1;)m+=o;u[u.length]={t:"n",v:m};break;case"?":for(m=o;e.charAt(++x)===o;)m+=o;u[u.length]={t:o,v:m},S=o;break;case"*":++x,(e.charAt(x)==" "||e.charAt(x)=="*")&&++x;break;case"(":case")":u[u.length]={t:l===1?"t":o,v:o},++x;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(m=o;x<e.length&&"0123456789".indexOf(e.charAt(++x))>-1;)m+=e.charAt(x);u[u.length]={t:"D",v:m};break;case" ":u[u.length]={t:o,v:o},++x;break;case"$":u[u.length]={t:"t",v:"$"},++x;break;default:if(",$-+/():!^&'~{}<>=\u20ACacfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);u[u.length]={t:"t",v:o},++x;break}var Y=0,X=0,K;for(x=u.length-1,S="t";x>=0;--x)switch(u[x].t){case"h":case"H":u[x].t=L,S="h",Y<1&&(Y=1);break;case"s":(K=u[x].v.match(/\.0+$/))&&(X=Math.max(X,K[0].length-1)),Y<3&&(Y=3);case"d":case"y":case"M":case"e":S=u[x].t;break;case"m":S==="s"&&(u[x].t="M",Y<2&&(Y=2));break;case"X":break;case"Z":Y<1&&u[x].v.match(/[Hh]/)&&(Y=1),Y<2&&u[x].v.match(/[Mm]/)&&(Y=2),Y<3&&u[x].v.match(/[Ss]/)&&(Y=3)}switch(Y){case 0:break;case 1:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M),A.M>=60&&(A.M=0,++A.H);break;case 2:A.u>=.5&&(A.u=0,++A.S),A.S>=60&&(A.S=0,++A.M);break}var G="",me;for(x=0;x<u.length;++x)switch(u[x].t){case"t":case"T":case" ":case"D":break;case"X":u[x].v="",u[x].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":u[x].v=TD(u[x].t.charCodeAt(0),u[x].v,A,X),u[x].t="t";break;case"n":case"?":for(me=x+1;u[me]!=null&&((o=u[me].t)==="?"||o==="D"||(o===" "||o==="t")&&u[me+1]!=null&&(u[me+1].t==="?"||u[me+1].t==="t"&&u[me+1].v==="/")||u[x].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(u[me].v==="/"||u[me].v===" "&&u[me+1]!=null&&u[me+1].t=="?"));)u[x].v+=u[me].v,u[me]={v:"",t:";"},++me;G+=u[x].v,x=me-1;break;case"G":u[x].t="t",u[x].v=Cc(r,n);break}var Ae="",ge,se;if(G.length>0){G.charCodeAt(0)==40?(ge=r<0&&G.charCodeAt(0)===45?-r:r,se=xo("n",G,ge)):(ge=r<0&&l>1?-r:r,se=xo("n",G,ge),ge<0&&u[0]&&u[0].t=="t"&&(se=se.substr(1),u[0].v="-"+u[0].v)),me=se.length-1;var ke=u.length;for(x=0;x<u.length;++x)if(u[x]!=null&&u[x].t!="t"&&u[x].v.indexOf(".")>-1){ke=x;break}var Ie=u.length;if(ke===u.length&&se.indexOf("E")===-1){for(x=u.length-1;x>=0;--x)u[x]==null||"n?".indexOf(u[x].t)===-1||(me>=u[x].v.length-1?(me-=u[x].v.length,u[x].v=se.substr(me+1,u[x].v.length)):me<0?u[x].v="":(u[x].v=se.substr(0,me+1),me=-1),u[x].t="t",Ie=x);me>=0&&Ie<u.length&&(u[Ie].v=se.substr(0,me+1)+u[Ie].v)}else if(ke!==u.length&&se.indexOf("E")===-1){for(me=se.indexOf(".")-1,x=ke;x>=0;--x)if(!(u[x]==null||"n?".indexOf(u[x].t)===-1)){for(I=u[x].v.indexOf(".")>-1&&x===ke?u[x].v.indexOf(".")-1:u[x].v.length-1,Ae=u[x].v.substr(I+1);I>=0;--I)me>=0&&(u[x].v.charAt(I)==="0"||u[x].v.charAt(I)==="#")&&(Ae=se.charAt(me--)+Ae);u[x].v=Ae,u[x].t="t",Ie=x}for(me>=0&&Ie<u.length&&(u[Ie].v=se.substr(0,me+1)+u[Ie].v),me=se.indexOf(".")+1,x=ke;x<u.length;++x)if(!(u[x]==null||"n?(".indexOf(u[x].t)===-1&&x!==ke)){for(I=u[x].v.indexOf(".")>-1&&x===ke?u[x].v.indexOf(".")+1:0,Ae=u[x].v.substr(0,I);I<u[x].v.length;++I)me<se.length&&(Ae+=se.charAt(me++));u[x].v=Ae,u[x].t="t",Ie=x}}}for(x=0;x<u.length;++x)u[x]!=null&&"n?".indexOf(u[x].t)>-1&&(ge=l>1&&r<0&&x>0&&u[x-1].v==="-"?-r:r,u[x].v=xo(u[x].t,u[x].v,ge),u[x].t="t");var Xe="";for(x=0;x!==u.length;++x)u[x]!=null&&(Xe+=u[x].v);return Xe}var LT=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function RT(e,r){if(r==null)return!1;var n=parseFloat(r[2]);switch(r[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function PD(e,r){var n=DD(e),l=n.length,u=n[l-1].indexOf("@");if(l<4&&u>-1&&--l,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof r!="number")return[4,n.length===4||u>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=u>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=u>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=u>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var m=r>0?n[0]:r<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[l,m];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var x=n[0].match(LT),o=n[1].match(LT);return RT(r,x)?[l,n[0]]:RT(r,o)?[l,n[1]]:[l,n[x!=null&&o!=null?2:1]]}return[l,m]}function Wa(e,r,n){n==null&&(n={});var l="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?l=n.dateNF:l=e;break;case"number":e==14&&n.dateNF?l=n.dateNF:l=(n.table!=null?n.table:hr)[e],l==null&&(l=n.table&&n.table[DT[e]]||hr[DT[e]]),l==null&&(l=mD[e]||"General");break}if($m(l,0))return Cc(r,n);r instanceof Date&&(r=WS(r,n.date1904));var u=PD(l,r);if($m(u[1]))return Cc(r,n);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return FD(u[1],r,n,u[0])}function Ec(e,r){if(typeof r!="number"){r=+r||-1;for(var n=0;n<392;++n){if(hr[n]==null){r<0&&(r=n);continue}if(hr[n]==e){r=n;break}}r<0&&(r=391)}return hr[r]=e,r}function ek(){hr=pD()}var LD={"5":'"$"#,##0_);\\("$"#,##0\\)',"6":'"$"#,##0_);[Red]\\("$"#,##0\\)',"7":'"$"#,##0.00_);\\("$"#,##0.00\\)',"8":'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',"23":"General","24":"General","25":"General","26":"General","27":"m/d/yy","28":"m/d/yy","29":"m/d/yy","30":"m/d/yy","31":"m/d/yy","32":"h:mm:ss","33":"h:mm:ss","34":"h:mm:ss","35":"h:mm:ss","36":"m/d/yy","41":'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',"42":'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',"43":'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',"44":'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',"50":"m/d/yy","51":"m/d/yy","52":"m/d/yy","53":"m/d/yy","54":"m/d/yy","55":"m/d/yy","56":"m/d/yy","57":"m/d/yy","58":"m/d/yy","59":"0","60":"0.00","61":"#,##0","62":"#,##0.00","63":'"$"#,##0_);\\("$"#,##0\\)',"64":'"$"#,##0_);[Red]\\("$"#,##0\\)',"65":'"$"#,##0.00_);\\("$"#,##0.00\\)',"66":'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',"67":"0%","68":"0.00%","69":"# ?/?","70":"# ??/??","71":"m/d/yy","72":"m/d/yy","73":"d-mmm-yy","74":"d-mmm","75":"mmm-yy","76":"h:mm","77":"h:mm:ss","78":"m/d/yy h:mm","79":"mm:ss","80":"[h]:mm:ss","81":"mmss.0"},tk=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function RD(e){var r=typeof e=="number"?hr[e]:e;return r=r.replace(tk,"(\\d+)"),new RegExp("^"+r+"$")}function zD(e,r,n){var l=-1,u=-1,m=-1,x=-1,o=-1,S=-1;(r.match(tk)||[]).forEach(function(D,L){var B=parseInt(n[L+1],10);switch(D.toLowerCase().charAt(0)){case"y":l=B;break;case"d":m=B;break;case"h":x=B;break;case"s":S=B;break;case"m":x>=0?o=B:u=B;break}}),S>=0&&o==-1&&u>=0&&(o=u,u=-1);var A=(""+(l>=0?l:new Date().getFullYear())).slice(-4)+"-"+("00"+(u>=1?u:1)).slice(-2)+"-"+("00"+(m>=1?m:1)).slice(-2);A.length==7&&(A="0"+A),A.length==8&&(A="20"+A);var I=("00"+(x>=0?x:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(S>=0?S:0)).slice(-2);return x==-1&&o==-1&&S==-1?A:l==-1&&u==-1&&m==-1?I:A+"T"+I}var OD=function(){var e={};e.version="1.2.0";function r(){for(var se=0,ke=new Array(256),Ie=0;Ie!=256;++Ie)se=Ie,se=se&1?-306674912^se>>>1:se>>>1,se=se&1?-306674912^se>>>1:se>>>1,se=se&1?-306674912^se>>>1:se>>>1,se=se&1?-306674912^se>>>1:se>>>1,se=se&1?-306674912^se>>>1:se>>>1,se=se&1?-306674912^se>>>1:se>>>1,se=se&1?-306674912^se>>>1:se>>>1,se=se&1?-306674912^se>>>1:se>>>1,ke[Ie]=se;return typeof Int32Array!="undefined"?new Int32Array(ke):ke}var n=r();function l(se){var ke=0,Ie=0,Xe=0,$e=typeof Int32Array!="undefined"?new Int32Array(4096):new Array(4096);for(Xe=0;Xe!=256;++Xe)$e[Xe]=se[Xe];for(Xe=0;Xe!=256;++Xe)for(Ie=se[Xe],ke=256+Xe;ke<4096;ke+=256)Ie=$e[ke]=Ie>>>8^se[Ie&255];var We=[];for(Xe=1;Xe!=16;++Xe)We[Xe-1]=typeof Int32Array!="undefined"?$e.subarray(Xe*256,Xe*256+256):$e.slice(Xe*256,Xe*256+256);return We}var u=l(n),m=u[0],x=u[1],o=u[2],S=u[3],A=u[4],I=u[5],D=u[6],L=u[7],B=u[8],U=u[9],V=u[10],Y=u[11],X=u[12],K=u[13],G=u[14];function me(se,ke){for(var Ie=ke^-1,Xe=0,$e=se.length;Xe<$e;)Ie=Ie>>>8^n[(Ie^se.charCodeAt(Xe++))&255];return~Ie}function Ae(se,ke){for(var Ie=ke^-1,Xe=se.length-15,$e=0;$e<Xe;)Ie=G[se[$e++]^Ie&255]^K[se[$e++]^Ie>>8&255]^X[se[$e++]^Ie>>16&255]^Y[se[$e++]^Ie>>>24]^V[se[$e++]]^U[se[$e++]]^B[se[$e++]]^L[se[$e++]]^D[se[$e++]]^I[se[$e++]]^A[se[$e++]]^S[se[$e++]]^o[se[$e++]]^x[se[$e++]]^m[se[$e++]]^n[se[$e++]];for(Xe+=15;$e<Xe;)Ie=Ie>>>8^n[(Ie^se[$e++])&255];return~Ie}function ge(se,ke){for(var Ie=ke^-1,Xe=0,$e=se.length,We=0,dt=0;Xe<$e;)We=se.charCodeAt(Xe++),We<128?Ie=Ie>>>8^n[(Ie^We)&255]:We<2048?(Ie=Ie>>>8^n[(Ie^(192|We>>6&31))&255],Ie=Ie>>>8^n[(Ie^(128|We&63))&255]):We>=55296&&We<57344?(We=(We&1023)+64,dt=se.charCodeAt(Xe++)&1023,Ie=Ie>>>8^n[(Ie^(240|We>>8&7))&255],Ie=Ie>>>8^n[(Ie^(128|We>>2&63))&255],Ie=Ie>>>8^n[(Ie^(128|dt>>6&15|(We&3)<<4))&255],Ie=Ie>>>8^n[(Ie^(128|dt&63))&255]):(Ie=Ie>>>8^n[(Ie^(224|We>>12&15))&255],Ie=Ie>>>8^n[(Ie^(128|We>>6&63))&255],Ie=Ie>>>8^n[(Ie^(128|We&63))&255]);return~Ie}return e.table=n,e.bstr=me,e.buf=Ae,e.str=ge,e}(),wr=function(){var r={};r.version="1.2.1";function n(z,H){for(var q=z.split("/"),ne=H.split("/"),re=0,ce=0,De=Math.min(q.length,ne.length);re<De;++re){if(ce=q[re].length-ne[re].length)return ce;if(q[re]!=ne[re])return q[re]<ne[re]?-1:1}return q.length-ne.length}function l(z){if(z.charAt(z.length-1)=="/")return z.slice(0,-1).indexOf("/")===-1?z:l(z.slice(0,-1));var H=z.lastIndexOf("/");return H===-1?z:z.slice(0,H+1)}function u(z){if(z.charAt(z.length-1)=="/")return u(z.slice(0,-1));var H=z.lastIndexOf("/");return H===-1?z:z.slice(H+1)}function m(z,H){typeof H=="string"&&(H=new Date(H));var q=H.getHours();q=q<<6|H.getMinutes(),q=q<<5|H.getSeconds()>>>1,z.write_shift(2,q);var ne=H.getFullYear()-1980;ne=ne<<4|H.getMonth()+1,ne=ne<<5|H.getDate(),z.write_shift(2,ne)}function x(z){var H=z.read_shift(2)&65535,q=z.read_shift(2)&65535,ne=new Date,re=q&31;q>>>=5;var ce=q&15;q>>>=4,ne.setMilliseconds(0),ne.setFullYear(q+1980),ne.setMonth(ce-1),ne.setDate(re);var De=H&31;H>>>=5;var Ne=H&63;return H>>>=6,ne.setHours(H),ne.setMinutes(Ne),ne.setSeconds(De<<1),ne}function o(z){Jn(z,0);for(var H={},q=0;z.l<=z.length-4;){var ne=z.read_shift(2),re=z.read_shift(2),ce=z.l+re,De={};switch(ne){case 21589:q=z.read_shift(1),q&1&&(De.mtime=z.read_shift(4)),re>5&&(q&2&&(De.atime=z.read_shift(4)),q&4&&(De.ctime=z.read_shift(4))),De.mtime&&(De.mt=new Date(De.mtime*1e3));break}z.l=ce,H[ne]=De}return H}var S;function A(){return S||(S={})}function I(z,H){if(z[0]==80&&z[1]==75)return Xs(z,H);if((z[0]|32)==109&&(z[1]|32)==105)return j(z,H);if(z.length<512)throw new Error("CFB file size "+z.length+" < 512");var q=3,ne=512,re=0,ce=0,De=0,Ne=0,Fe=0,le=[],Ze=z.slice(0,512);Jn(Ze,0);var qe=D(Ze);switch(q=qe[0],q){case 3:ne=512;break;case 4:ne=4096;break;case 0:if(qe[1]==0)return Xs(z,H);default:throw new Error("Major Version: Expected 3 or 4 saw "+q)}ne!==512&&(Ze=z.slice(0,ne),Jn(Ze,28));var lt=z.slice(0,ne);L(Ze,q);var pt=Ze.read_shift(4,"i");if(q===3&&pt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+pt);Ze.l+=4,De=Ze.read_shift(4,"i"),Ze.l+=4,Ze.chk("00100000","Mini Stream Cutoff Size: "),Ne=Ze.read_shift(4,"i"),re=Ze.read_shift(4,"i"),Fe=Ze.read_shift(4,"i"),ce=Ze.read_shift(4,"i");for(var wt=-1,Mt=0;Mt<109&&(wt=Ze.read_shift(4,"i"),!(wt<0));++Mt)le[Mt]=wt;var it=B(z,ne);Y(Fe,ce,it,ne,le);var Zt=K(it,De,le,ne);Zt[De].name="!Directory",re>0&&Ne!==dt&&(Zt[Ne].name="!MiniFAT"),Zt[le[0]].name="!FAT",Zt.fat_addrs=le,Zt.ssz=ne;var Gt={},Or=[],bi=[],Qt=[];G(De,Zt,it,Or,re,Gt,bi,Ne),U(bi,Qt,Or),Or.shift();var Si={FileIndex:bi,FullPaths:Qt};return H&&H.raw&&(Si.raw={header:lt,sectors:it}),Si}function D(z){if(z[z.l]==80&&z[z.l+1]==75)return[0,0];z.chk(Ut,"Header Signature: "),z.l+=16;var H=z.read_shift(2,"u");return[z.read_shift(2,"u"),H]}function L(z,H){var q=9;switch(z.l+=2,q=z.read_shift(2)){case 9:if(H!=3)throw new Error("Sector Shift: Expected 9 saw "+q);break;case 12:if(H!=4)throw new Error("Sector Shift: Expected 12 saw "+q);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+q)}z.chk("0600","Mini Sector Shift: "),z.chk("000000000000","Reserved: ")}function B(z,H){for(var q=Math.ceil(z.length/H)-1,ne=[],re=1;re<q;++re)ne[re-1]=z.slice(re*H,(re+1)*H);return ne[q-1]=z.slice(q*H),ne}function U(z,H,q){for(var ne=0,re=0,ce=0,De=0,Ne=0,Fe=q.length,le=[],Ze=[];ne<Fe;++ne)le[ne]=Ze[ne]=ne,H[ne]=q[ne];for(;Ne<Ze.length;++Ne)ne=Ze[Ne],re=z[ne].L,ce=z[ne].R,De=z[ne].C,le[ne]===ne&&(re!==-1&&le[re]!==re&&(le[ne]=le[re]),ce!==-1&&le[ce]!==ce&&(le[ne]=le[ce])),De!==-1&&(le[De]=ne),re!==-1&&ne!=le[ne]&&(le[re]=le[ne],Ze.lastIndexOf(re)<Ne&&Ze.push(re)),ce!==-1&&ne!=le[ne]&&(le[ce]=le[ne],Ze.lastIndexOf(ce)<Ne&&Ze.push(ce));for(ne=1;ne<Fe;++ne)le[ne]===ne&&(ce!==-1&&le[ce]!==ce?le[ne]=le[ce]:re!==-1&&le[re]!==re&&(le[ne]=le[re]));for(ne=1;ne<Fe;++ne)if(z[ne].type!==0){if(Ne=ne,Ne!=le[Ne])do Ne=le[Ne],H[ne]=H[Ne]+"/"+H[ne];while(Ne!==0&&le[Ne]!==-1&&Ne!=le[Ne]);le[ne]=-1}for(H[0]+="/",ne=1;ne<Fe;++ne)z[ne].type!==2&&(H[ne]+="/")}function V(z,H,q){for(var ne=z.start,re=z.size,ce=[],De=ne;q&&re>0&&De>=0;)ce.push(H.slice(De*We,De*We+We)),re-=We,De=pc(q,De*4);return ce.length===0?Un(0):ll(ce).slice(0,z.size)}function Y(z,H,q,ne,re){var ce=dt;if(z===dt){if(H!==0)throw new Error("DIFAT chain shorter than expected")}else if(z!==-1){var De=q[z],Ne=(ne>>>2)-1;if(!De)return;for(var Fe=0;Fe<Ne&&(ce=pc(De,Fe*4))!==dt;++Fe)re.push(ce);Y(pc(De,ne-4),H-1,q,ne,re)}}function X(z,H,q,ne,re){var ce=[],De=[];re||(re=[]);var Ne=ne-1,Fe=0,le=0;for(Fe=H;Fe>=0;){re[Fe]=!0,ce[ce.length]=Fe,De.push(z[Fe]);var Ze=q[Math.floor(Fe*4/ne)];if(le=Fe*4&Ne,ne<4+le)throw new Error("FAT boundary crossed: "+Fe+" 4 "+ne);if(!z[Ze])break;Fe=pc(z[Ze],le)}return{nodes:ce,data:WT([De])}}function K(z,H,q,ne){var re=z.length,ce=[],De=[],Ne=[],Fe=[],le=ne-1,Ze=0,qe=0,lt=0,pt=0;for(Ze=0;Ze<re;++Ze)if(Ne=[],lt=Ze+H,lt>=re&&(lt-=re),!De[lt]){Fe=[];var wt=[];for(qe=lt;qe>=0;){wt[qe]=!0,De[qe]=!0,Ne[Ne.length]=qe,Fe.push(z[qe]);var Mt=q[Math.floor(qe*4/ne)];if(pt=qe*4&le,ne<4+pt)throw new Error("FAT boundary crossed: "+qe+" 4 "+ne);if(!z[Mt]||(qe=pc(z[Mt],pt),wt[qe]))break}ce[lt]={nodes:Ne,data:WT([Fe])}}return ce}function G(z,H,q,ne,re,ce,De,Ne){for(var Fe=0,le=ne.length?2:0,Ze=H[z].data,qe=0,lt=0,pt;qe<Ze.length;qe+=128){var wt=Ze.slice(qe,qe+128);Jn(wt,64),lt=wt.read_shift(2),pt=zy(wt,0,lt-le),ne.push(pt);var Mt={name:pt,type:wt.read_shift(1),color:wt.read_shift(1),L:wt.read_shift(4,"i"),R:wt.read_shift(4,"i"),C:wt.read_shift(4,"i"),clsid:wt.read_shift(16),state:wt.read_shift(4,"i"),start:0,size:0},it=wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2);it!==0&&(Mt.ct=me(wt,wt.l-8));var Zt=wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2)+wt.read_shift(2);Zt!==0&&(Mt.mt=me(wt,wt.l-8)),Mt.start=wt.read_shift(4,"i"),Mt.size=wt.read_shift(4,"i"),Mt.size<0&&Mt.start<0&&(Mt.size=Mt.type=0,Mt.start=dt,Mt.name=""),Mt.type===5?(Fe=Mt.start,re>0&&Fe!==dt&&(H[Fe].name="!StreamData")):Mt.size>=4096?(Mt.storage="fat",H[Mt.start]===void 0&&(H[Mt.start]=X(q,Mt.start,H.fat_addrs,H.ssz)),H[Mt.start].name=Mt.name,Mt.content=H[Mt.start].data.slice(0,Mt.size)):(Mt.storage="minifat",Mt.size<0?Mt.size=0:Fe!==dt&&Mt.start!==dt&&H[Fe]&&(Mt.content=V(Mt,H[Fe].data,(H[Ne]||{}).data))),Mt.content&&Jn(Mt.content,0),ce[pt]=Mt,De.push(Mt)}}function me(z,H){return new Date((ya(z,H+4)/1e7*Math.pow(2,32)+ya(z,H)/1e7-11644473600)*1e3)}function Ae(z,H){return A(),I(S.readFileSync(z),H)}function ge(z,H){var q=H&&H.type;switch(q||vr&&Buffer.isBuffer(z)&&(q="buffer"),q||"base64"){case"file":return Ae(z,H);case"base64":return I(ls(ba(z)),H);case"binary":return I(ls(z),H)}return I(z,H)}function se(z,H){var q=H||{},ne=q.root||"Root Entry";if(z.FullPaths||(z.FullPaths=[]),z.FileIndex||(z.FileIndex=[]),z.FullPaths.length!==z.FileIndex.length)throw new Error("inconsistent CFB structure");z.FullPaths.length===0&&(z.FullPaths[0]=ne+"/",z.FileIndex[0]={name:ne,type:5}),q.CLSID&&(z.FileIndex[0].clsid=q.CLSID),ke(z)}function ke(z){var H="Sh33tJ5";if(!wr.find(z,"/"+H)){var q=Un(4);q[0]=55,q[1]=q[3]=50,q[2]=54,z.FileIndex.push({name:H,type:2,content:q,size:4,L:69,R:69,C:69}),z.FullPaths.push(z.FullPaths[0]+H),Ie(z)}}function Ie(z,H){se(z);for(var q=!1,ne=!1,re=z.FullPaths.length-1;re>=0;--re){var ce=z.FileIndex[re];switch(ce.type){case 0:ne?q=!0:(z.FileIndex.pop(),z.FullPaths.pop());break;case 1:case 2:case 5:ne=!0,isNaN(ce.R*ce.L*ce.C)&&(q=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(q=!0);break;default:q=!0;break}}if(!(!q&&!H)){var De=new Date(1987,1,19),Ne=0,Fe=Object.create?Object.create(null):{},le=[];for(re=0;re<z.FullPaths.length;++re)Fe[z.FullPaths[re]]=!0,z.FileIndex[re].type!==0&&le.push([z.FullPaths[re],z.FileIndex[re]]);for(re=0;re<le.length;++re){var Ze=l(le[re][0]);ne=Fe[Ze],ne||(le.push([Ze,{name:u(Ze).replace("/",""),type:1,clsid:Bt,ct:De,mt:De,content:null}]),Fe[Ze]=!0)}for(le.sort(function(pt,wt){return n(pt[0],wt[0])}),z.FullPaths=[],z.FileIndex=[],re=0;re<le.length;++re)z.FullPaths[re]=le[re][0],z.FileIndex[re]=le[re][1];for(re=0;re<le.length;++re){var qe=z.FileIndex[re],lt=z.FullPaths[re];if(qe.name=u(lt).replace("/",""),qe.L=qe.R=qe.C=-(qe.color=1),qe.size=qe.content?qe.content.length:0,qe.start=0,qe.clsid=qe.clsid||Bt,re===0)qe.C=le.length>1?1:-1,qe.size=0,qe.type=5;else if(lt.slice(-1)=="/"){for(Ne=re+1;Ne<le.length&&l(z.FullPaths[Ne])!=lt;++Ne);for(qe.C=Ne>=le.length?-1:Ne,Ne=re+1;Ne<le.length&&l(z.FullPaths[Ne])!=l(lt);++Ne);qe.R=Ne>=le.length?-1:Ne,qe.type=1}else l(z.FullPaths[re+1]||"")==l(lt)&&(qe.R=re+1),qe.type=2}}}function Xe(z,H){var q=H||{};if(q.fileType=="mad")return J(z,q);switch(Ie(z),q.fileType){case"zip":return Ca(z,q)}var ne=function(pt){for(var wt=0,Mt=0,it=0;it<pt.FileIndex.length;++it){var Zt=pt.FileIndex[it];if(!!Zt.content){var Gt=Zt.content.length;Gt>0&&(Gt<4096?wt+=Gt+63>>6:Mt+=Gt+511>>9)}}for(var Or=pt.FullPaths.length+3>>2,bi=wt+7>>3,Qt=wt+127>>7,Si=bi+Mt+Or+Qt,ii=Si+127>>7,Tn=ii<=109?0:Math.ceil((ii-109)/127);Si+ii+Tn+127>>7>ii;)Tn=++ii<=109?0:Math.ceil((ii-109)/127);var tn=[1,Tn,ii,Qt,Or,Mt,wt,0];return pt.FileIndex[0].size=wt<<6,tn[7]=(pt.FileIndex[0].start=tn[0]+tn[1]+tn[2]+tn[3]+tn[4]+tn[5])+(tn[6]+7>>3),tn}(z),re=Un(ne[7]<<9),ce=0,De=0;{for(ce=0;ce<8;++ce)re.write_shift(1,kt[ce]);for(ce=0;ce<8;++ce)re.write_shift(2,0);for(re.write_shift(2,62),re.write_shift(2,3),re.write_shift(2,65534),re.write_shift(2,9),re.write_shift(2,6),ce=0;ce<3;++ce)re.write_shift(2,0);for(re.write_shift(4,0),re.write_shift(4,ne[2]),re.write_shift(4,ne[0]+ne[1]+ne[2]+ne[3]-1),re.write_shift(4,0),re.write_shift(4,1<<12),re.write_shift(4,ne[3]?ne[0]+ne[1]+ne[2]-1:dt),re.write_shift(4,ne[3]),re.write_shift(-4,ne[1]?ne[0]-1:dt),re.write_shift(4,ne[1]),ce=0;ce<109;++ce)re.write_shift(-4,ce<ne[2]?ne[1]+ce:-1)}if(ne[1])for(De=0;De<ne[1];++De){for(;ce<236+De*127;++ce)re.write_shift(-4,ce<ne[2]?ne[1]+ce:-1);re.write_shift(-4,De===ne[1]-1?dt:De+1)}var Ne=function(pt){for(De+=pt;ce<De-1;++ce)re.write_shift(-4,ce+1);pt&&(++ce,re.write_shift(-4,dt))};for(De=ce=0,De+=ne[1];ce<De;++ce)re.write_shift(-4,zt.DIFSECT);for(De+=ne[2];ce<De;++ce)re.write_shift(-4,zt.FATSECT);Ne(ne[3]),Ne(ne[4]);for(var Fe=0,le=0,Ze=z.FileIndex[0];Fe<z.FileIndex.length;++Fe)Ze=z.FileIndex[Fe],Ze.content&&(le=Ze.content.length,!(le<4096)&&(Ze.start=De,Ne(le+511>>9)));for(Ne(ne[6]+7>>3);re.l&511;)re.write_shift(-4,zt.ENDOFCHAIN);for(De=ce=0,Fe=0;Fe<z.FileIndex.length;++Fe)Ze=z.FileIndex[Fe],Ze.content&&(le=Ze.content.length,!(!le||le>=4096)&&(Ze.start=De,Ne(le+63>>6)));for(;re.l&511;)re.write_shift(-4,zt.ENDOFCHAIN);for(ce=0;ce<ne[4]<<2;++ce){var qe=z.FullPaths[ce];if(!qe||qe.length===0){for(Fe=0;Fe<17;++Fe)re.write_shift(4,0);for(Fe=0;Fe<3;++Fe)re.write_shift(4,-1);for(Fe=0;Fe<12;++Fe)re.write_shift(4,0);continue}Ze=z.FileIndex[ce],ce===0&&(Ze.start=Ze.size?Ze.start-1:dt);var lt=ce===0&&q.root||Ze.name;if(le=2*(lt.length+1),re.write_shift(64,lt,"utf16le"),re.write_shift(2,le),re.write_shift(1,Ze.type),re.write_shift(1,Ze.color),re.write_shift(-4,Ze.L),re.write_shift(-4,Ze.R),re.write_shift(-4,Ze.C),Ze.clsid)re.write_shift(16,Ze.clsid,"hex");else for(Fe=0;Fe<4;++Fe)re.write_shift(4,0);re.write_shift(4,Ze.state||0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,0),re.write_shift(4,Ze.start),re.write_shift(4,Ze.size),re.write_shift(4,0)}for(ce=1;ce<z.FileIndex.length;++ce)if(Ze=z.FileIndex[ce],Ze.size>=4096)if(re.l=Ze.start+1<<9,vr&&Buffer.isBuffer(Ze.content))Ze.content.copy(re,re.l,0,Ze.size),re.l+=Ze.size+511&-512;else{for(Fe=0;Fe<Ze.size;++Fe)re.write_shift(1,Ze.content[Fe]);for(;Fe&511;++Fe)re.write_shift(1,0)}for(ce=1;ce<z.FileIndex.length;++ce)if(Ze=z.FileIndex[ce],Ze.size>0&&Ze.size<4096)if(vr&&Buffer.isBuffer(Ze.content))Ze.content.copy(re,re.l,0,Ze.size),re.l+=Ze.size+63&-64;else{for(Fe=0;Fe<Ze.size;++Fe)re.write_shift(1,Ze.content[Fe]);for(;Fe&63;++Fe)re.write_shift(1,0)}if(vr)re.l=re.length;else for(;re.l<re.length;)re.write_shift(1,0);return re}function $e(z,H){var q=z.FullPaths.map(function(Fe){return Fe.toUpperCase()}),ne=q.map(function(Fe){var le=Fe.split("/");return le[le.length-(Fe.slice(-1)=="/"?2:1)]}),re=!1;H.charCodeAt(0)===47?(re=!0,H=q[0].slice(0,-1)+H):re=H.indexOf("/")!==-1;var ce=H.toUpperCase(),De=re===!0?q.indexOf(ce):ne.indexOf(ce);if(De!==-1)return z.FileIndex[De];var Ne=!ce.match(nd);for(ce=ce.replace(Vi,""),Ne&&(ce=ce.replace(nd,"!")),De=0;De<q.length;++De)if((Ne?q[De].replace(nd,"!"):q[De]).replace(Vi,"")==ce||(Ne?ne[De].replace(nd,"!"):ne[De]).replace(Vi,"")==ce)return z.FileIndex[De];return null}var We=64,dt=-2,Ut="d0cf11e0a1b11ae1",kt=[208,207,17,224,161,177,26,225],Bt="00000000000000000000000000000000",zt={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:dt,FREESECT:-1,HEADER_SIGNATURE:Ut,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Bt,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function gt(z,H,q){A();var ne=Xe(z,q);S.writeFileSync(H,ne)}function Be(z){for(var H=new Array(z.length),q=0;q<z.length;++q)H[q]=String.fromCharCode(z[q]);return H.join("")}function Tt(z,H){var q=Xe(z,H);switch(H&&H.type||"buffer"){case"file":return A(),S.writeFileSync(H.filename,q),q;case"binary":return typeof q=="string"?q:Be(q);case"base64":return AT(typeof q=="string"?q:Be(q));case"buffer":if(vr)return Buffer.isBuffer(q)?q:Lc(q);case"array":return typeof q=="string"?ls(q):q}return q}var Dt;function Ee(z){try{var H=z.InflateRaw,q=new H;if(q._processChunk(new Uint8Array([3,0]),q._finishFlushFlag),q.bytesRead)Dt=z;else throw new Error("zlib does not expose bytesRead")}catch(ne){console.error("cannot use native zlib: "+(ne.message||ne))}}function He(z,H){if(!Dt)return Hs(z,H);var q=Dt.InflateRaw,ne=new q,re=ne._processChunk(z.slice(z.l),ne._finishFlushFlag);return z.l+=ne.bytesRead,re}function Re(z){return Dt?Dt.deflateRawSync(z):rr(z)}var Oe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],at=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],bt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ot(z){var H=(z<<1|z<<11)&139536|(z<<5|z<<15)&558144;return(H>>16|H>>8|H)&255}for(var At=typeof Uint8Array!="undefined",yt=At?new Uint8Array(1<<8):[],ar=0;ar<1<<8;++ar)yt[ar]=Ot(ar);function ve(z,H){var q=yt[z&255];return H<=8?q>>>8-H:(q=q<<8|yt[z>>8&255],H<=16?q>>>16-H:(q=q<<8|yt[z>>16&255],q>>>24-H))}function Cr(z,H){var q=H&7,ne=H>>>3;return(z[ne]|(q<=6?0:z[ne+1]<<8))>>>q&3}function dr(z,H){var q=H&7,ne=H>>>3;return(z[ne]|(q<=5?0:z[ne+1]<<8))>>>q&7}function or(z,H){var q=H&7,ne=H>>>3;return(z[ne]|(q<=4?0:z[ne+1]<<8))>>>q&15}function ir(z,H){var q=H&7,ne=H>>>3;return(z[ne]|(q<=3?0:z[ne+1]<<8))>>>q&31}function ut(z,H){var q=H&7,ne=H>>>3;return(z[ne]|(q<=1?0:z[ne+1]<<8))>>>q&127}function Ir(z,H,q){var ne=H&7,re=H>>>3,ce=(1<<q)-1,De=z[re]>>>ne;return q<8-ne||(De|=z[re+1]<<8-ne,q<16-ne)||(De|=z[re+2]<<16-ne,q<24-ne)||(De|=z[re+3]<<24-ne),De&ce}function hn(z,H,q){var ne=H&7,re=H>>>3;return ne<=5?z[re]|=(q&7)<<ne:(z[re]|=q<<ne&255,z[re+1]=(q&7)>>8-ne),H+3}function Xr(z,H,q){var ne=H&7,re=H>>>3;return q=(q&1)<<ne,z[re]|=q,H+1}function zn(z,H,q){var ne=H&7,re=H>>>3;return q<<=ne,z[re]|=q&255,q>>>=8,z[re+1]=q,H+8}function Wi(z,H,q){var ne=H&7,re=H>>>3;return q<<=ne,z[re]|=q&255,q>>>=8,z[re+1]=q&255,z[re+2]=q>>>8,H+16}function ni(z,H){var q=z.length,ne=2*q>H?2*q:H+5,re=0;if(q>=H)return z;if(vr){var ce=CT(ne);if(z.copy)z.copy(ce);else for(;re<z.length;++re)ce[re]=z[re];return ce}else if(At){var De=new Uint8Array(ne);if(De.set)De.set(z);else for(;re<q;++re)De[re]=z[re];return De}return z.length=ne,z}function fn(z){for(var H=new Array(z),q=0;q<z;++q)H[q]=0;return H}function On(z,H,q){var ne=1,re=0,ce=0,De=0,Ne=0,Fe=z.length,le=At?new Uint16Array(32):fn(32);for(ce=0;ce<32;++ce)le[ce]=0;for(ce=Fe;ce<q;++ce)z[ce]=0;Fe=z.length;var Ze=At?new Uint16Array(Fe):fn(Fe);for(ce=0;ce<Fe;++ce)le[re=z[ce]]++,ne<re&&(ne=re),Ze[ce]=0;for(le[0]=0,ce=1;ce<=ne;++ce)le[ce+16]=Ne=Ne+le[ce-1]<<1;for(ce=0;ce<Fe;++ce)Ne=z[ce],Ne!=0&&(Ze[ce]=le[Ne+16]++);var qe=0;for(ce=0;ce<Fe;++ce)if(qe=z[ce],qe!=0)for(Ne=ve(Ze[ce],ne)>>ne-qe,De=(1<<ne+4-qe)-1;De>=0;--De)H[Ne|De<<qe]=qe&15|ce<<4;return ne}var dn=At?new Uint16Array(512):fn(512),Ti=At?new Uint16Array(32):fn(32);if(!At){for(var Rr=0;Rr<512;++Rr)dn[Rr]=0;for(Rr=0;Rr<32;++Rr)Ti[Rr]=0}(function(){for(var z=[],H=0;H<32;H++)z.push(5);On(z,Ti,32);var q=[];for(H=0;H<=143;H++)q.push(8);for(;H<=255;H++)q.push(9);for(;H<=279;H++)q.push(7);for(;H<=287;H++)q.push(8);On(q,dn,288)})();var en=function(){for(var H=At?new Uint8Array(32768):[],q=0,ne=0;q<bt.length-1;++q)for(;ne<bt[q+1];++ne)H[ne]=q;for(;ne<32768;++ne)H[ne]=29;var re=At?new Uint8Array(259):[];for(q=0,ne=0;q<at.length-1;++q)for(;ne<at[q+1];++ne)re[ne]=q;function ce(Ne,Fe){for(var le=0;le<Ne.length;){var Ze=Math.min(65535,Ne.length-le),qe=le+Ze==Ne.length;for(Fe.write_shift(1,+qe),Fe.write_shift(2,Ze),Fe.write_shift(2,~Ze&65535);Ze-- >0;)Fe[Fe.l++]=Ne[le++]}return Fe.l}function De(Ne,Fe){for(var le=0,Ze=0,qe=At?new Uint16Array(32768):[];Ze<Ne.length;){var lt=Math.min(65535,Ne.length-Ze);if(lt<10){for(le=hn(Fe,le,+(Ze+lt==Ne.length)),le&7&&(le+=8-(le&7)),Fe.l=le/8|0,Fe.write_shift(2,lt),Fe.write_shift(2,~lt&65535);lt-- >0;)Fe[Fe.l++]=Ne[Ze++];le=Fe.l*8;continue}le=hn(Fe,le,+(Ze+lt==Ne.length)+2);for(var pt=0;lt-- >0;){var wt=Ne[Ze];pt=(pt<<5^wt)&32767;var Mt=-1,it=0;if((Mt=qe[pt])&&(Mt|=Ze&-32768,Mt>Ze&&(Mt-=32768),Mt<Ze))for(;Ne[Mt+it]==Ne[Ze+it]&&it<250;)++it;if(it>2){wt=re[it],wt<=22?le=zn(Fe,le,yt[wt+1]>>1)-1:(zn(Fe,le,3),le+=5,zn(Fe,le,yt[wt-23]>>5),le+=3);var Zt=wt<8?0:wt-4>>2;Zt>0&&(Wi(Fe,le,it-at[wt]),le+=Zt),wt=H[Ze-Mt],le=zn(Fe,le,yt[wt]>>3),le-=3;var Gt=wt<4?0:wt-2>>1;Gt>0&&(Wi(Fe,le,Ze-Mt-bt[wt]),le+=Gt);for(var Or=0;Or<it;++Or)qe[pt]=Ze&32767,pt=(pt<<5^Ne[Ze])&32767,++Ze;lt-=it-1}else wt<=143?wt=wt+48:le=Xr(Fe,le,1),le=zn(Fe,le,yt[wt]),qe[pt]=Ze&32767,++Ze}le=zn(Fe,le,0)-1}return Fe.l=(le+7)/8|0,Fe.l}return function(Fe,le){return Fe.length<8?ce(Fe,le):De(Fe,le)}}();function rr(z){var H=Un(50+Math.floor(z.length*1.1)),q=en(z,H);return H.slice(0,q)}var zr=At?new Uint16Array(32768):fn(32768),pn=At?new Uint16Array(32768):fn(32768),Nr=At?new Uint16Array(128):fn(128),ha=1,Zs=1;function Ao(z,H){var q=ir(z,H)+257;H+=5;var ne=ir(z,H)+1;H+=5;var re=or(z,H)+4;H+=4;for(var ce=0,De=At?new Uint8Array(19):fn(19),Ne=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Fe=1,le=At?new Uint8Array(8):fn(8),Ze=At?new Uint8Array(8):fn(8),qe=De.length,lt=0;lt<re;++lt)De[Oe[lt]]=ce=dr(z,H),Fe<ce&&(Fe=ce),le[ce]++,H+=3;var pt=0;for(le[0]=0,lt=1;lt<=Fe;++lt)Ze[lt]=pt=pt+le[lt-1]<<1;for(lt=0;lt<qe;++lt)(pt=De[lt])!=0&&(Ne[lt]=Ze[pt]++);var wt=0;for(lt=0;lt<qe;++lt)if(wt=De[lt],wt!=0){pt=yt[Ne[lt]]>>8-wt;for(var Mt=(1<<7-wt)-1;Mt>=0;--Mt)Nr[pt|Mt<<wt]=wt&7|lt<<3}var it=[];for(Fe=1;it.length<q+ne;)switch(pt=Nr[ut(z,H)],H+=pt&7,pt>>>=3){case 16:for(ce=3+Cr(z,H),H+=2,pt=it[it.length-1];ce-- >0;)it.push(pt);break;case 17:for(ce=3+dr(z,H),H+=3;ce-- >0;)it.push(0);break;case 18:for(ce=11+ut(z,H),H+=7;ce-- >0;)it.push(0);break;default:it.push(pt),Fe<pt&&(Fe=pt);break}var Zt=it.slice(0,q),Gt=it.slice(q);for(lt=q;lt<286;++lt)Zt[lt]=0;for(lt=ne;lt<30;++lt)Gt[lt]=0;return ha=On(Zt,zr,286),Zs=On(Gt,pn,30),H}function ps(z,H){if(z[0]==3&&!(z[1]&3))return[bl(H),2];for(var q=0,ne=0,re=CT(H||1<<18),ce=0,De=re.length>>>0,Ne=0,Fe=0;(ne&1)==0;){if(ne=dr(z,q),q+=3,ne>>>1==0){q&7&&(q+=8-(q&7));var le=z[q>>>3]|z[(q>>>3)+1]<<8;if(q+=32,le>0)for(!H&&De<ce+le&&(re=ni(re,ce+le),De=re.length);le-- >0;)re[ce++]=z[q>>>3],q+=8;continue}else ne>>1==1?(Ne=9,Fe=5):(q=Ao(z,q),Ne=ha,Fe=Zs);for(;;){!H&&De<ce+32767&&(re=ni(re,ce+32767),De=re.length);var Ze=Ir(z,q,Ne),qe=ne>>>1==1?dn[Ze]:zr[Ze];if(q+=qe&15,qe>>>=4,(qe>>>8&255)===0)re[ce++]=qe;else{if(qe==256)break;qe-=257;var lt=qe<8?0:qe-4>>2;lt>5&&(lt=0);var pt=ce+at[qe];lt>0&&(pt+=Ir(z,q,lt),q+=lt),Ze=Ir(z,q,Fe),qe=ne>>>1==1?Ti[Ze]:pn[Ze],q+=qe&15,qe>>>=4;var wt=qe<4?0:qe-2>>1,Mt=bt[qe];for(wt>0&&(Mt+=Ir(z,q,wt),q+=wt),!H&&De<pt&&(re=ni(re,pt+100),De=re.length);ce<pt;)re[ce]=re[ce-Mt],++ce}}}return H?[re,q+7>>>3]:[re.slice(0,ce),q+7>>>3]}function Hs(z,H){var q=z.slice(z.l||0),ne=ps(q,H);return z.l+=ne[1],ne[0]}function Aa(z,H){if(z)typeof console!="undefined"&&console.error(H);else throw new Error(H)}function Xs(z,H){var q=z;Jn(q,0);var ne=[],re=[],ce={FileIndex:ne,FullPaths:re};se(ce,{root:H.root});for(var De=q.length-4;(q[De]!=80||q[De+1]!=75||q[De+2]!=5||q[De+3]!=6)&&De>=0;)--De;q.l=De+4,q.l+=4;var Ne=q.read_shift(2);q.l+=6;var Fe=q.read_shift(4);for(q.l=Fe,De=0;De<Ne;++De){q.l+=20;var le=q.read_shift(4),Ze=q.read_shift(4),qe=q.read_shift(2),lt=q.read_shift(2),pt=q.read_shift(2);q.l+=8;var wt=q.read_shift(4),Mt=o(q.slice(q.l+qe,q.l+qe+lt));q.l+=qe+lt+pt;var it=q.l;q.l=wt+4,Ei(q,le,Ze,ce,Mt),q.l=it}return ce}function Ei(z,H,q,ne,re){z.l+=2;var ce=z.read_shift(2),De=z.read_shift(2),Ne=x(z);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var Fe=z.read_shift(4),le=z.read_shift(4),Ze=z.read_shift(4),qe=z.read_shift(2),lt=z.read_shift(2),pt="",wt=0;wt<qe;++wt)pt+=String.fromCharCode(z[z.l++]);if(lt){var Mt=o(z.slice(z.l,z.l+lt));(Mt[21589]||{}).mt&&(Ne=Mt[21589].mt),((re||{})[21589]||{}).mt&&(Ne=re[21589].mt)}z.l+=lt;var it=z.slice(z.l,z.l+le);switch(De){case 8:it=He(z,Ze);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+De)}var Zt=!1;ce&8&&(Fe=z.read_shift(4),Fe==134695760&&(Fe=z.read_shift(4),Zt=!0),le=z.read_shift(4),Ze=z.read_shift(4)),le!=H&&Aa(Zt,"Bad compressed size: "+H+" != "+le),Ze!=q&&Aa(Zt,"Bad uncompressed size: "+q+" != "+Ze),we(ne,pt,it,{unsafe:!0,mt:Ne})}function Ca(z,H){var q=H||{},ne=[],re=[],ce=Un(1),De=q.compression?8:0,Ne=0,Fe=0,le=0,Ze=0,qe=0,lt=z.FullPaths[0],pt=lt,wt=z.FileIndex[0],Mt=[],it=0;for(Fe=1;Fe<z.FullPaths.length;++Fe)if(pt=z.FullPaths[Fe].slice(lt.length),wt=z.FileIndex[Fe],!(!wt.size||!wt.content||pt=="Sh33tJ5")){var Zt=Ze,Gt=Un(pt.length);for(le=0;le<pt.length;++le)Gt.write_shift(1,pt.charCodeAt(le)&127);Gt=Gt.slice(0,Gt.l),Mt[qe]=OD.buf(wt.content,0);var Or=wt.content;De==8&&(Or=Re(Or)),ce=Un(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,Ne),ce.write_shift(2,De),wt.mt?m(ce,wt.mt):ce.write_shift(4,0),ce.write_shift(-4,Mt[qe]),ce.write_shift(4,Or.length),ce.write_shift(4,wt.content.length),ce.write_shift(2,Gt.length),ce.write_shift(2,0),Ze+=ce.length,ne.push(ce),Ze+=Gt.length,ne.push(Gt),Ze+=Or.length,ne.push(Or),ce=Un(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,Ne),ce.write_shift(2,De),ce.write_shift(4,0),ce.write_shift(-4,Mt[qe]),ce.write_shift(4,Or.length),ce.write_shift(4,wt.content.length),ce.write_shift(2,Gt.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,Zt),it+=ce.l,re.push(ce),it+=Gt.length,re.push(Gt),++qe}return ce=Un(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,qe),ce.write_shift(2,qe),ce.write_shift(4,it),ce.write_shift(4,Ze),ce.write_shift(2,0),ll([ll(ne),ll(re),ce])}var Zi={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ha(z,H){if(z.ctype)return z.ctype;var q=z.name||"",ne=q.match(/\.([^\.]+)$/);return ne&&Zi[ne[1]]||H&&(ne=(q=H).match(/[\.\\]([^\.\\])+$/),ne&&Zi[ne[1]])?Zi[ne[1]]:"application/octet-stream"}function ms(z){for(var H=AT(z),q=[],ne=0;ne<H.length;ne+=76)q.push(H.slice(ne,ne+76));return q.join(`\r
`)+`\r
`}function qs(z){var H=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(le){var Ze=le.charCodeAt(0).toString(16).toUpperCase();return"="+(Ze.length==1?"0"+Ze:Ze)});H=H.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),H.charAt(0)==`
`&&(H="=0D"+H.slice(1)),H=H.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var q=[],ne=H.split(`\r
`),re=0;re<ne.length;++re){var ce=ne[re];if(ce.length==0){q.push("");continue}for(var De=0;De<ce.length;){var Ne=76,Fe=ce.slice(De,De+Ne);Fe.charAt(Ne-1)=="="?Ne--:Fe.charAt(Ne-2)=="="?Ne-=2:Fe.charAt(Ne-3)=="="&&(Ne-=3),Fe=ce.slice(De,De+Ne),De+=Ne,De<ce.length&&(Fe+="="),q.push(Fe)}}return q.join(`\r
`)}function _s(z){for(var H=[],q=0;q<z.length;++q){for(var ne=z[q];q<=z.length&&ne.charAt(ne.length-1)=="=";)ne=ne.slice(0,ne.length-1)+z[++q];H.push(ne)}for(var re=0;re<H.length;++re)H[re]=H[re].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return ls(H.join(`\r
`))}function de(z,H,q){for(var ne="",re="",ce="",De,Ne=0;Ne<10;++Ne){var Fe=H[Ne];if(!Fe||Fe.match(/^\s*$/))break;var le=Fe.match(/^(.*?):\s*([^\s].*)$/);if(le)switch(le[1].toLowerCase()){case"content-location":ne=le[2].trim();break;case"content-type":ce=le[2].trim();break;case"content-transfer-encoding":re=le[2].trim();break}}switch(++Ne,re.toLowerCase()){case"base64":De=ls(ba(H.slice(Ne).join("")));break;case"quoted-printable":De=_s(H.slice(Ne));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+re)}var Ze=we(z,ne.slice(q.length),De,{unsafe:!0});ce&&(Ze.ctype=ce)}function j(z,H){if(Be(z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var q=H&&H.root||"",ne=(vr&&Buffer.isBuffer(z)?z.toString("binary"):Be(z)).split(`\r
`),re=0,ce="";for(re=0;re<ne.length;++re)if(ce=ne[re],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),q||(q=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,q.length)!=q))for(;q.length>0&&(q=q.slice(0,q.length-1),q=q.slice(0,q.lastIndexOf("/")+1),ce.slice(0,q.length)!=q););var De=(ne[1]||"").match(/boundary="(.*?)"/);if(!De)throw new Error("MAD cannot find boundary");var Ne="--"+(De[1]||""),Fe=[],le=[],Ze={FileIndex:Fe,FullPaths:le};se(Ze);var qe,lt=0;for(re=0;re<ne.length;++re){var pt=ne[re];pt!==Ne&&pt!==Ne+"--"||(lt++&&de(Ze,ne.slice(qe,re),q),qe=re)}return Ze}function J(z,H){var q=H||{},ne=q.boundary||"SheetJS";ne="------="+ne;for(var re=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ne.slice(2)+'"',"","",""],ce=z.FullPaths[0],De=ce,Ne=z.FileIndex[0],Fe=1;Fe<z.FullPaths.length;++Fe)if(De=z.FullPaths[Fe].slice(ce.length),Ne=z.FileIndex[Fe],!(!Ne.size||!Ne.content||De=="Sh33tJ5")){De=De.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(it){return"_x"+it.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(it){return"_u"+it.charCodeAt(0).toString(16)+"_"});for(var le=Ne.content,Ze=vr&&Buffer.isBuffer(le)?le.toString("binary"):Be(le),qe=0,lt=Math.min(1024,Ze.length),pt=0,wt=0;wt<=lt;++wt)(pt=Ze.charCodeAt(wt))>=32&&pt<128&&++qe;var Mt=qe>=lt*4/5;re.push(ne),re.push("Content-Location: "+(q.root||"file:///C:/SheetJS/")+De),re.push("Content-Transfer-Encoding: "+(Mt?"quoted-printable":"base64")),re.push("Content-Type: "+Ha(Ne,De)),re.push(""),re.push(Mt?qs(Ze):ms(Ze))}return re.push(ne+`--\r
`),re.join(`\r
`)}function ue(z){var H={};return se(H,z),H}function we(z,H,q,ne){var re=ne&&ne.unsafe;re||se(z);var ce=!re&&wr.find(z,H);if(!ce){var De=z.FullPaths[0];H.slice(0,De.length)==De?De=H:(De.slice(-1)!="/"&&(De+="/"),De=(De+H).replace("//","/")),ce={name:u(H),type:2},z.FileIndex.push(ce),z.FullPaths.push(De),re||wr.utils.cfb_gc(z)}return ce.content=q,ce.size=q?q.length:0,ne&&(ne.CLSID&&(ce.clsid=ne.CLSID),ne.mt&&(ce.mt=ne.mt),ne.ct&&(ce.ct=ne.ct)),ce}function Ce(z,H){se(z);var q=wr.find(z,H);if(q){for(var ne=0;ne<z.FileIndex.length;++ne)if(z.FileIndex[ne]==q)return z.FileIndex.splice(ne,1),z.FullPaths.splice(ne,1),!0}return!1}function Ve(z,H,q){se(z);var ne=wr.find(z,H);if(ne){for(var re=0;re<z.FileIndex.length;++re)if(z.FileIndex[re]==ne)return z.FileIndex[re].name=u(q),z.FullPaths[re]=q,!0}return!1}function Ue(z){Ie(z,!0)}return r.find=$e,r.read=ge,r.parse=I,r.write=Tt,r.writeFile=gt,r.utils={cfb_new:ue,cfb_add:we,cfb_del:Ce,cfb_mov:Ve,cfb_gc:Ue,ReadShift:pd,CheckField:bk,prep_blob:Jn,bconcat:ll,use_zlib:Ee,_deflateRaw:rr,_inflateRaw:Hs,consts:zt},r}();function BD(e){if(typeof Deno!="undefined")return Deno.readFileSync(e);if(typeof $!="undefined"&&typeof File!="undefined"&&typeof Folder!="undefined")try{var r=File(e);r.open("r"),r.encoding="binary";var n=r.read();return r.close(),n}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("Cannot access file "+e)}function js(e){for(var r=Object.keys(e),n=[],l=0;l<r.length;++l)Object.prototype.hasOwnProperty.call(e,r[l])&&n.push(r[l]);return n}function Fy(e){for(var r=[],n=js(e),l=0;l!==n.length;++l)r[e[n[l]]]=n[l];return r}var Zm=new Date(1899,11,30,0,0,0);function ji(e,r){var n=e.getTime();r&&(n-=1462*24*60*60*1e3);var l=Zm.getTime()+(e.getTimezoneOffset()-Zm.getTimezoneOffset())*6e4;return(n-l)/(24*60*60*1e3)}var rk=new Date,ND=Zm.getTime()+(rk.getTimezoneOffset()-Zm.getTimezoneOffset())*6e4,zT=rk.getTimezoneOffset();function v_(e){var r=new Date;return r.setTime(e*24*60*60*1e3+ND),r.getTimezoneOffset()!==zT&&r.setTime(r.getTime()+(r.getTimezoneOffset()-zT)*6e4),r}function UD(e){var r=0,n=0,l=!1,u=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!u)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var m=1;m!=u.length;++m)if(!!u[m]){switch(n=1,m>3&&(l=!0),u[m].slice(u[m].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+u[m].slice(u[m].length-1));case"D":n*=24;case"H":n*=60;case"M":if(l)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}r+=n*parseInt(u[m],10)}return r}var OT=new Date("2017-02-19T19:06:09.000Z"),nk=isNaN(OT.getFullYear())?new Date("2/19/17"):OT,VD=nk.getFullYear()==2017;function Kn(e,r){var n=new Date(e);if(VD)return r>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):r<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(nk.getFullYear()==1917&&!isNaN(n.getFullYear())){var l=n.getFullYear();return e.indexOf(""+l)>-1||n.setFullYear(n.getFullYear()+100),n}var u=e.match(/\d+/g)||["2017","2","19","0","0","0"],m=new Date(+u[0],+u[1]-1,+u[2],+u[3]||0,+u[4]||0,+u[5]||0);return e.indexOf("Z")>-1&&(m=new Date(m.getTime()-m.getTimezoneOffset()*60*1e3)),m}function Ic(e,r){if(vr&&Buffer.isBuffer(e)){if(r){if(e[0]==255&&e[1]==254)return ad(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ad(GS(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder!="undefined")try{if(r){if(e[0]==255&&e[1]==254)return ad(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ad(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"\u20AC":"\x80","\u201A":"\x82",\u0192:"\x83","\u201E":"\x84","\u2026":"\x85","\u2020":"\x86","\u2021":"\x87","\u02C6":"\x88","\u2030":"\x89",\u0160:"\x8A","\u2039":"\x8B",\u0152:"\x8C",\u017D:"\x8E","\u2018":"\x91","\u2019":"\x92","\u201C":"\x93","\u201D":"\x94","\u2022":"\x95","\u2013":"\x96","\u2014":"\x97","\u02DC":"\x98","\u2122":"\x99",\u0161:"\x9A","\u203A":"\x9B",\u0153:"\x9C",\u017E:"\x9E",\u0178:"\x9F"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(m){return n[m]||m})}catch{}for(var l=[],u=0;u!=e.length;++u)l.push(String.fromCharCode(e[u]));return l.join("")}function ei(e){if(typeof JSON!="undefined"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=ei(e[n]));return r}function yn(e,r){for(var n="";n.length<r;)n+=e;return n}function fs(e){var r=Number(e);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(e))return r;var n=1,l=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(r=Number(l))||(l=l.replace(/[(](.*)[)]/,function(u,m){return n=-n,m}),!isNaN(r=Number(l)))?r/n:r}var jD=["january","february","march","april","may","june","july","august","september","october","november","december"];function mh(e){var r=new Date(e),n=new Date(NaN),l=r.getYear(),u=r.getMonth(),m=r.getDate();if(isNaN(m))return n;var x=e.toLowerCase();if(x.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(x=x.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),x.length>3&&jD.indexOf(x)==-1)return n}else if(x.match(/[a-z]/))return n;return l<0||l>8099?n:(u>0||m>1)&&l!=101?r:e.match(/[^-0-9:,\/\\]/)?n:r}var GD=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,l,u){if(e||typeof l=="string")return n.split(l);for(var m=n.split(l),x=[m[0]],o=1;o<m.length;++o)x.push(u),x.push(m[o]);return x}}();function ik(e){return e?e.content&&e.type?Ic(e.content,!0):e.data?rd(e.data):e.asNodeBuffer&&vr?rd(e.asNodeBuffer().toString("binary")):e.asBinary?rd(e.asBinary()):e._data&&e._data.getContent?rd(Ic(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function ak(e){if(!e)return null;if(e.data)return ST(e.data);if(e.asNodeBuffer&&vr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var r=e._data.getContent();return typeof r=="string"?ST(r):Array.prototype.slice.call(r)}return e.content&&e.type?e.content:null}function $D(e){return e&&e.name.slice(-4)===".bin"?ak(e):ik(e)}function Oa(e,r){for(var n=e.FullPaths||js(e.files),l=r.toLowerCase().replace(/[\/]/g,"\\"),u=l.replace(/\\/g,"/"),m=0;m<n.length;++m){var x=n[m].replace(/^Root Entry[\/]/,"").toLowerCase();if(l==x||u==x)return e.files?e.files[n[m]]:e.FileIndex[m]}return null}function Py(e,r){var n=Oa(e,r);if(n==null)throw new Error("Cannot find file "+r+" in zip");return n}function Dn(e,r,n){if(!n)return $D(Py(e,r));if(!r)return null;try{return Dn(e,r)}catch{return null}}function va(e,r,n){if(!n)return ik(Py(e,r));if(!r)return null;try{return va(e,r)}catch{return null}}function sk(e,r,n){if(!n)return ak(Py(e,r));if(!r)return null;try{return sk(e,r)}catch{return null}}function BT(e){for(var r=e.FullPaths||js(e.files),n=[],l=0;l<r.length;++l)r[l].slice(-1)!="/"&&n.push(r[l].replace(/^Root Entry[\/]/,""));return n.sort()}function WD(e,r,n){if(e.FullPaths){if(typeof n=="string"){var l;return vr?l=Lc(n):l=hD(n),wr.utils.cfb_add(e,r,l)}wr.utils.cfb_add(e,r,n)}else e.file(r,n)}function ok(e,r){switch(r.type){case"base64":return wr.read(e,{type:"base64"});case"binary":return wr.read(e,{type:"binary"});case"buffer":case"array":return wr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+r.type)}function id(e,r){if(e.charAt(0)=="/")return e.slice(1);var n=r.split("/");r.slice(-1)!="/"&&n.pop();for(var l=e.split("/");l.length!==0;){var u=l.shift();u===".."?n.pop():u!=="."&&n.push(u)}return n.join("/")}var lk=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,ZD=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,NT=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,HD=/<[^>]*>/g,wi=lk.match(NT)?NT:HD,XD=/<\w*:/,qD=/<(\/?)\w+:/;function nr(e,r,n){for(var l={},u=0,m=0;u!==e.length&&!((m=e.charCodeAt(u))===32||m===10||m===13);++u);if(r||(l[0]=e.slice(0,u)),u===e.length)return l;var x=e.match(ZD),o=0,S="",A=0,I="",D="",L=1;if(x)for(A=0;A!=x.length;++A){for(D=x[A],m=0;m!=D.length&&D.charCodeAt(m)!==61;++m);for(I=D.slice(0,m).trim();D.charCodeAt(m+1)==32;)++m;for(L=(u=D.charCodeAt(m+1))==34||u==39?1:0,S=D.slice(m+1+L,D.length-L),o=0;o!=I.length&&I.charCodeAt(o)!==58;++o);if(o===I.length)I.indexOf("_")>0&&(I=I.slice(0,I.indexOf("_"))),l[I]=S,n||(l[I.toLowerCase()]=S);else{var B=(o===5&&I.slice(0,5)==="xmlns"?"xmlns":"")+I.slice(o+1);if(l[B]&&I.slice(o-3,o)=="ext")continue;l[B]=S,n||(l[B.toLowerCase()]=S)}}return l}function $s(e){return e.replace(qD,"<$1")}var ck={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},KD=Fy(ck),Ar=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,r=/_x([\da-fA-F]{4})_/ig;return function n(l){var u=l+"",m=u.indexOf("<![CDATA[");if(m==-1)return u.replace(e,function(o,S){return ck[o]||String.fromCharCode(parseInt(S,o.indexOf("x")>-1?16:10))||o}).replace(r,function(o,S){return String.fromCharCode(parseInt(S,16))});var x=u.indexOf("]]>");return n(u.slice(0,m))+u.slice(m+9,x)+n(u.slice(x+3))}}(),YD=/[&<>'"]/g,JD=/[\u0000-\u001f]/g;function Ly(e){var r=e+"";return r.replace(YD,function(n){return KD[n]}).replace(/\n/g,"<br/>").replace(JD,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}var UT=function(){var e=/&#(\d+);/g;function r(n,l){return String.fromCharCode(parseInt(l,10))}return function(l){return l.replace(e,r)}}();function rn(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yx(e){for(var r="",n=0,l=0,u=0,m=0,x=0,o=0;n<e.length;){if(l=e.charCodeAt(n++),l<128){r+=String.fromCharCode(l);continue}if(u=e.charCodeAt(n++),l>191&&l<224){x=(l&31)<<6,x|=u&63,r+=String.fromCharCode(x);continue}if(m=e.charCodeAt(n++),l<240){r+=String.fromCharCode((l&15)<<12|(u&63)<<6|m&63);continue}x=e.charCodeAt(n++),o=((l&7)<<18|(u&63)<<12|(m&63)<<6|x&63)-65536,r+=String.fromCharCode(55296+(o>>>10&1023)),r+=String.fromCharCode(56320+(o&1023))}return r}function VT(e){var r=bl(2*e.length),n,l,u=1,m=0,x=0,o;for(l=0;l<e.length;l+=u)u=1,(o=e.charCodeAt(l))<128?n=o:o<224?(n=(o&31)*64+(e.charCodeAt(l+1)&63),u=2):o<240?(n=(o&15)*4096+(e.charCodeAt(l+1)&63)*64+(e.charCodeAt(l+2)&63),u=3):(u=4,n=(o&7)*262144+(e.charCodeAt(l+1)&63)*4096+(e.charCodeAt(l+2)&63)*64+(e.charCodeAt(l+3)&63),n-=65536,x=55296+(n>>>10&1023),n=56320+(n&1023)),x!==0&&(r[m++]=x&255,r[m++]=x>>>8,x=0),r[m++]=n%256,r[m++]=n>>>8;return r.slice(0,m).toString("ucs2")}function jT(e){return Lc(e,"binary").toString("utf8")}var Y0="foo bar baz\xE2\x98\x83\xF0\x9F\x8D\xA3",Hr=vr&&(jT(Y0)==yx(Y0)&&jT||VT(Y0)==yx(Y0)&&VT)||yx,ad=vr?function(e){return Lc(e,"utf8").toString("binary")}:function(e){for(var r=[],n=0,l=0,u=0;n<e.length;)switch(l=e.charCodeAt(n++),!0){case l<128:r.push(String.fromCharCode(l));break;case l<2048:r.push(String.fromCharCode(192+(l>>6))),r.push(String.fromCharCode(128+(l&63)));break;case(l>=55296&&l<57344):l-=55296,u=e.charCodeAt(n++)-56320+(l<<10),r.push(String.fromCharCode(240+(u>>18&7))),r.push(String.fromCharCode(144+(u>>12&63))),r.push(String.fromCharCode(128+(u>>6&63))),r.push(String.fromCharCode(128+(u&63)));break;default:r.push(String.fromCharCode(224+(l>>12))),r.push(String.fromCharCode(128+(l>>6&63))),r.push(String.fromCharCode(128+(l&63)))}return r.join("")},jd=function(){var e={};return function(n,l){var u=n+"|"+(l||"");return e[u]?e[u]:e[u]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",l||"")}}(),uk=function(){var e=[["nbsp"," "],["middot","\xB7"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(n){for(var l=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),u=0;u<e.length;++u)l=l.replace(e[u][0],e[u][1]);return l}}(),QD=function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),eF=/<\/?(?:vt:)?variant>/g,tF=/<(?:vt:)([^>]*)>([\s\S]*)</;function GT(e,r){var n=nr(e),l=e.match(QD(n.baseType))||[],u=[];if(l.length!=n.size){if(r.WTF)throw new Error("unexpected vector length "+l.length+" != "+n.size);return u}return l.forEach(function(m){var x=m.replace(eF,"").match(tF);x&&u.push({v:Hr(x[2]),t:x[1]})}),u}var rF=/(^\s|\s$|\n)/;function nF(e){return js(e).map(function(r){return" "+r+'="'+e[r]+'"'}).join("")}function iF(e,r,n){return"<"+e+(n!=null?nF(n):"")+(r!=null?(r.match(rF)?' xml:space="preserve"':"")+">"+r+"</"+e:"/")+">"}function Ry(e){if(vr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array!="undefined"&&e instanceof Uint8Array)return Hr(Rc(Iy(e)));throw new Error("Bad input format: expected Buffer or string")}var Gd=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,aF={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},sF=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function oF(e,r){for(var n=1-2*(e[r+7]>>>7),l=((e[r+7]&127)<<4)+(e[r+6]>>>4&15),u=e[r+6]&15,m=5;m>=0;--m)u=u*256+e[r+m];return l==2047?u==0?n*(1/0):NaN:(l==0?l=-1022:(l-=1023,u+=Math.pow(2,52)),n*Math.pow(2,l-52)*u)}function lF(e,r,n){var l=(r<0||1/r==-1/0?1:0)<<7,u=0,m=0,x=l?-r:r;isFinite(x)?x==0?u=m=0:(u=Math.floor(Math.log(x)/Math.LN2),m=x*Math.pow(2,52-u),u<=-1023&&(!isFinite(m)||m<Math.pow(2,52))?u=-1022:(m-=Math.pow(2,52),u+=1023)):(u=2047,m=isNaN(r)?26985:0);for(var o=0;o<=5;++o,m/=256)e[n+o]=m&255;e[n+6]=(u&15)<<4|m&15,e[n+7]=u>>4|l}var $T=function(e){for(var r=[],n=10240,l=0;l<e[0].length;++l)if(e[0][l])for(var u=0,m=e[0][l].length;u<m;u+=n)r.push.apply(r,e[0][l].slice(u,u+n));return r},WT=vr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(r){return Buffer.isBuffer(r)?r:Lc(r)})):$T(e)}:$T,ZT=function(e,r,n){for(var l=[],u=r;u<n;u+=2)l.push(String.fromCharCode(_o(e,u)));return l.join("").replace(Vi,"")},zy=vr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("utf16le",r,n).replace(Vi,""):ZT(e,r,n)}:ZT,HT=function(e,r,n){for(var l=[],u=r;u<r+n;++u)l.push(("0"+e[u].toString(16)).slice(-2));return l.join("")},hk=vr?function(e,r,n){return Buffer.isBuffer(e)?e.toString("hex",r,r+n):HT(e,r,n)}:HT,XT=function(e,r,n){for(var l=[],u=r;u<n;u++)l.push(String.fromCharCode(Nu(e,u)));return l.join("")},ep=vr?function(r,n,l){return Buffer.isBuffer(r)?r.toString("utf8",n,l):XT(r,n,l)}:XT,fk=function(e,r){var n=ya(e,r);return n>0?ep(e,r+4,r+4+n-1):""},dk=fk,pk=function(e,r){var n=ya(e,r);return n>0?ep(e,r+4,r+4+n-1):""},mk=pk,_k=function(e,r){var n=2*ya(e,r);return n>0?ep(e,r+4,r+4+n-1):""},gk=_k,xk=function(r,n){var l=ya(r,n);return l>0?zy(r,n+4,n+4+l):""},yk=xk,vk=function(e,r){var n=ya(e,r);return n>0?ep(e,r+4,r+4+n):""},wk=vk,Tk=function(e,r){return oF(e,r)},Hm=Tk,Ek=function(r){return Array.isArray(r)||typeof Uint8Array!="undefined"&&r instanceof Uint8Array};vr&&(dk=function(r,n){if(!Buffer.isBuffer(r))return fk(r,n);var l=r.readUInt32LE(n);return l>0?r.toString("utf8",n+4,n+4+l-1):""},mk=function(r,n){if(!Buffer.isBuffer(r))return pk(r,n);var l=r.readUInt32LE(n);return l>0?r.toString("utf8",n+4,n+4+l-1):""},gk=function(r,n){if(!Buffer.isBuffer(r))return _k(r,n);var l=2*r.readUInt32LE(n);return r.toString("utf16le",n+4,n+4+l-1)},yk=function(r,n){if(!Buffer.isBuffer(r))return xk(r,n);var l=r.readUInt32LE(n);return r.toString("utf16le",n+4,n+4+l)},wk=function(r,n){if(!Buffer.isBuffer(r))return vk(r,n);var l=r.readUInt32LE(n);return r.toString("utf8",n+4,n+4+l)},Hm=function(r,n){return Buffer.isBuffer(r)?r.readDoubleLE(n):Tk(r,n)},Ek=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array!="undefined"&&r instanceof Uint8Array});var Nu=function(e,r){return e[r]},_o=function(e,r){return e[r+1]*(1<<8)+e[r]},cF=function(e,r){var n=e[r+1]*256+e[r];return n<32768?n:(65535-n+1)*-1},ya=function(e,r){return e[r+3]*(1<<24)+(e[r+2]<<16)+(e[r+1]<<8)+e[r]},pc=function(e,r){return e[r+3]<<24|e[r+2]<<16|e[r+1]<<8|e[r]},uF=function(e,r){return e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3]};function pd(e,r){var n="",l,u,m=[],x,o,S,A;switch(r){case"dbcs":if(A=this.l,vr&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(S=0;S<e;++S)n+=String.fromCharCode(_o(this,A)),A+=2;e*=2;break;case"utf8":n=ep(this,this.l,this.l+e);break;case"utf16le":e*=2,n=zy(this,this.l,this.l+e);break;case"wstr":return pd.call(this,e,"dbcs");case"lpstr-ansi":n=dk(this,this.l),e=4+ya(this,this.l);break;case"lpstr-cp":n=mk(this,this.l),e=4+ya(this,this.l);break;case"lpwstr":n=gk(this,this.l),e=4+2*ya(this,this.l);break;case"lpp4":e=4+ya(this,this.l),n=yk(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+ya(this,this.l),n=wk(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(x=Nu(this,this.l+e++))!==0;)m.push(K0(x));n=m.join("");break;case"_wstr":for(e=0,n="";(x=_o(this,this.l+e))!==0;)m.push(K0(x)),e+=2;e+=2,n=m.join("");break;case"dbcs-cont":for(n="",A=this.l,S=0;S<e;++S){if(this.lens&&this.lens.indexOf(A)!==-1)return x=Nu(this,A),this.l=A+1,o=pd.call(this,e-S,x?"dbcs-cont":"sbcs-cont"),m.join("")+o;m.push(K0(_o(this,A))),A+=2}n=m.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",A=this.l,S=0;S!=e;++S){if(this.lens&&this.lens.indexOf(A)!==-1)return x=Nu(this,A),this.l=A+1,o=pd.call(this,e-S,x?"dbcs-cont":"sbcs-cont"),m.join("")+o;m.push(K0(Nu(this,A))),A+=1}n=m.join("");break;default:switch(e){case 1:return l=Nu(this,this.l),this.l++,l;case 2:return l=(r==="i"?cF:_o)(this,this.l),this.l+=2,l;case 4:case-4:return r==="i"||(this[this.l+3]&128)===0?(l=(e>0?pc:uF)(this,this.l),this.l+=4,l):(u=ya(this,this.l),this.l+=4,u);case 8:case-8:if(r==="f")return e==8?u=Hm(this,this.l):u=Hm([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,u;e=8;case 16:n=hk(this,this.l,e);break}}return this.l+=e,n}var hF=function(e,r,n){e[n]=r&255,e[n+1]=r>>>8&255,e[n+2]=r>>>16&255,e[n+3]=r>>>24&255},fF=function(e,r,n){e[n]=r&255,e[n+1]=r>>8&255,e[n+2]=r>>16&255,e[n+3]=r>>24&255},dF=function(e,r,n){e[n]=r&255,e[n+1]=r>>>8&255};function pF(e,r,n){var l=0,u=0;if(n==="dbcs"){for(u=0;u!=r.length;++u)dF(this,r.charCodeAt(u),this.l+2*u);l=2*r.length}else if(n==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),u=0;u!=r.length;++u)this[this.l+u]=r.charCodeAt(u)&255;l=r.length}else if(n==="hex"){for(;u<e;++u)this[this.l++]=parseInt(r.slice(2*u,2*u+2),16)||0;return this}else if(n==="utf16le"){var m=Math.min(this.l+e,this.length);for(u=0;u<Math.min(r.length,e);++u){var x=r.charCodeAt(u);this[this.l++]=x&255,this[this.l++]=x>>8}for(;this.l<m;)this[this.l++]=0;return this}else switch(e){case 1:l=1,this[this.l]=r&255;break;case 2:l=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:l=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:l=4,hF(this,r,this.l);break;case 8:if(l=8,n==="f"){lF(this,r,this.l);break}case 16:break;case-4:l=4,fF(this,r,this.l);break}return this.l+=l,this}function bk(e,r){var n=hk(this,this.l,e.length>>1);if(n!==e)throw new Error(r+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Jn(e,r){e.l=r,e.read_shift=pd,e.chk=bk,e.write_shift=pF}function vi(e,r){e.l+=r}function Un(e){var r=bl(e);return Jn(r,0),r}function ko(e,r,n){if(!!e){var l,u,m;Jn(e,e.l||0);for(var x=e.length,o=0,S=0;e.l<x;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var A=Qm[o]||Qm[65535];for(l=e.read_shift(1),m=l&127,u=1;u<4&&l&128;++u)m+=((l=e.read_shift(1))&127)<<7*u;S=e.l+m;var I=A.f&&A.f(e,m,n);if(e.l=S,r(I,A,o))return}}}function T1(){var e=[],r=vr?256:2048,n=function(A){var I=Un(A);return Jn(I,0),I},l=n(r),u=function(){!l||(l.length>l.l&&(l=l.slice(0,l.l),l.l=l.length),l.length>0&&e.push(l),l=null)},m=function(A){return l&&A<l.length-l.l?l:(u(),l=n(Math.max(A+1,r)))},x=function(){return u(),ll(e)},o=function(A){u(),l=A,l.l==null&&(l.l=l.length),m(r)};return{next:m,push:o,end:x,_bufs:e}}function md(e,r,n){var l=ei(e);if(r.s?(l.cRel&&(l.c+=r.s.c),l.rRel&&(l.r+=r.s.r)):(l.cRel&&(l.c+=r.c),l.rRel&&(l.r+=r.r)),!n||n.biff<12){for(;l.c>=256;)l.c-=256;for(;l.r>=65536;)l.r-=65536}return l}function qT(e,r,n){var l=ei(e);return l.s=md(l.s,r.s,n),l.e=md(l.e,r.s,n),l}function _d(e,r){if(e.cRel&&e.c<0)for(e=ei(e);e.c<0;)e.c+=r>8?16384:256;if(e.rRel&&e.r<0)for(e=ei(e);e.r<0;)e.r+=r>8?1048576:r>5?65536:16384;var n=lr(e);return!e.cRel&&e.cRel!=null&&(n=gF(n)),!e.rRel&&e.rRel!=null&&(n=mF(n)),n}function vx(e,r){return e.s.r==0&&!e.s.rRel&&e.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+jn(e.s.c)+":"+(e.e.cRel?"":"$")+jn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(r.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+ti(e.s.r)+":"+(e.e.rRel?"":"$")+ti(e.e.r):_d(e.s,r.biff)+":"+_d(e.e,r.biff)}function Oy(e){return parseInt(_F(e),10)-1}function ti(e){return""+(e+1)}function mF(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function _F(e){return e.replace(/\$(\d+)$/,"$1")}function By(e){for(var r=xF(e),n=0,l=0;l!==r.length;++l)n=26*n+r.charCodeAt(l)-64;return n-1}function jn(e){if(e<0)throw new Error("invalid column "+e);var r="";for(++e;e;e=Math.floor((e-1)/26))r=String.fromCharCode((e-1)%26+65)+r;return r}function gF(e){return e.replace(/^([A-Z])/,"$$$1")}function xF(e){return e.replace(/^\$([A-Z])/,"$1")}function yF(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Ni(e){for(var r=0,n=0,l=0;l<e.length;++l){var u=e.charCodeAt(l);u>=48&&u<=57?r=10*r+(u-48):u>=65&&u<=90&&(n=26*n+(u-64))}return{c:n-1,r:r-1}}function lr(e){for(var r=e.c+1,n="";r;r=(r-1)/26|0)n=String.fromCharCode((r-1)%26+65)+n;return n+(e.r+1)}function Th(e){var r=e.indexOf(":");return r==-1?{s:Ni(e),e:Ni(e)}:{s:Ni(e.slice(0,r)),e:Ni(e.slice(r+1))}}function br(e,r){return typeof r=="undefined"||typeof r=="number"?br(e.s,e.e):(typeof e!="string"&&(e=lr(e)),typeof r!="string"&&(r=lr(r)),e==r?e:e+":"+r)}function wn(e){var r={s:{c:0,r:0},e:{c:0,r:0}},n=0,l=0,u=0,m=e.length;for(n=0;l<m&&!((u=e.charCodeAt(l)-64)<1||u>26);++l)n=26*n+u;for(r.s.c=--n,n=0;l<m&&!((u=e.charCodeAt(l)-48)<0||u>9);++l)n=10*n+u;if(r.s.r=--n,l===m||u!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++l,n=0;l!=m&&!((u=e.charCodeAt(l)-64)<1||u>26);++l)n=26*n+u;for(r.e.c=--n,n=0;l!=m&&!((u=e.charCodeAt(l)-48)<0||u>9);++l)n=10*n+u;return r.e.r=--n,r}function KT(e,r){var n=e.t=="d"&&r instanceof Date;if(e.z!=null)try{return e.w=Wa(e.z,n?ji(r):r)}catch{}try{return e.w=Wa((e.XF||{}).numFmtId||(n?14:0),n?ji(r):r)}catch{return""+r}}function Eo(e,r,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Bc[e.v]||e.v:r==null?KT(e,e.v):KT(e,r))}function Il(e,r){var n=r&&r.sheet?r.sheet:"Sheet1",l={};return l[n]=e,{SheetNames:[n],Sheets:l}}function Sk(e,r,n){var l=n||{},u=e?Array.isArray(e):l.dense,m=e||(u?[]:{}),x=0,o=0;if(m&&l.origin!=null){if(typeof l.origin=="number")x=l.origin;else{var S=typeof l.origin=="string"?Ni(l.origin):l.origin;x=S.r,o=S.c}m["!ref"]||(m["!ref"]="A1:A1")}var A={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(m["!ref"]){var I=wn(m["!ref"]);A.s.c=I.s.c,A.s.r=I.s.r,A.e.c=Math.max(A.e.c,I.e.c),A.e.r=Math.max(A.e.r,I.e.r),x==-1&&(A.e.r=x=I.e.r+1)}for(var D=0;D!=r.length;++D)if(!!r[D]){if(!Array.isArray(r[D]))throw new Error("aoa_to_sheet expects an array of arrays");for(var L=0;L!=r[D].length;++L)if(typeof r[D][L]!="undefined"){var B={v:r[D][L]},U=x+D,V=o+L;if(A.s.r>U&&(A.s.r=U),A.s.c>V&&(A.s.c=V),A.e.r<U&&(A.e.r=U),A.e.c<V&&(A.e.c=V),r[D][L]&&typeof r[D][L]=="object"&&!Array.isArray(r[D][L])&&!(r[D][L]instanceof Date))B=r[D][L];else if(Array.isArray(B.v)&&(B.f=r[D][L][1],B.v=B.v[0]),B.v===null)if(B.f)B.t="n";else if(l.nullError)B.t="e",B.v=0;else if(l.sheetStubs)B.t="z";else continue;else typeof B.v=="number"?B.t="n":typeof B.v=="boolean"?B.t="b":B.v instanceof Date?(B.z=l.dateNF||hr[14],l.cellDates?(B.t="d",B.w=Wa(B.z,ji(B.v))):(B.t="n",B.v=ji(B.v),B.w=Wa(B.z,B.v))):B.t="s";if(u)m[U]||(m[U]=[]),m[U][V]&&m[U][V].z&&(B.z=m[U][V].z),m[U][V]=B;else{var Y=lr({c:V,r:U});m[Y]&&m[Y].z&&(B.z=m[Y].z),m[Y]=B}}}return A.s.c<1e7&&(m["!ref"]=br(A)),m}function Eh(e,r){return Sk(null,e,r)}function vF(e){return e.read_shift(4,"i")}function xi(e){var r=e.read_shift(4);return r===0?"":e.read_shift(r,"dbcs")}function wF(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function Ny(e,r){var n=e.l,l=e.read_shift(1),u=xi(e),m=[],x={t:u,h:u};if((l&1)!==0){for(var o=e.read_shift(4),S=0;S!=o;++S)m.push(wF(e));x.r=m}else x.r=[{ich:0,ifnt:0}];return e.l=n+r,x}var TF=Ny;function Za(e){var r=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:r,iStyleRef:n}}function zc(e){var r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:r}}var EF=xi;function Uy(e){var r=e.read_shift(4);return r===0||r===4294967295?"":e.read_shift(r,"dbcs")}var bF=xi,E1=Uy;function Vy(e){var r=e.slice(e.l,e.l+4),n=r[0]&1,l=r[0]&2;e.l+=4;var u=l===0?Hm([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):pc(r,0)>>2;return n?u/100:u}function kk(e){var r={s:{},e:{}};return r.s.r=e.read_shift(4),r.e.r=e.read_shift(4),r.s.c=e.read_shift(4),r.e.c=e.read_shift(4),r}var Oc=kk;function _i(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function SF(e){var r={},n=e.read_shift(1),l=n>>>1,u=e.read_shift(1),m=e.read_shift(2,"i"),x=e.read_shift(1),o=e.read_shift(1),S=e.read_shift(1);switch(e.l++,l){case 0:r.auto=1;break;case 1:r.index=u;var A=bc[u];A&&(r.rgb=Wd(A));break;case 2:r.rgb=Wd([x,o,S]);break;case 3:r.theme=u;break}return m!=0&&(r.tint=m>0?m/32767:m/32768),r}function kF(e){var r=e.read_shift(1);e.l++;var n={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return n}function Ak(e,r){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},l=e.read_shift(4);switch(l){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(l>400)throw new Error("Unsupported Clipboard: "+l.toString(16));return e.l-=4,e.read_shift(0,r==1?"lpstr":"lpwstr")}function AF(e){return Ak(e,1)}function CF(e){return Ak(e,2)}var jy=2,ia=3,J0=11,YT=12,Xm=19,Q0=64,IF=65,MF=71,DF=4108,FF=4126,Xn=80,Ck=81,PF=[Xn,Ck],LF={1:{n:"CodePage",t:jy},2:{n:"Category",t:Xn},3:{n:"PresentationFormat",t:Xn},4:{n:"ByteCount",t:ia},5:{n:"LineCount",t:ia},6:{n:"ParagraphCount",t:ia},7:{n:"SlideCount",t:ia},8:{n:"NoteCount",t:ia},9:{n:"HiddenCount",t:ia},10:{n:"MultimediaClipCount",t:ia},11:{n:"ScaleCrop",t:J0},12:{n:"HeadingPairs",t:DF},13:{n:"TitlesOfParts",t:FF},14:{n:"Manager",t:Xn},15:{n:"Company",t:Xn},16:{n:"LinksUpToDate",t:J0},17:{n:"CharacterCount",t:ia},19:{n:"SharedDoc",t:J0},22:{n:"HyperlinksChanged",t:J0},23:{n:"AppVersion",t:ia,p:"version"},24:{n:"DigSig",t:IF},26:{n:"ContentType",t:Xn},27:{n:"ContentStatus",t:Xn},28:{n:"Language",t:Xn},29:{n:"Version",t:Xn},255:{},2147483648:{n:"Locale",t:Xm},2147483651:{n:"Behavior",t:Xm},1919054434:{}},RF={1:{n:"CodePage",t:jy},2:{n:"Title",t:Xn},3:{n:"Subject",t:Xn},4:{n:"Author",t:Xn},5:{n:"Keywords",t:Xn},6:{n:"Comments",t:Xn},7:{n:"Template",t:Xn},8:{n:"LastAuthor",t:Xn},9:{n:"RevNumber",t:Xn},10:{n:"EditTime",t:Q0},11:{n:"LastPrinted",t:Q0},12:{n:"CreatedDate",t:Q0},13:{n:"ModifiedDate",t:Q0},14:{n:"PageCount",t:ia},15:{n:"WordCount",t:ia},16:{n:"CharCount",t:ia},17:{n:"Thumbnail",t:MF},18:{n:"Application",t:Xn},19:{n:"DocSecurity",t:ia},255:{},2147483648:{n:"Locale",t:Xm},2147483651:{n:"Behavior",t:Xm},1919054434:{}},JT={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},zF=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function OF(e){return e.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var BF=OF([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),bc=ei(BF),Bc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},Ik={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},QT={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function NF(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function UF(e){var r=NF();if(!e||!e.match)return r;var n={};if((e.match(wi)||[]).forEach(function(l){var u=nr(l);switch(u[0].replace(XD,"<")){case"<?xml":break;case"<Types":r.xmlns=u["xmlns"+(u[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[u.Extension]=u.ContentType;break;case"<Override":r[QT[u.ContentType]]!==void 0&&r[QT[u.ContentType]].push(u.PartName);break}}),r.xmlns!==aF.CT)throw new Error("Unknown Namespace: "+r.xmlns);return r.calcchain=r.calcchains.length>0?r.calcchains[0]:"",r.sst=r.strs.length>0?r.strs[0]:"",r.style=r.styles.length>0?r.styles[0]:"",r.defaults=n,delete r.calcchains,r}var Yu={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function b1(e){var r=e.lastIndexOf("/");return e.slice(0,r+1)+"_rels/"+e.slice(r+1)+".rels"}function gd(e,r){var n={"!id":{}};if(!e)return n;r.charAt(0)!=="/"&&(r="/"+r);var l={};return(e.match(wi)||[]).forEach(function(u){var m=nr(u);if(m[0]==="<Relationship"){var x={};x.Type=m.Type,x.Target=m.Target,x.Id=m.Id,m.TargetMode&&(x.TargetMode=m.TargetMode);var o=m.TargetMode==="External"?m.Target:id(m.Target,r);n[o]=x,l[m.Id]=x}}),n["!id"]=l,n}var VF="application/vnd.oasis.opendocument.spreadsheet";function jF(e,r){for(var n=Ry(e),l,u;l=Gd.exec(n);)switch(l[3]){case"manifest":break;case"file-entry":if(u=nr(l[0],!1),u.path=="/"&&u.type!==VF)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(r&&r.WTF)throw l}}var xd=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],GF=function(){for(var e=new Array(xd.length),r=0;r<xd.length;++r){var n=xd[r],l="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[r]=new RegExp("<"+l+"[^>]*>([\\s\\S]*?)</"+l+">")}return e}();function Mk(e){var r={};e=Hr(e);for(var n=0;n<xd.length;++n){var l=xd[n],u=e.match(GF[n]);u!=null&&u.length>0&&(r[l[1]]=Ar(u[1])),l[2]==="date"&&r[l[1]]&&(r[l[1]]=Kn(r[l[1]]))}return r}var $F=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function Dk(e,r,n,l){var u=[];if(typeof e=="string")u=GT(e,l);else for(var m=0;m<e.length;++m)u=u.concat(e[m].map(function(I){return{v:I}}));var x=typeof r=="string"?GT(r,l).map(function(I){return I.v}):r,o=0,S=0;if(x.length>0)for(var A=0;A!==u.length;A+=2){switch(S=+u[A+1].v,u[A].v){case"Worksheets":case"\u5DE5\u4F5C\u8868":case"\u041B\u0438\u0441\u0442\u044B":case"\u0623\u0648\u0631\u0627\u0642 \u0627\u0644\u0639\u0645\u0644":case"\u30EF\u30FC\u30AF\u30B7\u30FC\u30C8":case"\u05D2\u05DC\u05D9\u05D5\u05E0\u05D5\u05EA \u05E2\u05D1\u05D5\u05D3\u05D4":case"Arbeitsbl\xE4tter":case"\xC7al\u0131\u015Fma Sayfalar\u0131":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de c\xE1lculo":case"Planilhas":case"Regneark":case"Hojas de c\xE1lculo":case"Werkbladen":n.Worksheets=S,n.SheetNames=x.slice(o,o+S);break;case"Named Ranges":case"Rangos con nombre":case"\u540D\u524D\u4ED8\u304D\u4E00\u89A7":case"Benannte Bereiche":case"Navngivne omr\xE5der":n.NamedRanges=S,n.DefinedNames=x.slice(o,o+S);break;case"Charts":case"Diagramme":n.Chartsheets=S,n.ChartNames=x.slice(o,o+S);break}o+=S}}function WF(e,r,n){var l={};return r||(r={}),e=Hr(e),$F.forEach(function(u){var m=(e.match(jd(u[0]))||[])[1];switch(u[2]){case"string":m&&(r[u[1]]=Ar(m));break;case"bool":r[u[1]]=m==="true";break;case"raw":var x=e.match(new RegExp("<"+u[0]+"[^>]*>([\\s\\S]*?)</"+u[0]+">"));x&&x.length>0&&(l[u[1]]=x[1]);break}}),l.HeadingPairs&&l.TitlesOfParts&&Dk(l.HeadingPairs,l.TitlesOfParts,r,n),r}var ZF=/<[^>]+>[^<]*/g;function HF(e,r){var n={},l="",u=e.match(ZF);if(u)for(var m=0;m!=u.length;++m){var x=u[m],o=nr(x);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":l=Ar(o.name);break;case"</property>":l=null;break;default:if(x.indexOf("<vt:")===0){var S=x.split(">"),A=S[0].slice(4),I=S[1];switch(A){case"lpstr":case"bstr":case"lpwstr":n[l]=Ar(I);break;case"bool":n[l]=rn(I);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[l]=parseInt(I,10);break;case"r4":case"r8":case"decimal":n[l]=parseFloat(I);break;case"filetime":case"date":n[l]=Kn(I);break;case"cy":case"error":n[l]=Ar(I);break;default:if(A.slice(-1)=="/")break;r.WTF&&typeof console!="undefined"&&console.warn("Unexpected",x,A,S)}}else if(x.slice(0,2)!=="</"){if(r.WTF)throw new Error(x)}}}return n}var XF={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},wx;function qF(e,r,n){wx||(wx=Fy(XF)),r=wx[r]||r,e[r]=n}function Gy(e){var r=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+r/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Fk(e,r,n){var l=e.l,u=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-l&3;)++e.l;return u}function Pk(e,r,n){var l=e.read_shift(0,"lpwstr");return n&&(e.l+=4-(l.length+1&3)&3),l}function Lk(e,r,n){return r===31?Pk(e):Fk(e,r,n)}function S1(e,r,n){return Lk(e,r,n===!1?0:4)}function KF(e,r){if(!r)throw new Error("VtUnalignedString must have positive length");return Lk(e,r,0)}function YF(e){for(var r=e.read_shift(4),n=[],l=0;l!=r;++l){var u=e.l;n[l]=e.read_shift(0,"lpwstr").replace(Vi,""),e.l-u&2&&(e.l+=2)}return n}function JF(e){for(var r=e.read_shift(4),n=[],l=0;l!=r;++l)n[l]=e.read_shift(0,"lpstr-cp").replace(Vi,"");return n}function QF(e){var r=e.l,n=qm(e,Ck);e[e.l]==0&&e[e.l+1]==0&&e.l-r&2&&(e.l+=2);var l=qm(e,ia);return[n,l]}function eP(e){for(var r=e.read_shift(4),n=[],l=0;l<r/2;++l)n.push(QF(e));return n}function eE(e,r){for(var n=e.read_shift(4),l={},u=0;u!=n;++u){var m=e.read_shift(4),x=e.read_shift(4);l[m]=e.read_shift(x,r===1200?"utf16le":"utf8").replace(Vi,"").replace(nd,"!"),r===1200&&x%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>2+1<<2),l}function Rk(e){var r=e.read_shift(4),n=e.slice(e.l,e.l+r);return e.l+=r,(r&3)>0&&(e.l+=4-(r&3)&3),n}function tP(e){var r={};return r.Size=e.read_shift(4),e.l+=r.Size+3-(r.Size-1)%4,r}function qm(e,r,n){var l=e.read_shift(2),u,m=n||{};if(e.l+=2,r!==YT&&l!==r&&PF.indexOf(r)===-1&&!((r&65534)==4126&&(l&65534)==4126))throw new Error("Expected type "+r+" saw "+l);switch(r===YT?l:r){case 2:return u=e.read_shift(2,"i"),m.raw||(e.l+=2),u;case 3:return u=e.read_shift(4,"i"),u;case 11:return e.read_shift(4)!==0;case 19:return u=e.read_shift(4),u;case 30:return Fk(e,l,4).replace(Vi,"");case 31:return Pk(e);case 64:return Gy(e);case 65:return Rk(e);case 71:return tP(e);case 80:return S1(e,l,!m.raw).replace(Vi,"");case 81:return KF(e,l).replace(Vi,"");case 4108:return eP(e);case 4126:case 4127:return l==4127?YF(e):JF(e);default:throw new Error("TypedPropertyValue unrecognized type "+r+" "+l)}}function tE(e,r){var n=e.l,l=e.read_shift(4),u=e.read_shift(4),m=[],x=0,o=0,S=-1,A={};for(x=0;x!=u;++x){var I=e.read_shift(4),D=e.read_shift(4);m[x]=[I,D+n]}m.sort(function(K,G){return K[1]-G[1]});var L={};for(x=0;x!=u;++x){if(e.l!==m[x][1]){var B=!0;if(x>0&&r)switch(r[m[x-1][0]].t){case 2:e.l+2===m[x][1]&&(e.l+=2,B=!1);break;case 80:e.l<=m[x][1]&&(e.l=m[x][1],B=!1);break;case 4108:e.l<=m[x][1]&&(e.l=m[x][1],B=!1);break}if((!r||x==0)&&e.l<=m[x][1]&&(B=!1,e.l=m[x][1]),B)throw new Error("Read Error: Expected address "+m[x][1]+" at "+e.l+" :"+x)}if(r){var U=r[m[x][0]];if(L[U.n]=qm(e,U.t,{raw:!0}),U.p==="version"&&(L[U.n]=String(L[U.n]>>16)+"."+("0000"+String(L[U.n]&65535)).slice(-4)),U.n=="CodePage")switch(L[U.n]){case 0:L[U.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:cs(o=L[U.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+L[U.n])}}else if(m[x][0]===1){if(o=L.CodePage=qm(e,jy),cs(o),S!==-1){var V=e.l;e.l=m[S][1],A=eE(e,o),e.l=V}}else if(m[x][0]===0){if(o===0){S=x,e.l=m[x+1][1];continue}A=eE(e,o)}else{var Y=A[m[x][0]],X;switch(e[e.l]){case 65:e.l+=4,X=Rk(e);break;case 30:e.l+=4,X=S1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,X=S1(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,X=e.read_shift(4,"i");break;case 19:e.l+=4,X=e.read_shift(4);break;case 5:e.l+=4,X=e.read_shift(8,"f");break;case 11:e.l+=4,X=bn(e,4);break;case 64:e.l+=4,X=Kn(Gy(e));break;default:throw new Error("unparsed value: "+e[e.l])}L[Y]=X}}return e.l=n+l,L}function rE(e,r,n){var l=e.content;if(!l)return{};Jn(l,0);var u,m,x,o,S=0;l.chk("feff","Byte Order: "),l.read_shift(2);var A=l.read_shift(4),I=l.read_shift(16);if(I!==wr.utils.consts.HEADER_CLSID&&I!==n)throw new Error("Bad PropertySet CLSID "+I);if(u=l.read_shift(4),u!==1&&u!==2)throw new Error("Unrecognized #Sets: "+u);if(m=l.read_shift(16),o=l.read_shift(4),u===1&&o!==l.l)throw new Error("Length mismatch: "+o+" !== "+l.l);u===2&&(x=l.read_shift(16),S=l.read_shift(4));var D=tE(l,r),L={SystemIdentifier:A};for(var B in D)L[B]=D[B];if(L.FMTID=m,u===1)return L;if(S-l.l==2&&(l.l+=2),l.l!==S)throw new Error("Length mismatch 2: "+l.l+" !== "+S);var U;try{U=tE(l,null)}catch{}for(B in U)L[B]=U[B];return L.FMTID=[m,x],L}function rl(e,r){return e.read_shift(r),null}function rP(e,r,n){for(var l=[],u=e.l+r;e.l<u;)l.push(n(e,u-e.l));if(u!==e.l)throw new Error("Slurp error");return l}function bn(e,r){return e.read_shift(r)===1}function Fn(e){return e.read_shift(2,"u")}function zk(e,r){return rP(e,r,Fn)}function nP(e){var r=e.read_shift(1),n=e.read_shift(1);return n===1?r:r===1}function tp(e,r,n){var l=e.read_shift(n&&n.biff>=12?2:1),u="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var m=e.read_shift(1);m&&(u="dbcs-cont")}else n.biff==12&&(u="wstr");n.biff>=2&&n.biff<=5&&(u="cpstr");var x=l?e.read_shift(l,u):"";return x}function iP(e){var r=e.read_shift(2),n=e.read_shift(1),l=n&4,u=n&8,m=1+(n&1),x=0,o,S={};u&&(x=e.read_shift(2)),l&&(o=e.read_shift(4));var A=m==2?"dbcs-cont":"sbcs-cont",I=r===0?"":e.read_shift(r,A);return u&&(e.l+=4*x),l&&(e.l+=o),S.t=I,u||(S.raw="<t>"+S.t+"</t>",S.r=S.t),S}function Mc(e,r,n){var l;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(r,"cpstr");if(n.biff>=12)return e.read_shift(r,"dbcs-cont")}var u=e.read_shift(1);return u===0?l=e.read_shift(r,"sbcs-cont"):l=e.read_shift(r,"dbcs-cont"),l}function rp(e,r,n){var l=e.read_shift(n&&n.biff==2?1:2);return l===0?(e.l++,""):Mc(e,l,n)}function Nc(e,r,n){if(n.biff>5)return rp(e,r,n);var l=e.read_shift(1);return l===0?(e.l++,""):e.read_shift(l,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function aP(e){var r=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[r,n]}function sP(e){var r=e.read_shift(4),n=e.l,l=!1;r>24&&(e.l+=r-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(l=!0),e.l=n);var u=e.read_shift((l?r-24:r)>>1,"utf16le").replace(Vi,"");return l&&(e.l+=24),u}function oP(e){for(var r=e.read_shift(2),n="";r-- >0;)n+="../";var l=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var u=e.read_shift(4);if(u===0)return n+l.replace(/\\/g,"/");var m=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var x=e.read_shift(m>>1,"utf16le").replace(Vi,"");return n+x}function lP(e,r){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return sP(e);case"0303000000000000c000000000000046":return oP(e);default:throw new Error("Unsupported Moniker "+n)}}function em(e){var r=e.read_shift(4),n=r>0?e.read_shift(r,"utf16le").replace(Vi,""):"";return n}function cP(e,r){var n=e.l+r,l=e.read_shift(4);if(l!==2)throw new Error("Unrecognized streamVersion: "+l);var u=e.read_shift(2);e.l+=2;var m,x,o,S,A="",I,D;u&16&&(m=em(e,n-e.l)),u&128&&(x=em(e,n-e.l)),(u&257)===257&&(o=em(e,n-e.l)),(u&257)===1&&(S=lP(e,n-e.l)),u&8&&(A=em(e,n-e.l)),u&32&&(I=e.read_shift(16)),u&64&&(D=Gy(e)),e.l=n;var L=x||o||S||"";L&&A&&(L+="#"+A),L||(L="#"+A),u&2&&L.charAt(0)=="/"&&L.charAt(1)!="/"&&(L="file://"+L);var B={Target:L};return I&&(B.guid=I),D&&(B.time=D),m&&(B.Tooltip=m),B}function Ok(e){var r=e.read_shift(1),n=e.read_shift(1),l=e.read_shift(1),u=e.read_shift(1);return[r,n,l,u]}function Bk(e,r){var n=Ok(e);return n[3]=0,n}function Ws(e){var r=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2);return{r,c:n,ixfe:l}}function uP(e){var r=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:r,flags:n}}function hP(e,r,n){return r===0?"":Nc(e,r,n)}function fP(e,r,n){var l=n.biff>8?4:2,u=e.read_shift(l),m=e.read_shift(l,"i"),x=e.read_shift(l,"i");return[u,m,x]}function Nk(e){var r=e.read_shift(2),n=Vy(e);return[r,n]}function dP(e,r,n){e.l+=4,r-=4;var l=e.l+r,u=tp(e,r,n),m=e.read_shift(2);if(l-=e.l,m!==l)throw new Error("Malformed AddinUdf: padding = "+l+" != "+m);return e.l+=m,u}function w_(e){var r=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{s:{c:l,r},e:{c:u,r:n}}}function Uk(e){var r=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(1),u=e.read_shift(1);return{s:{c:l,r},e:{c:u,r:n}}}var pP=Uk;function Vk(e){e.l+=4;var r=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2);return e.l+=12,[n,r,l]}function mP(e){var r={};return e.l+=4,e.l+=16,r.fSharedNote=e.read_shift(2),e.l+=4,r}function _P(e){var r={};return e.l+=4,e.cf=e.read_shift(2),r}function di(e){e.l+=2,e.l+=e.read_shift(2)}var gP={0:di,4:di,5:di,6:di,7:_P,8:di,9:di,10:di,11:di,12:di,13:mP,14:di,15:di,16:di,17:di,18:di,19:di,20:di,21:Vk};function xP(e,r){for(var n=e.l+r,l=[];e.l<n;){var u=e.read_shift(2);e.l-=2;try{l.push(gP[u](e,n-e.l))}catch{return e.l=n,l}}return e.l!=n&&(e.l=n),l}function tm(e,r){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),r-=2,r>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(r>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(r),n}function yP(e,r){return r===0||e.read_shift(2),1200}function vP(e,r,n){if(n.enc)return e.l+=r,"";var l=e.l,u=Nc(e,0,n);return e.read_shift(r+l-e.l),u}function wP(e,r,n){var l=n&&n.biff==8||r==2?e.read_shift(2):(e.l+=r,0);return{fDialog:l&16,fBelow:l&64,fRight:l&128}}function TP(e,r,n){var l=e.read_shift(4),u=e.read_shift(1)&3,m=e.read_shift(1);switch(m){case 0:m="Worksheet";break;case 1:m="Macrosheet";break;case 2:m="Chartsheet";break;case 6:m="VBAModule";break}var x=tp(e,0,n);return x.length===0&&(x="Sheet1"),{pos:l,hs:u,dt:m,name:x}}function EP(e,r){for(var n=e.l+r,l=e.read_shift(4),u=e.read_shift(4),m=[],x=0;x!=u&&e.l<n;++x)m.push(iP(e));return m.Count=l,m.Unique=u,m}function bP(e,r){var n={};return n.dsst=e.read_shift(2),e.l+=r-2,n}function SP(e){var r={};r.r=e.read_shift(2),r.c=e.read_shift(2),r.cnt=e.read_shift(2)-r.c;var n=e.read_shift(2);e.l+=4;var l=e.read_shift(1);return e.l+=3,l&7&&(r.level=l&7),l&32&&(r.hidden=!0),l&64&&(r.hpt=n/20),r}function kP(e){var r=uP(e);if(r.type!=2211)throw new Error("Invalid Future Record "+r.type);var n=e.read_shift(4);return n!==0}function AP(e){return e.read_shift(2),e.read_shift(4)}function nE(e,r,n){var l=0;n&&n.biff==2||(l=e.read_shift(2));var u=e.read_shift(2);n&&n.biff==2&&(l=1-(u>>15),u&=32767);var m={Unsynced:l&1,DyZero:(l&2)>>1,ExAsc:(l&4)>>2,ExDsc:(l&8)>>3};return[m,u]}function CP(e){var r=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2),m=e.read_shift(2),x=e.read_shift(2),o=e.read_shift(2),S=e.read_shift(2),A=e.read_shift(2);return{Pos:[r,n],Dim:[l,u],Flags:m,CurTab:x,FirstTab:o,Selected:S,TabRatio:A}}function IP(e,r,n){if(n&&n.biff>=2&&n.biff<5)return{};var l=e.read_shift(2);return{RTL:l&64}}function MP(){}function DP(e,r,n){var l={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return l.name=tp(e,0,n),l}function FP(e){var r=Ws(e);return r.isst=e.read_shift(4),r}function PP(e,r,n){n.biffguess&&n.biff==2&&(n.biff=5);var l=e.l+r,u=Ws(e);n.biff==2&&e.l++;var m=rp(e,l-e.l,n);return u.val=m,u}function LP(e,r,n){var l=e.read_shift(2),u=Nc(e,0,n);return[l,u]}var RP=Nc;function iE(e,r,n){var l=e.l+r,u=n.biff==8||!n.biff?4:2,m=e.read_shift(u),x=e.read_shift(u),o=e.read_shift(2),S=e.read_shift(2);return e.l=l,{s:{r:m,c:o},e:{r:x,c:S}}}function zP(e){var r=e.read_shift(2),n=e.read_shift(2),l=Nk(e);return{r,c:n,ixfe:l[0],rknum:l[1]}}function OP(e,r){for(var n=e.l+r-2,l=e.read_shift(2),u=e.read_shift(2),m=[];e.l<n;)m.push(Nk(e));if(e.l!==n)throw new Error("MulRK read error");var x=e.read_shift(2);if(m.length!=x-u+1)throw new Error("MulRK length mismatch");return{r:l,c:u,C:x,rkrec:m}}function BP(e,r){for(var n=e.l+r-2,l=e.read_shift(2),u=e.read_shift(2),m=[];e.l<n;)m.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var x=e.read_shift(2);if(m.length!=x-u+1)throw new Error("MulBlank length mismatch");return{r:l,c:u,C:x,ixfe:m}}function NP(e,r,n,l){var u={},m=e.read_shift(4),x=e.read_shift(4),o=e.read_shift(4),S=e.read_shift(2);return u.patternType=zF[o>>26],l.cellStyles&&(u.alc=m&7,u.fWrap=m>>3&1,u.alcV=m>>4&7,u.fJustLast=m>>7&1,u.trot=m>>8&255,u.cIndent=m>>16&15,u.fShrinkToFit=m>>20&1,u.iReadOrder=m>>22&2,u.fAtrNum=m>>26&1,u.fAtrFnt=m>>27&1,u.fAtrAlc=m>>28&1,u.fAtrBdr=m>>29&1,u.fAtrPat=m>>30&1,u.fAtrProt=m>>31&1,u.dgLeft=x&15,u.dgRight=x>>4&15,u.dgTop=x>>8&15,u.dgBottom=x>>12&15,u.icvLeft=x>>16&127,u.icvRight=x>>23&127,u.grbitDiag=x>>30&3,u.icvTop=o&127,u.icvBottom=o>>7&127,u.icvDiag=o>>14&127,u.dgDiag=o>>21&15,u.icvFore=S&127,u.icvBack=S>>7&127,u.fsxButton=S>>14&1),u}function UP(e,r,n){var l={};return l.ifnt=e.read_shift(2),l.numFmtId=e.read_shift(2),l.flags=e.read_shift(2),l.fStyle=l.flags>>2&1,r-=6,l.data=NP(e,r,l.fStyle,n),l}function VP(e){e.l+=4;var r=[e.read_shift(2),e.read_shift(2)];if(r[0]!==0&&r[0]--,r[1]!==0&&r[1]--,r[0]>7||r[1]>7)throw new Error("Bad Gutters: "+r.join("|"));return r}function aE(e,r,n){var l=Ws(e);(n.biff==2||r==9)&&++e.l;var u=nP(e);return l.val=u,l.t=u===!0||u===!1?"b":"e",l}function jP(e,r,n){n.biffguess&&n.biff==2&&(n.biff=5);var l=Ws(e),u=_i(e);return l.val=u,l}var sE=hP;function GP(e,r,n){var l=e.l+r,u=e.read_shift(2),m=e.read_shift(2);if(n.sbcch=m,m==1025||m==14849)return[m,u];if(m<1||m>255)throw new Error("Unexpected SupBook type: "+m);for(var x=Mc(e,m),o=[];l>e.l;)o.push(rp(e));return[m,u,x,o]}function oE(e,r,n){var l=e.read_shift(2),u,m={fBuiltIn:l&1,fWantAdvise:l>>>1&1,fWantPict:l>>>2&1,fOle:l>>>3&1,fOleLink:l>>>4&1,cf:l>>>5&1023,fIcon:l>>>15&1};return n.sbcch===14849&&(u=dP(e,r-2,n)),m.body=u||e.read_shift(r-2),typeof u=="string"&&(m.Name=u),m}var $P=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function lE(e,r,n){var l=e.l+r,u=e.read_shift(2),m=e.read_shift(1),x=e.read_shift(1),o=e.read_shift(n&&n.biff==2?1:2),S=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),S=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var A=Mc(e,x,n);u&32&&(A=$P[A.charCodeAt(0)]);var I=l-e.l;n&&n.biff==2&&--I;var D=l==e.l||o===0||!(I>0)?[]:Sz(e,I,n,o);return{chKey:m,Name:A,itab:S,rgce:D}}function jk(e,r,n){if(n.biff<8)return WP(e,r,n);for(var l=[],u=e.l+r,m=e.read_shift(n.biff>8?4:2);m--!==0;)l.push(fP(e,n.biff>8?12:6,n));if(e.l!=u)throw new Error("Bad ExternSheet: "+e.l+" != "+u);return l}function WP(e,r,n){e[e.l+1]==3&&e[e.l]++;var l=tp(e,r,n);return l.charCodeAt(0)==3?l.slice(1):l}function ZP(e,r,n){if(n.biff<8){e.l+=r;return}var l=e.read_shift(2),u=e.read_shift(2),m=Mc(e,l,n),x=Mc(e,u,n);return[m,x]}function HP(e,r,n){var l=Uk(e);e.l++;var u=e.read_shift(1);return r-=8,[kz(e,r,n),u,l]}function cE(e,r,n){var l=pP(e);switch(n.biff){case 2:e.l++,r-=7;break;case 3:case 4:e.l+=2,r-=8;break;default:e.l+=6,r-=12}return[l,Ez(e,r,n)]}function XP(e){var r=e.read_shift(4)!==0,n=e.read_shift(4)!==0,l=e.read_shift(4);return[r,n,l]}function qP(e,r,n){if(!(n.biff<8)){var l=e.read_shift(2),u=e.read_shift(2),m=e.read_shift(2),x=e.read_shift(2),o=Nc(e,0,n);return n.biff<8&&e.read_shift(1),[{r:l,c:u},o,x,m]}}function KP(e,r,n){return qP(e,r,n)}function YP(e,r){for(var n=[],l=e.read_shift(2);l--;)n.push(w_(e));return n}function JP(e,r,n){if(n&&n.biff<8)return eL(e,r,n);var l=Vk(e),u=xP(e,r-22,l[1]);return{cmo:l,ft:u}}var QP={8:function(e,r){var n=e.l+r;e.l+=10;var l=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var u=e.read_shift(1);return e.l+=u,e.l=n,{fmt:l}}};function eL(e,r,n){e.l+=4;var l=e.read_shift(2),u=e.read_shift(2),m=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,r-=36;var x=[];return x.push((QP[l]||vi)(e,r,n)),{cmo:[u,l,m],ft:x}}function tL(e,r,n){var l=e.l,u="";try{e.l+=4;var m=(n.lastobj||{cmo:[0,0]}).cmo[1],x;[0,5,7,11,12,14].indexOf(m)==-1?e.l+=6:x=aP(e,6,n);var o=e.read_shift(2);e.read_shift(2),Fn(e,2);var S=e.read_shift(2);e.l+=S;for(var A=1;A<e.lens.length-1;++A){if(e.l-l!=e.lens[A])throw new Error("TxO: bad continue record");var I=e[e.l],D=Mc(e,e.lens[A+1]-e.lens[A]-1);if(u+=D,u.length>=(I?o:2*o))break}if(u.length!==o&&u.length!==o*2)throw new Error("cchText: "+o+" != "+u.length);return e.l=l+r,{t:u}}catch{return e.l=l+r,{t:u}}}function rL(e,r){var n=w_(e);e.l+=16;var l=cP(e,r-24);return[n,l]}function nL(e,r){e.read_shift(2);var n=w_(e),l=e.read_shift((r-10)/2,"dbcs-cont");return l=l.replace(Vi,""),[n,l]}function iL(e){var r=[0,0],n;return n=e.read_shift(2),r[0]=JT[n]||n,n=e.read_shift(2),r[1]=JT[n]||n,r}function aL(e){for(var r=e.read_shift(2),n=[];r-- >0;)n.push(Bk(e));return n}function sL(e){for(var r=e.read_shift(2),n=[];r-- >0;)n.push(Bk(e));return n}function oL(e){e.l+=2;var r={cxfs:0,crc:0};return r.cxfs=e.read_shift(2),r.crc=e.read_shift(4),r}function Gk(e,r,n){if(!n.cellStyles)return vi(e,r);var l=n&&n.biff>=12?4:2,u=e.read_shift(l),m=e.read_shift(l),x=e.read_shift(l),o=e.read_shift(l),S=e.read_shift(2);l==2&&(e.l+=2);var A={s:u,e:m,w:x,ixfe:o,flags:S};return(n.biff>=5||!n.biff)&&(A.level=S>>8&7),A}function lL(e,r){var n={};return r<32||(e.l+=16,n.header=_i(e),n.footer=_i(e),e.l+=2),n}function cL(e,r,n){var l={area:!1};if(n.biff!=5)return e.l+=r,l;var u=e.read_shift(1);return e.l+=3,u&16&&(l.area=!0),l}var uL=Ws,hL=zk,fL=rp;function dL(e){var r=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(4),u={fmt:r,env:n,len:l,data:e.slice(e.l,e.l+l)};return e.l+=l,u}function pL(e,r,n){n.biffguess&&n.biff==5&&(n.biff=2);var l=Ws(e);++e.l;var u=Nc(e,r-7,n);return l.t="str",l.val=u,l}function mL(e){var r=Ws(e);++e.l;var n=_i(e);return r.t="n",r.val=n,r}function _L(e){var r=Ws(e);++e.l;var n=e.read_shift(2);return r.t="n",r.val=n,r}function gL(e){var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,"sbcs-cont")}function xL(e,r){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=r-13}function yL(e,r,n){var l=e.l+r,u=Ws(e),m=e.read_shift(2),x=Mc(e,m,n);return e.l=l,u.t="str",u.val=x,u}var vL=[2,3,48,49,131,139,140,245],uE=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Fy({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(o,S){var A=[],I=bl(1);switch(S.type){case"base64":I=ls(ba(o));break;case"binary":I=ls(o);break;case"buffer":case"array":I=o;break}Jn(I,0);var D=I.read_shift(1),L=!!(D&136),B=!1,U=!1;switch(D){case 2:break;case 3:break;case 48:B=!0,L=!0;break;case 49:B=!0,L=!0;break;case 131:break;case 139:break;case 140:U=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+D.toString(16))}var V=0,Y=521;D==2&&(V=I.read_shift(2)),I.l+=3,D!=2&&(V=I.read_shift(4)),V>1048576&&(V=1e6),D!=2&&(Y=I.read_shift(2));var X=I.read_shift(2),K=S.codepage||1252;D!=2&&(I.l+=16,I.read_shift(1),I[I.l]!==0&&(K=e[I[I.l]]),I.l+=1,I.l+=2),U&&(I.l+=36);for(var G=[],me={},Ae=Math.min(I.length,D==2?521:Y-10-(B?264:0)),ge=U?32:11;I.l<Ae&&I[I.l]!=13;)switch(me={},me.name=ol.utils.decode(K,I.slice(I.l,I.l+ge)).replace(/[\u0000\r\n].*$/g,""),I.l+=ge,me.type=String.fromCharCode(I.read_shift(1)),D!=2&&!U&&(me.offset=I.read_shift(4)),me.len=I.read_shift(1),D==2&&(me.offset=I.read_shift(2)),me.dec=I.read_shift(1),me.name.length&&G.push(me),D!=2&&(I.l+=U?13:14),me.type){case"B":(!B||me.len!=8)&&S.WTF&&console.log("Skipping "+me.name+":"+me.type);break;case"G":case"P":S.WTF&&console.log("Skipping "+me.name+":"+me.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+me.type)}if(I[I.l]!==13&&(I.l=Y-1),I.read_shift(1)!==13)throw new Error("DBF Terminator not found "+I.l+" "+I[I.l]);I.l=Y;var se=0,ke=0;for(A[0]=[],ke=0;ke!=G.length;++ke)A[0][ke]=G[ke].name;for(;V-- >0;){if(I[I.l]===42){I.l+=X;continue}for(++I.l,A[++se]=[],ke=0,ke=0;ke!=G.length;++ke){var Ie=I.slice(I.l,I.l+G[ke].len);I.l+=G[ke].len,Jn(Ie,0);var Xe=ol.utils.decode(K,Ie);switch(G[ke].type){case"C":Xe.trim().length&&(A[se][ke]=Xe.replace(/\s+$/,""));break;case"D":Xe.length===8?A[se][ke]=new Date(+Xe.slice(0,4),+Xe.slice(4,6)-1,+Xe.slice(6,8)):A[se][ke]=Xe;break;case"F":A[se][ke]=parseFloat(Xe.trim());break;case"+":case"I":A[se][ke]=U?Ie.read_shift(-4,"i")^2147483648:Ie.read_shift(4,"i");break;case"L":switch(Xe.trim().toUpperCase()){case"Y":case"T":A[se][ke]=!0;break;case"N":case"F":A[se][ke]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Xe+"|")}break;case"M":if(!L)throw new Error("DBF Unexpected MEMO for type "+D.toString(16));A[se][ke]="##MEMO##"+(U?parseInt(Xe.trim(),10):Ie.read_shift(4));break;case"N":Xe=Xe.replace(/\u0000/g,"").trim(),Xe&&Xe!="."&&(A[se][ke]=+Xe||0);break;case"@":A[se][ke]=new Date(Ie.read_shift(-8,"f")-621356832e5);break;case"T":A[se][ke]=new Date((Ie.read_shift(4)-2440588)*864e5+Ie.read_shift(4));break;case"Y":A[se][ke]=Ie.read_shift(4,"i")/1e4+Ie.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":A[se][ke]=-Ie.read_shift(-8,"f");break;case"B":if(B&&G[ke].len==8){A[se][ke]=Ie.read_shift(8,"f");break}case"G":case"P":Ie.l+=G[ke].len;break;case"0":if(G[ke].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+G[ke].type)}}}if(D!=2&&I.l<I.length&&I[I.l++]!=26)throw new Error("DBF EOF Marker missing "+(I.l-1)+" of "+I.length+" "+I[I.l-1].toString(16));return S&&S.sheetRows&&(A=A.slice(0,S.sheetRows)),S.DBF=G,A}function l(o,S){var A=S||{};A.dateNF||(A.dateNF="yyyymmdd");var I=Eh(n(o,A),A);return I["!cols"]=A.DBF.map(function(D){return{wch:D.len,DBF:D}}),delete A.DBF,I}function u(o,S){try{return Il(l(o,S),S)}catch(A){if(S&&S.WTF)throw A}return{SheetNames:[],Sheets:{}}}var m={B:8,C:250,L:1,D:8,"?":0,"":0};function x(o,S){var A=S||{};if(+A.codepage>=0&&cs(+A.codepage),A.type=="string")throw new Error("Cannot write DBF to JS string");var I=T1(),D=F1(o,{header:1,raw:!0,cellDates:!0}),L=D[0],B=D.slice(1),U=o["!cols"]||[],V=0,Y=0,X=0,K=1;for(V=0;V<L.length;++V){if(((U[V]||{}).DBF||{}).name){L[V]=U[V].DBF.name,++X;continue}if(L[V]!=null){if(++X,typeof L[V]=="number"&&(L[V]=L[V].toString(10)),typeof L[V]!="string")throw new Error("DBF Invalid column name "+L[V]+" |"+typeof L[V]+"|");if(L.indexOf(L[V])!==V){for(Y=0;Y<1024;++Y)if(L.indexOf(L[V]+"_"+Y)==-1){L[V]+="_"+Y;break}}}}var G=wn(o["!ref"]),me=[],Ae=[],ge=[];for(V=0;V<=G.e.c-G.s.c;++V){var se="",ke="",Ie=0,Xe=[];for(Y=0;Y<B.length;++Y)B[Y][V]!=null&&Xe.push(B[Y][V]);if(Xe.length==0||L[V]==null){me[V]="?";continue}for(Y=0;Y<Xe.length;++Y){switch(typeof Xe[Y]){case"number":ke="B";break;case"string":ke="C";break;case"boolean":ke="L";break;case"object":ke=Xe[Y]instanceof Date?"D":"C";break;default:ke="C"}Ie=Math.max(Ie,String(Xe[Y]).length),se=se&&se!=ke?"C":ke}Ie>250&&(Ie=250),ke=((U[V]||{}).DBF||{}).type,ke=="C"&&U[V].DBF.len>Ie&&(Ie=U[V].DBF.len),se=="B"&&ke=="N"&&(se="N",ge[V]=U[V].DBF.dec,Ie=U[V].DBF.len),Ae[V]=se=="C"||ke=="N"?Ie:m[se]||0,K+=Ae[V],me[V]=se}var $e=I.next(32);for($e.write_shift(4,318902576),$e.write_shift(4,B.length),$e.write_shift(2,296+32*X),$e.write_shift(2,K),V=0;V<4;++V)$e.write_shift(4,0);for($e.write_shift(4,0|(+r[VS]||3)<<8),V=0,Y=0;V<L.length;++V)if(L[V]!=null){var We=I.next(32),dt=(L[V].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);We.write_shift(1,dt,"sbcs"),We.write_shift(1,me[V]=="?"?"C":me[V],"sbcs"),We.write_shift(4,Y),We.write_shift(1,Ae[V]||m[me[V]]||0),We.write_shift(1,ge[V]||0),We.write_shift(1,2),We.write_shift(4,0),We.write_shift(1,0),We.write_shift(4,0),We.write_shift(4,0),Y+=Ae[V]||m[me[V]]||0}var Ut=I.next(264);for(Ut.write_shift(4,13),V=0;V<65;++V)Ut.write_shift(4,0);for(V=0;V<B.length;++V){var kt=I.next(K);for(kt.write_shift(1,0),Y=0;Y<L.length;++Y)if(L[Y]!=null)switch(me[Y]){case"L":kt.write_shift(1,B[V][Y]==null?63:B[V][Y]?84:70);break;case"B":kt.write_shift(8,B[V][Y]||0,"f");break;case"N":var Bt="0";for(typeof B[V][Y]=="number"&&(Bt=B[V][Y].toFixed(ge[Y]||0)),X=0;X<Ae[Y]-Bt.length;++X)kt.write_shift(1,32);kt.write_shift(1,Bt,"sbcs");break;case"D":B[V][Y]?(kt.write_shift(4,("0000"+B[V][Y].getFullYear()).slice(-4),"sbcs"),kt.write_shift(2,("00"+(B[V][Y].getMonth()+1)).slice(-2),"sbcs"),kt.write_shift(2,("00"+B[V][Y].getDate()).slice(-2),"sbcs")):kt.write_shift(8,"00000000","sbcs");break;case"C":var zt=String(B[V][Y]!=null?B[V][Y]:"").slice(0,Ae[Y]);for(kt.write_shift(1,zt,"sbcs"),X=0;X<Ae[Y]-zt.length;++X)kt.write_shift(1,32);break}}return I.next(1).write_shift(1,26),I.end()}return{to_workbook:u,to_sheet:l,from_sheet:x}}(),wL=function(){var e={AA:"\xC0",BA:"\xC1",CA:"\xC2",DA:195,HA:"\xC4",JA:197,AE:"\xC8",BE:"\xC9",CE:"\xCA",HE:"\xCB",AI:"\xCC",BI:"\xCD",CI:"\xCE",HI:"\xCF",AO:"\xD2",BO:"\xD3",CO:"\xD4",DO:213,HO:"\xD6",AU:"\xD9",BU:"\xDA",CU:"\xDB",HU:"\xDC",Aa:"\xE0",Ba:"\xE1",Ca:"\xE2",Da:227,Ha:"\xE4",Ja:229,Ae:"\xE8",Be:"\xE9",Ce:"\xEA",He:"\xEB",Ai:"\xEC",Bi:"\xED",Ci:"\xEE",Hi:"\xEF",Ao:"\xF2",Bo:"\xF3",Co:"\xF4",Do:245,Ho:"\xF6",Au:"\xF9",Bu:"\xFA",Cu:"\xFB",Hu:"\xFC",KC:"\xC7",Kc:"\xE7",q:"\xE6",z:"\u0153",a:"\xC6",j:"\u0152",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+js(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(L,B){var U=e[B];return typeof U=="number"?kT(U):U},l=function(L,B,U){var V=B.charCodeAt(0)-32<<4|U.charCodeAt(0)-48;return V==59?L:kT(V)};e["|"]=254;function u(L,B){switch(B.type){case"base64":return m(ba(L),B);case"binary":return m(L,B);case"buffer":return m(vr&&Buffer.isBuffer(L)?L.toString("binary"):Rc(L),B);case"array":return m(Ic(L),B)}throw new Error("Unrecognized type "+B.type)}function m(L,B){var U=L.split(/[\n\r]+/),V=-1,Y=-1,X=0,K=0,G=[],me=[],Ae=null,ge={},se=[],ke=[],Ie=[],Xe=0,$e;for(+B.codepage>=0&&cs(+B.codepage);X!==U.length;++X){Xe=0;var We=U[X].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,l).replace(r,n),dt=We.replace(/;;/g,"\0").split(";").map(function(Oe){return Oe.replace(/\u0000/g,";")}),Ut=dt[0],kt;if(We.length>0)switch(Ut){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":dt[1].charAt(0)=="P"&&me.push(We.slice(3).replace(/;;/g,";"));break;case"C":var Bt=!1,zt=!1,gt=!1,Be=!1,Tt=-1,Dt=-1;for(K=1;K<dt.length;++K)switch(dt[K].charAt(0)){case"A":break;case"X":Y=parseInt(dt[K].slice(1))-1,zt=!0;break;case"Y":for(V=parseInt(dt[K].slice(1))-1,zt||(Y=0),$e=G.length;$e<=V;++$e)G[$e]=[];break;case"K":kt=dt[K].slice(1),kt.charAt(0)==='"'?kt=kt.slice(1,kt.length-1):kt==="TRUE"?kt=!0:kt==="FALSE"?kt=!1:isNaN(fs(kt))?isNaN(mh(kt).getDate())||(kt=Kn(kt)):(kt=fs(kt),Ae!==null&&wh(Ae)&&(kt=v_(kt))),Bt=!0;break;case"E":Be=!0;var Ee=ah(dt[K].slice(1),{r:V,c:Y});G[V][Y]=[G[V][Y],Ee];break;case"S":gt=!0,G[V][Y]=[G[V][Y],"S5S"];break;case"G":break;case"R":Tt=parseInt(dt[K].slice(1))-1;break;case"C":Dt=parseInt(dt[K].slice(1))-1;break;default:if(B&&B.WTF)throw new Error("SYLK bad record "+We)}if(Bt&&(G[V][Y]&&G[V][Y].length==2?G[V][Y][0]=kt:G[V][Y]=kt,Ae=null),gt){if(Be)throw new Error("SYLK shared formula cannot have own formula");var He=Tt>-1&&G[Tt][Dt];if(!He||!He[1])throw new Error("SYLK shared formula cannot find base");G[V][Y][1]=Qk(He[1],{r:V-Tt,c:Y-Dt})}break;case"F":var Re=0;for(K=1;K<dt.length;++K)switch(dt[K].charAt(0)){case"X":Y=parseInt(dt[K].slice(1))-1,++Re;break;case"Y":for(V=parseInt(dt[K].slice(1))-1,$e=G.length;$e<=V;++$e)G[$e]=[];break;case"M":Xe=parseInt(dt[K].slice(1))/20;break;case"F":break;case"G":break;case"P":Ae=me[parseInt(dt[K].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(Ie=dt[K].slice(1).split(" "),$e=parseInt(Ie[0],10);$e<=parseInt(Ie[1],10);++$e)Xe=parseInt(Ie[2],10),ke[$e-1]=Xe===0?{hidden:!0}:{wch:Xe},_h(ke[$e-1]);break;case"C":Y=parseInt(dt[K].slice(1))-1,ke[Y]||(ke[Y]={});break;case"R":V=parseInt(dt[K].slice(1))-1,se[V]||(se[V]={}),Xe>0?(se[V].hpt=Xe,se[V].hpx=Zd(Xe)):Xe===0&&(se[V].hidden=!0);break;default:if(B&&B.WTF)throw new Error("SYLK bad record "+We)}Re<1&&(Ae=null);break;default:if(B&&B.WTF)throw new Error("SYLK bad record "+We)}}return se.length>0&&(ge["!rows"]=se),ke.length>0&&(ge["!cols"]=ke),B&&B.sheetRows&&(G=G.slice(0,B.sheetRows)),[G,ge]}function x(L,B){var U=u(L,B),V=U[0],Y=U[1],X=Eh(V,B);return js(Y).forEach(function(K){X[K]=Y[K]}),X}function o(L,B){return Il(x(L,B),B)}function S(L,B,U,V){var Y="C;Y"+(U+1)+";X"+(V+1)+";K";switch(L.t){case"n":Y+=L.v||0,L.f&&!L.F&&(Y+=";E"+o5(L.f,{r:U,c:V}));break;case"b":Y+=L.v?"TRUE":"FALSE";break;case"e":Y+=L.w||L.v;break;case"d":Y+='"'+(L.w||L.v)+'"';break;case"s":Y+='"'+L.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return Y}function A(L,B){B.forEach(function(U,V){var Y="F;W"+(V+1)+" "+(V+1)+" ";U.hidden?Y+="0":(typeof U.width=="number"&&!U.wpx&&(U.wpx=Ym(U.width)),typeof U.wpx=="number"&&!U.wch&&(U.wch=Jm(U.wpx)),typeof U.wch=="number"&&(Y+=Math.round(U.wch))),Y.charAt(Y.length-1)!=" "&&L.push(Y)})}function I(L,B){B.forEach(function(U,V){var Y="F;";U.hidden?Y+="M0;":U.hpt?Y+="M"+20*U.hpt+";":U.hpx&&(Y+="M"+20*Kk(U.hpx)+";"),Y.length>2&&L.push(Y+"R"+(V+1))})}function D(L,B){var U=["ID;PWXL;N;E"],V=[],Y=wn(L["!ref"]),X,K=Array.isArray(L),G=`\r
`;U.push("P;PGeneral"),U.push("F;P0;DG0G8;M255"),L["!cols"]&&A(U,L["!cols"]),L["!rows"]&&I(U,L["!rows"]),U.push("B;Y"+(Y.e.r-Y.s.r+1)+";X"+(Y.e.c-Y.s.c+1)+";D"+[Y.s.c,Y.s.r,Y.e.c,Y.e.r].join(" "));for(var me=Y.s.r;me<=Y.e.r;++me)for(var Ae=Y.s.c;Ae<=Y.e.c;++Ae){var ge=lr({r:me,c:Ae});X=K?(L[me]||[])[Ae]:L[ge],!(!X||X.v==null&&(!X.f||X.F))&&V.push(S(X,L,me,Ae))}return U.join(G)+G+V.join(G)+G+"E"+G}return{to_workbook:o,to_sheet:x,from_sheet:D}}(),TL=function(){function e(m,x){switch(x.type){case"base64":return r(ba(m),x);case"binary":return r(m,x);case"buffer":return r(vr&&Buffer.isBuffer(m)?m.toString("binary"):Rc(m),x);case"array":return r(Ic(m),x)}throw new Error("Unrecognized type "+x.type)}function r(m,x){for(var o=m.split(`
`),S=-1,A=-1,I=0,D=[];I!==o.length;++I){if(o[I].trim()==="BOT"){D[++S]=[],A=0;continue}if(!(S<0)){var L=o[I].trim().split(","),B=L[0],U=L[1];++I;for(var V=o[I]||"";(V.match(/["]/g)||[]).length&1&&I<o.length-1;)V+=`
`+o[++I];switch(V=V.trim(),+B){case-1:if(V==="BOT"){D[++S]=[],A=0;continue}else if(V!=="EOD")throw new Error("Unrecognized DIF special command "+V);break;case 0:V==="TRUE"?D[S][A]=!0:V==="FALSE"?D[S][A]=!1:isNaN(fs(U))?isNaN(mh(U).getDate())?D[S][A]=U:D[S][A]=Kn(U):D[S][A]=fs(U),++A;break;case 1:V=V.slice(1,V.length-1),V=V.replace(/""/g,'"'),V&&V.match(/^=".*"$/)&&(V=V.slice(2,-1)),D[S][A++]=V!==""?V:null;break}if(V==="EOD")break}}return x&&x.sheetRows&&(D=D.slice(0,x.sheetRows)),D}function n(m,x){return Eh(e(m,x),x)}function l(m,x){return Il(n(m,x),x)}var u=function(){var m=function(S,A,I,D,L){S.push(A),S.push(I+","+D),S.push('"'+L.replace(/"/g,'""')+'"')},x=function(S,A,I,D){S.push(A+","+I),S.push(A==1?'"'+D.replace(/"/g,'""')+'"':D)};return function(S){var A=[],I=wn(S["!ref"]),D,L=Array.isArray(S);m(A,"TABLE",0,1,"sheetjs"),m(A,"VECTORS",0,I.e.r-I.s.r+1,""),m(A,"TUPLES",0,I.e.c-I.s.c+1,""),m(A,"DATA",0,0,"");for(var B=I.s.r;B<=I.e.r;++B){x(A,-1,0,"BOT");for(var U=I.s.c;U<=I.e.c;++U){var V=lr({r:B,c:U});if(D=L?(S[B]||[])[U]:S[V],!D){x(A,1,0,"");continue}switch(D.t){case"n":var Y=D.w;!Y&&D.v!=null&&(Y=D.v),Y==null?D.f&&!D.F?x(A,1,0,"="+D.f):x(A,1,0,""):x(A,0,Y,"V");break;case"b":x(A,0,D.v?1:0,D.v?"TRUE":"FALSE");break;case"s":x(A,1,0,isNaN(D.v)?D.v:'="'+D.v+'"');break;case"d":D.w||(D.w=Wa(D.z||hr[14],ji(Kn(D.v)))),x(A,0,D.w,"V");break;default:x(A,1,0,"")}}}x(A,-1,0,"EOD");var X=`\r
`,K=A.join(X);return K}}();return{to_workbook:l,to_sheet:n,from_sheet:u}}(),EL=function(){function e(D){return D.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(D){return D.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(D,L){for(var B=D.split(`
`),U=-1,V=-1,Y=0,X=[];Y!==B.length;++Y){var K=B[Y].trim().split(":");if(K[0]==="cell"){var G=Ni(K[1]);if(X.length<=G.r)for(U=X.length;U<=G.r;++U)X[U]||(X[U]=[]);switch(U=G.r,V=G.c,K[2]){case"t":X[U][V]=e(K[3]);break;case"v":X[U][V]=+K[3];break;case"vtf":var me=K[K.length-1];case"vtc":switch(K[3]){case"nl":X[U][V]=!!+K[4];break;default:X[U][V]=+K[4];break}K[2]=="vtf"&&(X[U][V]=[X[U][V],me])}}}return L&&L.sheetRows&&(X=X.slice(0,L.sheetRows)),X}function l(D,L){return Eh(n(D,L),L)}function u(D,L){return Il(l(D,L),L)}var m=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),x=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),S="--SocialCalcSpreadsheetControlSave--";function A(D){if(!D||!D["!ref"])return"";for(var L=[],B=[],U,V="",Y=Th(D["!ref"]),X=Array.isArray(D),K=Y.s.r;K<=Y.e.r;++K)for(var G=Y.s.c;G<=Y.e.c;++G)if(V=lr({r:K,c:G}),U=X?(D[K]||[])[G]:D[V],!(!U||U.v==null||U.t==="z")){switch(B=["cell",V,"t"],U.t){case"s":case"str":B.push(r(U.v));break;case"n":U.f?(B[2]="vtf",B[3]="n",B[4]=U.v,B[5]=r(U.f)):(B[2]="v",B[3]=U.v);break;case"b":B[2]="vt"+(U.f?"f":"c"),B[3]="nl",B[4]=U.v?"1":"0",B[5]=r(U.f||(U.v?"TRUE":"FALSE"));break;case"d":var me=ji(Kn(U.v));B[2]="vtc",B[3]="nd",B[4]=""+me,B[5]=U.w||Wa(U.z||hr[14],me);break;case"e":continue}L.push(B.join(":"))}return L.push("sheet:c:"+(Y.e.c-Y.s.c+1)+":r:"+(Y.e.r-Y.s.r+1)+":tvf:1"),L.push("valueformat:1:text-wiki"),L.join(`
`)}function I(D){return[m,x,o,x,A(D),S].join(`
`)}return{to_workbook:u,to_sheet:l,from_sheet:I}}(),$d=function(){function e(I,D,L,B,U){U.raw?D[L][B]=I:I===""||(I==="TRUE"?D[L][B]=!0:I==="FALSE"?D[L][B]=!1:isNaN(fs(I))?isNaN(mh(I).getDate())?D[L][B]=I:D[L][B]=Kn(I):D[L][B]=fs(I))}function r(I,D){var L=D||{},B=[];if(!I||I.length===0)return B;for(var U=I.split(/[\r\n]/),V=U.length-1;V>=0&&U[V].length===0;)--V;for(var Y=10,X=0,K=0;K<=V;++K)X=U[K].indexOf(" "),X==-1?X=U[K].length:X++,Y=Math.max(Y,X);for(K=0;K<=V;++K){B[K]=[];var G=0;for(e(U[K].slice(0,Y).trim(),B,K,G,L),G=1;G<=(U[K].length-Y)/10+1;++G)e(U[K].slice(Y+(G-1)*10,Y+G*10).trim(),B,K,G,L)}return L.sheetRows&&(B=B.slice(0,L.sheetRows)),B}var n={44:",",9:"	",59:";",124:"|"},l={44:3,9:2,59:1,124:0};function u(I){for(var D={},L=!1,B=0,U=0;B<I.length;++B)(U=I.charCodeAt(B))==34?L=!L:!L&&U in n&&(D[U]=(D[U]||0)+1);U=[];for(B in D)Object.prototype.hasOwnProperty.call(D,B)&&U.push([D[B],B]);if(!U.length){D=l;for(B in D)Object.prototype.hasOwnProperty.call(D,B)&&U.push([D[B],B])}return U.sort(function(V,Y){return V[0]-Y[0]||l[V[1]]-l[Y[1]]}),n[U.pop()[1]]||44}function m(I,D){var L=D||{},B="",U=L.dense?[]:{},V={s:{c:0,r:0},e:{c:0,r:0}};I.slice(0,4)=="sep="?I.charCodeAt(5)==13&&I.charCodeAt(6)==10?(B=I.charAt(4),I=I.slice(7)):I.charCodeAt(5)==13||I.charCodeAt(5)==10?(B=I.charAt(4),I=I.slice(6)):B=u(I.slice(0,1024)):L&&L.FS?B=L.FS:B=u(I.slice(0,1024));var Y=0,X=0,K=0,G=0,me=0,Ae=B.charCodeAt(0),ge=!1,se=0,ke=I.charCodeAt(0);I=I.replace(/\r\n/mg,`
`);var Ie=L.dateNF!=null?RD(L.dateNF):null;function Xe(){var $e=I.slice(G,me),We={};if($e.charAt(0)=='"'&&$e.charAt($e.length-1)=='"'&&($e=$e.slice(1,-1).replace(/""/g,'"')),$e.length===0)We.t="z";else if(L.raw)We.t="s",We.v=$e;else if($e.trim().length===0)We.t="s",We.v=$e;else if($e.charCodeAt(0)==61)$e.charCodeAt(1)==34&&$e.charCodeAt($e.length-1)==34?(We.t="s",We.v=$e.slice(2,-1).replace(/""/g,'"')):c5($e)?(We.t="n",We.f=$e.slice(1)):(We.t="s",We.v=$e);else if($e=="TRUE")We.t="b",We.v=!0;else if($e=="FALSE")We.t="b",We.v=!1;else if(!isNaN(K=fs($e)))We.t="n",L.cellText!==!1&&(We.w=$e),We.v=K;else if(!isNaN(mh($e).getDate())||Ie&&$e.match(Ie)){We.z=L.dateNF||hr[14];var dt=0;Ie&&$e.match(Ie)&&($e=zD($e,L.dateNF,$e.match(Ie)||[]),dt=1),L.cellDates?(We.t="d",We.v=Kn($e,dt)):(We.t="n",We.v=ji(Kn($e,dt))),L.cellText!==!1&&(We.w=Wa(We.z,We.v instanceof Date?ji(We.v):We.v)),L.cellNF||delete We.z}else We.t="s",We.v=$e;if(We.t=="z"||(L.dense?(U[Y]||(U[Y]=[]),U[Y][X]=We):U[lr({c:X,r:Y})]=We),G=me+1,ke=I.charCodeAt(G),V.e.c<X&&(V.e.c=X),V.e.r<Y&&(V.e.r=Y),se==Ae)++X;else if(X=0,++Y,L.sheetRows&&L.sheetRows<=Y)return!0}e:for(;me<I.length;++me)switch(se=I.charCodeAt(me)){case 34:ke===34&&(ge=!ge);break;case Ae:case 10:case 13:if(!ge&&Xe())break e;break}return me-G>0&&Xe(),U["!ref"]=br(V),U}function x(I,D){return!(D&&D.PRN)||D.FS||I.slice(0,4)=="sep="||I.indexOf("	")>=0||I.indexOf(",")>=0||I.indexOf(";")>=0?m(I,D):Eh(r(I,D),D)}function o(I,D){var L="",B=D.type=="string"?[0,0,0,0]:Yy(I,D);switch(D.type){case"base64":L=ba(I);break;case"binary":L=I;break;case"buffer":D.codepage==65001?L=I.toString("utf8"):D.codepage&&typeof ol!="undefined"?L=ol.utils.decode(D.codepage,I):L=vr&&Buffer.isBuffer(I)?I.toString("binary"):Rc(I);break;case"array":L=Ic(I);break;case"string":L=I;break;default:throw new Error("Unrecognized type "+D.type)}return B[0]==239&&B[1]==187&&B[2]==191?L=Hr(L.slice(3)):D.type!="string"&&D.type!="buffer"&&D.codepage==65001?L=Hr(L):D.type=="binary"&&typeof ol!="undefined"&&D.codepage&&(L=ol.utils.decode(D.codepage,ol.utils.encode(28591,L))),L.slice(0,19)=="socialcalc:version:"?EL.to_sheet(D.type=="string"?L:Hr(L),D):x(L,D)}function S(I,D){return Il(o(I,D),D)}function A(I){for(var D=[],L=wn(I["!ref"]),B,U=Array.isArray(I),V=L.s.r;V<=L.e.r;++V){for(var Y=[],X=L.s.c;X<=L.e.c;++X){var K=lr({r:V,c:X});if(B=U?(I[V]||[])[X]:I[K],!B||B.v==null){Y.push("          ");continue}for(var G=(B.w||(Eo(B),B.w)||"").slice(0,10);G.length<10;)G+=" ";Y.push(G+(X===0?" ":""))}D.push(Y.join(""))}return D.join(`
`)}return{to_workbook:S,to_sheet:o,from_sheet:A}}();function bL(e,r){var n=r||{},l=!!n.WTF;n.WTF=!0;try{var u=wL.to_workbook(e,n);return n.WTF=l,u}catch(m){if(n.WTF=l,!m.message.match(/SYLK bad record ID/)&&l)throw m;return $d.to_workbook(e,r)}}var yd=function(){function e(Ee,He,Re){if(!!Ee){Jn(Ee,Ee.l||0);for(var Oe=Re.Enum||Tt;Ee.l<Ee.length;){var at=Ee.read_shift(2),bt=Oe[at]||Oe[65535],Ot=Ee.read_shift(2),At=Ee.l+Ot,yt=bt.f&&bt.f(Ee,Ot,Re);if(Ee.l=At,He(yt,bt,at))return}}}function r(Ee,He){switch(He.type){case"base64":return n(ls(ba(Ee)),He);case"binary":return n(ls(Ee),He);case"buffer":case"array":return n(Ee,He)}throw"Unsupported type "+He.type}function n(Ee,He){if(!Ee)return Ee;var Re=He||{},Oe=Re.dense?[]:{},at="Sheet1",bt="",Ot=0,At={},yt=[],ar=[],ve={s:{r:0,c:0},e:{r:0,c:0}},Cr=Re.sheetRows||0;if(Ee[2]==0&&(Ee[3]==8||Ee[3]==9)&&Ee.length>=16&&Ee[14]==5&&Ee[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Ee[2]==2)Re.Enum=Tt,e(Ee,function(ut,Ir,hn){switch(hn){case 0:Re.vers=ut,ut>=4096&&(Re.qpro=!0);break;case 6:ve=ut;break;case 204:ut&&(bt=ut);break;case 222:bt=ut;break;case 15:case 51:Re.qpro||(ut[1].v=ut[1].v.slice(1));case 13:case 14:case 16:hn==14&&(ut[2]&112)==112&&(ut[2]&15)>1&&(ut[2]&15)<15&&(ut[1].z=Re.dateNF||hr[14],Re.cellDates&&(ut[1].t="d",ut[1].v=v_(ut[1].v))),Re.qpro&&ut[3]>Ot&&(Oe["!ref"]=br(ve),At[at]=Oe,yt.push(at),Oe=Re.dense?[]:{},ve={s:{r:0,c:0},e:{r:0,c:0}},Ot=ut[3],at=bt||"Sheet"+(Ot+1),bt="");var Xr=Re.dense?(Oe[ut[0].r]||[])[ut[0].c]:Oe[lr(ut[0])];if(Xr){Xr.t=ut[1].t,Xr.v=ut[1].v,ut[1].z!=null&&(Xr.z=ut[1].z),ut[1].f!=null&&(Xr.f=ut[1].f);break}Re.dense?(Oe[ut[0].r]||(Oe[ut[0].r]=[]),Oe[ut[0].r][ut[0].c]=ut[1]):Oe[lr(ut[0])]=ut[1];break}},Re);else if(Ee[2]==26||Ee[2]==14)Re.Enum=Dt,Ee[2]==14&&(Re.qpro=!0,Ee.l=0),e(Ee,function(ut,Ir,hn){switch(hn){case 204:at=ut;break;case 22:ut[1].v=ut[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ut[3]>Ot&&(Oe["!ref"]=br(ve),At[at]=Oe,yt.push(at),Oe=Re.dense?[]:{},ve={s:{r:0,c:0},e:{r:0,c:0}},Ot=ut[3],at="Sheet"+(Ot+1)),Cr>0&&ut[0].r>=Cr)break;Re.dense?(Oe[ut[0].r]||(Oe[ut[0].r]=[]),Oe[ut[0].r][ut[0].c]=ut[1]):Oe[lr(ut[0])]=ut[1],ve.e.c<ut[0].c&&(ve.e.c=ut[0].c),ve.e.r<ut[0].r&&(ve.e.r=ut[0].r);break;case 27:ut[14e3]&&(ar[ut[14e3][0]]=ut[14e3][1]);break;case 1537:ar[ut[0]]=ut[1],ut[0]==Ot&&(at=ut[1]);break}},Re);else throw new Error("Unrecognized LOTUS BOF "+Ee[2]);if(Oe["!ref"]=br(ve),At[bt||at]=Oe,yt.push(bt||at),!ar.length)return{SheetNames:yt,Sheets:At};for(var dr={},or=[],ir=0;ir<ar.length;++ir)At[yt[ir]]?(or.push(ar[ir]||yt[ir]),dr[ar[ir]]=At[ar[ir]]||At[yt[ir]]):(or.push(ar[ir]),dr[ar[ir]]={"!ref":"A1"});return{SheetNames:or,Sheets:dr}}function l(Ee,He){var Re=He||{};if(+Re.codepage>=0&&cs(+Re.codepage),Re.type=="string")throw new Error("Cannot write WK1 to JS string");var Oe=T1(),at=wn(Ee["!ref"]),bt=Array.isArray(Ee),Ot=[];as(Oe,0,m(1030)),as(Oe,6,S(at));for(var At=Math.min(at.e.r,8191),yt=at.s.r;yt<=At;++yt)for(var ar=ti(yt),ve=at.s.c;ve<=at.e.c;++ve){yt===at.s.r&&(Ot[ve]=jn(ve));var Cr=Ot[ve]+ar,dr=bt?(Ee[yt]||[])[ve]:Ee[Cr];if(!(!dr||dr.t=="z"))if(dr.t=="n")(dr.v|0)==dr.v&&dr.v>=-32768&&dr.v<=32767?as(Oe,13,B(yt,ve,dr.v)):as(Oe,14,V(yt,ve,dr.v));else{var or=Eo(dr);as(Oe,15,D(yt,ve,or.slice(0,239)))}}return as(Oe,1),Oe.end()}function u(Ee,He){var Re=He||{};if(+Re.codepage>=0&&cs(+Re.codepage),Re.type=="string")throw new Error("Cannot write WK3 to JS string");var Oe=T1();as(Oe,0,x(Ee));for(var at=0,bt=0;at<Ee.SheetNames.length;++at)(Ee.Sheets[Ee.SheetNames[at]]||{})["!ref"]&&as(Oe,27,Be(Ee.SheetNames[at],bt++));var Ot=0;for(at=0;at<Ee.SheetNames.length;++at){var At=Ee.Sheets[Ee.SheetNames[at]];if(!(!At||!At["!ref"])){for(var yt=wn(At["!ref"]),ar=Array.isArray(At),ve=[],Cr=Math.min(yt.e.r,8191),dr=yt.s.r;dr<=Cr;++dr)for(var or=ti(dr),ir=yt.s.c;ir<=yt.e.c;++ir){dr===yt.s.r&&(ve[ir]=jn(ir));var ut=ve[ir]+or,Ir=ar?(At[dr]||[])[ir]:At[ut];if(!(!Ir||Ir.t=="z"))if(Ir.t=="n")as(Oe,23,Xe(dr,ir,Ot,Ir.v));else{var hn=Eo(Ir);as(Oe,22,se(dr,ir,Ot,hn.slice(0,239)))}}++Ot}}return as(Oe,1),Oe.end()}function m(Ee){var He=Un(2);return He.write_shift(2,Ee),He}function x(Ee){var He=Un(26);He.write_shift(2,4096),He.write_shift(2,4),He.write_shift(4,0);for(var Re=0,Oe=0,at=0,bt=0;bt<Ee.SheetNames.length;++bt){var Ot=Ee.SheetNames[bt],At=Ee.Sheets[Ot];if(!(!At||!At["!ref"])){++at;var yt=Th(At["!ref"]);Re<yt.e.r&&(Re=yt.e.r),Oe<yt.e.c&&(Oe=yt.e.c)}}return Re>8191&&(Re=8191),He.write_shift(2,Re),He.write_shift(1,at),He.write_shift(1,Oe),He.write_shift(2,0),He.write_shift(2,0),He.write_shift(1,1),He.write_shift(1,2),He.write_shift(4,0),He.write_shift(4,0),He}function o(Ee,He,Re){var Oe={s:{c:0,r:0},e:{c:0,r:0}};return He==8&&Re.qpro?(Oe.s.c=Ee.read_shift(1),Ee.l++,Oe.s.r=Ee.read_shift(2),Oe.e.c=Ee.read_shift(1),Ee.l++,Oe.e.r=Ee.read_shift(2),Oe):(Oe.s.c=Ee.read_shift(2),Oe.s.r=Ee.read_shift(2),He==12&&Re.qpro&&(Ee.l+=2),Oe.e.c=Ee.read_shift(2),Oe.e.r=Ee.read_shift(2),He==12&&Re.qpro&&(Ee.l+=2),Oe.s.c==65535&&(Oe.s.c=Oe.e.c=Oe.s.r=Oe.e.r=0),Oe)}function S(Ee){var He=Un(8);return He.write_shift(2,Ee.s.c),He.write_shift(2,Ee.s.r),He.write_shift(2,Ee.e.c),He.write_shift(2,Ee.e.r),He}function A(Ee,He,Re){var Oe=[{c:0,r:0},{t:"n",v:0},0,0];return Re.qpro&&Re.vers!=20768?(Oe[0].c=Ee.read_shift(1),Oe[3]=Ee.read_shift(1),Oe[0].r=Ee.read_shift(2),Ee.l+=2):(Oe[2]=Ee.read_shift(1),Oe[0].c=Ee.read_shift(2),Oe[0].r=Ee.read_shift(2)),Oe}function I(Ee,He,Re){var Oe=Ee.l+He,at=A(Ee,He,Re);if(at[1].t="s",Re.vers==20768){Ee.l++;var bt=Ee.read_shift(1);return at[1].v=Ee.read_shift(bt,"utf8"),at}return Re.qpro&&Ee.l++,at[1].v=Ee.read_shift(Oe-Ee.l,"cstr"),at}function D(Ee,He,Re){var Oe=Un(7+Re.length);Oe.write_shift(1,255),Oe.write_shift(2,He),Oe.write_shift(2,Ee),Oe.write_shift(1,39);for(var at=0;at<Oe.length;++at){var bt=Re.charCodeAt(at);Oe.write_shift(1,bt>=128?95:bt)}return Oe.write_shift(1,0),Oe}function L(Ee,He,Re){var Oe=A(Ee,He,Re);return Oe[1].v=Ee.read_shift(2,"i"),Oe}function B(Ee,He,Re){var Oe=Un(7);return Oe.write_shift(1,255),Oe.write_shift(2,He),Oe.write_shift(2,Ee),Oe.write_shift(2,Re,"i"),Oe}function U(Ee,He,Re){var Oe=A(Ee,He,Re);return Oe[1].v=Ee.read_shift(8,"f"),Oe}function V(Ee,He,Re){var Oe=Un(13);return Oe.write_shift(1,255),Oe.write_shift(2,He),Oe.write_shift(2,Ee),Oe.write_shift(8,Re,"f"),Oe}function Y(Ee,He,Re){var Oe=Ee.l+He,at=A(Ee,He,Re);if(at[1].v=Ee.read_shift(8,"f"),Re.qpro)Ee.l=Oe;else{var bt=Ee.read_shift(2);me(Ee.slice(Ee.l,Ee.l+bt),at),Ee.l+=bt}return at}function X(Ee,He,Re){var Oe=He&32768;return He&=-32769,He=(Oe?Ee:0)+(He>=8192?He-16384:He),(Oe?"":"$")+(Re?jn(He):ti(He))}var K={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},G=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function me(Ee,He){Jn(Ee,0);for(var Re=[],Oe=0,at="",bt="",Ot="",At="";Ee.l<Ee.length;){var yt=Ee[Ee.l++];switch(yt){case 0:Re.push(Ee.read_shift(8,"f"));break;case 1:bt=X(He[0].c,Ee.read_shift(2),!0),at=X(He[0].r,Ee.read_shift(2),!1),Re.push(bt+at);break;case 2:{var ar=X(He[0].c,Ee.read_shift(2),!0),ve=X(He[0].r,Ee.read_shift(2),!1);bt=X(He[0].c,Ee.read_shift(2),!0),at=X(He[0].r,Ee.read_shift(2),!1),Re.push(ar+ve+":"+bt+at)}break;case 3:if(Ee.l<Ee.length){console.error("WK1 premature formula end");return}break;case 4:Re.push("("+Re.pop()+")");break;case 5:Re.push(Ee.read_shift(2));break;case 6:{for(var Cr="";yt=Ee[Ee.l++];)Cr+=String.fromCharCode(yt);Re.push('"'+Cr.replace(/"/g,'""')+'"')}break;case 8:Re.push("-"+Re.pop());break;case 23:Re.push("+"+Re.pop());break;case 22:Re.push("NOT("+Re.pop()+")");break;case 20:case 21:At=Re.pop(),Ot=Re.pop(),Re.push(["AND","OR"][yt-20]+"("+Ot+","+At+")");break;default:if(yt<32&&G[yt])At=Re.pop(),Ot=Re.pop(),Re.push(Ot+G[yt]+At);else if(K[yt]){if(Oe=K[yt][1],Oe==69&&(Oe=Ee[Ee.l++]),Oe>Re.length){console.error("WK1 bad formula parse 0x"+yt.toString(16)+":|"+Re.join("|")+"|");return}var dr=Re.slice(-Oe);Re.length-=Oe,Re.push(K[yt][0]+"("+dr.join(",")+")")}else return yt<=7?console.error("WK1 invalid opcode "+yt.toString(16)):yt<=24?console.error("WK1 unsupported op "+yt.toString(16)):yt<=30?console.error("WK1 invalid opcode "+yt.toString(16)):yt<=115?console.error("WK1 unsupported function opcode "+yt.toString(16)):console.error("WK1 unrecognized opcode "+yt.toString(16))}}Re.length==1?He[1].f=""+Re[0]:console.error("WK1 bad formula parse |"+Re.join("|")+"|")}function Ae(Ee){var He=[{c:0,r:0},{t:"n",v:0},0];return He[0].r=Ee.read_shift(2),He[3]=Ee[Ee.l++],He[0].c=Ee[Ee.l++],He}function ge(Ee,He){var Re=Ae(Ee);return Re[1].t="s",Re[1].v=Ee.read_shift(He-4,"cstr"),Re}function se(Ee,He,Re,Oe){var at=Un(6+Oe.length);at.write_shift(2,Ee),at.write_shift(1,Re),at.write_shift(1,He),at.write_shift(1,39);for(var bt=0;bt<Oe.length;++bt){var Ot=Oe.charCodeAt(bt);at.write_shift(1,Ot>=128?95:Ot)}return at.write_shift(1,0),at}function ke(Ee,He){var Re=Ae(Ee);Re[1].v=Ee.read_shift(2);var Oe=Re[1].v>>1;if(Re[1].v&1)switch(Oe&7){case 0:Oe=(Oe>>3)*5e3;break;case 1:Oe=(Oe>>3)*500;break;case 2:Oe=(Oe>>3)/20;break;case 3:Oe=(Oe>>3)/200;break;case 4:Oe=(Oe>>3)/2e3;break;case 5:Oe=(Oe>>3)/2e4;break;case 6:Oe=(Oe>>3)/16;break;case 7:Oe=(Oe>>3)/64;break}return Re[1].v=Oe,Re}function Ie(Ee,He){var Re=Ae(Ee),Oe=Ee.read_shift(4),at=Ee.read_shift(4),bt=Ee.read_shift(2);if(bt==65535)return Oe===0&&at===3221225472?(Re[1].t="e",Re[1].v=15):Oe===0&&at===3489660928?(Re[1].t="e",Re[1].v=42):Re[1].v=0,Re;var Ot=bt&32768;return bt=(bt&32767)-16446,Re[1].v=(1-Ot*2)*(at*Math.pow(2,bt+32)+Oe*Math.pow(2,bt)),Re}function Xe(Ee,He,Re,Oe){var at=Un(14);if(at.write_shift(2,Ee),at.write_shift(1,Re),at.write_shift(1,He),Oe==0)return at.write_shift(4,0),at.write_shift(4,0),at.write_shift(2,65535),at;var bt=0,Ot=0,At=0,yt=0;return Oe<0&&(bt=1,Oe=-Oe),Ot=Math.log2(Oe)|0,Oe/=Math.pow(2,Ot-31),yt=Oe>>>0,(yt&2147483648)==0&&(Oe/=2,++Ot,yt=Oe>>>0),Oe-=yt,yt|=2147483648,yt>>>=0,Oe*=Math.pow(2,32),At=Oe>>>0,at.write_shift(4,At),at.write_shift(4,yt),Ot+=16383+(bt?32768:0),at.write_shift(2,Ot),at}function $e(Ee,He){var Re=Ie(Ee);return Ee.l+=He-14,Re}function We(Ee,He){var Re=Ae(Ee),Oe=Ee.read_shift(4);return Re[1].v=Oe>>6,Re}function dt(Ee,He){var Re=Ae(Ee),Oe=Ee.read_shift(8,"f");return Re[1].v=Oe,Re}function Ut(Ee,He){var Re=dt(Ee);return Ee.l+=He-10,Re}function kt(Ee,He){return Ee[Ee.l+He-1]==0?Ee.read_shift(He,"cstr"):""}function Bt(Ee,He){var Re=Ee[Ee.l++];Re>He-1&&(Re=He-1);for(var Oe="";Oe.length<Re;)Oe+=String.fromCharCode(Ee[Ee.l++]);return Oe}function zt(Ee,He,Re){if(!(!Re.qpro||He<21)){var Oe=Ee.read_shift(1);Ee.l+=17,Ee.l+=1,Ee.l+=2;var at=Ee.read_shift(He-21,"cstr");return[Oe,at]}}function gt(Ee,He){for(var Re={},Oe=Ee.l+He;Ee.l<Oe;){var at=Ee.read_shift(2);if(at==14e3){for(Re[at]=[0,""],Re[at][0]=Ee.read_shift(2);Ee[Ee.l];)Re[at][1]+=String.fromCharCode(Ee[Ee.l]),Ee.l++;Ee.l++}}return Re}function Be(Ee,He){var Re=Un(5+Ee.length);Re.write_shift(2,14e3),Re.write_shift(2,He);for(var Oe=0;Oe<Ee.length;++Oe){var at=Ee.charCodeAt(Oe);Re[Re.l++]=at>127?95:at}return Re[Re.l++]=0,Re}var Tt={0:{n:"BOF",f:Fn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:L},14:{n:"NUMBER",f:U},15:{n:"LABEL",f:I},16:{n:"FORMULA",f:Y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:I},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:kt},222:{n:"SHEETNAMELP",f:Bt},65535:{n:""}},Dt={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:ge},23:{n:"NUMBER17",f:Ie},24:{n:"NUMBER18",f:ke},25:{n:"FORMULA19",f:$e},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:gt},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:We},38:{n:"??"},39:{n:"NUMBER27",f:dt},40:{n:"FORMULA28",f:Ut},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:kt},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:zt},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:l,book_to_wk3:u,to_workbook:r}}();function SL(e){var r={},n=e.match(wi),l=0,u=!1;if(n)for(;l!=n.length;++l){var m=nr(n[l]);switch(m[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!m.val)break;case"<shadow>":case"<shadow/>":r.shadow=1;break;case"</shadow>":break;case"<charset":if(m.val=="1")break;r.cp=Ay[parseInt(m.val,10)];break;case"<outline":if(!m.val)break;case"<outline>":case"<outline/>":r.outline=1;break;case"</outline>":break;case"<rFont":r.name=m.val;break;case"<sz":r.sz=m.val;break;case"<strike":if(!m.val)break;case"<strike>":case"<strike/>":r.strike=1;break;case"</strike>":break;case"<u":if(!m.val)break;switch(m.val){case"double":r.uval="double";break;case"singleAccounting":r.uval="single-accounting";break;case"doubleAccounting":r.uval="double-accounting";break}case"<u>":case"<u/>":r.u=1;break;case"</u>":break;case"<b":if(m.val=="0")break;case"<b>":case"<b/>":r.b=1;break;case"</b>":break;case"<i":if(m.val=="0")break;case"<i>":case"<i/>":r.i=1;break;case"</i>":break;case"<color":m.rgb&&(r.color=m.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":r.family=m.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":r.valign=m.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(m[0].charCodeAt(1)!==47&&!u)throw new Error("Unrecognized rich format "+m[0])}}return r}var kL=function(){var e=jd("t"),r=jd("rPr");function n(m){var x=m.match(e);if(!x)return{t:"s",v:""};var o={t:"s",v:Ar(x[1])},S=m.match(r);return S&&(o.s=SL(S[1])),o}var l=/<(?:\w+:)?r>/g,u=/<\/(?:\w+:)?r>/;return function(x){return x.replace(l,"").split(u).map(n).filter(function(o){return o.v})}}(),AL=function(){var r=/(\r\n|\n)/g;function n(u,m,x){var o=[];u.u&&o.push("text-decoration: underline;"),u.uval&&o.push("text-underline-style:"+u.uval+";"),u.sz&&o.push("font-size:"+u.sz+"pt;"),u.outline&&o.push("text-effect: outline;"),u.shadow&&o.push("text-shadow: auto;"),m.push('<span style="'+o.join("")+'">'),u.b&&(m.push("<b>"),x.push("</b>")),u.i&&(m.push("<i>"),x.push("</i>")),u.strike&&(m.push("<s>"),x.push("</s>"));var S=u.valign||"";return S=="superscript"||S=="super"?S="sup":S=="subscript"&&(S="sub"),S!=""&&(m.push("<"+S+">"),x.push("</"+S+">")),x.push("</span>"),u}function l(u){var m=[[],u.v,[]];return u.v?(u.s&&n(u.s,m[0],m[2]),m[0].join("")+m[1].replace(r,"<br/>")+m[2].join("")):""}return function(m){return m.map(l).join("")}}(),CL=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,IL=/<(?:\w+:)?r>/,ML=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function $y(e,r){var n=r?r.cellHTML:!0,l={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(l.t=Ar(Hr(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),l.r=Hr(e),n&&(l.h=Ly(l.t))):e.match(IL)&&(l.r=Hr(e),l.t=Ar(Hr((e.replace(ML,"").match(CL)||[]).join("").replace(wi,""))),n&&(l.h=AL(kL(l.r)))),l):{t:""}}var DL=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,FL=/<(?:\w+:)?(?:si|sstItem)>/g,PL=/<\/(?:\w+:)?(?:si|sstItem)>/;function LL(e,r){var n=[],l="";if(!e)return n;var u=e.match(DL);if(u){l=u[2].replace(FL,"").split(PL);for(var m=0;m!=l.length;++m){var x=$y(l[m].trim(),r);x!=null&&(n[n.length]=x)}u=nr(u[1]),n.Count=u.count,n.Unique=u.uniqueCount}return n}function RL(e){return[e.read_shift(4),e.read_shift(4)]}function zL(e,r){var n=[],l=!1;return ko(e,function(m,x,o){switch(o){case 159:n.Count=m[0],n.Unique=m[1];break;case 19:n.push(m);break;case 160:return!0;case 35:l=!0;break;case 36:l=!1;break;default:if(x.T,!l||r.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function $k(e){for(var r=[],n=e.split(""),l=0;l<n.length;++l)r[l]=n[l].charCodeAt(0);return r}function yo(e,r){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),r>=4&&(e.l+=r-4),n}function OL(e){var r={};return r.id=e.read_shift(0,"lpp4"),r.R=yo(e,4),r.U=yo(e,4),r.W=yo(e,4),r}function BL(e){for(var r=e.read_shift(4),n=e.l+r-4,l={},u=e.read_shift(4),m=[];u-- >0;)m.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(l.name=e.read_shift(0,"lpp4"),l.comps=m,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return l}function NL(e){var r=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)r.push(BL(e));return r}function UL(e){var r=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)r.push(e.read_shift(0,"lpp4"));return r}function VL(e){var r={};return e.read_shift(4),e.l+=4,r.id=e.read_shift(0,"lpp4"),r.name=e.read_shift(0,"lpp4"),r.R=yo(e,4),r.U=yo(e,4),r.W=yo(e,4),r}function jL(e){var r=VL(e);if(r.ename=e.read_shift(0,"8lpp4"),r.blksz=e.read_shift(4),r.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return r}function Wk(e,r){var n=e.l+r,l={};l.Flags=e.read_shift(4)&63,e.l+=4,l.AlgID=e.read_shift(4);var u=!1;switch(l.AlgID){case 26126:case 26127:case 26128:u=l.Flags==36;break;case 26625:u=l.Flags==4;break;case 0:u=l.Flags==16||l.Flags==4||l.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+l.AlgID}if(!u)throw new Error("Encryption Flags/AlgID mismatch");return l.AlgIDHash=e.read_shift(4),l.KeySize=e.read_shift(4),l.ProviderType=e.read_shift(4),e.l+=8,l.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,l}function Zk(e,r){var n={},l=e.l+r;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,l),e.l=l,n}function GL(e){var r=yo(e);switch(r.Minor){case 2:return[r.Minor,$L(e)];case 3:return[r.Minor,WL()];case 4:return[r.Minor,ZL(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+r.Minor)}function $L(e){var r=e.read_shift(4);if((r&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),l=Wk(e,n),u=Zk(e,e.length-e.l);return{t:"Std",h:l,v:u}}function WL(){throw new Error("File is password-protected: ECMA-376 Extensible")}function ZL(e){var r=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),l={};return n.replace(wi,function(m){var x=nr(m);switch($s(x[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":r.forEach(function(o){l[o]=x[o]});break;case"<dataIntegrity":l.encryptedHmacKey=x.encryptedHmacKey,l.encryptedHmacValue=x.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":l.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":l.uri=x.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":l.encs.push(x);break;default:throw x[0]}}),l}function HL(e,r){var n={},l=n.EncryptionVersionInfo=yo(e,4);if(r-=4,l.Minor!=2)throw new Error("unrecognized minor version code: "+l.Minor);if(l.Major>4||l.Major<2)throw new Error("unrecognized major version code: "+l.Major);n.Flags=e.read_shift(4),r-=4;var u=e.read_shift(4);return r-=4,n.EncryptionHeader=Wk(e,u),r-=u,n.EncryptionVerifier=Zk(e,r),n}function XL(e){var r={},n=r.EncryptionVersionInfo=yo(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return r.Salt=e.read_shift(16),r.EncryptedVerifier=e.read_shift(16),r.EncryptedVerifierHash=e.read_shift(16),r}function qL(e){var r=0,n,l=$k(e),u=l.length+1,m,x,o,S,A;for(n=bl(u),n[0]=l.length,m=1;m!=u;++m)n[m]=l[m-1];for(m=u-1;m>=0;--m)x=n[m],o=(r&16384)===0?0:1,S=r<<1&32767,A=o|S,r=A^x;return r^52811}var Hk=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],r=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],l=function(x){return(x/2|x*128)&255},u=function(x,o){return l(x^o)},m=function(x){for(var o=r[x.length-1],S=104,A=x.length-1;A>=0;--A)for(var I=x[A],D=0;D!=7;++D)I&64&&(o^=n[S]),I*=2,--S;return o};return function(x){for(var o=$k(x),S=m(o),A=o.length,I=bl(16),D=0;D!=16;++D)I[D]=0;var L,B,U;for((A&1)===1&&(L=S>>8,I[A]=u(e[0],L),--A,L=S&255,B=o[o.length-1],I[A]=u(B,L));A>0;)--A,L=S>>8,I[A]=u(o[A],L),--A,L=S&255,I[A]=u(o[A],L);for(A=15,U=15-o.length;U>0;)L=S>>8,I[A]=u(e[U],L),--A,--U,L=S&255,I[A]=u(o[A],L),--A,--U;return I}}(),KL=function(e,r,n,l,u){u||(u=r),l||(l=Hk(e));var m,x;for(m=0;m!=r.length;++m)x=r[m],x^=l[n],x=(x>>5|x<<3)&255,u[m]=x,++n;return[u,n,l]},YL=function(e){var r=0,n=Hk(e);return function(l){var u=KL("",l,r,n);return r=u[1],u[0]}};function JL(e,r,n,l){var u={key:Fn(e),verificationBytes:Fn(e)};return n.password&&(u.verifier=qL(n.password)),l.valid=u.verificationBytes===u.verifier,l.valid&&(l.insitu=YL(n.password)),u}function QL(e,r,n){var l=n||{};return l.Info=e.read_shift(2),e.l-=2,l.Info===1?l.Data=XL(e):l.Data=HL(e,r),l}function eR(e,r,n){var l={Type:n.biff>=8?e.read_shift(2):0};return l.Type?QL(e,r-2,l):JL(e,n.biff>=8?r:r-2,n,l),l}var tR=function(){function e(u,m){switch(m.type){case"base64":return r(ba(u),m);case"binary":return r(u,m);case"buffer":return r(vr&&Buffer.isBuffer(u)?u.toString("binary"):Rc(u),m);case"array":return r(Ic(u),m)}throw new Error("Unrecognized type "+m.type)}function r(u,m){var x=m||{},o=x.dense?[]:{},S=u.match(/\\trowd.*?\\row\b/g);if(!S.length)throw new Error("RTF missing table");var A={s:{c:0,r:0},e:{c:0,r:S.length-1}};return S.forEach(function(I,D){Array.isArray(o)&&(o[D]=[]);for(var L=/\\\w+\b/g,B=0,U,V=-1;U=L.exec(I);){switch(U[0]){case"\\cell":var Y=I.slice(B,L.lastIndex-U[0].length);if(Y[0]==" "&&(Y=Y.slice(1)),++V,Y.length){var X={v:Y,t:"s"};Array.isArray(o)?o[D][V]=X:o[lr({r:D,c:V})]=X}break}B=L.lastIndex}V>A.e.c&&(A.e.c=V)}),o["!ref"]=br(A),o}function n(u,m){return Il(e(u,m),m)}function l(u){for(var m=["{\\rtf1\\ansi"],x=wn(u["!ref"]),o,S=Array.isArray(u),A=x.s.r;A<=x.e.r;++A){m.push("\\trowd\\trautofit1");for(var I=x.s.c;I<=x.e.c;++I)m.push("\\cellx"+(I+1));for(m.push("\\pard\\intbl"),I=x.s.c;I<=x.e.c;++I){var D=lr({r:A,c:I});o=S?(u[A]||[])[I]:u[D],!(!o||o.v==null&&(!o.f||o.F))&&(m.push(" "+(o.w||(Eo(o),o.w))),m.push("\\cell"))}m.push("\\pard\\intbl\\row")}return m.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:l}}();function rR(e){var r=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(r.slice(0,2),16),parseInt(r.slice(2,4),16),parseInt(r.slice(4,6),16)]}function Wd(e){for(var r=0,n=1;r!=3;++r)n=n*256+(e[r]>255?255:e[r]<0?0:e[r]);return n.toString(16).toUpperCase().slice(1)}function nR(e){var r=e[0]/255,n=e[1]/255,l=e[2]/255,u=Math.max(r,n,l),m=Math.min(r,n,l),x=u-m;if(x===0)return[0,0,r];var o=0,S=0,A=u+m;switch(S=x/(A>1?2-A:A),u){case r:o=((n-l)/x+6)%6;break;case n:o=(l-r)/x+2;break;case l:o=(r-n)/x+4;break}return[o/6,S,A/2]}function iR(e){var r=e[0],n=e[1],l=e[2],u=n*2*(l<.5?l:1-l),m=l-u/2,x=[m,m,m],o=6*r,S;if(n!==0)switch(o|0){case 0:case 6:S=u*o,x[0]+=u,x[1]+=S;break;case 1:S=u*(2-o),x[0]+=S,x[1]+=u;break;case 2:S=u*(o-2),x[1]+=u,x[2]+=S;break;case 3:S=u*(4-o),x[1]+=S,x[2]+=u;break;case 4:S=u*(o-4),x[2]+=u,x[0]+=S;break;case 5:S=u*(6-o),x[2]+=S,x[0]+=u;break}for(var A=0;A!=3;++A)x[A]=Math.round(x[A]*255);return x}function Km(e,r){if(r===0)return e;var n=nR(rR(e));return r<0?n[2]=n[2]*(1+r):n[2]=1-(1-n[2])*(1-r),Wd(iR(n))}var Xk=6,aR=15,sR=1,Bi=Xk;function Ym(e){return Math.floor((e+Math.round(128/Bi)/256)*Bi)}function Jm(e){return Math.floor((e-5)/Bi*100+.5)/100}function k1(e){return Math.round((e*Bi+5)/Bi*256)/256}function Tx(e){return k1(Jm(Ym(e)))}function Wy(e){var r=Math.abs(e-Tx(e)),n=Bi;if(r>.005)for(Bi=sR;Bi<aR;++Bi)Math.abs(e-Tx(e))<=r&&(r=Math.abs(e-Tx(e)),n=Bi);Bi=n}function _h(e){e.width?(e.wpx=Ym(e.width),e.wch=Jm(e.wpx),e.MDW=Bi):e.wpx?(e.wch=Jm(e.wpx),e.width=k1(e.wch),e.MDW=Bi):typeof e.wch=="number"&&(e.width=k1(e.wch),e.wpx=Ym(e.width),e.MDW=Bi),e.customWidth&&delete e.customWidth}var oR=96,qk=oR;function Kk(e){return e*96/qk}function Zd(e){return e*qk/96}var lR={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function cR(e,r,n,l){r.Borders=[];var u={},m=!1;(e[0].match(wi)||[]).forEach(function(x){var o=nr(x);switch($s(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":u={},o.diagonalUp&&(u.diagonalUp=rn(o.diagonalUp)),o.diagonalDown&&(u.diagonalDown=rn(o.diagonalDown)),r.Borders.push(u);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":m=!0;break;case"</ext>":m=!1;break;default:if(l&&l.WTF&&!m)throw new Error("unrecognized "+o[0]+" in borders")}})}function uR(e,r,n,l){r.Fills=[];var u={},m=!1;(e[0].match(wi)||[]).forEach(function(x){var o=nr(x);switch($s(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":u={},r.Fills.push(u);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":r.Fills.push(u),u={};break;case"<patternFill":case"<patternFill>":o.patternType&&(u.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":u.bgColor||(u.bgColor={}),o.indexed&&(u.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(u.bgColor.theme=parseInt(o.theme,10)),o.tint&&(u.bgColor.tint=parseFloat(o.tint)),o.rgb&&(u.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":u.fgColor||(u.fgColor={}),o.theme&&(u.fgColor.theme=parseInt(o.theme,10)),o.tint&&(u.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(u.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":m=!0;break;case"</ext>":m=!1;break;default:if(l&&l.WTF&&!m)throw new Error("unrecognized "+o[0]+" in fills")}})}function hR(e,r,n,l){r.Fonts=[];var u={},m=!1;(e[0].match(wi)||[]).forEach(function(x){var o=nr(x);switch($s(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":r.Fonts.push(u),u={};break;case"<name":o.val&&(u.name=Hr(o.val));break;case"<name/>":case"</name>":break;case"<b":u.bold=o.val?rn(o.val):1;break;case"<b/>":u.bold=1;break;case"<i":u.italic=o.val?rn(o.val):1;break;case"<i/>":u.italic=1;break;case"<u":switch(o.val){case"none":u.underline=0;break;case"single":u.underline=1;break;case"double":u.underline=2;break;case"singleAccounting":u.underline=33;break;case"doubleAccounting":u.underline=34;break}break;case"<u/>":u.underline=1;break;case"<strike":u.strike=o.val?rn(o.val):1;break;case"<strike/>":u.strike=1;break;case"<outline":u.outline=o.val?rn(o.val):1;break;case"<outline/>":u.outline=1;break;case"<shadow":u.shadow=o.val?rn(o.val):1;break;case"<shadow/>":u.shadow=1;break;case"<condense":u.condense=o.val?rn(o.val):1;break;case"<condense/>":u.condense=1;break;case"<extend":u.extend=o.val?rn(o.val):1;break;case"<extend/>":u.extend=1;break;case"<sz":o.val&&(u.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(u.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(u.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(u.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=Ay[parseInt(o.val,10)];break;case"<color":if(u.color||(u.color={}),o.auto&&(u.color.auto=rn(o.auto)),o.rgb)u.color.rgb=o.rgb.slice(-6);else if(o.indexed){u.color.index=parseInt(o.indexed,10);var S=bc[u.color.index];u.color.index==81&&(S=bc[1]),S||(S=bc[1]),u.color.rgb=S[0].toString(16)+S[1].toString(16)+S[2].toString(16)}else o.theme&&(u.color.theme=parseInt(o.theme,10),o.tint&&(u.color.tint=parseFloat(o.tint)),o.theme&&n.themeElements&&n.themeElements.clrScheme&&(u.color.rgb=Km(n.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":m=!0;break;case"</AlternateContent>":m=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":m=!0;break;case"</ext>":m=!1;break;default:if(l&&l.WTF&&!m)throw new Error("unrecognized "+o[0]+" in fonts")}})}function fR(e,r,n){r.NumberFmt=[];for(var l=js(hr),u=0;u<l.length;++u)r.NumberFmt[l[u]]=hr[l[u]];var m=e[0].match(wi);if(!!m)for(u=0;u<m.length;++u){var x=nr(m[u]);switch($s(x[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=Ar(Hr(x.formatCode)),S=parseInt(x.numFmtId,10);if(r.NumberFmt[S]=o,S>0){if(S>392){for(S=392;S>60&&r.NumberFmt[S]!=null;--S);r.NumberFmt[S]=o}Ec(o,S)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+x[0]+" in numFmts")}}}var rm=["numFmtId","fillId","fontId","borderId","xfId"],nm=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function dR(e,r,n){r.CellXf=[];var l,u=!1;(e[0].match(wi)||[]).forEach(function(m){var x=nr(m),o=0;switch($s(x[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(l=x,delete l[0],o=0;o<rm.length;++o)l[rm[o]]&&(l[rm[o]]=parseInt(l[rm[o]],10));for(o=0;o<nm.length;++o)l[nm[o]]&&(l[nm[o]]=rn(l[nm[o]]));if(r.NumberFmt&&l.numFmtId>392){for(o=392;o>60;--o)if(r.NumberFmt[l.numFmtId]==r.NumberFmt[o]){l.numFmtId=o;break}}r.CellXf.push(l);break;case"</xf>":break;case"<alignment":case"<alignment/>":var S={};x.vertical&&(S.vertical=x.vertical),x.horizontal&&(S.horizontal=x.horizontal),x.textRotation!=null&&(S.textRotation=x.textRotation),x.indent&&(S.indent=x.indent),x.wrapText&&(S.wrapText=rn(x.wrapText)),l.alignment=S;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":u=!0;break;case"</AlternateContent>":u=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;default:if(n&&n.WTF&&!u)throw new Error("unrecognized "+x[0]+" in cellXfs")}})}var pR=function(){var r=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,l=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,u=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,m=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,S,A){var I={};if(!o)return I;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var D;return(D=o.match(r))&&fR(D,I,A),(D=o.match(u))&&hR(D,I,S,A),(D=o.match(l))&&uR(D,I,S,A),(D=o.match(m))&&cR(D,I,S,A),(D=o.match(n))&&dR(D,I,A),I}}();function mR(e,r){var n=e.read_shift(2),l=xi(e);return[n,l]}function _R(e,r,n){var l={};l.sz=e.read_shift(2)/20;var u=kF(e);u.fItalic&&(l.italic=1),u.fCondense&&(l.condense=1),u.fExtend&&(l.extend=1),u.fShadow&&(l.shadow=1),u.fOutline&&(l.outline=1),u.fStrikeout&&(l.strike=1);var m=e.read_shift(2);switch(m===700&&(l.bold=1),e.read_shift(2)){case 1:l.vertAlign="superscript";break;case 2:l.vertAlign="subscript";break}var x=e.read_shift(1);x!=0&&(l.underline=x);var o=e.read_shift(1);o>0&&(l.family=o);var S=e.read_shift(1);switch(S>0&&(l.charset=S),e.l++,l.color=SF(e),e.read_shift(1)){case 1:l.scheme="major";break;case 2:l.scheme="minor";break}return l.name=xi(e),l}var gR=vi;function xR(e,r){var n=e.l+r,l=e.read_shift(2),u=e.read_shift(2);return e.l=n,{ixfe:l,numFmtId:u}}var yR=vi;function vR(e,r,n){var l={};l.NumberFmt=[];for(var u in hr)l.NumberFmt[u]=hr[u];l.CellXf=[],l.Fonts=[];var m=[],x=!1;return ko(e,function(S,A,I){switch(I){case 44:l.NumberFmt[S[0]]=S[1],Ec(S[1],S[0]);break;case 43:l.Fonts.push(S),S.color.theme!=null&&r&&r.themeElements&&r.themeElements.clrScheme&&(S.color.rgb=Km(r.themeElements.clrScheme[S.color.theme].rgb,S.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:m[m.length-1]==617&&l.CellXf.push(S);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:x=!0;break;case 36:x=!1;break;case 37:m.push(I),x=!0;break;case 38:m.pop(),x=!1;break;default:if(A.T>0)m.push(I);else if(A.T<0)m.pop();else if(!x||n.WTF&&m[m.length-1]!=37)throw new Error("Unexpected record 0x"+I.toString(16))}}),l}var wR=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function TR(e,r,n){r.themeElements.clrScheme=[];var l={};(e[0].match(wi)||[]).forEach(function(u){var m=nr(u);switch(m[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":l.rgb=m.val;break;case"<a:sysClr":l.rgb=m.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":m[0].charAt(1)==="/"?(r.themeElements.clrScheme[wR.indexOf(m[0])]=l,l={}):l.name=m[0].slice(3,m[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+m[0]+" in clrScheme")}})}function ER(){}function bR(){}var SR=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,kR=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,AR=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function CR(e,r,n){r.themeElements={};var l;[["clrScheme",SR,TR],["fontScheme",kR,ER],["fmtScheme",AR,bR]].forEach(function(u){if(!(l=e.match(u[1])))throw new Error(u[0]+" not found in themeElements");u[2](l,r,n)})}var IR=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Yk(e,r){(!e||e.length===0)&&(e=MR());var n,l={};if(!(n=e.match(IR)))throw new Error("themeElements not found in theme");return CR(n[0],l,r),l.raw=e,l}function MR(e,r){if(r&&r.themeXLSX)return r.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[lk];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',n[n.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',n[n.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',n[n.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface="\uFF2D\uFF33 \uFF30\u30B4\u30B7\u30C3\u30AF"/>',n[n.length]='<a:font script="Hang" typeface="\uB9D1\uC740 \uACE0\uB515"/>',n[n.length]='<a:font script="Hans" typeface="\u5B8B\u4F53"/>',n[n.length]='<a:font script="Hant" typeface="\u65B0\u7D30\u660E\u9AD4"/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function DR(e,r,n){var l=e.l+r,u=e.read_shift(4);if(u!==124226){if(!n.cellStyles){e.l=l;return}var m=e.slice(e.l);e.l=l;var x;try{x=ok(m,{type:"array"})}catch{return}var o=va(x,"theme/theme/theme1.xml",!0);if(!!o)return Yk(o,n)}}function FR(e){return e.read_shift(4)}function PR(e){var r={};switch(r.xclrType=e.read_shift(2),r.nTintShade=e.read_shift(2),r.xclrType){case 0:e.l+=4;break;case 1:r.xclrValue=LR(e,4);break;case 2:r.xclrValue=Ok(e);break;case 3:r.xclrValue=FR(e);break;case 4:e.l+=4;break}return e.l+=8,r}function LR(e,r){return vi(e,r)}function RR(e,r){return vi(e,r)}function zR(e){var r=e.read_shift(2),n=e.read_shift(2)-4,l=[r];switch(r){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:l[1]=PR(e);break;case 6:l[1]=RR(e,n);break;case 14:case 15:l[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+r+" "+n)}return l}function OR(e,r){var n=e.l+r;e.l+=2;var l=e.read_shift(2);e.l+=2;for(var u=e.read_shift(2),m=[];u-- >0;)m.push(zR(e,n-e.l));return{ixfe:l,ext:m}}function BR(e,r){r.forEach(function(n){switch(n[0]){}})}function NR(e,r){return{flags:e.read_shift(4),version:e.read_shift(4),name:xi(e)}}function UR(e){for(var r=[],n=e.read_shift(4);n-- >0;)r.push([e.read_shift(4),e.read_shift(4)]);return r}function VR(e){return e.l+=4,e.read_shift(4)!=0}function jR(e,r,n){var l={Types:[],Cell:[],Value:[]},u=n||{},m=[],x=!1,o=2;return ko(e,function(S,A,I){switch(I){case 335:l.Types.push({name:S.name});break;case 51:S.forEach(function(D){o==1?l.Cell.push({type:l.Types[D[0]-1].name,index:D[1]}):o==0&&l.Value.push({type:l.Types[D[0]-1].name,index:D[1]})});break;case 337:o=S?1:0;break;case 338:o=2;break;case 35:m.push(I),x=!0;break;case 36:m.pop(),x=!1;break;default:if(!A.T){if(!x||u.WTF&&m[m.length-1]!=35)throw new Error("Unexpected record 0x"+I.toString(16))}}}),l}function GR(e,r,n){var l={Types:[],Cell:[],Value:[]};if(!e)return l;var u=!1,m=2,x;return e.replace(wi,function(o){var S=nr(o);switch($s(S[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":l.Types.push({name:S.name});break;case"</metadataType>":break;case"<futureMetadata":for(var A=0;A<l.Types.length;++A)l.Types[A].name==S.name&&(x=l.Types[A]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":m==1?l.Cell.push({type:l.Types[S.t-1].name,index:+S.v}):m==0&&l.Value.push({type:l.Types[S.t-1].name,index:+S.v});break;case"</rc>":break;case"<cellMetadata":m=1;break;case"</cellMetadata>":m=2;break;case"<valueMetadata":m=0;break;case"</valueMetadata>":m=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":u=!0;break;case"</ext>":u=!1;break;case"<rvb":if(!x)break;x.offsets||(x.offsets=[]),x.offsets.push(+S.i);break;default:if(!u&&n.WTF)throw new Error("unrecognized "+S[0]+" in metadata")}return o}),l}function $R(e){var r=[];if(!e)return r;var n=1;return(e.match(wi)||[]).forEach(function(l){var u=nr(l);switch(u[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete u[0],u.i?n=u.i:u.i=n,r.push(u);break}}),r}function WR(e){var r={};r.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),r.r=lr(n);var l=e.read_shift(1);return l&2&&(r.l="1"),l&8&&(r.a="1"),r}function ZR(e,r,n){var l=[];return ko(e,function(m,x,o){switch(o){case 63:l.push(m);break;default:if(!x.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),l}function HR(e,r,n,l){if(!e)return e;var u=l||{},m=!1;ko(e,function(o,S,A){switch(A){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:m=!0;break;case 36:m=!1;break;default:if(!S.T){if(!m||u.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}},u)}function XR(e,r){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return r["!id"][n].Target}function hE(e,r,n,l){var u=Array.isArray(e),m;r.forEach(function(x){var o=Ni(x.ref);if(u?(e[o.r]||(e[o.r]=[]),m=e[o.r][o.c]):m=e[x.ref],!m){m={t:"z"},u?e[o.r][o.c]=m:e[x.ref]=m;var S=wn(e["!ref"]||"BDWGO1000001:A1");S.s.r>o.r&&(S.s.r=o.r),S.e.r<o.r&&(S.e.r=o.r),S.s.c>o.c&&(S.s.c=o.c),S.e.c<o.c&&(S.e.c=o.c);var A=br(S);A!==e["!ref"]&&(e["!ref"]=A)}m.c||(m.c=[]);var I={a:x.author,t:x.t,r:x.r,T:n};x.h&&(I.h=x.h);for(var D=m.c.length-1;D>=0;--D){if(!n&&m.c[D].T)return;n&&!m.c[D].T&&m.c.splice(D,1)}if(n&&l){for(D=0;D<l.length;++D)if(I.a==l[D].id){I.a=l[D].name||I.a;break}}m.c.push(I)})}function qR(e,r){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],l=[],u=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);u&&u[1]&&u[1].split(/<\/\w*:?author>/).forEach(function(x){if(!(x===""||x.trim()==="")){var o=x.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&n.push(o[1])}});var m=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return m&&m[1]&&m[1].split(/<\/\w*:?comment>/).forEach(function(x){if(!(x===""||x.trim()==="")){var o=x.match(/<(?:\w+:)?comment[^>]*>/);if(!!o){var S=nr(o[0]),A={author:S.authorId&&n[S.authorId]||"sheetjsghost",ref:S.ref,guid:S.guid},I=Ni(S.ref);if(!(r.sheetRows&&r.sheetRows<=I.r)){var D=x.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),L=!!D&&!!D[1]&&$y(D[1])||{r:"",t:"",h:""};A.r=L.r,L.r=="<t></t>"&&(L.t=L.h=""),A.t=(L.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),r.cellHTML&&(A.h=L.h),l.push(A)}}}}),l}function KR(e,r){var n=[],l=!1,u={},m=0;return e.replace(wi,function(o,S){var A=nr(o);switch($s(A[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":u={author:A.personId,guid:A.id,ref:A.ref,T:1};break;case"</threadedComment>":u.t!=null&&n.push(u);break;case"<text>":case"<text":m=S+o.length;break;case"</text>":u.t=e.slice(m,S).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":l=!0;break;case"</mentions>":l=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(!l&&r.WTF)throw new Error("unrecognized "+A[0]+" in threaded comments")}return o}),n}function YR(e,r){var n=[],l=!1;return e.replace(wi,function(m){var x=nr(m);switch($s(x[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:x.displayname,id:x.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;default:if(!l&&r.WTF)throw new Error("unrecognized "+x[0]+" in threaded comments")}return m}),n}function JR(e){var r={};r.iauthor=e.read_shift(4);var n=Oc(e);return r.rfx=n.s,r.ref=lr(n.s),e.l+=16,r}var QR=xi;function e5(e,r){var n=[],l=[],u={},m=!1;return ko(e,function(o,S,A){switch(A){case 632:l.push(o);break;case 635:u=o;break;case 637:u.t=o.t,u.h=o.h,u.r=o.r;break;case 636:if(u.author=l[u.iauthor],delete u.iauthor,r.sheetRows&&u.rfx&&r.sheetRows<=u.rfx.r)break;u.t||(u.t=""),delete u.rfx,n.push(u);break;case 3072:break;case 35:m=!0;break;case 36:m=!1;break;case 37:break;case 38:break;default:if(!S.T){if(!m||r.WTF)throw new Error("Unexpected record 0x"+A.toString(16))}}}),n}var t5="application/vnd.ms-office.vbaProject";function r5(e){var r=wr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,l){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var u=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");wr.utils.cfb_add(r,u,e.FileIndex[l].content)}}),wr.write(r)}function n5(){return{"!type":"dialog"}}function i5(){return{"!type":"dialog"}}function a5(){return{"!type":"macro"}}function s5(){return{"!type":"macro"}}var ah=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function n(l,u,m,x){var o=!1,S=!1;m.length==0?S=!0:m.charAt(0)=="["&&(S=!0,m=m.slice(1,-1)),x.length==0?o=!0:x.charAt(0)=="["&&(o=!0,x=x.slice(1,-1));var A=m.length>0?parseInt(m,10)|0:0,I=x.length>0?parseInt(x,10)|0:0;return o?I+=r.c:--I,S?A+=r.r:--A,u+(o?"":"$")+jn(I)+(S?"":"$")+ti(A)}return function(u,m){return r=m,u.replace(e,n)}}(),Jk=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,o5=function(){return function(r,n){return r.replace(Jk,function(l,u,m,x,o,S){var A=By(x)-(m?0:n.c),I=Oy(S)-(o?0:n.r),D=I==0?"":o?I+1:"["+I+"]",L=A==0?"":m?A+1:"["+A+"]";return u+"R"+D+"C"+L})}}();function Qk(e,r){return e.replace(Jk,function(n,l,u,m,x,o){return l+(u=="$"?u+m:jn(By(m)+r.c))+(x=="$"?x+o:ti(Oy(o)+r.r))})}function l5(e,r,n){var l=Th(r),u=l.s,m=Ni(n),x={r:m.r-u.r,c:m.c-u.c};return Qk(e,x)}function c5(e){return e.length!=1}function fE(e){return e.replace(/_xlfn\./g,"")}function Mn(e){e.l+=1}function Sl(e,r){var n=e.read_shift(r==1?1:2);return[n&16383,n>>14&1,n>>15&1]}function eA(e,r,n){var l=2;if(n){if(n.biff>=2&&n.biff<=5)return tA(e);n.biff==12&&(l=4)}var u=e.read_shift(l),m=e.read_shift(l),x=Sl(e,2),o=Sl(e,2);return{s:{r:u,c:x[0],cRel:x[1],rRel:x[2]},e:{r:m,c:o[0],cRel:o[1],rRel:o[2]}}}function tA(e){var r=Sl(e,2),n=Sl(e,2),l=e.read_shift(1),u=e.read_shift(1);return{s:{r:r[0],c:l,cRel:r[1],rRel:r[2]},e:{r:n[0],c:u,cRel:n[1],rRel:n[2]}}}function u5(e,r,n){if(n.biff<8)return tA(e);var l=e.read_shift(n.biff==12?4:2),u=e.read_shift(n.biff==12?4:2),m=Sl(e,2),x=Sl(e,2);return{s:{r:l,c:m[0],cRel:m[1],rRel:m[2]},e:{r:u,c:x[0],cRel:x[1],rRel:x[2]}}}function rA(e,r,n){if(n&&n.biff>=2&&n.biff<=5)return h5(e);var l=e.read_shift(n&&n.biff==12?4:2),u=Sl(e,2);return{r:l,c:u[0],cRel:u[1],rRel:u[2]}}function h5(e){var r=Sl(e,2),n=e.read_shift(1);return{r:r[0],c:n,cRel:r[1],rRel:r[2]}}function f5(e){var r=e.read_shift(2),n=e.read_shift(2);return{r,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function d5(e,r,n){var l=n&&n.biff?n.biff:8;if(l>=2&&l<=5)return p5(e);var u=e.read_shift(l>=12?4:2),m=e.read_shift(2),x=(m&16384)>>14,o=(m&32768)>>15;if(m&=16383,o==1)for(;u>524287;)u-=1048576;if(x==1)for(;m>8191;)m=m-16384;return{r:u,c:m,cRel:x,rRel:o}}function p5(e){var r=e.read_shift(2),n=e.read_shift(1),l=(r&32768)>>15,u=(r&16384)>>14;return r&=16383,l==1&&r>=8192&&(r=r-16384),u==1&&n>=128&&(n=n-256),{r,c:n,cRel:u,rRel:l}}function m5(e,r,n){var l=(e[e.l++]&96)>>5,u=eA(e,n.biff>=2&&n.biff<=5?6:8,n);return[l,u]}function _5(e,r,n){var l=(e[e.l++]&96)>>5,u=e.read_shift(2,"i"),m=8;if(n)switch(n.biff){case 5:e.l+=12,m=6;break;case 12:m=12;break}var x=eA(e,m,n);return[l,u,x]}function g5(e,r,n){var l=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[l]}function x5(e,r,n){var l=(e[e.l++]&96)>>5,u=e.read_shift(2),m=8;if(n)switch(n.biff){case 5:e.l+=12,m=6;break;case 12:m=12;break}return e.l+=m,[l,u]}function y5(e,r,n){var l=(e[e.l++]&96)>>5,u=u5(e,r-1,n);return[l,u]}function v5(e,r,n){var l=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[l]}function dE(e){var r=e[e.l+1]&1,n=1;return e.l+=4,[r,n]}function w5(e,r,n){e.l+=2;for(var l=e.read_shift(n&&n.biff==2?1:2),u=[],m=0;m<=l;++m)u.push(e.read_shift(n&&n.biff==2?1:2));return u}function T5(e,r,n){var l=e[e.l+1]&255?1:0;return e.l+=2,[l,e.read_shift(n&&n.biff==2?1:2)]}function E5(e,r,n){var l=e[e.l+1]&255?1:0;return e.l+=2,[l,e.read_shift(n&&n.biff==2?1:2)]}function b5(e){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(2)]}function S5(e,r,n){var l=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[l]}function nA(e){var r=e.read_shift(1),n=e.read_shift(1);return[r,n]}function k5(e){return e.read_shift(2),nA(e)}function A5(e){return e.read_shift(2),nA(e)}function C5(e,r,n){var l=(e[e.l]&96)>>5;e.l+=1;var u=rA(e,0,n);return[l,u]}function I5(e,r,n){var l=(e[e.l]&96)>>5;e.l+=1;var u=d5(e,0,n);return[l,u]}function M5(e,r,n){var l=(e[e.l]&96)>>5;e.l+=1;var u=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var m=rA(e,0,n);return[l,u,m]}function D5(e,r,n){var l=(e[e.l]&96)>>5;e.l+=1;var u=e.read_shift(n&&n.biff<=3?1:2);return[Fz[u],sA[u],l]}function F5(e,r,n){var l=e[e.l++],u=e.read_shift(1),m=n&&n.biff<=3?[l==88?-1:0,e.read_shift(1)]:P5(e);return[u,(m[0]===0?sA:Dz)[m[1]]]}function P5(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function L5(e,r,n){e.l+=n&&n.biff==2?3:4}function R5(e,r,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var l=e.read_shift(2),u=e.read_shift(n&&n.biff==2?1:2);return[l,u]}function z5(e){return e.l++,Bc[e.read_shift(1)]}function O5(e){return e.l++,e.read_shift(2)}function B5(e){return e.l++,e.read_shift(1)!==0}function N5(e){return e.l++,_i(e)}function U5(e,r,n){return e.l++,tp(e,r-1,n)}function V5(e,r){var n=[e.read_shift(1)];if(r==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=bn(e,1)?"TRUE":"FALSE",r!=12&&(e.l+=7);break;case 37:case 16:n[1]=Bc[e[e.l]],e.l+=r==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=_i(e);break;case 2:n[1]=Nc(e,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function j5(e,r,n){for(var l=e.read_shift(n.biff==12?4:2),u=[],m=0;m!=l;++m)u.push((n.biff==12?Oc:w_)(e));return u}function G5(e,r,n){var l=0,u=0;n.biff==12?(l=e.read_shift(4),u=e.read_shift(4)):(u=1+e.read_shift(1),l=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--l,--u==0&&(u=256));for(var m=0,x=[];m!=l&&(x[m]=[]);++m)for(var o=0;o!=u;++o)x[m][o]=V5(e,n.biff);return x}function $5(e,r,n){var l=e.read_shift(1)>>>5&3,u=!n||n.biff>=8?4:2,m=e.read_shift(u);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[l,0,m]}function W5(e,r,n){if(n.biff==5)return Z5(e);var l=e.read_shift(1)>>>5&3,u=e.read_shift(2),m=e.read_shift(4);return[l,u,m]}function Z5(e){var r=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var l=e.read_shift(2);return e.l+=12,[r,n,l]}function H5(e,r,n){var l=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var u=e.read_shift(n&&n.biff==2?1:2);return[l,u]}function X5(e,r,n){var l=e.read_shift(1)>>>5&3,u=e.read_shift(n&&n.biff==2?1:2);return[l,u]}function q5(e,r,n){var l=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[l]}function K5(e,r,n){var l=(e[e.l++]&96)>>5,u=e.read_shift(2),m=4;if(n)switch(n.biff){case 5:m=15;break;case 12:m=6;break}return e.l+=m,[l,u]}var Y5=vi,J5=vi,Q5=vi;function np(e,r,n){return e.l+=2,[f5(e)]}function Zy(e){return e.l+=6,[]}var ez=np,tz=Zy,rz=Zy,nz=np;function iA(e){return e.l+=2,[Fn(e),e.read_shift(2)&1]}var iz=np,az=iA,sz=Zy,oz=np,lz=np,cz=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uz(e){e.l+=2;var r=e.read_shift(2),n=e.read_shift(2),l=e.read_shift(4),u=e.read_shift(2),m=e.read_shift(2),x=cz[n>>2&31];return{ixti:r,coltype:n&3,rt:x,idx:l,c:u,C:m}}function hz(e){return e.l+=2,[e.read_shift(4)]}function fz(e,r,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function dz(e,r,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function pz(e){var r=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[r,n]}function mz(e){var r=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[r,n]}function _z(e){return e.l+=4,[0,0]}var pE={1:{n:"PtgExp",f:R5},2:{n:"PtgTbl",f:Q5},3:{n:"PtgAdd",f:Mn},4:{n:"PtgSub",f:Mn},5:{n:"PtgMul",f:Mn},6:{n:"PtgDiv",f:Mn},7:{n:"PtgPower",f:Mn},8:{n:"PtgConcat",f:Mn},9:{n:"PtgLt",f:Mn},10:{n:"PtgLe",f:Mn},11:{n:"PtgEq",f:Mn},12:{n:"PtgGe",f:Mn},13:{n:"PtgGt",f:Mn},14:{n:"PtgNe",f:Mn},15:{n:"PtgIsect",f:Mn},16:{n:"PtgUnion",f:Mn},17:{n:"PtgRange",f:Mn},18:{n:"PtgUplus",f:Mn},19:{n:"PtgUminus",f:Mn},20:{n:"PtgPercent",f:Mn},21:{n:"PtgParen",f:Mn},22:{n:"PtgMissArg",f:Mn},23:{n:"PtgStr",f:U5},26:{n:"PtgSheet",f:fz},27:{n:"PtgEndSheet",f:dz},28:{n:"PtgErr",f:z5},29:{n:"PtgBool",f:B5},30:{n:"PtgInt",f:O5},31:{n:"PtgNum",f:N5},32:{n:"PtgArray",f:v5},33:{n:"PtgFunc",f:D5},34:{n:"PtgFuncVar",f:F5},35:{n:"PtgName",f:$5},36:{n:"PtgRef",f:C5},37:{n:"PtgArea",f:m5},38:{n:"PtgMemArea",f:H5},39:{n:"PtgMemErr",f:Y5},40:{n:"PtgMemNoMem",f:J5},41:{n:"PtgMemFunc",f:X5},42:{n:"PtgRefErr",f:q5},43:{n:"PtgAreaErr",f:g5},44:{n:"PtgRefN",f:I5},45:{n:"PtgAreaN",f:y5},46:{n:"PtgMemAreaN",f:pz},47:{n:"PtgMemNoMemN",f:mz},57:{n:"PtgNameX",f:W5},58:{n:"PtgRef3d",f:M5},59:{n:"PtgArea3d",f:_5},60:{n:"PtgRefErr3d",f:K5},61:{n:"PtgAreaErr3d",f:x5},255:{}},gz={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xz={1:{n:"PtgElfLel",f:iA},2:{n:"PtgElfRw",f:oz},3:{n:"PtgElfCol",f:ez},6:{n:"PtgElfRwV",f:lz},7:{n:"PtgElfColV",f:nz},10:{n:"PtgElfRadical",f:iz},11:{n:"PtgElfRadicalS",f:sz},13:{n:"PtgElfColS",f:tz},15:{n:"PtgElfColSV",f:rz},16:{n:"PtgElfRadicalLel",f:az},25:{n:"PtgList",f:uz},29:{n:"PtgSxName",f:hz},255:{}},yz={0:{n:"PtgAttrNoop",f:_z},1:{n:"PtgAttrSemi",f:S5},2:{n:"PtgAttrIf",f:E5},4:{n:"PtgAttrChoose",f:w5},8:{n:"PtgAttrGoto",f:T5},16:{n:"PtgAttrSum",f:L5},32:{n:"PtgAttrBaxcel",f:dE},33:{n:"PtgAttrBaxcel",f:dE},64:{n:"PtgAttrSpace",f:k5},65:{n:"PtgAttrSpaceSemi",f:A5},128:{n:"PtgAttrIfError",f:b5},255:{}};function ip(e,r,n,l){if(l.biff<8)return vi(e,r);for(var u=e.l+r,m=[],x=0;x!==n.length;++x)switch(n[x][0]){case"PtgArray":n[x][1]=G5(e,0,l),m.push(n[x][1]);break;case"PtgMemArea":n[x][2]=j5(e,n[x][1],l),m.push(n[x][2]);break;case"PtgExp":l&&l.biff==12&&(n[x][1][1]=e.read_shift(4),m.push(n[x][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[x][0]}return r=u-e.l,r!==0&&m.push(vi(e,r)),m}function ap(e,r,n){for(var l=e.l+r,u,m,x=[];l!=e.l;)r=l-e.l,m=e[e.l],u=pE[m]||pE[gz[m]],(m===24||m===25)&&(u=(m===24?xz:yz)[e[e.l+1]]),!u||!u.f?vi(e,r):x.push([u.n,u.f(e,r,n)]);return x}function vz(e){for(var r=[],n=0;n<e.length;++n){for(var l=e[n],u=[],m=0;m<l.length;++m){var x=l[m];if(x)switch(x[0]){case 2:u.push('"'+x[1].replace(/"/g,'""')+'"');break;default:u.push(x[1])}else u.push("")}r.push(u.join(","))}return r.join(";")}var wz={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Tz(e,r){if(!e&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function aA(e,r,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[r]))return e.SheetNames[r];if(!e.XTI)return"SH33TJSERR6";var l=e.XTI[r];if(n.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":e.XTI[r-1];if(!l)return"SH33TJSERR1";var u="";if(n.biff>8)switch(e[l[0]][0]){case 357:return u=l[1]==-1?"#REF":e.SheetNames[l[1]],l[1]==l[2]?u:u+":"+e.SheetNames[l[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[l[0]][0];case 355:default:return"SH33TJSSRC"+e[l[0]][0]}switch(e[l[0]][0][0]){case 1025:return u=l[1]==-1?"#REF":e.SheetNames[l[1]]||"SH33TJSERR3",l[1]==l[2]?u:u+":"+e.SheetNames[l[2]];case 14849:return e[l[0]].slice(1).map(function(m){return m.Name}).join(";;");default:return e[l[0]][0][3]?(u=l[1]==-1?"#REF":e[l[0]][0][3][l[1]]||"SH33TJSERR4",l[1]==l[2]?u:u+":"+e[l[0]][0][3][l[2]]):"SH33TJSERR2"}}function mE(e,r,n){var l=aA(e,r,n);return l=="#REF"?l:Tz(l,n)}function mi(e,r,n,l,u){var m=u&&u.biff||8,x={s:{c:0,r:0},e:{c:0,r:0}},o=[],S,A,I,D=0,L=0,B,U="";if(!e[0]||!e[0][0])return"";for(var V=-1,Y="",X=0,K=e[0].length;X<K;++X){var G=e[0][X];switch(G[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(S=o.pop(),A=o.pop(),V>=0){switch(e[0][V][1][0]){case 0:Y=yn(" ",e[0][V][1][1]);break;case 1:Y=yn("\r",e[0][V][1][1]);break;default:if(Y="",u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][V][1][0])}A=A+Y,V=-1}o.push(A+wz[G[0]]+S);break;case"PtgIsect":S=o.pop(),A=o.pop(),o.push(A+" "+S);break;case"PtgUnion":S=o.pop(),A=o.pop(),o.push(A+","+S);break;case"PtgRange":S=o.pop(),A=o.pop(),o.push(A+":"+S);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":I=md(G[1][1],x,u),o.push(_d(I,m));break;case"PtgRefN":I=n?md(G[1][1],n,u):G[1][1],o.push(_d(I,m));break;case"PtgRef3d":D=G[1][1],I=md(G[1][2],x,u),U=mE(l,D,u),o.push(U+"!"+_d(I,m));break;case"PtgFunc":case"PtgFuncVar":var me=G[1][0],Ae=G[1][1];me||(me=0),me&=127;var ge=me==0?[]:o.slice(-me);o.length-=me,Ae==="User"&&(Ae=ge.shift()),o.push(Ae+"("+ge.join(",")+")");break;case"PtgBool":o.push(G[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(G[1]);break;case"PtgNum":o.push(String(G[1]));break;case"PtgStr":o.push('"'+G[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(G[1]);break;case"PtgAreaN":B=qT(G[1][1],n?{s:n}:x,u),o.push(vx(B,u));break;case"PtgArea":B=qT(G[1][1],x,u),o.push(vx(B,u));break;case"PtgArea3d":D=G[1][1],B=G[1][2],U=mE(l,D,u),o.push(U+"!"+vx(B,u));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":L=G[1][2];var se=(l.names||[])[L-1]||(l[0]||[])[L],ke=se?se.Name:"SH33TJSNAME"+String(L);ke&&ke.slice(0,6)=="_xlfn."&&!u.xlfn&&(ke=ke.slice(6)),o.push(ke);break;case"PtgNameX":var Ie=G[1][1];L=G[1][2];var Xe;if(u.biff<=5)Ie<0&&(Ie=-Ie),l[Ie]&&(Xe=l[Ie][L]);else{var $e="";if(((l[Ie]||[])[0]||[])[0]==14849||(((l[Ie]||[])[0]||[])[0]==1025?l[Ie][L]&&l[Ie][L].itab>0&&($e=l.SheetNames[l[Ie][L].itab-1]+"!"):$e=l.SheetNames[L-1]+"!"),l[Ie]&&l[Ie][L])$e+=l[Ie][L].Name;else if(l[0]&&l[0][L])$e+=l[0][L].Name;else{var We=(aA(l,Ie,u)||"").split(";;");We[L-1]?$e=We[L-1]:$e+="SH33TJSERRX"}o.push($e);break}Xe||(Xe={Name:"SH33TJSERRY"}),o.push(Xe.Name);break;case"PtgParen":var dt="(",Ut=")";if(V>=0){switch(Y="",e[0][V][1][0]){case 2:dt=yn(" ",e[0][V][1][1])+dt;break;case 3:dt=yn("\r",e[0][V][1][1])+dt;break;case 4:Ut=yn(" ",e[0][V][1][1])+Ut;break;case 5:Ut=yn("\r",e[0][V][1][1])+Ut;break;default:if(u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][V][1][0])}V=-1}o.push(dt+o.pop()+Ut);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":I={c:G[1][1],r:G[1][0]};var kt={c:n.c,r:n.r};if(l.sharedf[lr(I)]){var Bt=l.sharedf[lr(I)];o.push(mi(Bt,x,kt,l,u))}else{var zt=!1;for(S=0;S!=l.arrayf.length;++S)if(A=l.arrayf[S],!(I.c<A[0].s.c||I.c>A[0].e.c)&&!(I.r<A[0].s.r||I.r>A[0].e.r)){o.push(mi(A[1],x,kt,l,u)),zt=!0;break}zt||o.push(G[1])}break;case"PtgArray":o.push("{"+vz(G[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":V=X;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+G[1].idx+"[#"+G[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(G));default:throw new Error("Unrecognized Formula Token: "+String(G))}var gt=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(u.biff!=3&&V>=0&&gt.indexOf(e[0][X][0])==-1){G=e[0][V];var Be=!0;switch(G[1][0]){case 4:Be=!1;case 0:Y=yn(" ",G[1][1]);break;case 5:Be=!1;case 1:Y=yn("\r",G[1][1]);break;default:if(Y="",u.WTF)throw new Error("Unexpected PtgAttrSpaceType "+G[1][0])}o.push((Be?Y:"")+o.pop()+(Be?"":Y)),V=-1}}if(o.length>1&&u.WTF)throw new Error("bad formula stack");return o[0]}function Ez(e,r,n){var l=e.l+r,u=n.biff==2?1:2,m,x=e.read_shift(u);if(x==65535)return[[],vi(e,r-2)];var o=ap(e,x,n);return r!==x+u&&(m=ip(e,r-x-u,o,n)),e.l=l,[o,m]}function bz(e,r,n){var l=e.l+r,u=n.biff==2?1:2,m,x=e.read_shift(u);if(x==65535)return[[],vi(e,r-2)];var o=ap(e,x,n);return r!==x+u&&(m=ip(e,r-x-u,o,n)),e.l=l,[o,m]}function Sz(e,r,n,l){var u=e.l+r,m=ap(e,l,n),x;return u!==e.l&&(x=ip(e,u-e.l,m,n)),[m,x]}function kz(e,r,n){var l=e.l+r,u,m=e.read_shift(2),x=ap(e,m,n);return m==65535?[[],vi(e,r-2)]:(r!==m+2&&(u=ip(e,l-m-2,x,n)),[x,u])}function Az(e){var r;if(_o(e,e.l+6)!==65535)return[_i(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return r=e[e.l+2]===1,e.l+=8,[r,"b"];case 2:return r=e[e.l+2],e.l+=8,[r,"e"];case 3:return e.l+=8,["","s"]}return[]}function Ex(e,r,n){var l=e.l+r,u=Ws(e);n.biff==2&&++e.l;var m=Az(e),x=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var o=bz(e,l-e.l,n);return{cell:u,val:m[0],formula:o,shared:x>>3&1,tt:m[1]}}function T_(e,r,n){var l=e.read_shift(4),u=ap(e,l,n),m=e.read_shift(4),x=m>0?ip(e,m,u,n):null;return[u,x]}var Cz=T_,E_=T_,Iz=T_,Mz=T_,Dz={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},sA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Fz={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function _E(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(r,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function bx(e){var r=e.split(":"),n=r[0].split(".")[0];return[n,r[0].split(".")[1]+(r.length>1?":"+(r[1].split(".")[1]||r[1].split(".")[0]):"")]}var vd={},sh={};function wd(e,r){if(!!e){var n=[.7,.7,.75,.75,.3,.3];r=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function oA(e,r,n,l,u,m){try{l.cellNF&&(e.z=hr[r])}catch(o){if(l.WTF)throw o}if(!(e.t==="z"&&!l.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Kn(e.v)),(!l||l.cellText!==!1)&&e.t!=="z")try{if(hr[r]==null&&Ec(LD[r]||"General",r),e.t==="e")e.w=e.w||Bc[e.v];else if(r===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vd(e.v);else if(e.t==="d"){var x=ji(e.v);(x|0)===x?e.w=x.toString(10):e.w=Vd(x)}else{if(e.v===void 0)return"";e.w=Cc(e.v,sh)}else e.t==="d"?e.w=Wa(r,ji(e.v),sh):e.w=Wa(r,e.v,sh)}catch(o){if(l.WTF)throw o}if(!!l.cellStyles&&n!=null)try{e.s=m.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Km(u.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),l.WTF&&(e.s.fgColor.raw_rgb=u.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Km(u.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),l.WTF&&(e.s.bgColor.raw_rgb=u.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(l.WTF&&m.Fills)throw o}}}function Pz(e,r){var n=wn(r);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=br(n))}var Lz=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Rz=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,zz=/<(?:\w:)?hyperlink [^>]*>/mg,Oz=/"(\w*:\w*)"/,Bz=/<(?:\w:)?col\b[^>]*[\/]?>/g,Nz=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Uz=/<(?:\w:)?pageMargins[^>]*\/>/g,lA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Vz=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,jz=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Gz(e,r,n,l,u,m,x){if(!e)return e;l||(l={"!id":{}});var o=r.dense?[]:{},S={s:{r:2e6,c:2e6},e:{r:0,c:0}},A="",I="",D=e.match(Rz);D?(A=e.slice(0,D.index),I=e.slice(D.index+D[0].length)):A=I=e;var L=A.match(lA);L?Hy(L[0],o,u,n):(L=A.match(Vz))&&$z(L[0],L[1]||"",o,u,n);var B=(A.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(B>0){var U=A.slice(B,B+50).match(Oz);U&&Pz(o,U[1])}var V=A.match(jz);V&&V[1]&&Kz(V[1],u);var Y=[];if(r.cellStyles){var X=A.match(Bz);X&&Hz(Y,X)}D&&Yz(D[1],o,r,S,m,x);var K=I.match(Nz);K&&(o["!autofilter"]=Xz(K[0]));var G=[],me=I.match(Lz);if(me)for(B=0;B!=me.length;++B)G[B]=wn(me[B].slice(me[B].indexOf('"')+1));var Ae=I.match(zz);Ae&&Wz(o,Ae,l);var ge=I.match(Uz);if(ge&&(o["!margins"]=Zz(nr(ge[0]))),!o["!ref"]&&S.e.c>=S.s.c&&S.e.r>=S.s.r&&(o["!ref"]=br(S)),r.sheetRows>0&&o["!ref"]){var se=wn(o["!ref"]);r.sheetRows<=+se.e.r&&(se.e.r=r.sheetRows-1,se.e.r>S.e.r&&(se.e.r=S.e.r),se.e.r<se.s.r&&(se.s.r=se.e.r),se.e.c>S.e.c&&(se.e.c=S.e.c),se.e.c<se.s.c&&(se.s.c=se.e.c),o["!fullref"]=o["!ref"],o["!ref"]=br(se))}return Y.length>0&&(o["!cols"]=Y),G.length>0&&(o["!merges"]=G),o}function Hy(e,r,n,l){var u=nr(e);n.Sheets[l]||(n.Sheets[l]={}),u.codeName&&(n.Sheets[l].CodeName=Ar(Hr(u.codeName)))}function $z(e,r,n,l,u){Hy(e.slice(0,e.indexOf(">")),n,l,u)}function Wz(e,r,n){for(var l=Array.isArray(e),u=0;u!=r.length;++u){var m=nr(Hr(r[u]),!0);if(!m.ref)return;var x=((n||{})["!id"]||[])[m.id];x?(m.Target=x.Target,m.location&&(m.Target+="#"+Ar(m.location))):(m.Target="#"+Ar(m.location),x={Target:m.Target,TargetMode:"Internal"}),m.Rel=x,m.tooltip&&(m.Tooltip=m.tooltip,delete m.tooltip);for(var o=wn(m.ref),S=o.s.r;S<=o.e.r;++S)for(var A=o.s.c;A<=o.e.c;++A){var I=lr({c:A,r:S});l?(e[S]||(e[S]=[]),e[S][A]||(e[S][A]={t:"z",v:void 0}),e[S][A].l=m):(e[I]||(e[I]={t:"z",v:void 0}),e[I].l=m)}}}function Zz(e){var r={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(r[n]=parseFloat(e[n]))}),r}function Hz(e,r){for(var n=!1,l=0;l!=r.length;++l){var u=nr(r[l],!0);u.hidden&&(u.hidden=rn(u.hidden));var m=parseInt(u.min,10)-1,x=parseInt(u.max,10)-1;for(u.outlineLevel&&(u.level=+u.outlineLevel||0),delete u.min,delete u.max,u.width=+u.width,!n&&u.width&&(n=!0,Wy(u.width)),_h(u);m<=x;)e[m++]=ei(u)}}function Xz(e){var r={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return r}var qz=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Kz(e,r){r.Views||(r.Views=[{}]),(e.match(qz)||[]).forEach(function(n,l){var u=nr(n);r.Views[l]||(r.Views[l]={}),+u.zoomScale&&(r.Views[l].zoom=+u.zoomScale),rn(u.rightToLeft)&&(r.Views[l].RTL=!0)})}var Yz=function(){var e=/<(?:\w+:)?c[ \/>]/,r=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,l=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,u=/ref=["']([^"']*)["']/,m=jd("v"),x=jd("f");return function(S,A,I,D,L,B){for(var U=0,V="",Y=[],X=[],K=0,G=0,me=0,Ae="",ge,se,ke=0,Ie=0,Xe,$e,We=0,dt=0,Ut=Array.isArray(B.CellXf),kt,Bt=[],zt=[],gt=Array.isArray(A),Be=[],Tt={},Dt=!1,Ee=!!I.sheetStubs,He=S.split(r),Re=0,Oe=He.length;Re!=Oe;++Re){V=He[Re].trim();var at=V.length;if(at===0)continue;var bt=0;e:for(U=0;U<at;++U)switch(V[U]){case">":if(V[U-1]!="/"){++U;break e}if(I&&I.cellStyles){if(se=nr(V.slice(bt,U),!0),ke=se.r!=null?parseInt(se.r,10):ke+1,Ie=-1,I.sheetRows&&I.sheetRows<ke)continue;Tt={},Dt=!1,se.ht&&(Dt=!0,Tt.hpt=parseFloat(se.ht),Tt.hpx=Zd(Tt.hpt)),se.hidden=="1"&&(Dt=!0,Tt.hidden=!0),se.outlineLevel!=null&&(Dt=!0,Tt.level=+se.outlineLevel),Dt&&(Be[ke-1]=Tt)}break;case"<":bt=U;break}if(bt>=U)break;if(se=nr(V.slice(bt,U),!0),ke=se.r!=null?parseInt(se.r,10):ke+1,Ie=-1,!(I.sheetRows&&I.sheetRows<ke)){D.s.r>ke-1&&(D.s.r=ke-1),D.e.r<ke-1&&(D.e.r=ke-1),I&&I.cellStyles&&(Tt={},Dt=!1,se.ht&&(Dt=!0,Tt.hpt=parseFloat(se.ht),Tt.hpx=Zd(Tt.hpt)),se.hidden=="1"&&(Dt=!0,Tt.hidden=!0),se.outlineLevel!=null&&(Dt=!0,Tt.level=+se.outlineLevel),Dt&&(Be[ke-1]=Tt)),Y=V.slice(U).split(e);for(var Ot=0;Ot!=Y.length&&Y[Ot].trim().charAt(0)=="<";++Ot);for(Y=Y.slice(Ot),U=0;U!=Y.length;++U)if(V=Y[U].trim(),V.length!==0){if(X=V.match(n),K=U,G=0,me=0,V="<c "+(V.slice(0,1)=="<"?">":"")+V,X!=null&&X.length===2){for(K=0,Ae=X[1],G=0;G!=Ae.length&&!((me=Ae.charCodeAt(G)-64)<1||me>26);++G)K=26*K+me;--K,Ie=K}else++Ie;for(G=0;G!=V.length&&V.charCodeAt(G)!==62;++G);if(++G,se=nr(V.slice(0,G),!0),se.r||(se.r=lr({r:ke-1,c:Ie})),Ae=V.slice(G),ge={t:""},(X=Ae.match(m))!=null&&X[1]!==""&&(ge.v=Ar(X[1])),I.cellFormula){if((X=Ae.match(x))!=null&&X[1]!==""){if(ge.f=Ar(Hr(X[1])).replace(/\r\n/g,`
`),I.xlfn||(ge.f=fE(ge.f)),X[0].indexOf('t="array"')>-1)ge.F=(Ae.match(u)||[])[1],ge.F.indexOf(":")>-1&&Bt.push([wn(ge.F),ge.F]);else if(X[0].indexOf('t="shared"')>-1){$e=nr(X[0]);var At=Ar(Hr(X[1]));I.xlfn||(At=fE(At)),zt[parseInt($e.si,10)]=[$e,At,se.r]}}else(X=Ae.match(/<f[^>]*\/>/))&&($e=nr(X[0]),zt[$e.si]&&(ge.f=l5(zt[$e.si][1],zt[$e.si][2],se.r)));var yt=Ni(se.r);for(G=0;G<Bt.length;++G)yt.r>=Bt[G][0].s.r&&yt.r<=Bt[G][0].e.r&&yt.c>=Bt[G][0].s.c&&yt.c<=Bt[G][0].e.c&&(ge.F=Bt[G][1])}if(se.t==null&&ge.v===void 0)if(ge.f||ge.F)ge.v=0,ge.t="n";else if(Ee)ge.t="z";else continue;else ge.t=se.t||"n";switch(D.s.c>Ie&&(D.s.c=Ie),D.e.c<Ie&&(D.e.c=Ie),ge.t){case"n":if(ge.v==""||ge.v==null){if(!Ee)continue;ge.t="z"}else ge.v=parseFloat(ge.v);break;case"s":if(typeof ge.v=="undefined"){if(!Ee)continue;ge.t="z"}else Xe=vd[parseInt(ge.v,10)],ge.v=Xe.t,ge.r=Xe.r,I.cellHTML&&(ge.h=Xe.h);break;case"str":ge.t="s",ge.v=ge.v!=null?Hr(ge.v):"",I.cellHTML&&(ge.h=Ly(ge.v));break;case"inlineStr":X=Ae.match(l),ge.t="s",X!=null&&(Xe=$y(X[1]))?(ge.v=Xe.t,I.cellHTML&&(ge.h=Xe.h)):ge.v="";break;case"b":ge.v=rn(ge.v);break;case"d":I.cellDates?ge.v=Kn(ge.v,1):(ge.v=ji(Kn(ge.v,1)),ge.t="n");break;case"e":(!I||I.cellText!==!1)&&(ge.w=ge.v),ge.v=Ik[ge.v];break}if(We=dt=0,kt=null,Ut&&se.s!==void 0&&(kt=B.CellXf[se.s],kt!=null&&(kt.numFmtId!=null&&(We=kt.numFmtId),I.cellStyles&&kt.fillId!=null&&(dt=kt.fillId))),oA(ge,We,dt,I,L,B),I.cellDates&&Ut&&ge.t=="n"&&wh(hr[We])&&(ge.t="d",ge.v=v_(ge.v)),se.cm&&I.xlmeta){var ar=(I.xlmeta.Cell||[])[+se.cm-1];ar&&ar.type=="XLDAPR"&&(ge.D=!0)}if(gt){var ve=Ni(se.r);A[ve.r]||(A[ve.r]=[]),A[ve.r][ve.c]=ge}else A[se.r]=ge}}}Be.length>0&&(A["!rows"]=Be)}}();function Jz(e,r){var n={},l=e.l+r;n.r=e.read_shift(4),e.l+=4;var u=e.read_shift(2);e.l+=1;var m=e.read_shift(1);return e.l=l,m&7&&(n.level=m&7),m&16&&(n.hidden=!0),m&32&&(n.hpt=u/20),n}var Qz=Oc;function e6(){}function t6(e,r){var n={},l=e[e.l];return++e.l,n.above=!(l&64),n.left=!(l&128),e.l+=18,n.name=EF(e),n}function r6(e){var r=Za(e);return[r]}function n6(e){var r=zc(e);return[r]}function i6(e){var r=Za(e),n=e.read_shift(1);return[r,n,"b"]}function a6(e){var r=zc(e),n=e.read_shift(1);return[r,n,"b"]}function s6(e){var r=Za(e),n=e.read_shift(1);return[r,n,"e"]}function o6(e){var r=zc(e),n=e.read_shift(1);return[r,n,"e"]}function l6(e){var r=Za(e),n=e.read_shift(4);return[r,n,"s"]}function c6(e){var r=zc(e),n=e.read_shift(4);return[r,n,"s"]}function u6(e){var r=Za(e),n=_i(e);return[r,n,"n"]}function cA(e){var r=zc(e),n=_i(e);return[r,n,"n"]}function h6(e){var r=Za(e),n=Vy(e);return[r,n,"n"]}function f6(e){var r=zc(e),n=Vy(e);return[r,n,"n"]}function d6(e){var r=Za(e),n=Ny(e);return[r,n,"is"]}function p6(e){var r=Za(e),n=xi(e);return[r,n,"str"]}function m6(e){var r=zc(e),n=xi(e);return[r,n,"str"]}function _6(e,r,n){var l=e.l+r,u=Za(e);u.r=n["!row"];var m=e.read_shift(1),x=[u,m,"b"];if(n.cellFormula){e.l+=2;var o=E_(e,l-e.l,n);x[3]=mi(o,null,u,n.supbooks,n)}else e.l=l;return x}function g6(e,r,n){var l=e.l+r,u=Za(e);u.r=n["!row"];var m=e.read_shift(1),x=[u,m,"e"];if(n.cellFormula){e.l+=2;var o=E_(e,l-e.l,n);x[3]=mi(o,null,u,n.supbooks,n)}else e.l=l;return x}function x6(e,r,n){var l=e.l+r,u=Za(e);u.r=n["!row"];var m=_i(e),x=[u,m,"n"];if(n.cellFormula){e.l+=2;var o=E_(e,l-e.l,n);x[3]=mi(o,null,u,n.supbooks,n)}else e.l=l;return x}function y6(e,r,n){var l=e.l+r,u=Za(e);u.r=n["!row"];var m=xi(e),x=[u,m,"str"];if(n.cellFormula){e.l+=2;var o=E_(e,l-e.l,n);x[3]=mi(o,null,u,n.supbooks,n)}else e.l=l;return x}var v6=Oc;function w6(e,r){var n=e.l+r,l=Oc(e),u=Uy(e),m=xi(e),x=xi(e),o=xi(e);e.l=n;var S={rfx:l,relId:u,loc:m,display:o};return x&&(S.Tooltip=x),S}function T6(){}function E6(e,r,n){var l=e.l+r,u=kk(e),m=e.read_shift(1),x=[u];if(x[2]=m,n.cellFormula){var o=Cz(e,l-e.l,n);x[1]=o}else e.l=l;return x}function b6(e,r,n){var l=e.l+r,u=Oc(e),m=[u];if(n.cellFormula){var x=Mz(e,l-e.l,n);m[1]=x,e.l=l}else e.l=l;return m}var S6=["left","right","top","bottom","header","footer"];function k6(e){var r={};return S6.forEach(function(n){r[n]=_i(e)}),r}function A6(e){var r=e.read_shift(2);return e.l+=28,{RTL:r&32}}function C6(){}function I6(){}function M6(e,r,n,l,u,m,x){if(!e)return e;var o=r||{};l||(l={"!id":{}});var S=o.dense?[]:{},A,I={s:{r:2e6,c:2e6},e:{r:0,c:0}},D=!1,L=!1,B,U,V,Y,X,K,G,me,Ae,ge=[];o.biff=12,o["!row"]=0;var se=0,ke=!1,Ie=[],Xe={},$e=o.supbooks||u.supbooks||[[]];if($e.sharedf=Xe,$e.arrayf=Ie,$e.SheetNames=u.SheetNames||u.Sheets.map(function(gt){return gt.name}),!o.supbooks&&(o.supbooks=$e,u.Names))for(var We=0;We<u.Names.length;++We)$e[0][We+1]=u.Names[We];var dt=[],Ut=[],kt=!1;Qm[16]={n:"BrtShortReal",f:cA};var Bt;if(ko(e,function(Be,Tt,Dt){if(!L)switch(Dt){case 148:A=Be;break;case 0:B=Be,o.sheetRows&&o.sheetRows<=B.r&&(L=!0),me=ti(Y=B.r),o["!row"]=B.r,(Be.hidden||Be.hpt||Be.level!=null)&&(Be.hpt&&(Be.hpx=Zd(Be.hpt)),Ut[Be.r]=Be);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(U={t:Be[2]},Be[2]){case"n":U.v=Be[1];break;case"s":G=vd[Be[1]],U.v=G.t,U.r=G.r;break;case"b":U.v=!!Be[1];break;case"e":U.v=Be[1],o.cellText!==!1&&(U.w=Bc[U.v]);break;case"str":U.t="s",U.v=Be[1];break;case"is":U.t="s",U.v=Be[1].t;break}if((V=x.CellXf[Be[0].iStyleRef])&&oA(U,V.numFmtId,null,o,m,x),X=Be[0].c==-1?X+1:Be[0].c,o.dense?(S[Y]||(S[Y]=[]),S[Y][X]=U):S[jn(X)+me]=U,o.cellFormula){for(ke=!1,se=0;se<Ie.length;++se){var Ee=Ie[se];B.r>=Ee[0].s.r&&B.r<=Ee[0].e.r&&X>=Ee[0].s.c&&X<=Ee[0].e.c&&(U.F=br(Ee[0]),ke=!0)}!ke&&Be.length>3&&(U.f=Be[3])}if(I.s.r>B.r&&(I.s.r=B.r),I.s.c>X&&(I.s.c=X),I.e.r<B.r&&(I.e.r=B.r),I.e.c<X&&(I.e.c=X),o.cellDates&&V&&U.t=="n"&&wh(hr[V.numFmtId])){var He=yc(U.v);He&&(U.t="d",U.v=new Date(He.y,He.m-1,He.d,He.H,He.M,He.S,He.u))}Bt&&(Bt.type=="XLDAPR"&&(U.D=!0),Bt=void 0);break;case 1:case 12:if(!o.sheetStubs||D)break;U={t:"z",v:void 0},X=Be[0].c==-1?X+1:Be[0].c,o.dense?(S[Y]||(S[Y]=[]),S[Y][X]=U):S[jn(X)+me]=U,I.s.r>B.r&&(I.s.r=B.r),I.s.c>X&&(I.s.c=X),I.e.r<B.r&&(I.e.r=B.r),I.e.c<X&&(I.e.c=X),Bt&&(Bt.type=="XLDAPR"&&(U.D=!0),Bt=void 0);break;case 176:ge.push(Be);break;case 49:Bt=((o.xlmeta||{}).Cell||[])[Be-1];break;case 494:var Re=l["!id"][Be.relId];for(Re?(Be.Target=Re.Target,Be.loc&&(Be.Target+="#"+Be.loc),Be.Rel=Re):Be.relId==""&&(Be.Target="#"+Be.loc),Y=Be.rfx.s.r;Y<=Be.rfx.e.r;++Y)for(X=Be.rfx.s.c;X<=Be.rfx.e.c;++X)o.dense?(S[Y]||(S[Y]=[]),S[Y][X]||(S[Y][X]={t:"z",v:void 0}),S[Y][X].l=Be):(K=lr({c:X,r:Y}),S[K]||(S[K]={t:"z",v:void 0}),S[K].l=Be);break;case 426:if(!o.cellFormula)break;Ie.push(Be),Ae=o.dense?S[Y][X]:S[jn(X)+me],Ae.f=mi(Be[1],I,{r:B.r,c:X},$e,o),Ae.F=br(Be[0]);break;case 427:if(!o.cellFormula)break;Xe[lr(Be[0].s)]=Be[1],Ae=o.dense?S[Y][X]:S[jn(X)+me],Ae.f=mi(Be[1],I,{r:B.r,c:X},$e,o);break;case 60:if(!o.cellStyles)break;for(;Be.e>=Be.s;)dt[Be.e--]={width:Be.w/256,hidden:!!(Be.flags&1),level:Be.level},kt||(kt=!0,Wy(Be.w/256)),_h(dt[Be.e+1]);break;case 161:S["!autofilter"]={ref:br(Be)};break;case 476:S["!margins"]=Be;break;case 147:u.Sheets[n]||(u.Sheets[n]={}),Be.name&&(u.Sheets[n].CodeName=Be.name),(Be.above||Be.left)&&(S["!outline"]={above:Be.above,left:Be.left});break;case 137:u.Views||(u.Views=[{}]),u.Views[0]||(u.Views[0]={}),Be.RTL&&(u.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:D=!0;break;case 36:D=!1;break;case 37:D=!0;break;case 38:D=!1;break;default:if(!Tt.T){if(!D||o.WTF)throw new Error("Unexpected record 0x"+Dt.toString(16))}}},o),delete o.supbooks,delete o["!row"],!S["!ref"]&&(I.s.r<2e6||A&&(A.e.r>0||A.e.c>0||A.s.r>0||A.s.c>0))&&(S["!ref"]=br(A||I)),o.sheetRows&&S["!ref"]){var zt=wn(S["!ref"]);o.sheetRows<=+zt.e.r&&(zt.e.r=o.sheetRows-1,zt.e.r>I.e.r&&(zt.e.r=I.e.r),zt.e.r<zt.s.r&&(zt.s.r=zt.e.r),zt.e.c>I.e.c&&(zt.e.c=I.e.c),zt.e.c<zt.s.c&&(zt.s.c=zt.e.c),S["!fullref"]=S["!ref"],S["!ref"]=br(zt))}return ge.length>0&&(S["!merges"]=ge),dt.length>0&&(S["!cols"]=dt),Ut.length>0&&(S["!rows"]=Ut),S}function D6(e){var r=[],n=e.match(/^<c:numCache>/),l;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(m){var x=m.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);!x||(r[+x[1]]=n?+x[2]:x[2])});var u=Ar((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(m){l=m.replace(/<.*?>/g,"")}),[r,u,l]}function F6(e,r,n,l,u,m){var x=m||{"!type":"chart"};if(!e)return m;var o=0,S=0,A="A",I={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(D){var L=D6(D);I.s.r=I.s.c=0,I.e.c=o,A=jn(o),L[0].forEach(function(B,U){x[A+ti(U)]={t:"n",v:B,z:L[1]},S=U}),I.e.r<S&&(I.e.r=S),++o}),o>0&&(x["!ref"]=br(I)),x}function P6(e,r,n,l,u){if(!e)return e;l||(l={"!id":{}});var m={"!type":"chart","!drawel":null,"!rel":""},x,o=e.match(lA);return o&&Hy(o[0],m,u,n),(x=e.match(/drawing r:id="(.*?)"/))&&(m["!rel"]=x[1]),l["!id"][m["!rel"]]&&(m["!drawel"]=l["!id"][m["!rel"]]),m}function L6(e,r){e.l+=10;var n=xi(e);return{name:n}}function R6(e,r,n,l,u){if(!e)return e;l||(l={"!id":{}});var m={"!type":"chart","!drawel":null,"!rel":""},x=!1;return ko(e,function(S,A,I){switch(I){case 550:m["!rel"]=S;break;case 651:u.Sheets[n]||(u.Sheets[n]={}),S.name&&(u.Sheets[n].CodeName=S.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:x=!0;break;case 36:x=!1;break;case 37:break;case 38:break;default:if(!(A.T>0)){if(!(A.T<0)){if(!x||r.WTF)throw new Error("Unexpected record 0x"+I.toString(16))}}}},r),l["!id"][m["!rel"]]&&(m["!drawel"]=l["!id"][m["!rel"]]),m}var uA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],z6=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],O6=[],B6=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function gE(e,r){for(var n=0;n!=e.length;++n)for(var l=e[n],u=0;u!=r.length;++u){var m=r[u];if(l[m[0]]==null)l[m[0]]=m[1];else switch(m[2]){case"bool":typeof l[m[0]]=="string"&&(l[m[0]]=rn(l[m[0]]));break;case"int":typeof l[m[0]]=="string"&&(l[m[0]]=parseInt(l[m[0]],10));break}}}function xE(e,r){for(var n=0;n!=r.length;++n){var l=r[n];if(e[l[0]]==null)e[l[0]]=l[1];else switch(l[2]){case"bool":typeof e[l[0]]=="string"&&(e[l[0]]=rn(e[l[0]]));break;case"int":typeof e[l[0]]=="string"&&(e[l[0]]=parseInt(e[l[0]],10));break}}}function hA(e){xE(e.WBProps,uA),xE(e.CalcPr,B6),gE(e.WBView,z6),gE(e.Sheets,O6),sh.date1904=rn(e.WBProps.date1904)}var N6="][*?/\\".split("");function U6(e,r){if(e.length>31){if(r)return!1;throw new Error("Sheet names cannot exceed 31 chars")}var n=!0;return N6.forEach(function(l){if(e.indexOf(l)!=-1){if(!r)throw new Error("Sheet name cannot contain : \\ / ? * [ ]");n=!1}}),n}var V6=/<\w+:workbook/;function j6(e,r){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},l=!1,u="xmlns",m={},x=0;if(e.replace(wi,function(S,A){var I=nr(S);switch($s(I[0])){case"<?xml":break;case"<workbook":S.match(V6)&&(u="xmlns"+S.match(/<(\w+):/)[1]),n.xmlns=I[u];break;case"</workbook>":break;case"<fileVersion":delete I[0],n.AppVersion=I;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":uA.forEach(function(D){if(I[D[0]]!=null)switch(D[2]){case"bool":n.WBProps[D[0]]=rn(I[D[0]]);break;case"int":n.WBProps[D[0]]=parseInt(I[D[0]],10);break;default:n.WBProps[D[0]]=I[D[0]]}}),I.codeName&&(n.WBProps.CodeName=Hr(I.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete I[0],n.WBView.push(I);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(I.state){case"hidden":I.Hidden=1;break;case"veryHidden":I.Hidden=2;break;default:I.Hidden=0}delete I.state,I.name=Ar(Hr(I.name)),delete I[0],n.Sheets.push(I);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":l=!0;break;case"</definedNames>":l=!1;break;case"<definedName":m={},m.Name=Hr(I.name),I.comment&&(m.Comment=I.comment),I.localSheetId&&(m.Sheet=+I.localSheetId),rn(I.hidden||"0")&&(m.Hidden=!0),x=A+S.length;break;case"</definedName>":m.Ref=Ar(Hr(e.slice(x,A))),n.Names.push(m);break;case"<definedName/>":break;case"<calcPr":delete I[0],n.CalcPr=I;break;case"<calcPr/>":delete I[0],n.CalcPr=I;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":l=!0;break;case"</ext>":l=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":l=!0;break;case"</AlternateContent>":l=!1;break;case"<revisionPtr":break;default:if(!l&&r.WTF)throw new Error("unrecognized "+I[0]+" in workbook")}return S}),sF.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return hA(n),n}function G6(e,r){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=E1(e),n.name=xi(e),n}function $6(e,r){var n={},l=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var u=r>8?xi(e):"";return u.length>0&&(n.CodeName=u),n.autoCompressPictures=!!(l&65536),n.backupFile=!!(l&64),n.checkCompatibility=!!(l&4096),n.date1904=!!(l&1),n.filterPrivacy=!!(l&8),n.hidePivotFieldList=!!(l&1024),n.promptedSolutions=!!(l&16),n.publishItems=!!(l&2048),n.refreshAllConnections=!!(l&262144),n.saveExternalLinkValues=!!(l&128),n.showBorderUnselectedTables=!!(l&4),n.showInkAnnotation=!!(l&32),n.showObjects=["all","placeholders","none"][l>>13&3],n.showPivotChartFilter=!!(l&32768),n.updateLinks=["userSet","never","always"][l>>8&3],n}function W6(e,r){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=r-8,n}function Z6(e,r,n){var l=e.l+r;e.l+=4,e.l+=1;var u=e.read_shift(4),m=bF(e),x=Iz(e,0,n),o=Uy(e);e.l=l;var S={Name:m,Ptg:x};return u<268435455&&(S.Sheet=u),o&&(S.Comment=o),S}function H6(e,r){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},l=[],u=!1;r||(r={}),r.biff=12;var m=[],x=[[]];return x.SheetNames=[],x.XTI=[],Qm[16]={n:"BrtFRTArchID$",f:W6},ko(e,function(S,A,I){switch(I){case 156:x.SheetNames.push(S.name),n.Sheets.push(S);break;case 153:n.WBProps=S;break;case 39:S.Sheet!=null&&(r.SID=S.Sheet),S.Ref=mi(S.Ptg,null,null,x,r),delete r.SID,delete S.Ptg,m.push(S);break;case 1036:break;case 357:case 358:case 355:case 667:x[0].length?x.push([I,S]):x[0]=[I,S],x[x.length-1].XTI=[];break;case 362:x.length===0&&(x[0]=[],x[0].XTI=[]),x[x.length-1].XTI=x[x.length-1].XTI.concat(S),x.XTI=x.XTI.concat(S);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:l.push(I),u=!0;break;case 36:l.pop(),u=!1;break;case 37:l.push(I),u=!0;break;case 38:l.pop(),u=!1;break;case 16:break;default:if(!A.T){if(!u||r.WTF&&l[l.length-1]!=37&&l[l.length-1]!=35)throw new Error("Unexpected record 0x"+I.toString(16))}}},r),hA(n),n.Names=m,n.supbooks=x,n}function X6(e,r,n){return r.slice(-4)===".bin"?H6(e,n):j6(e,n)}function q6(e,r,n,l,u,m,x,o){return r.slice(-4)===".bin"?M6(e,l,n,u,m,x,o):Gz(e,l,n,u,m,x,o)}function K6(e,r,n,l,u,m,x,o){return r.slice(-4)===".bin"?R6(e,l,n,u,m):P6(e,l,n,u,m)}function Y6(e,r,n,l,u,m,x,o){return r.slice(-4)===".bin"?a5():s5()}function J6(e,r,n,l,u,m,x,o){return r.slice(-4)===".bin"?n5():i5()}function Q6(e,r,n,l){return r.slice(-4)===".bin"?vR(e,n,l):pR(e,n,l)}function eO(e,r,n){return Yk(e,n)}function tO(e,r,n){return r.slice(-4)===".bin"?zL(e,n):LL(e,n)}function rO(e,r,n){return r.slice(-4)===".bin"?e5(e,n):qR(e,n)}function nO(e,r,n){return r.slice(-4)===".bin"?ZR(e):$R(e)}function iO(e,r,n,l){return n.slice(-4)===".bin"?HR(e,r,n,l):void 0}function aO(e,r,n){return r.slice(-4)===".bin"?jR(e,r,n):GR(e,r,n)}var fA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,dA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function is(e,r){var n=e.split(/\s+/),l=[];if(r||(l[0]=n[0]),n.length===1)return l;var u=e.match(fA),m,x,o,S;if(u)for(S=0;S!=u.length;++S)m=u[S].match(dA),(x=m[1].indexOf(":"))===-1?l[m[1]]=m[2].slice(1,m[2].length-1):(m[1].slice(0,6)==="xmlns:"?o="xmlns"+m[1].slice(6):o=m[1].slice(x+1),l[o]=m[2].slice(1,m[2].length-1));return l}function sO(e){var r=e.split(/\s+/),n={};if(r.length===1)return n;var l=e.match(fA),u,m,x,o;if(l)for(o=0;o!=l.length;++o)u=l[o].match(dA),(m=u[1].indexOf(":"))===-1?n[u[1]]=u[2].slice(1,u[2].length-1):(u[1].slice(0,6)==="xmlns:"?x="xmlns"+u[1].slice(6):x=u[1].slice(m+1),n[x]=u[2].slice(1,u[2].length-1));return n}var Td;function oO(e,r){var n=Td[e]||Ar(e);return n==="General"?Cc(r):Wa(n,r)}function lO(e,r,n,l){var u=l;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":u=rn(l);break;case"i2":case"int":u=parseInt(l,10);break;case"r4":case"float":u=parseFloat(l);break;case"date":case"dateTime.tz":u=Kn(l);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[Ar(r)]=u}function cO(e,r,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Bc[e.v]:r==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vd(e.v):e.w=Cc(e.v):e.w=oO(r||"General",e.v)}catch(m){if(n.WTF)throw m}try{var l=Td[r]||r||"General";if(n.cellNF&&(e.z=l),n.cellDates&&e.t=="n"&&wh(l)){var u=yc(e.v);u&&(e.t="d",e.v=new Date(u.y,u.m-1,u.d,u.H,u.M,u.S,u.u))}}catch(m){if(n.WTF)throw m}}}function uO(e,r,n){if(n.cellStyles&&r.Interior){var l=r.Interior;l.Pattern&&(l.patternType=lR[l.Pattern]||l.Pattern)}e[r.ID]=r}function hO(e,r,n,l,u,m,x,o,S,A){var I="General",D=l.StyleID,L={};A=A||{};var B=[],U=0;for(D===void 0&&o&&(D=o.StyleID),D===void 0&&x&&(D=x.StyleID);m[D]!==void 0&&(m[D].nf&&(I=m[D].nf),m[D].Interior&&B.push(m[D].Interior),!!m[D].Parent);)D=m[D].Parent;switch(n.Type){case"Boolean":l.t="b",l.v=rn(e);break;case"String":l.t="s",l.r=UT(Ar(e)),l.v=e.indexOf("<")>-1?Ar(r||e).replace(/<.*?>/g,""):l.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),l.v=(Kn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),l.v!==l.v?l.v=Ar(e):l.v<60&&(l.v=l.v-1),(!I||I=="General")&&(I="yyyy-mm-dd");case"Number":l.v===void 0&&(l.v=+e),l.t||(l.t="n");break;case"Error":l.t="e",l.v=Ik[e],A.cellText!==!1&&(l.w=e);break;default:e==""&&r==""?l.t="z":(l.t="s",l.v=UT(r||e));break}if(cO(l,I,A),A.cellFormula!==!1)if(l.Formula){var V=Ar(l.Formula);V.charCodeAt(0)==61&&(V=V.slice(1)),l.f=ah(V,u),delete l.Formula,l.ArrayRange=="RC"?l.F=ah("RC:RC",u):l.ArrayRange&&(l.F=ah(l.ArrayRange,u),S.push([wn(l.F),l.F]))}else for(U=0;U<S.length;++U)u.r>=S[U][0].s.r&&u.r<=S[U][0].e.r&&u.c>=S[U][0].s.c&&u.c<=S[U][0].e.c&&(l.F=S[U][1]);A.cellStyles&&(B.forEach(function(Y){!L.patternType&&Y.patternType&&(L.patternType=Y.patternType)}),l.s=L),l.StyleID!==void 0&&(l.ixfe=l.StyleID)}function fO(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Sx(e,r){var n=r||{};ek();var l=rd(Ry(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(l=Hr(l));var u=l.slice(0,1024).toLowerCase(),m=!1;if(u=u.replace(/".*?"/g,""),(u.indexOf(">")&1023)>Math.min(u.indexOf(",")&1023,u.indexOf(";")&1023)){var x=ei(n);return x.type="string",$d.to_workbook(l,x)}if(u.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ir){u.indexOf("<"+Ir)>=0&&(m=!0)}),m)return wO(l,n);Td={"General Number":"General","General Date":hr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":hr[15],"Short Date":hr[14],"Long Time":hr[19],"Medium Time":hr[18],"Short Time":hr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:hr[2],Standard:hr[4],Percent:hr[10],Scientific:hr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,S=[],A,I={},D=[],L=n.dense?[]:{},B="",U={},V={},Y=is('<Data ss:Type="String">'),X=0,K=0,G=0,me={s:{r:2e6,c:2e6},e:{r:0,c:0}},Ae={},ge={},se="",ke=0,Ie=[],Xe={},$e={},We=0,dt=[],Ut=[],kt={},Bt=[],zt,gt=!1,Be=[],Tt=[],Dt={},Ee=0,He=0,Re={Sheets:[],WBProps:{date1904:!1}},Oe={};Gd.lastIndex=0,l=l.replace(/<!--([\s\S]*?)-->/mg,"");for(var at="";o=Gd.exec(l);)switch(o[3]=(at=o[3]).toLowerCase()){case"data":if(at=="data"){if(o[1]==="/"){if((A=S.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&S.push([o[3],!0]);break}if(S[S.length-1][1])break;o[1]==="/"?hO(l.slice(X,o.index),se,Y,S[S.length-1][0]=="comment"?kt:U,{c:K,r:G},Ae,Bt[K],V,Be,n):(se="",Y=is(o[0]),X=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Ut.length>0&&(U.c=Ut),(!n.sheetRows||n.sheetRows>G)&&U.v!==void 0&&(n.dense?(L[G]||(L[G]=[]),L[G][K]=U):L[jn(K)+ti(G)]=U),U.HRef&&(U.l={Target:Ar(U.HRef)},U.HRefScreenTip&&(U.l.Tooltip=U.HRefScreenTip),delete U.HRef,delete U.HRefScreenTip),(U.MergeAcross||U.MergeDown)&&(Ee=K+(parseInt(U.MergeAcross,10)|0),He=G+(parseInt(U.MergeDown,10)|0),Ie.push({s:{c:K,r:G},e:{c:Ee,r:He}})),!n.sheetStubs)U.MergeAcross?K=Ee+1:++K;else if(U.MergeAcross||U.MergeDown){for(var bt=K;bt<=Ee;++bt)for(var Ot=G;Ot<=He;++Ot)(bt>K||Ot>G)&&(n.dense?(L[Ot]||(L[Ot]=[]),L[Ot][bt]={t:"z"}):L[jn(bt)+ti(Ot)]={t:"z"});K=Ee+1}else++K;else U=sO(o[0]),U.Index&&(K=+U.Index-1),K<me.s.c&&(me.s.c=K),K>me.e.c&&(me.e.c=K),o[0].slice(-2)==="/>"&&++K,Ut=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(G<me.s.r&&(me.s.r=G),G>me.e.r&&(me.e.r=G),o[0].slice(-2)==="/>"&&(V=is(o[0]),V.Index&&(G=+V.Index-1)),K=0,++G):(V=is(o[0]),V.Index&&(G=+V.Index-1),Dt={},(V.AutoFitHeight=="0"||V.Height)&&(Dt.hpx=parseInt(V.Height,10),Dt.hpt=Kk(Dt.hpx),Tt[G]=Dt),V.Hidden=="1"&&(Dt.hidden=!0,Tt[G]=Dt));break;case"worksheet":if(o[1]==="/"){if((A=S.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"));D.push(B),me.s.r<=me.e.r&&me.s.c<=me.e.c&&(L["!ref"]=br(me),n.sheetRows&&n.sheetRows<=me.e.r&&(L["!fullref"]=L["!ref"],me.e.r=n.sheetRows-1,L["!ref"]=br(me))),Ie.length&&(L["!merges"]=Ie),Bt.length>0&&(L["!cols"]=Bt),Tt.length>0&&(L["!rows"]=Tt),I[B]=L}else me={s:{r:2e6,c:2e6},e:{r:0,c:0}},G=K=0,S.push([o[3],!1]),A=is(o[0]),B=Ar(A.Name),L=n.dense?[]:{},Ie=[],Be=[],Tt=[],Oe={name:B,Hidden:0},Re.Sheets.push(Oe);break;case"table":if(o[1]==="/"){if((A=S.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else{if(o[0].slice(-2)=="/>")break;S.push([o[3],!1]),Bt=[],gt=!1}break;case"style":o[1]==="/"?uO(Ae,ge,n):ge=is(o[0]);break;case"numberformat":ge.nf=Ar(is(o[0]).Format||"General"),Td[ge.nf]&&(ge.nf=Td[ge.nf]);for(var At=0;At!=392&&hr[At]!=ge.nf;++At);if(At==392){for(At=57;At!=392;++At)if(hr[At]==null){Ec(ge.nf,At);break}}break;case"column":if(S[S.length-1][0]!=="table")break;if(zt=is(o[0]),zt.Hidden&&(zt.hidden=!0,delete zt.Hidden),zt.Width&&(zt.wpx=parseInt(zt.Width,10)),!gt&&zt.wpx>10){gt=!0,Bi=Xk;for(var yt=0;yt<Bt.length;++yt)Bt[yt]&&_h(Bt[yt])}gt&&_h(zt),Bt[zt.Index-1||Bt.length]=zt;for(var ar=0;ar<+zt.Span;++ar)Bt[Bt.length]=ei(zt);break;case"namedrange":if(o[1]==="/")break;Re.Names||(Re.Names=[]);var ve=nr(o[0]),Cr={Name:ve.Name,Ref:ah(ve.RefersTo.slice(1),{r:0,c:0})};Re.Sheets.length>0&&(Cr.Sheet=Re.Sheets.length-1),Re.Names.push(Cr);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?se+=l.slice(ke,o.index):ke=o.index+o[0].length;break;case"interior":if(!n.cellStyles)break;ge.Interior=is(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?qF(Xe,at,l.slice(We,o.index)):We=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((A=S.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else S.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((A=S.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"));fO(kt),Ut.push(kt)}else S.push([o[3],!1]),A=is(o[0]),kt={a:A.Author};break;case"autofilter":if(o[1]==="/"){if((A=S.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var dr=is(o[0]);L["!autofilter"]={ref:ah(dr.Range).replace(/\$/g,"")},S.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((A=S.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&S.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((A=S.pop())[0]!==o[3])throw new Error("Bad state: "+A.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&S.push([o[3],!0]);break;case"null":break;default:if(S.length==0&&o[3]=="document"||S.length==0&&o[3]=="uof")return bE(l,n);var or=!0;switch(S[S.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:or=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:or=!1}break;case"excelworkbook":switch(o[3]){case"date1904":Re.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:or=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:or=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(l.slice(We,o.index)){case"SheetHidden":Oe.Hidden=1;break;case"SheetVeryHidden":Oe.Hidden=2;break}else We=o.index+o[0].length;break;case"header":L["!margins"]||wd(L["!margins"]={},"xlml"),isNaN(+nr(o[0]).Margin)||(L["!margins"].header=+nr(o[0]).Margin);break;case"footer":L["!margins"]||wd(L["!margins"]={},"xlml"),isNaN(+nr(o[0]).Margin)||(L["!margins"].footer=+nr(o[0]).Margin);break;case"pagemargins":var ir=nr(o[0]);L["!margins"]||wd(L["!margins"]={},"xlml"),isNaN(+ir.Top)||(L["!margins"].top=+ir.Top),isNaN(+ir.Left)||(L["!margins"].left=+ir.Left),isNaN(+ir.Right)||(L["!margins"].right=+ir.Right),isNaN(+ir.Bottom)||(L["!margins"].bottom=+ir.Bottom);break;case"displayrighttoleft":Re.Views||(Re.Views=[]),Re.Views[0]||(Re.Views[0]={}),Re.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":L["!outline"]||(L["!outline"]={}),L["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":L["!outline"]||(L["!outline"]={}),L["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:or=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:or=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:or=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:or=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:or=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:or=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:or=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:or=!1}break;case"smarttags":break;default:or=!1;break}if(or||o[3].match(/!\[CDATA/))break;if(!S[S.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+S.join("|");if(S[S.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?lO($e,at,dt,l.slice(We,o.index)):(dt=o,We=o.index+o[0].length);break}if(n.WTF)throw"Unrecognized tag: "+o[3]+"|"+S.join("|")}var ut={};return!n.bookSheets&&!n.bookProps&&(ut.Sheets=I),ut.SheetNames=D,ut.Workbook=Re,ut.SSF=ei(hr),ut.Props=Xe,ut.Custprops=$e,ut}function A1(e,r){switch(Ky(r=r||{}),r.type||"base64"){case"base64":return Sx(ba(e),r);case"binary":case"buffer":case"file":return Sx(e,r);case"array":return Sx(Rc(e),r)}}function dO(e){var r={},n=e.content;if(n.l=28,r.AnsiUserType=n.read_shift(0,"lpstr-ansi"),r.AnsiClipboardFormat=AF(n),n.length-n.l<=4)return r;var l=n.read_shift(4);if(l==0||l>40||(n.l-=4,r.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(l=n.read_shift(4),l!==1907505652)||(r.UnicodeClipboardFormat=CF(n),l=n.read_shift(4),l==0||l>40))return r;n.l-=4,r.Reserved2=n.read_shift(0,"lpwstr")}var pO=[60,1084,2066,2165,2175];function mO(e,r,n,l,u){var m=l,x=[],o=n.slice(n.l,n.l+m);if(u&&u.enc&&u.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:u.enc.insitu(o)}x.push(o),n.l+=m;for(var S=_o(n,n.l),A=C1[S],I=0;A!=null&&pO.indexOf(S)>-1;)m=_o(n,n.l+2),I=n.l+4,S==2066?I+=4:(S==2165||S==2175)&&(I+=12),o=n.slice(I,n.l+4+m),x.push(o),n.l+=4+m,A=C1[S=_o(n,n.l)];var D=ll(x);Jn(D,0);var L=0;D.lens=[];for(var B=0;B<x.length;++B)D.lens.push(L),L+=x[B].length;if(D.length<l)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+D.length+" < "+l;return r.f(D,D.length,u)}function Rs(e,r,n){if(e.t!=="z"&&!!e.XF){var l=0;try{l=e.z||e.XF.numFmtId||0,r.cellNF&&(e.z=hr[l])}catch(m){if(r.WTF)throw m}if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Bc[e.v]:l===0||l=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=Vd(e.v):e.w=Cc(e.v):e.w=Wa(l,e.v,{date1904:!!n,dateNF:r&&r.dateNF})}catch(m){if(r.WTF)throw m}if(r.cellDates&&l&&e.t=="n"&&wh(hr[l]||String(l))){var u=yc(e.v);u&&(e.t="d",e.v=new Date(u.y,u.m-1,u.d,u.H,u.M,u.S,u.u))}}}function im(e,r,n){return{v:e,ixfe:r,t:n}}function _O(e,r){var n={opts:{}},l={},u=r.dense?[]:{},m={},x={},o=null,S=[],A="",I={},D,L="",B,U,V,Y,X={},K=[],G,me,Ae=[],ge=[],se={Sheets:[],WBProps:{date1904:!1},Views:[{}]},ke={},Ie=function(rr){return rr<8?bc[rr]:rr<64&&ge[rr-8]||bc[rr]},Xe=function(rr,zr,pn){var Nr=zr.XF.data;if(!(!Nr||!Nr.patternType||!pn||!pn.cellStyles)){zr.s={},zr.s.patternType=Nr.patternType;var ha;(ha=Wd(Ie(Nr.icvFore)))&&(zr.s.fgColor={rgb:ha}),(ha=Wd(Ie(Nr.icvBack)))&&(zr.s.bgColor={rgb:ha})}},$e=function(rr,zr,pn){if(!(Dt>1)&&!(pn.sheetRows&&rr.r>=pn.sheetRows)){if(pn.cellStyles&&zr.XF&&zr.XF.data&&Xe(rr,zr,pn),delete zr.ixfe,delete zr.XF,D=rr,L=lr(rr),(!x||!x.s||!x.e)&&(x={s:{r:0,c:0},e:{r:0,c:0}}),rr.r<x.s.r&&(x.s.r=rr.r),rr.c<x.s.c&&(x.s.c=rr.c),rr.r+1>x.e.r&&(x.e.r=rr.r+1),rr.c+1>x.e.c&&(x.e.c=rr.c+1),pn.cellFormula&&zr.f){for(var Nr=0;Nr<K.length;++Nr)if(!(K[Nr][0].s.c>rr.c||K[Nr][0].s.r>rr.r)&&!(K[Nr][0].e.c<rr.c||K[Nr][0].e.r<rr.r)){zr.F=br(K[Nr][0]),(K[Nr][0].s.c!=rr.c||K[Nr][0].s.r!=rr.r)&&delete zr.f,zr.f&&(zr.f=""+mi(K[Nr][1],x,rr,Be,We));break}}pn.dense?(u[rr.r]||(u[rr.r]=[]),u[rr.r][rr.c]=zr):u[L]=zr}},We={enc:!1,sbcch:0,snames:[],sharedf:X,arrayf:K,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!r&&!!r.cellStyles,WTF:!!r&&!!r.wtf};r.password&&(We.password=r.password);var dt,Ut=[],kt=[],Bt=[],zt=[],gt=!1,Be=[];Be.SheetNames=We.snames,Be.sharedf=We.sharedf,Be.arrayf=We.arrayf,Be.names=[],Be.XTI=[];var Tt=0,Dt=0,Ee=0,He=[],Re=[],Oe;We.codepage=1200,cs(1200);for(var at=!1;e.l<e.length-1;){var bt=e.l,Ot=e.read_shift(2);if(Ot===0&&Tt===10)break;var At=e.l===e.length?0:e.read_shift(2),yt=C1[Ot];if(yt&&yt.f){if(r.bookSheets&&Tt===133&&Ot!==133)break;if(Tt=Ot,yt.r===2||yt.r==12){var ar=e.read_shift(2);if(At-=2,!We.enc&&ar!==Ot&&((ar&255)<<8|ar>>8)!==Ot)throw new Error("rt mismatch: "+ar+"!="+Ot);yt.r==12&&(e.l+=10,At-=10)}var ve={};if(Ot===10?ve=yt.f(e,At,We):ve=mO(Ot,yt,e,At,We),Dt==0&&[9,521,1033,2057].indexOf(Tt)===-1)continue;switch(Ot){case 34:n.opts.Date1904=se.WBProps.date1904=ve;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(We.enc||(e.l=0),We.enc=ve,!r.password)throw new Error("File is password-protected");if(ve.valid==null)throw new Error("Encryption scheme unsupported");if(!ve.valid)throw new Error("Password is incorrect");break;case 92:We.lastuser=ve;break;case 66:var Cr=Number(ve);switch(Cr){case 21010:Cr=1200;break;case 32768:Cr=1e4;break;case 32769:Cr=1252;break}cs(We.codepage=Cr),at=!0;break;case 317:We.rrtabid=ve;break;case 25:We.winlocked=ve;break;case 439:n.opts.RefreshAll=ve;break;case 12:n.opts.CalcCount=ve;break;case 16:n.opts.CalcDelta=ve;break;case 17:n.opts.CalcIter=ve;break;case 13:n.opts.CalcMode=ve;break;case 14:n.opts.CalcPrecision=ve;break;case 95:n.opts.CalcSaveRecalc=ve;break;case 15:We.CalcRefMode=ve;break;case 2211:n.opts.FullCalc=ve;break;case 129:ve.fDialog&&(u["!type"]="dialog"),ve.fBelow||((u["!outline"]||(u["!outline"]={})).above=!0),ve.fRight||((u["!outline"]||(u["!outline"]={})).left=!0);break;case 224:Ae.push(ve);break;case 430:Be.push([ve]),Be[Be.length-1].XTI=[];break;case 35:case 547:Be[Be.length-1].push(ve);break;case 24:case 536:Oe={Name:ve.Name,Ref:mi(ve.rgce,x,null,Be,We)},ve.itab>0&&(Oe.Sheet=ve.itab-1),Be.names.push(Oe),Be[0]||(Be[0]=[],Be[0].XTI=[]),Be[Be.length-1].push(ve),ve.Name=="_xlnm._FilterDatabase"&&ve.itab>0&&ve.rgce&&ve.rgce[0]&&ve.rgce[0][0]&&ve.rgce[0][0][0]=="PtgArea3d"&&(Re[ve.itab-1]={ref:br(ve.rgce[0][0][1][2])});break;case 22:We.ExternCount=ve;break;case 23:Be.length==0&&(Be[0]=[],Be[0].XTI=[]),Be[Be.length-1].XTI=Be[Be.length-1].XTI.concat(ve),Be.XTI=Be.XTI.concat(ve);break;case 2196:if(We.biff<8)break;Oe!=null&&(Oe.Comment=ve[1]);break;case 18:u["!protect"]=ve;break;case 19:ve!==0&&We.WTF&&console.error("Password verifier: "+ve);break;case 133:m[ve.pos]=ve,We.snames.push(ve.name);break;case 10:{if(--Dt)break;if(x.e){if(x.e.r>0&&x.e.c>0){if(x.e.r--,x.e.c--,u["!ref"]=br(x),r.sheetRows&&r.sheetRows<=x.e.r){var dr=x.e.r;x.e.r=r.sheetRows-1,u["!fullref"]=u["!ref"],u["!ref"]=br(x),x.e.r=dr}x.e.r++,x.e.c++}Ut.length>0&&(u["!merges"]=Ut),kt.length>0&&(u["!objects"]=kt),Bt.length>0&&(u["!cols"]=Bt),zt.length>0&&(u["!rows"]=zt),se.Sheets.push(ke)}A===""?I=u:l[A]=u,u=r.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(We.biff===8&&(We.biff={9:2,521:3,1033:4}[Ot]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[ve.BIFFVer]||8),We.biffguess=ve.BIFFVer==0,ve.BIFFVer==0&&ve.dt==4096&&(We.biff=5,at=!0,cs(We.codepage=28591)),We.biff==8&&ve.BIFFVer==0&&ve.dt==16&&(We.biff=2),Dt++)break;if(u=r.dense?[]:{},We.biff<8&&!at&&(at=!0,cs(We.codepage=r.codepage||1252)),We.biff<5||ve.BIFFVer==0&&ve.dt==4096){A===""&&(A="Sheet1"),x={s:{r:0,c:0},e:{r:0,c:0}};var or={pos:e.l-At,name:A};m[or.pos]=or,We.snames.push(A)}else A=(m[bt]||{name:""}).name;ve.dt==32&&(u["!type"]="chart"),ve.dt==64&&(u["!type"]="macro"),Ut=[],kt=[],We.arrayf=K=[],Bt=[],zt=[],gt=!1,ke={Hidden:(m[bt]||{hs:0}).hs,name:A}}break;case 515:case 3:case 2:u["!type"]=="chart"&&(r.dense?(u[ve.r]||[])[ve.c]:u[lr({c:ve.c,r:ve.r})])&&++ve.c,G={ixfe:ve.ixfe,XF:Ae[ve.ixfe]||{},v:ve.val,t:"n"},Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e({c:ve.c,r:ve.r},G,r);break;case 5:case 517:G={ixfe:ve.ixfe,XF:Ae[ve.ixfe],v:ve.val,t:ve.t},Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e({c:ve.c,r:ve.r},G,r);break;case 638:G={ixfe:ve.ixfe,XF:Ae[ve.ixfe],v:ve.rknum,t:"n"},Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e({c:ve.c,r:ve.r},G,r);break;case 189:for(var ir=ve.c;ir<=ve.C;++ir){var ut=ve.rkrec[ir-ve.c][0];G={ixfe:ut,XF:Ae[ut],v:ve.rkrec[ir-ve.c][1],t:"n"},Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e({c:ir,r:ve.r},G,r)}break;case 6:case 518:case 1030:{if(ve.val=="String"){o=ve;break}if(G=im(ve.val,ve.cell.ixfe,ve.tt),G.XF=Ae[G.ixfe],r.cellFormula){var Ir=ve.formula;if(Ir&&Ir[0]&&Ir[0][0]&&Ir[0][0][0]=="PtgExp"){var hn=Ir[0][0][1][0],Xr=Ir[0][0][1][1],zn=lr({r:hn,c:Xr});X[zn]?G.f=""+mi(ve.formula,x,ve.cell,Be,We):G.F=((r.dense?(u[hn]||[])[Xr]:u[zn])||{}).F}else G.f=""+mi(ve.formula,x,ve.cell,Be,We)}Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e(ve.cell,G,r),o=ve}break;case 7:case 519:if(o)o.val=ve,G=im(ve,o.cell.ixfe,"s"),G.XF=Ae[G.ixfe],r.cellFormula&&(G.f=""+mi(o.formula,x,o.cell,Be,We)),Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e(o.cell,G,r),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{K.push(ve);var Wi=lr(ve[0].s);if(B=r.dense?(u[ve[0].s.r]||[])[ve[0].s.c]:u[Wi],r.cellFormula&&B){if(!o||!Wi||!B)break;B.f=""+mi(ve[1],x,ve[0],Be,We),B.F=br(ve[0])}}break;case 1212:{if(!r.cellFormula)break;if(L){if(!o)break;X[lr(o.cell)]=ve[0],B=r.dense?(u[o.cell.r]||[])[o.cell.c]:u[lr(o.cell)],(B||{}).f=""+mi(ve[0],x,D,Be,We)}}break;case 253:G=im(S[ve.isst].t,ve.ixfe,"s"),S[ve.isst].h&&(G.h=S[ve.isst].h),G.XF=Ae[G.ixfe],Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e({c:ve.c,r:ve.r},G,r);break;case 513:r.sheetStubs&&(G={ixfe:ve.ixfe,XF:Ae[ve.ixfe],t:"z"},Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e({c:ve.c,r:ve.r},G,r));break;case 190:if(r.sheetStubs)for(var ni=ve.c;ni<=ve.C;++ni){var fn=ve.ixfe[ni-ve.c];G={ixfe:fn,XF:Ae[fn],t:"z"},Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e({c:ni,r:ve.r},G,r)}break;case 214:case 516:case 4:G=im(ve.val,ve.ixfe,"s"),G.XF=Ae[G.ixfe],Ee>0&&(G.z=He[G.ixfe>>8&63]),Rs(G,r,n.opts.Date1904),$e({c:ve.c,r:ve.r},G,r);break;case 0:case 512:Dt===1&&(x=ve);break;case 252:S=ve;break;case 1054:if(We.biff==4){He[Ee++]=ve[1];for(var On=0;On<Ee+163&&hr[On]!=ve[1];++On);On>=163&&Ec(ve[1],Ee+163)}else Ec(ve[1],ve[0]);break;case 30:{He[Ee++]=ve;for(var dn=0;dn<Ee+163&&hr[dn]!=ve;++dn);dn>=163&&Ec(ve,Ee+163)}break;case 229:Ut=Ut.concat(ve);break;case 93:kt[ve.cmo[0]]=We.lastobj=ve;break;case 438:We.lastobj.TxO=ve;break;case 127:We.lastobj.ImData=ve;break;case 440:for(Y=ve[0].s.r;Y<=ve[0].e.r;++Y)for(V=ve[0].s.c;V<=ve[0].e.c;++V)B=r.dense?(u[Y]||[])[V]:u[lr({c:V,r:Y})],B&&(B.l=ve[1]);break;case 2048:for(Y=ve[0].s.r;Y<=ve[0].e.r;++Y)for(V=ve[0].s.c;V<=ve[0].e.c;++V)B=r.dense?(u[Y]||[])[V]:u[lr({c:V,r:Y})],B&&B.l&&(B.l.Tooltip=ve[1]);break;case 28:{if(We.biff<=5&&We.biff>=2)break;B=r.dense?(u[ve[0].r]||[])[ve[0].c]:u[lr(ve[0])];var Ti=kt[ve[2]];B||(r.dense?(u[ve[0].r]||(u[ve[0].r]=[]),B=u[ve[0].r][ve[0].c]={t:"z"}):B=u[lr(ve[0])]={t:"z"},x.e.r=Math.max(x.e.r,ve[0].r),x.s.r=Math.min(x.s.r,ve[0].r),x.e.c=Math.max(x.e.c,ve[0].c),x.s.c=Math.min(x.s.c,ve[0].c)),B.c||(B.c=[]),U={a:ve[1],t:Ti.TxO.t},B.c.push(U)}break;case 2173:BR(Ae[ve.ixfe],ve.ext);break;case 125:{if(!We.cellStyles)break;for(;ve.e>=ve.s;)Bt[ve.e--]={width:ve.w/256,level:ve.level||0,hidden:!!(ve.flags&1)},gt||(gt=!0,Wy(ve.w/256)),_h(Bt[ve.e+1])}break;case 520:{var Rr={};ve.level!=null&&(zt[ve.r]=Rr,Rr.level=ve.level),ve.hidden&&(zt[ve.r]=Rr,Rr.hidden=!0),ve.hpt&&(zt[ve.r]=Rr,Rr.hpt=ve.hpt,Rr.hpx=Zd(ve.hpt))}break;case 38:case 39:case 40:case 41:u["!margins"]||wd(u["!margins"]={}),u["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Ot]]=ve;break;case 161:u["!margins"]||wd(u["!margins"]={}),u["!margins"].header=ve.header,u["!margins"].footer=ve.footer;break;case 574:ve.RTL&&(se.Views[0].RTL=!0);break;case 146:ge=ve;break;case 2198:dt=ve;break;case 140:me=ve;break;case 442:A?ke.CodeName=ve||ke.name:se.WBProps.CodeName=ve||"ThisWorkbook";break}}else yt||console.error("Missing Info for XLS Record 0x"+Ot.toString(16)),e.l+=At}return n.SheetNames=js(m).sort(function(en,rr){return Number(en)-Number(rr)}).map(function(en){return m[en].name}),r.bookSheets||(n.Sheets=l),!n.SheetNames.length&&I["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=I)):n.Preamble=I,n.Sheets&&Re.forEach(function(en,rr){n.Sheets[n.SheetNames[rr]]["!autofilter"]=en}),n.Strings=S,n.SSF=ei(hr),We.enc&&(n.Encryption=We.enc),dt&&(n.Themes=dt),n.Metadata={},me!==void 0&&(n.Metadata.Country=me),Be.names.length>0&&(se.Names=Be.names),n.Workbook=se,n}var yE={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gO(e,r,n){var l=wr.find(e,"/!DocumentSummaryInformation");if(l&&l.size>0)try{var u=rE(l,LF,yE.DSI);for(var m in u)r[m]=u[m]}catch(A){if(n.WTF)throw A}var x=wr.find(e,"/!SummaryInformation");if(x&&x.size>0)try{var o=rE(x,RF,yE.SI);for(var S in o)r[S]==null&&(r[S]=o[S])}catch(A){if(n.WTF)throw A}r.HeadingPairs&&r.TitlesOfParts&&(Dk(r.HeadingPairs,r.TitlesOfParts,r,n),delete r.HeadingPairs,delete r.TitlesOfParts)}function pA(e,r){r||(r={}),Ky(r),jS(),r.codepage&&Cy(r.codepage);var n,l;if(e.FullPaths){if(wr.find(e,"/encryption"))throw new Error("File is password-protected");n=wr.find(e,"!CompObj"),l=wr.find(e,"/Workbook")||wr.find(e,"/Book")}else{switch(r.type){case"base64":e=ls(ba(e));break;case"binary":e=ls(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jn(e,0),l={content:e}}var u,m;if(n&&dO(n),r.bookProps&&!r.bookSheets)u={};else{var x=vr?"buffer":"array";if(l&&l.content)u=_O(l.content,r);else if((m=wr.find(e,"PerfectOffice_MAIN"))&&m.content)u=yd.to_workbook(m.content,(r.type=x,r));else if((m=wr.find(e,"NativeContent_MAIN"))&&m.content)u=yd.to_workbook(m.content,(r.type=x,r));else throw(m=wr.find(e,"MN0"))&&m.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r.bookVBA&&e.FullPaths&&wr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(u.vbaraw=r5(e))}var o={};return e.FullPaths&&gO(e,o,r),u.Props=u.Custprops=o,r.bookFiles&&(u.cfb=e),u}var Qm={0:{f:Jz},1:{f:r6},2:{f:h6},3:{f:s6},4:{f:i6},5:{f:u6},6:{f:p6},7:{f:l6},8:{f:y6},9:{f:x6},10:{f:_6},11:{f:g6},12:{f:n6},13:{f:f6},14:{f:o6},15:{f:a6},16:{f:cA},17:{f:m6},18:{f:c6},19:{f:Ny},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Z6},40:{},42:{},43:{f:_R},44:{f:mR},45:{f:gR},46:{f:yR},47:{f:xR},48:{},49:{f:vF},50:{},51:{f:UR},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Gk},62:{f:d6},63:{f:WR},64:{f:C6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:A6},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:t6},148:{f:Qz,p:16},151:{f:T6},152:{},153:{f:$6},154:{},155:{},156:{f:G6},157:{},158:{},159:{T:1,f:RL},160:{T:-1},161:{T:1,f:Oc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:v6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:NR},336:{T:-1},337:{f:VR,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:E1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:jk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:E6},427:{f:b6},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:k6},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:e6},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:w6},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:E1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:QR},633:{T:1},634:{T:-1},635:{T:1,f:JR},636:{T:-1},637:{f:TF},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:L6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:I6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},C1={6:{f:Ex},10:{f:rl},12:{f:Fn},13:{f:Fn},14:{f:bn},15:{f:bn},16:{f:_i},17:{f:bn},18:{f:bn},19:{f:Fn},20:{f:sE},21:{f:sE},23:{f:jk},24:{f:lE},25:{f:bn},26:{},27:{},28:{f:KP},29:{},34:{f:bn},35:{f:oE},38:{f:_i},39:{f:_i},40:{f:_i},41:{f:_i},42:{f:bn},43:{f:bn},47:{f:eR},49:{f:DP},51:{f:Fn},60:{},61:{f:CP},64:{f:bn},65:{f:MP},66:{f:Fn},77:{},80:{},81:{},82:{},85:{f:Fn},89:{},90:{},91:{},92:{f:vP},93:{f:JP},94:{},95:{f:bn},96:{},97:{},99:{f:bn},125:{f:Gk},128:{f:VP},129:{f:wP},130:{f:Fn},131:{f:bn},132:{f:bn},133:{f:TP},134:{},140:{f:iL},141:{f:Fn},144:{},146:{f:sL},151:{},152:{},153:{},154:{},155:{},156:{f:Fn},157:{},158:{},160:{f:hL},161:{f:lL},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:OP},190:{f:BP},193:{f:rl},197:{},198:{},199:{},200:{},201:{},202:{f:bn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Fn},220:{},221:{f:bn},222:{},224:{f:UP},225:{f:yP},226:{f:rl},227:{},229:{f:YP},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:EP},253:{f:FP},255:{f:bP},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:zk},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:bn},353:{f:rl},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:GP},431:{f:bn},432:{},433:{},434:{},437:{},438:{f:tL},439:{f:bn},440:{f:rL},441:{},442:{f:rp},443:{},444:{f:Fn},445:{},446:{},448:{f:rl},449:{f:AP,r:2},450:{f:rl},512:{f:iE},513:{f:uL},515:{f:jP},516:{f:PP},517:{f:aE},519:{f:fL},520:{f:SP},523:{},545:{f:cE},549:{f:nE},566:{},574:{f:IP},638:{f:zP},659:{},1048:{},1054:{f:LP},1084:{},1212:{f:HP},2048:{f:nL},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:tm},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:rl},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:oL,r:12},2173:{f:OR,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:bn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:ZP,r:12},2197:{},2198:{f:DR,r:12},2199:{},2200:{},2201:{},2202:{f:XP,r:12},2203:{f:rl},2204:{},2205:{},2206:{},2207:{},2211:{f:kP},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Fn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:cL},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:aL},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:iE},1:{},2:{f:_L},3:{f:mL},4:{f:pL},5:{f:aE},7:{f:gL},8:{},9:{f:tm},11:{},22:{f:Fn},30:{f:RP},31:{},32:{},33:{f:cE},36:{},37:{f:nE},50:{f:xL},62:{},52:{},67:{},68:{f:Fn},69:{},86:{},126:{},127:{f:dL},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:yL},223:{},234:{},354:{},421:{},518:{f:Ex},521:{f:tm},536:{f:lE},547:{f:oE},561:{},579:{},1030:{f:Ex},1033:{f:tm},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function as(e,r,n,l){var u=r;if(!isNaN(u)){var m=l||(n||[]).length||0,x=e.next(4);x.write_shift(2,u),x.write_shift(2,m),m>0&&Ek(n)&&e.push(n)}}function vE(e,r){var n=r||{},l=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var u=e.match(/<table/i);if(!u)throw new Error("Invalid HTML: could not find <table>");var m=e.match(/<\/table/i),x=u.index,o=m&&m.index||e.length,S=GD(e.slice(x,o),/(:?<tr[^>]*>)/i,"<tr>"),A=-1,I=0,D=0,L=0,B={s:{r:1e7,c:1e7},e:{r:0,c:0}},U=[];for(x=0;x<S.length;++x){var V=S[x].trim(),Y=V.slice(0,3).toLowerCase();if(Y=="<tr"){if(++A,n.sheetRows&&n.sheetRows<=A){--A;break}I=0;continue}if(!(Y!="<td"&&Y!="<th")){var X=V.split(/<\/t[dh]>/i);for(o=0;o<X.length;++o){var K=X[o].trim();if(!!K.match(/<t[dh]/i)){for(var G=K,me=0;G.charAt(0)=="<"&&(me=G.indexOf(">"))>-1;)G=G.slice(me+1);for(var Ae=0;Ae<U.length;++Ae){var ge=U[Ae];ge.s.c==I&&ge.s.r<A&&A<=ge.e.r&&(I=ge.e.c+1,Ae=-1)}var se=nr(K.slice(0,K.indexOf(">")));L=se.colspan?+se.colspan:1,((D=+se.rowspan)>1||L>1)&&U.push({s:{r:A,c:I},e:{r:A+(D||1)-1,c:I+L-1}});var ke=se.t||se["data-t"]||"";if(!G.length){I+=L;continue}if(G=uk(G),B.s.r>A&&(B.s.r=A),B.e.r<A&&(B.e.r=A),B.s.c>I&&(B.s.c=I),B.e.c<I&&(B.e.c=I),!G.length){I+=L;continue}var Ie={t:"s",v:G};n.raw||!G.trim().length||ke=="s"||(G==="TRUE"?Ie={t:"b",v:!0}:G==="FALSE"?Ie={t:"b",v:!1}:isNaN(fs(G))?isNaN(mh(G).getDate())||(Ie={t:"d",v:Kn(G)},n.cellDates||(Ie={t:"n",v:ji(Ie.v)}),Ie.z=n.dateNF||hr[14]):Ie={t:"n",v:fs(G)}),n.dense?(l[A]||(l[A]=[]),l[A][I]=Ie):l[lr({r:A,c:I})]=Ie,I+=L}}}}return l["!ref"]=br(B),U.length&&(l["!merges"]=U),l}function xO(e,r,n,l){for(var u=e["!merges"]||[],m=[],x=r.s.c;x<=r.e.c;++x){for(var o=0,S=0,A=0;A<u.length;++A)if(!(u[A].s.r>n||u[A].s.c>x)&&!(u[A].e.r<n||u[A].e.c<x)){if(u[A].s.r<n||u[A].s.c<x){o=-1;break}o=u[A].e.r-u[A].s.r+1,S=u[A].e.c-u[A].s.c+1;break}if(!(o<0)){var I=lr({r:n,c:x}),D=l.dense?(e[n]||[])[x]:e[I],L=D&&D.v!=null&&(D.h||Ly(D.w||(Eo(D),D.w)||""))||"",B={};o>1&&(B.rowspan=o),S>1&&(B.colspan=S),l.editable?L='<span contenteditable="true">'+L+"</span>":D&&(B["data-t"]=D&&D.t||"z",D.v!=null&&(B["data-v"]=D.v),D.z!=null&&(B["data-z"]=D.z),D.l&&(D.l.Target||"#").charAt(0)!="#"&&(L='<a href="'+D.l.Target+'">'+L+"</a>")),B.id=(l.id||"sjs")+"-"+I,m.push(iF("td",L,B))}}var U="<tr>";return U+m.join("")+"</tr>"}var yO='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vO="</body></html>";function wO(e,r){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Il(vE(n[0],r),r);var l=Jy();return n.forEach(function(u,m){Qy(l,vE(u,r),"Sheet"+(m+1))}),l}function TO(e,r,n){var l=[];return l.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function EO(e,r){var n=r||{},l=n.header!=null?n.header:yO,u=n.footer!=null?n.footer:vO,m=[l],x=Th(e["!ref"]);n.dense=Array.isArray(e),m.push(TO(e,x,n));for(var o=x.s.r;o<=x.e.r;++o)m.push(xO(e,x,o,n));return m.push("</table>"+u),m.join("")}function mA(e,r,n){var l=n||{},u=0,m=0;if(l.origin!=null)if(typeof l.origin=="number")u=l.origin;else{var x=typeof l.origin=="string"?Ni(l.origin):l.origin;u=x.r,m=x.c}var o=r.getElementsByTagName("tr"),S=Math.min(l.sheetRows||1e7,o.length),A={s:{r:0,c:0},e:{r:u,c:m}};if(e["!ref"]){var I=Th(e["!ref"]);A.s.r=Math.min(A.s.r,I.s.r),A.s.c=Math.min(A.s.c,I.s.c),A.e.r=Math.max(A.e.r,I.e.r),A.e.c=Math.max(A.e.c,I.e.c),u==-1&&(A.e.r=u=I.e.r+1)}var D=[],L=0,B=e["!rows"]||(e["!rows"]=[]),U=0,V=0,Y=0,X=0,K=0,G=0;for(e["!cols"]||(e["!cols"]=[]);U<o.length&&V<S;++U){var me=o[U];if(wE(me)){if(l.display)continue;B[V]={hidden:!0}}var Ae=me.children;for(Y=X=0;Y<Ae.length;++Y){var ge=Ae[Y];if(!(l.display&&wE(ge))){var se=ge.hasAttribute("data-v")?ge.getAttribute("data-v"):ge.hasAttribute("v")?ge.getAttribute("v"):uk(ge.innerHTML),ke=ge.getAttribute("data-z")||ge.getAttribute("z");for(L=0;L<D.length;++L){var Ie=D[L];Ie.s.c==X+m&&Ie.s.r<V+u&&V+u<=Ie.e.r&&(X=Ie.e.c+1-m,L=-1)}G=+ge.getAttribute("colspan")||1,((K=+ge.getAttribute("rowspan")||1)>1||G>1)&&D.push({s:{r:V+u,c:X+m},e:{r:V+u+(K||1)-1,c:X+m+(G||1)-1}});var Xe={t:"s",v:se},$e=ge.getAttribute("data-t")||ge.getAttribute("t")||"";se!=null&&(se.length==0?Xe.t=$e||"z":l.raw||se.trim().length==0||$e=="s"||(se==="TRUE"?Xe={t:"b",v:!0}:se==="FALSE"?Xe={t:"b",v:!1}:isNaN(fs(se))?isNaN(mh(se).getDate())||(Xe={t:"d",v:Kn(se)},l.cellDates||(Xe={t:"n",v:ji(Xe.v)}),Xe.z=l.dateNF||hr[14]):Xe={t:"n",v:fs(se)})),Xe.z===void 0&&ke!=null&&(Xe.z=ke);var We="",dt=ge.getElementsByTagName("A");if(dt&&dt.length)for(var Ut=0;Ut<dt.length&&!(dt[Ut].hasAttribute("href")&&(We=dt[Ut].getAttribute("href"),We.charAt(0)!="#"));++Ut);We&&We.charAt(0)!="#"&&(Xe.l={Target:We}),l.dense?(e[V+u]||(e[V+u]=[]),e[V+u][X+m]=Xe):e[lr({c:X+m,r:V+u})]=Xe,A.e.c<X+m&&(A.e.c=X+m),X+=G}}++V}return D.length&&(e["!merges"]=(e["!merges"]||[]).concat(D)),A.e.r=Math.max(A.e.r,V-1+u),e["!ref"]=br(A),V>=S&&(e["!fullref"]=br((A.e.r=o.length-U+V-1+u,A))),e}function _A(e,r){var n=r||{},l=n.dense?[]:{};return mA(l,e,r)}function bO(e,r){return Il(_A(e,r),r)}function wE(e){var r="",n=SO(e);return n&&(r=n(e).getPropertyValue("display")),r||(r=e.style&&e.style.display),r==="none"}function SO(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function kO(e){var r=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(l,u){return Array(parseInt(u,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=Ar(r.replace(/<[^>]*>/g,""));return[n]}var TE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function gA(e,r){var n=r||{},l=Ry(e),u=[],m,x,o={name:""},S="",A=0,I,D,L={},B=[],U=n.dense?[]:{},V,Y,X={value:""},K="",G=0,me=[],Ae=-1,ge=-1,se={s:{r:1e6,c:1e7},e:{r:0,c:0}},ke=0,Ie={},Xe=[],$e={},We=0,dt=0,Ut=[],kt=1,Bt=1,zt=[],gt={Names:[]},Be={},Tt=["",""],Dt=[],Ee={},He="",Re=0,Oe=!1,at=!1,bt=0;for(Gd.lastIndex=0,l=l.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");V=Gd.exec(l);)switch(V[3]=V[3].replace(/_.*$/,"")){case"table":case"\u5DE5\u4F5C\u8868":V[1]==="/"?(se.e.c>=se.s.c&&se.e.r>=se.s.r?U["!ref"]=br(se):U["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=se.e.r&&(U["!fullref"]=U["!ref"],se.e.r=n.sheetRows-1,U["!ref"]=br(se)),Xe.length&&(U["!merges"]=Xe),Ut.length&&(U["!rows"]=Ut),I.name=I.\u540D\u79F0||I.name,typeof JSON!="undefined"&&JSON.stringify(I),B.push(I.name),L[I.name]=U,at=!1):V[0].charAt(V[0].length-2)!=="/"&&(I=nr(V[0],!1),Ae=ge=-1,se.s.r=se.s.c=1e7,se.e.r=se.e.c=0,U=n.dense?[]:{},Xe=[],Ut=[],at=!0);break;case"table-row-group":V[1]==="/"?--ke:++ke;break;case"table-row":case"\u884C":if(V[1]==="/"){Ae+=kt,kt=1;break}if(D=nr(V[0],!1),D.\u884C\u53F7?Ae=D.\u884C\u53F7-1:Ae==-1&&(Ae=0),kt=+D["number-rows-repeated"]||1,kt<10)for(bt=0;bt<kt;++bt)ke>0&&(Ut[Ae+bt]={level:ke});ge=-1;break;case"covered-table-cell":V[1]!=="/"&&++ge,n.sheetStubs&&(n.dense?(U[Ae]||(U[Ae]=[]),U[Ae][ge]={t:"z"}):U[lr({r:Ae,c:ge})]={t:"z"}),K="",me=[];break;case"table-cell":case"\u6570\u636E":if(V[0].charAt(V[0].length-2)==="/")++ge,X=nr(V[0],!1),Bt=parseInt(X["number-columns-repeated"]||"1",10),Y={t:"z",v:null},X.formula&&n.cellFormula!=!1&&(Y.f=_E(Ar(X.formula))),(X.\u6570\u636E\u7C7B\u578B||X["value-type"])=="string"&&(Y.t="s",Y.v=Ar(X["string-value"]||""),n.dense?(U[Ae]||(U[Ae]=[]),U[Ae][ge]=Y):U[lr({r:Ae,c:ge})]=Y),ge+=Bt-1;else if(V[1]!=="/"){++ge,K="",G=0,me=[],Bt=1;var Ot=kt?Ae+kt-1:Ae;if(ge>se.e.c&&(se.e.c=ge),ge<se.s.c&&(se.s.c=ge),Ae<se.s.r&&(se.s.r=Ae),Ot>se.e.r&&(se.e.r=Ot),X=nr(V[0],!1),Dt=[],Ee={},Y={t:X.\u6570\u636E\u7C7B\u578B||X["value-type"],v:null},n.cellFormula)if(X.formula&&(X.formula=Ar(X.formula)),X["number-matrix-columns-spanned"]&&X["number-matrix-rows-spanned"]&&(We=parseInt(X["number-matrix-rows-spanned"],10)||0,dt=parseInt(X["number-matrix-columns-spanned"],10)||0,$e={s:{r:Ae,c:ge},e:{r:Ae+We-1,c:ge+dt-1}},Y.F=br($e),zt.push([$e,Y.F])),X.formula)Y.f=_E(X.formula);else for(bt=0;bt<zt.length;++bt)Ae>=zt[bt][0].s.r&&Ae<=zt[bt][0].e.r&&ge>=zt[bt][0].s.c&&ge<=zt[bt][0].e.c&&(Y.F=zt[bt][1]);switch((X["number-columns-spanned"]||X["number-rows-spanned"])&&(We=parseInt(X["number-rows-spanned"],10)||0,dt=parseInt(X["number-columns-spanned"],10)||0,$e={s:{r:Ae,c:ge},e:{r:Ae+We-1,c:ge+dt-1}},Xe.push($e)),X["number-columns-repeated"]&&(Bt=parseInt(X["number-columns-repeated"],10)),Y.t){case"boolean":Y.t="b",Y.v=rn(X["boolean-value"]);break;case"float":Y.t="n",Y.v=parseFloat(X.value);break;case"percentage":Y.t="n",Y.v=parseFloat(X.value);break;case"currency":Y.t="n",Y.v=parseFloat(X.value);break;case"date":Y.t="d",Y.v=Kn(X["date-value"]),n.cellDates||(Y.t="n",Y.v=ji(Y.v)),Y.z="m/d/yy";break;case"time":Y.t="n",Y.v=UD(X["time-value"])/86400,n.cellDates&&(Y.t="d",Y.v=v_(Y.v)),Y.z="HH:MM:SS";break;case"number":Y.t="n",Y.v=parseFloat(X.\u6570\u636E\u6570\u503C);break;default:if(Y.t==="string"||Y.t==="text"||!Y.t)Y.t="s",X["string-value"]!=null&&(K=Ar(X["string-value"]),me=[]);else throw new Error("Unsupported value type "+Y.t)}}else{if(Oe=!1,Y.t==="s"&&(Y.v=K||"",me.length&&(Y.R=me),Oe=G==0),Be.Target&&(Y.l=Be),Dt.length>0&&(Y.c=Dt,Dt=[]),K&&n.cellText!==!1&&(Y.w=K),Oe&&(Y.t="z",delete Y.v),(!Oe||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=Ae))for(var At=0;At<kt;++At){if(Bt=parseInt(X["number-columns-repeated"]||"1",10),n.dense)for(U[Ae+At]||(U[Ae+At]=[]),U[Ae+At][ge]=At==0?Y:ei(Y);--Bt>0;)U[Ae+At][ge+Bt]=ei(Y);else for(U[lr({r:Ae+At,c:ge})]=Y;--Bt>0;)U[lr({r:Ae+At,c:ge+Bt})]=ei(Y);se.e.c<=ge&&(se.e.c=ge)}Bt=parseInt(X["number-columns-repeated"]||"1",10),ge+=Bt-1,Bt=0,Y={},K="",me=[]}Be={};break;case"document":case"document-content":case"\u7535\u5B50\u8868\u683C\u6587\u6863":case"spreadsheet":case"\u4E3B\u4F53":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(V[1]==="/"){if((m=u.pop())[0]!==V[3])throw"Bad state: "+m}else V[0].charAt(V[0].length-2)!=="/"&&u.push([V[3],!0]);break;case"annotation":if(V[1]==="/"){if((m=u.pop())[0]!==V[3])throw"Bad state: "+m;Ee.t=K,me.length&&(Ee.R=me),Ee.a=He,Dt.push(Ee)}else V[0].charAt(V[0].length-2)!=="/"&&u.push([V[3],!1]);He="",Re=0,K="",G=0,me=[];break;case"creator":V[1]==="/"?He=l.slice(Re,V.index):Re=V.index+V[0].length;break;case"meta":case"\u5143\u6570\u636E":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(V[1]==="/"){if((m=u.pop())[0]!==V[3])throw"Bad state: "+m}else V[0].charAt(V[0].length-2)!=="/"&&u.push([V[3],!1]);K="",G=0,me=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(V[1]==="/"){if(Ie[o.name]=S,(m=u.pop())[0]!==V[3])throw"Bad state: "+m}else V[0].charAt(V[0].length-2)!=="/"&&(S="",o=nr(V[0],!1),u.push([V[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(u[u.length-1][0]){case"time-style":case"date-style":x=nr(V[0],!1),S+=TE[V[3]][x.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(u[u.length-1][0]){case"time-style":case"date-style":x=nr(V[0],!1),S+=TE[V[3]][x.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(V[0].slice(-2)==="/>")break;if(V[1]==="/")switch(u[u.length-1][0]){case"number-style":case"date-style":case"time-style":S+=l.slice(A,V.index);break}else A=V.index+V[0].length;break;case"named-range":x=nr(V[0],!1),Tt=bx(x["cell-range-address"]);var yt={Name:x.name,Ref:Tt[0]+"!"+Tt[1]};at&&(yt.Sheet=B.length),gt.Names.push(yt);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"\u7535\u5B50\u8868\u683C":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"\u6587\u672C\u4E32":if(["master-styles"].indexOf(u[u.length-1][0])>-1)break;if(V[1]==="/"&&(!X||!X["string-value"])){var ar=kO(l.slice(G,V.index));K=(K.length>0?K+`
`:"")+ar[0]}else nr(V[0],!1),G=V.index+V[0].length;break;case"s":break;case"database-range":if(V[1]==="/")break;try{Tt=bx(nr(V[0])["target-range-address"]),L[Tt[0]]["!autofilter"]={ref:Tt[1]}}catch{}break;case"date":break;case"object":break;case"title":case"\u6807\u9898":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(V[1]!=="/"){if(Be=nr(V[0],!1),!Be.href)break;Be.Target=Ar(Be.href),delete Be.href,Be.Target.charAt(0)=="#"&&Be.Target.indexOf(".")>-1?(Tt=bx(Be.Target.slice(1)),Be.Target="#"+Tt[0]+"!"+Tt[1]):Be.Target.match(/^\.\.[\\\/]/)&&(Be.Target=Be.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(V[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"\u8868:":case"\u5B57:":break;default:if(n.WTF)throw new Error(V)}}var ve={Sheets:L,SheetNames:B,Workbook:gt};return n.bookSheets&&delete ve.Sheets,ve}function EE(e,r){r=r||{},Oa(e,"META-INF/manifest.xml")&&jF(Dn(e,"META-INF/manifest.xml"),r);var n=va(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var l=gA(Hr(n),r);return Oa(e,"meta.xml")&&(l.Props=Mk(Dn(e,"meta.xml"))),l}function bE(e,r){return gA(e,r)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Xy(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function I1(e){return typeof TextDecoder!="undefined"?new TextDecoder().decode(e):Hr(Rc(e))}function M1(e){var r=e.reduce(function(u,m){return u+m.length},0),n=new Uint8Array(r),l=0;return e.forEach(function(u){n.set(u,l),l+=u.length}),n}function SE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function AO(e,r){for(var n=(e[r+15]&127)<<7|e[r+14]>>1,l=e[r+14]&1,u=r+13;u>=r;--u)l=l*256+e[u];return(e[r+15]&128?-l:l)*Math.pow(10,n-6176)}function Hd(e,r){var n=r?r[0]:0,l=e[n]&127;e:if(e[n++]>=128&&(l|=(e[n]&127)<<7,e[n++]<128||(l|=(e[n]&127)<<14,e[n++]<128)||(l|=(e[n]&127)<<21,e[n++]<128)||(l+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(l+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(l+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return r&&(r[0]=n),l}function Gn(e){var r=0,n=e[r]&127;e:if(e[r++]>=128){if(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128))break e;n|=(e[r]&127)<<28}return n}function gi(e){for(var r=[],n=[0];n[0]<e.length;){var l=n[0],u=Hd(e,n),m=u&7;u=Math.floor(u/8);var x=0,o;if(u==0)break;switch(m){case 0:{for(var S=n[0];e[n[0]++]>=128;);o=e.slice(S,n[0])}break;case 5:x=4,o=e.slice(n[0],n[0]+x),n[0]+=x;break;case 1:x=8,o=e.slice(n[0],n[0]+x),n[0]+=x;break;case 2:x=Hd(e,n),o=e.slice(n[0],n[0]+x),n[0]+=x;break;case 3:case 4:default:throw new Error("PB Type ".concat(m," for Field ").concat(u," at offset ").concat(l))}var A={data:o,type:m};r[u]==null?r[u]=[A]:r[u].push(A)}return r}function qy(e,r){return(e==null?void 0:e.map(function(n){return r(n.data)}))||[]}function CO(e){for(var r,n=[],l=[0];l[0]<e.length;){var u=Hd(e,l),m=gi(e.slice(l[0],l[0]+u));l[0]+=u;var x={id:Gn(m[1][0].data),messages:[]};m[2].forEach(function(o){var S=gi(o.data),A=Gn(S[3][0].data);x.messages.push({meta:S,data:e.slice(l[0],l[0]+A)}),l[0]+=A}),(r=m[3])!=null&&r[0]&&(x.merge=Gn(m[3][0].data)>>>0>0),n.push(x)}return n}function IO(e,r){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],l=Hd(r,n),u=[];n[0]<r.length;){var m=r[n[0]]&3;if(m==0){var x=r[n[0]++]>>2;if(x<60)++x;else{var o=x-59;x=r[n[0]],o>1&&(x|=r[n[0]+1]<<8),o>2&&(x|=r[n[0]+2]<<16),o>3&&(x|=r[n[0]+3]<<24),x>>>=0,x++,n[0]+=o}u.push(r.slice(n[0],n[0]+x)),n[0]+=x;continue}else{var S=0,A=0;if(m==1?(A=(r[n[0]]>>2&7)+4,S=(r[n[0]++]&224)<<3,S|=r[n[0]++]):(A=(r[n[0]++]>>2)+1,m==2?(S=r[n[0]]|r[n[0]+1]<<8,n[0]+=2):(S=(r[n[0]]|r[n[0]+1]<<8|r[n[0]+2]<<16|r[n[0]+3]<<24)>>>0,n[0]+=4)),u=[M1(u)],S==0)throw new Error("Invalid offset 0");if(S>u[0].length)throw new Error("Invalid offset beyond length");if(A>=S)for(u.push(u[0].slice(-S)),A-=S;A>=u[u.length-1].length;)u.push(u[u.length-1]),A-=u[u.length-1].length;u.push(u[0].slice(-S,-S+A))}}var I=M1(u);if(I.length!=l)throw new Error("Unexpected length: ".concat(I.length," != ").concat(l));return I}function MO(e){for(var r=[],n=0;n<e.length;){var l=e[n++],u=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,r.push(IO(l,e.slice(n,n+u))),n+=u}if(n!==e.length)throw new Error("data is not a valid framed stream!");return M1(r)}function DO(e,r,n,l){var u=Xy(e),m=u.getUint32(4,!0),x=(l>1?12:8)+SE(m&(l>1?3470:398))*4,o=-1,S=-1,A=NaN,I=new Date(2001,0,1);m&512&&(o=u.getUint32(x,!0),x+=4),x+=SE(m&(l>1?12288:4096))*4,m&16&&(S=u.getUint32(x,!0),x+=4),m&32&&(A=u.getFloat64(x,!0),x+=8),m&64&&(I.setTime(I.getTime()+u.getFloat64(x,!0)*1e3),x+=8);var D;switch(e[2]){case 0:break;case 2:D={t:"n",v:A};break;case 3:D={t:"s",v:r[S]};break;case 5:D={t:"d",v:I};break;case 6:D={t:"b",v:A>0};break;case 7:D={t:"n",v:A/86400};break;case 8:D={t:"e",v:0};break;case 9:if(o>-1)D={t:"s",v:n[o]};else if(S>-1)D={t:"s",v:r[S]};else if(!isNaN(A))D={t:"n",v:A};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return D}function FO(e,r,n){var l=Xy(e),u=l.getUint32(8,!0),m=12,x=-1,o=-1,S=NaN,A=NaN,I=new Date(2001,0,1);u&1&&(S=AO(e,m),m+=16),u&2&&(A=l.getFloat64(m,!0),m+=8),u&4&&(I.setTime(I.getTime()+l.getFloat64(m,!0)*1e3),m+=8),u&8&&(o=l.getUint32(m,!0),m+=4),u&16&&(x=l.getUint32(m,!0),m+=4);var D;switch(e[1]){case 0:break;case 2:D={t:"n",v:S};break;case 3:D={t:"s",v:r[o]};break;case 5:D={t:"d",v:I};break;case 6:D={t:"b",v:A>0};break;case 7:D={t:"n",v:A/86400};break;case 8:D={t:"e",v:0};break;case 9:if(x>-1)D={t:"s",v:n[x]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(u&31," : ").concat(e.slice(0,4)));break;case 10:D={t:"n",v:S};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(u&31," : ").concat(e.slice(0,4)))}return D}function PO(e,r,n){switch(e[0]){case 0:case 1:case 2:case 3:return DO(e,r,n,e[0]);case 5:return FO(e,r,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function vl(e){var r=gi(e);return Hd(r[1][0].data)}function kE(e,r){var n=gi(r.data),l=Gn(n[1][0].data),u=n[3],m=[];return(u||[]).forEach(function(x){var o=gi(x.data),S=Gn(o[1][0].data)>>>0;switch(l){case 1:m[S]=I1(o[3][0].data);break;case 8:{var A=e[vl(o[9][0].data)][0],I=gi(A.data),D=e[vl(I[1][0].data)][0],L=Gn(D.meta[1][0].data);if(L!=2001)throw new Error("2000 unexpected reference to ".concat(L));var B=gi(D.data);m[S]=B[3].map(function(U){return I1(U.data)}).join("")}break}}),m}function LO(e,r){var n,l,u,m,x,o,S,A,I,D,L,B,U,V,Y=gi(e),X=Gn(Y[1][0].data)>>>0,K=Gn(Y[2][0].data)>>>0,G=((l=(n=Y[8])==null?void 0:n[0])==null?void 0:l.data)&&Gn(Y[8][0].data)>0||!1,me,Ae;if(((m=(u=Y[7])==null?void 0:u[0])==null?void 0:m.data)&&r!=0)me=(o=(x=Y[7])==null?void 0:x[0])==null?void 0:o.data,Ae=(A=(S=Y[6])==null?void 0:S[0])==null?void 0:A.data;else if(((D=(I=Y[4])==null?void 0:I[0])==null?void 0:D.data)&&r!=1)me=(B=(L=Y[4])==null?void 0:L[0])==null?void 0:B.data,Ae=(V=(U=Y[3])==null?void 0:U[0])==null?void 0:V.data;else throw"NUMBERS Tile missing ".concat(r," cell storage");for(var ge=G?4:1,se=Xy(me),ke=[],Ie=0;Ie<me.length/2;++Ie){var Xe=se.getUint16(Ie*2,!0);Xe<65535&&ke.push([Ie,Xe])}if(ke.length!=K)throw"Expected ".concat(K," cells, found ").concat(ke.length);var $e=[];for(Ie=0;Ie<ke.length-1;++Ie)$e[ke[Ie][0]]=Ae.subarray(ke[Ie][1]*ge,ke[Ie+1][1]*ge);return ke.length>=1&&($e[ke[ke.length-1][0]]=Ae.subarray(ke[ke.length-1][1]*ge)),{R:X,cells:$e}}function RO(e,r){var n,l=gi(r.data),u=(n=l==null?void 0:l[7])!=null&&n[0]?Gn(l[7][0].data)>>>0>0?1:0:-1,m=qy(l[5],function(x){return LO(x,u)});return{nrows:Gn(l[4][0].data)>>>0,data:m.reduce(function(x,o){return x[o.R]||(x[o.R]=[]),o.cells.forEach(function(S,A){if(x[o.R][A])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(A));x[o.R][A]=S}),x},[])}}function zO(e,r,n){var l,u=gi(r.data),m={s:{r:0,c:0},e:{r:0,c:0}};if(m.e.r=(Gn(u[6][0].data)>>>0)-1,m.e.r<0)throw new Error("Invalid row varint ".concat(u[6][0].data));if(m.e.c=(Gn(u[7][0].data)>>>0)-1,m.e.c<0)throw new Error("Invalid col varint ".concat(u[7][0].data));n["!ref"]=br(m);var x=gi(u[4][0].data),o=kE(e,e[vl(x[4][0].data)][0]),S=(l=x[17])!=null&&l[0]?kE(e,e[vl(x[17][0].data)][0]):[],A=gi(x[3][0].data),I=0;A[1].forEach(function(D){var L=gi(D.data),B=e[vl(L[2][0].data)][0],U=Gn(B.meta[1][0].data);if(U!=6002)throw new Error("6001 unexpected reference to ".concat(U));var V=RO(e,B);V.data.forEach(function(Y,X){Y.forEach(function(K,G){var me=lr({r:I+X,c:G}),Ae=PO(K,o,S);Ae&&(n[me]=Ae)})}),I+=V.nrows})}function OO(e,r){var n=gi(r.data),l={"!ref":"A1"},u=e[vl(n[2][0].data)],m=Gn(u[0].meta[1][0].data);if(m!=6001)throw new Error("6000 unexpected reference to ".concat(m));return zO(e,u[0],l),l}function BO(e,r){var n,l=gi(r.data),u={name:(n=l[1])!=null&&n[0]?I1(l[1][0].data):"",sheets:[]},m=qy(l[2],vl);return m.forEach(function(x){e[x].forEach(function(o){var S=Gn(o.meta[1][0].data);S==6e3&&u.sheets.push(OO(e,o))})}),u}function NO(e,r){var n=Jy(),l=gi(r.data),u=qy(l[1],vl);if(u.forEach(function(m){e[m].forEach(function(x){var o=Gn(x.meta[1][0].data);if(o==2){var S=BO(e,x);S.sheets.forEach(function(A,I){Qy(n,A,I==0?S.name:S.name+"_"+I,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function kx(e){var r,n,l,u,m={},x=[];if(e.FullPaths.forEach(function(S){if(S.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(S){if(!!S.name.match(/\.iwa$/)){var A;try{A=MO(S.content)}catch(D){return console.log("?? "+S.content.length+" "+(D.message||D))}var I;try{I=CO(A)}catch(D){return console.log("## "+(D.message||D))}I.forEach(function(D){m[D.id]=D.messages,x.push(D.id)})}}),!x.length)throw new Error("File has no messages");var o=((u=(l=(n=(r=m==null?void 0:m[1])==null?void 0:r[0])==null?void 0:n.meta)==null?void 0:l[1])==null?void 0:u[0].data)&&Gn(m[1][0].meta[1][0].data)==1&&m[1][0];if(o||x.forEach(function(S){m[S].forEach(function(A){var I=Gn(A.meta[1][0].data)>>>0;if(I==1)if(!o)o=A;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return NO(m,o)}function UO(e){return function(n){for(var l=0;l!=e.length;++l){var u=e[l];n[u[0]]===void 0&&(n[u[0]]=u[1]),u[2]==="n"&&(n[u[0]]=Number(n[u[0]]))}}}function Ky(e){UO([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function VO(e){return Yu.WS.indexOf(e)>-1?"sheet":e==Yu.CS?"chart":e==Yu.DS?"dialog":e==Yu.MS?"macro":e&&e.length?e:"sheet"}function jO(e,r){if(!e)return 0;try{e=r.map(function(l){return l.id||(l.id=l.strRelID),[l.name,e["!id"][l.id].Target,VO(e["!id"][l.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function GO(e,r,n,l,u,m,x,o,S,A,I,D){try{m[l]=gd(va(e,n,!0),r);var L=Dn(e,r),B;switch(o){case"sheet":B=q6(L,r,u,S,m[l],A,I,D);break;case"chart":if(B=K6(L,r,u,S,m[l],A,I,D),!B||!B["!drawel"])break;var U=id(B["!drawel"].Target,r),V=b1(U),Y=XR(va(e,U,!0),gd(va(e,V,!0),U)),X=id(Y,U),K=b1(X);B=F6(va(e,X,!0),X,S,gd(va(e,K,!0),X),A,B);break;case"macro":B=Y6(L,r,u,S,m[l],A,I,D);break;case"dialog":B=J6(L,r,u,S,m[l],A,I,D);break;default:throw new Error("Unrecognized sheet type "+o)}x[l]=B;var G=[];m&&m[l]&&js(m[l]).forEach(function(me){var Ae="";if(m[l][me].Type==Yu.CMNT){Ae=id(m[l][me].Target,r);var ge=rO(Dn(e,Ae,!0),Ae,S);if(!ge||!ge.length)return;hE(B,ge,!1)}m[l][me].Type==Yu.TCMNT&&(Ae=id(m[l][me].Target,r),G=G.concat(KR(Dn(e,Ae,!0),S)))}),G&&G.length&&hE(B,G,!0,S.people||[])}catch(me){if(S.WTF)throw me}}function Ra(e){return e.charAt(0)=="/"?e.slice(1):e}function $O(e,r){if(ek(),r=r||{},Ky(r),Oa(e,"META-INF/manifest.xml")||Oa(e,"objectdata.xml"))return EE(e,r);if(Oa(e,"Index/Document.iwa")){if(typeof Uint8Array=="undefined")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof kx!="undefined"){if(e.FileIndex)return kx(e);var n=wr.utils.cfb_new();return BT(e).forEach(function(Ut){WD(n,Ut,sk(e,Ut))}),kx(n)}throw new Error("Unsupported NUMBERS file")}if(!Oa(e,"[Content_Types].xml"))throw Oa(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):Oa(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var l=BT(e),u=UF(va(e,"[Content_Types].xml")),m=!1,x,o;if(u.workbooks.length===0&&(o="xl/workbook.xml",Dn(e,o,!0)&&u.workbooks.push(o)),u.workbooks.length===0){if(o="xl/workbook.bin",!Dn(e,o,!0))throw new Error("Could not find workbook");u.workbooks.push(o),m=!0}u.workbooks[0].slice(-3)=="bin"&&(m=!0);var S={},A={};if(!r.bookSheets&&!r.bookProps){if(vd=[],u.sst)try{vd=tO(Dn(e,Ra(u.sst)),u.sst,r)}catch(Ut){if(r.WTF)throw Ut}r.cellStyles&&u.themes.length&&(S=eO(va(e,u.themes[0].replace(/^\//,""),!0)||"",u.themes[0],r)),u.style&&(A=Q6(Dn(e,Ra(u.style)),u.style,S,r))}u.links.map(function(Ut){try{var kt=gd(va(e,b1(Ra(Ut))),Ut);return iO(Dn(e,Ra(Ut)),kt,Ut,r)}catch{}});var I=X6(Dn(e,Ra(u.workbooks[0])),u.workbooks[0],r),D={},L="";u.coreprops.length&&(L=Dn(e,Ra(u.coreprops[0]),!0),L&&(D=Mk(L)),u.extprops.length!==0&&(L=Dn(e,Ra(u.extprops[0]),!0),L&&WF(L,D,r)));var B={};(!r.bookSheets||r.bookProps)&&u.custprops.length!==0&&(L=va(e,Ra(u.custprops[0]),!0),L&&(B=HF(L,r)));var U={};if((r.bookSheets||r.bookProps)&&(I.Sheets?x=I.Sheets.map(function(kt){return kt.name}):D.Worksheets&&D.SheetNames.length>0&&(x=D.SheetNames),r.bookProps&&(U.Props=D,U.Custprops=B),r.bookSheets&&typeof x!="undefined"&&(U.SheetNames=x),r.bookSheets?U.SheetNames:r.bookProps))return U;x={};var V={};r.bookDeps&&u.calcchain&&(V=nO(Dn(e,Ra(u.calcchain)),u.calcchain));var Y=0,X={},K,G;{var me=I.Sheets;D.Worksheets=me.length,D.SheetNames=[];for(var Ae=0;Ae!=me.length;++Ae)D.SheetNames[Ae]=me[Ae].name}var ge=m?"bin":"xml",se=u.workbooks[0].lastIndexOf("/"),ke=(u.workbooks[0].slice(0,se+1)+"_rels/"+u.workbooks[0].slice(se+1)+".rels").replace(/^\//,"");Oa(e,ke)||(ke="xl/_rels/workbook."+ge+".rels");var Ie=gd(va(e,ke,!0),ke.replace(/_rels.*/,"s5s"));(u.metadata||[]).length>=1&&(r.xlmeta=aO(Dn(e,Ra(u.metadata[0])),u.metadata[0],r)),(u.people||[]).length>=1&&(r.people=YR(Dn(e,Ra(u.people[0])),r)),Ie&&(Ie=jO(Ie,I.Sheets));var Xe=Dn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(Y=0;Y!=D.Worksheets;++Y){var $e="sheet";if(Ie&&Ie[Y]?(K="xl/"+Ie[Y][1].replace(/[\/]?xl\//,""),Oa(e,K)||(K=Ie[Y][1]),Oa(e,K)||(K=ke.replace(/_rels\/.*$/,"")+Ie[Y][1]),$e=Ie[Y][2]):(K="xl/worksheets/sheet"+(Y+1-Xe)+"."+ge,K=K.replace(/sheet0\./,"sheet.")),G=K.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),r&&r.sheets!=null)switch(typeof r.sheets){case"number":if(Y!=r.sheets)continue e;break;case"string":if(D.SheetNames[Y].toLowerCase()!=r.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(r.sheets)){for(var We=!1,dt=0;dt!=r.sheets.length;++dt)typeof r.sheets[dt]=="number"&&r.sheets[dt]==Y&&(We=1),typeof r.sheets[dt]=="string"&&r.sheets[dt].toLowerCase()==D.SheetNames[Y].toLowerCase()&&(We=1);if(!We)continue e}}GO(e,K,G,D.SheetNames[Y],Y,X,x,$e,r,I,S,A)}return U={Directory:u,Workbook:I,Props:D,Custprops:B,Deps:V,Sheets:x,SheetNames:D.SheetNames,Strings:vd,Styles:A,Themes:S,SSF:ei(hr)},r&&r.bookFiles&&(e.files?(U.keys=l,U.files=e.files):(U.keys=[],U.files={},e.FullPaths.forEach(function(Ut,kt){Ut=Ut.replace(/^Root Entry[\/]/,""),U.keys.push(Ut),U.files[Ut]=e.FileIndex[kt]}))),r&&r.bookVBA&&(u.vba.length>0?U.vbaraw=Dn(e,Ra(u.vba[0]),!0):u.defaults&&u.defaults.bin===t5&&(U.vbaraw=Dn(e,"xl/vbaProject.bin",!0))),U}function WO(e,r){var n=r||{},l="Workbook",u=wr.find(e,l);try{if(l="/!DataSpaces/Version",u=wr.find(e,l),!u||!u.content)throw new Error("ECMA-376 Encrypted file missing "+l);if(OL(u.content),l="/!DataSpaces/DataSpaceMap",u=wr.find(e,l),!u||!u.content)throw new Error("ECMA-376 Encrypted file missing "+l);var m=NL(u.content);if(m.length!==1||m[0].comps.length!==1||m[0].comps[0].t!==0||m[0].name!=="StrongEncryptionDataSpace"||m[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+l);if(l="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",u=wr.find(e,l),!u||!u.content)throw new Error("ECMA-376 Encrypted file missing "+l);var x=UL(u.content);if(x.length!=1||x[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+l);if(l="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",u=wr.find(e,l),!u||!u.content)throw new Error("ECMA-376 Encrypted file missing "+l);jL(u.content)}catch{}if(l="/EncryptionInfo",u=wr.find(e,l),!u||!u.content)throw new Error("ECMA-376 Encrypted file missing "+l);var o=GL(u.content);if(l="/EncryptedPackage",u=wr.find(e,l),!u||!u.content)throw new Error("ECMA-376 Encrypted file missing "+l);if(o[0]==4&&typeof decrypt_agile!="undefined")return decrypt_agile(o[1],u.content,n.password||"",n);if(o[0]==2&&typeof decrypt_std76!="undefined")return decrypt_std76(o[1],u.content,n.password||"",n);throw new Error("File is password-protected")}function Yy(e,r){var n="";switch((r||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=ba(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function ZO(e,r){return wr.find(e,"EncryptedPackage")?WO(e,r):pA(e,r)}function HO(e,r){var n,l=e,u=r||{};return u.type||(u.type=vr&&Buffer.isBuffer(e)?"buffer":"base64"),n=ok(l,u),$O(n,u)}function xA(e,r){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return A1(e.slice(n),r);default:break e}return $d.to_workbook(e,r)}function XO(e,r){var n="",l=Yy(e,r);switch(r.type){case"base64":n=ba(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Ic(e);break;default:throw new Error("Unrecognized type "+r.type)}return l[0]==239&&l[1]==187&&l[2]==191&&(n=Hr(n)),r.type="binary",xA(n,r)}function qO(e,r){var n=e;return r.type=="base64"&&(n=ba(n)),n=ol.utils.decode(1200,n.slice(2),"str"),r.type="binary",xA(n,r)}function KO(e){return e.match(/[^\x00-\x7F]/)?ad(e):e}function Ax(e,r,n,l){return l?(n.type="string",$d.to_workbook(e,n)):$d.to_workbook(r,n)}function D1(e,r){jS();var n=r||{};if(typeof ArrayBuffer!="undefined"&&e instanceof ArrayBuffer)return D1(new Uint8Array(e),(n=ei(n),n.type="array",n));typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno!="undefined"?"buffer":"array");var l=e,u=[0,0,0,0],m=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),sh={},n.dateNF&&(sh.dateNF=n.dateNF),n.type||(n.type=vr&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=vr?"buffer":"binary",l=BD(e),typeof Uint8Array!="undefined"&&!vr&&(n.type="array")),n.type=="string"&&(m=!0,n.type="binary",n.codepage=65001,l=KO(e)),n.type=="array"&&typeof Uint8Array!="undefined"&&e instanceof Uint8Array&&typeof ArrayBuffer!="undefined"){var x=new ArrayBuffer(3),o=new Uint8Array(x);if(o.foo="bar",!o.foo)return n=ei(n),n.type="array",D1(Iy(l),n)}switch((u=Yy(l,n))[0]){case 208:if(u[1]===207&&u[2]===17&&u[3]===224&&u[4]===161&&u[5]===177&&u[6]===26&&u[7]===225)return ZO(wr.read(l,n),n);break;case 9:if(u[1]<=8)return pA(l,n);break;case 60:return A1(l,n);case 73:if(u[1]===73&&u[2]===42&&u[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(u[1]===68)return bL(l,n);break;case 84:if(u[1]===65&&u[2]===66&&u[3]===76)return TL.to_workbook(l,n);break;case 80:return u[1]===75&&u[2]<9&&u[3]<9?HO(l,n):Ax(e,l,n,m);case 239:return u[3]===60?A1(l,n):Ax(e,l,n,m);case 255:if(u[1]===254)return qO(l,n);if(u[1]===0&&u[2]===2&&u[3]===0)return yd.to_workbook(l,n);break;case 0:if(u[1]===0&&(u[2]>=2&&u[3]===0||u[2]===0&&(u[3]===8||u[3]===9)))return yd.to_workbook(l,n);break;case 3:case 131:case 139:case 140:return uE.to_workbook(l,n);case 123:if(u[1]===92&&u[2]===114&&u[3]===116)return tR.to_workbook(l,n);break;case 10:case 13:case 32:return XO(l,n);case 137:if(u[1]===80&&u[2]===78&&u[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return vL.indexOf(u[0])>-1&&u[2]<=12&&u[3]<=31?uE.to_workbook(l,n):Ax(e,l,n,m)}function YO(e,r,n,l,u,m,x,o){var S=ti(n),A=o.defval,I=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),D=!0,L=u===1?[]:{};if(u!==1)if(Object.defineProperty)try{Object.defineProperty(L,"__rowNum__",{value:n,enumerable:!1})}catch{L.__rowNum__=n}else L.__rowNum__=n;if(!x||e[n])for(var B=r.s.c;B<=r.e.c;++B){var U=x?e[n][B]:e[l[B]+S];if(U===void 0||U.t===void 0){if(A===void 0)continue;m[B]!=null&&(L[m[B]]=A);continue}var V=U.v;switch(U.t){case"z":if(V==null)break;continue;case"e":V=V==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+U.t)}if(m[B]!=null){if(V==null)if(U.t=="e"&&V===null)L[m[B]]=null;else if(A!==void 0)L[m[B]]=A;else if(I&&V===null)L[m[B]]=null;else continue;else L[m[B]]=I&&(U.t!=="n"||U.t==="n"&&o.rawNumbers!==!1)?V:Eo(U,V,o);V!=null&&(D=!1)}}return{row:L,isempty:D}}function F1(e,r){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},l=0,u=1,m=[],x=0,o="",S={s:{r:0,c:0},e:{r:0,c:0}},A=r||{},I=A.range!=null?A.range:e["!ref"];switch(A.header===1?l=1:A.header==="A"?l=2:Array.isArray(A.header)?l=3:A.header==null&&(l=0),typeof I){case"string":S=wn(I);break;case"number":S=wn(e["!ref"]),S.s.r=I;break;default:S=I}l>0&&(u=0);var D=ti(S.s.r),L=[],B=[],U=0,V=0,Y=Array.isArray(e),X=S.s.r,K=0,G={};Y&&!e[X]&&(e[X]=[]);var me=A.skipHidden&&e["!cols"]||[],Ae=A.skipHidden&&e["!rows"]||[];for(K=S.s.c;K<=S.e.c;++K)if(!(me[K]||{}).hidden)switch(L[K]=jn(K),n=Y?e[X][K]:e[L[K]+D],l){case 1:m[K]=K-S.s.c;break;case 2:m[K]=L[K];break;case 3:m[K]=A.header[K-S.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),o=x=Eo(n,null,A),V=G[x]||0,!V)G[x]=1;else{do o=x+"_"+V++;while(G[o]);G[x]=V,G[o]=1}m[K]=o}for(X=S.s.r+u;X<=S.e.r;++X)if(!(Ae[X]||{}).hidden){var ge=YO(e,S,X,L,l,m,Y,A);(ge.isempty===!1||(l===1?A.blankrows!==!1:!!A.blankrows))&&(B[U++]=ge.row)}return B.length=U,B}var AE=/"/g;function JO(e,r,n,l,u,m,x,o){for(var S=!0,A=[],I="",D=ti(n),L=r.s.c;L<=r.e.c;++L)if(!!l[L]){var B=o.dense?(e[n]||[])[L]:e[l[L]+D];if(B==null)I="";else if(B.v!=null){S=!1,I=""+(o.rawNumbers&&B.t=="n"?B.v:Eo(B,null,o));for(var U=0,V=0;U!==I.length;++U)if((V=I.charCodeAt(U))===u||V===m||V===34||o.forceQuotes){I='"'+I.replace(AE,'""')+'"';break}I=="ID"&&(I='"ID"')}else B.f!=null&&!B.F?(S=!1,I="="+B.f,I.indexOf(",")>=0&&(I='"'+I.replace(AE,'""')+'"')):I="";A.push(I)}return o.blankrows===!1&&S?null:A.join(x)}function yA(e,r){var n=[],l=r==null?{}:r;if(e==null||e["!ref"]==null)return"";var u=wn(e["!ref"]),m=l.FS!==void 0?l.FS:",",x=m.charCodeAt(0),o=l.RS!==void 0?l.RS:`
`,S=o.charCodeAt(0),A=new RegExp((m=="|"?"\\|":m)+"+$"),I="",D=[];l.dense=Array.isArray(e);for(var L=l.skipHidden&&e["!cols"]||[],B=l.skipHidden&&e["!rows"]||[],U=u.s.c;U<=u.e.c;++U)(L[U]||{}).hidden||(D[U]=jn(U));for(var V=0,Y=u.s.r;Y<=u.e.r;++Y)(B[Y]||{}).hidden||(I=JO(e,u,Y,D,x,S,m,l),I!=null&&(l.strip&&(I=I.replace(A,"")),(I||l.blankrows!==!1)&&n.push((V++?o:"")+I)));return delete l.dense,n.join("")}function QO(e,r){r||(r={}),r.FS="	",r.RS=`
`;var n=yA(e,r);return n}function eB(e){var r="",n,l="";if(e==null||e["!ref"]==null)return[];var u=wn(e["!ref"]),m="",x=[],o,S=[],A=Array.isArray(e);for(o=u.s.c;o<=u.e.c;++o)x[o]=jn(o);for(var I=u.s.r;I<=u.e.r;++I)for(m=ti(I),o=u.s.c;o<=u.e.c;++o)if(r=x[o]+m,n=A?(e[I]||[])[o]:e[r],l="",n!==void 0){if(n.F!=null){if(r=n.F,!n.f)continue;l=n.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(n.f!=null)l=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)l=""+n.v;else if(n.t=="b")l=n.v?"TRUE":"FALSE";else if(n.w!==void 0)l="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?l="'"+n.v:l=""+n.v}}S[S.length]=r+"="+l}return S}function vA(e,r,n){var l=n||{},u=+!l.skipHeader,m=e||{},x=0,o=0;if(m&&l.origin!=null)if(typeof l.origin=="number")x=l.origin;else{var S=typeof l.origin=="string"?Ni(l.origin):l.origin;x=S.r,o=S.c}var A,I={s:{c:0,r:0},e:{c:o,r:x+r.length-1+u}};if(m["!ref"]){var D=wn(m["!ref"]);I.e.c=Math.max(I.e.c,D.e.c),I.e.r=Math.max(I.e.r,D.e.r),x==-1&&(x=D.e.r+1,I.e.r=x+r.length-1+u)}else x==-1&&(x=0,I.e.r=r.length-1+u);var L=l.header||[],B=0;r.forEach(function(V,Y){js(V).forEach(function(X){(B=L.indexOf(X))==-1&&(L[B=L.length]=X);var K=V[X],G="z",me="",Ae=lr({c:o+B,r:x+Y+u});A=Xd(m,Ae),K&&typeof K=="object"&&!(K instanceof Date)?m[Ae]=K:(typeof K=="number"?G="n":typeof K=="boolean"?G="b":typeof K=="string"?G="s":K instanceof Date?(G="d",l.cellDates||(G="n",K=ji(K)),me=l.dateNF||hr[14]):K===null&&l.nullError&&(G="e",K=0),A?(A.t=G,A.v=K,delete A.w,delete A.R,me&&(A.z=me)):m[Ae]=A={t:G,v:K},me&&(A.z=me))})}),I.e.c=Math.max(I.e.c,o+L.length-1);var U=ti(x);if(u)for(B=0;B<L.length;++B)m[jn(B+o)+U]={t:"s",v:L[B]};return m["!ref"]=br(I),m}function tB(e,r){return vA(null,e,r)}function Xd(e,r,n){if(typeof r=="string"){if(Array.isArray(e)){var l=Ni(r);return e[l.r]||(e[l.r]=[]),e[l.r][l.c]||(e[l.r][l.c]={t:"z"})}return e[r]||(e[r]={t:"z"})}return typeof r!="number"?Xd(e,lr(r)):Xd(e,lr({r,c:n||0}))}function rB(e,r){if(typeof r=="number"){if(r>=0&&e.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var n=e.SheetNames.indexOf(r);if(n>-1)return n;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function Jy(){return{SheetNames:[],Sheets:{}}}function Qy(e,r,n,l){var u=1;if(!n)for(;u<=65535&&e.SheetNames.indexOf(n="Sheet"+u)!=-1;++u,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(l&&e.SheetNames.indexOf(n)>=0){var m=n.match(/(^.*?)(\d+)$/);u=m&&+m[2]||0;var x=m&&m[1]||n;for(++u;u<=65535&&e.SheetNames.indexOf(n=x+u)!=-1;++u);}if(U6(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=r,n}function nB(e,r,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var l=rB(e,r);switch(e.Workbook.Sheets[l]||(e.Workbook.Sheets[l]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[l].Hidden=n}function iB(e,r){return e.z=r,e}function wA(e,r,n){return r?(e.l={Target:r},n&&(e.l.Tooltip=n)):delete e.l,e}function aB(e,r,n){return wA(e,"#"+r,n)}function sB(e,r,n){e.c||(e.c=[]),e.c.push({t:r,a:n||"SheetJS"})}function oB(e,r,n,l){for(var u=typeof r!="string"?r:wn(r),m=typeof r=="string"?r:br(r),x=u.s.r;x<=u.e.r;++x)for(var o=u.s.c;o<=u.e.c;++o){var S=Xd(e,x,o);S.t="n",S.F=m,delete S.v,x==u.s.r&&o==u.s.c&&(S.f=n,l&&(S.D=!0))}return e}var lB={encode_col:jn,encode_row:ti,encode_cell:lr,encode_range:br,decode_col:By,decode_row:Oy,split_cell:yF,decode_cell:Ni,decode_range:Th,format_cell:Eo,sheet_add_aoa:Sk,sheet_add_json:vA,sheet_add_dom:mA,aoa_to_sheet:Eh,json_to_sheet:tB,table_to_sheet:_A,table_to_book:bO,sheet_to_csv:yA,sheet_to_txt:QO,sheet_to_json:F1,sheet_to_html:EO,sheet_to_formulae:eB,sheet_to_row_object_array:F1,sheet_get_cell:Xd,book_new:Jy,book_append_sheet:Qy,book_set_sheet_visibility:nB,cell_set_number_format:iB,cell_set_hyperlink:wA,cell_set_internal_link:aB,cell_add_comment:sB,sheet_set_array_formula:oB,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function TA(){const{setCoordinatesData:e}=Ln.useContext(So),[r,n]=Ln.useState(!1),[l,u]=Ln.useState(Xt("span",{children:"Seleccione un archivo"}));function m(D){console.log(D.target.files);const L=D.target.files[0];A(L)}function x(D){if(console.log("Fichero(s) arrastrados"),D.preventDefault(),console.log(D.dataTransfer.files),D.dataTransfer.files.length==1)if(console.log(D.dataTransfer.files[0].name.split(".").slice(-1)[0]),D.dataTransfer.files[0].name.split(".").slice(-1)[0]=="xlsx"){const L=D.dataTransfer.files[0];A(L)}else u(Sn(_m,{children:[Xt("span",{children:"\u{1F440}"}),Xt("span",{children:"El archivo tiene que ser un .xlsx"})]}));else u(Sn(_m,{children:[Xt("span",{children:"\u{1F440}"}),Xt("span",{children:"Arratre un solo archivo"})]}));S(D)}function o(D){console.log("File(s) in drop zone"),n(!0),D.preventDefault()}function S(D){console.log("Removing drag data"),n(!1),D.dataTransfer.clearData()}function A(D){u(Sn(_m,{children:[Xt("span",{children:"Archivo seleccionado: "}),Xt("span",{children:D.name})]})),I(D)}function I(D){if(!D)console.log("ingrese archivo");else{console.log(D);const L=new FileReader;L.onload=function(){const B=L.result,U=D1(B,{type:"binary"});console.log(U);const V=U.Sheets[U.SheetNames[0]],Y=lB.sheet_to_json(V,{header:0,blankrows:!1});console.log(Y),e(Y)},L.readAsArrayBuffer(D)}}return Sn("div",{id:"container-input-file",children:[Xt("label",{htmlFor:"input-file",id:"label-input-file",onDrop:x,onDragOver:o,style:r?{backgroundColor:"rgb(138, 138, 138)"}:{},children:Xt("div",{className:"text_input",children:l})}),Xt("input",{type:"file",id:"input-file",multiple:!1,accept:".xlsx",onChange:m})]})}var EA={exports:{}};(function(e,r){(function(n,l){e.exports=l()})(tI,function(){var n,l,u;function m(o,S){if(!n)n=S;else if(!l)l=S;else{var A="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+l+")(sharedChunk); self.onerror = null;",I={};n(I),u=S(I),typeof window!="undefined"&&window&&window.URL&&window.URL.createObjectURL&&(u.workerUrl=window.URL.createObjectURL(new Blob([A],{type:"text/javascript"})))}}m(["exports"],function(o){var S="2.8.2",A=I;function I(a,t,s,c){this.cx=3*a,this.bx=3*(s-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(c-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=a,this.p1y=c,this.p2x=s,this.p2y=c}I.prototype.sampleCurveX=function(a){return((this.ax*a+this.bx)*a+this.cx)*a},I.prototype.sampleCurveY=function(a){return((this.ay*a+this.by)*a+this.cy)*a},I.prototype.sampleCurveDerivativeX=function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},I.prototype.solveCurveX=function(a,t){var s,c,f,p,g;for(t===void 0&&(t=1e-6),f=a,g=0;g<8;g++){if(p=this.sampleCurveX(f)-a,Math.abs(p)<t)return f;var y=this.sampleCurveDerivativeX(f);if(Math.abs(y)<1e-6)break;f-=p/y}if((f=a)<(s=0))return s;if(f>(c=1))return c;for(;s<c;){if(p=this.sampleCurveX(f),Math.abs(p-a)<t)return f;a>p?s=f:c=f,f=.5*(c-s)+s}return f},I.prototype.solve=function(a,t){return this.sampleCurveY(this.solveCurveX(a,t))};var D=L;function L(a,t){this.x=a,this.y=t}L.prototype={clone:function(){return new L(this.x,this.y)},add:function(a){return this.clone()._add(a)},sub:function(a){return this.clone()._sub(a)},multByPoint:function(a){return this.clone()._multByPoint(a)},divByPoint:function(a){return this.clone()._divByPoint(a)},mult:function(a){return this.clone()._mult(a)},div:function(a){return this.clone()._div(a)},rotate:function(a){return this.clone()._rotate(a)},rotateAround:function(a,t){return this.clone()._rotateAround(a,t)},matMult:function(a){return this.clone()._matMult(a)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(a){return this.x===a.x&&this.y===a.y},dist:function(a){return Math.sqrt(this.distSqr(a))},distSqr:function(a){var t=a.x-this.x,s=a.y-this.y;return t*t+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(a){return Math.atan2(this.y-a.y,this.x-a.x)},angleWith:function(a){return this.angleWithSep(a.x,a.y)},angleWithSep:function(a,t){return Math.atan2(this.x*t-this.y*a,this.x*a+this.y*t)},_matMult:function(a){var t=a[2]*this.x+a[3]*this.y;return this.x=a[0]*this.x+a[1]*this.y,this.y=t,this},_add:function(a){return this.x+=a.x,this.y+=a.y,this},_sub:function(a){return this.x-=a.x,this.y-=a.y,this},_mult:function(a){return this.x*=a,this.y*=a,this},_div:function(a){return this.x/=a,this.y/=a,this},_multByPoint:function(a){return this.x*=a.x,this.y*=a.y,this},_divByPoint:function(a){return this.x/=a.x,this.y/=a.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var a=this.y;return this.y=this.x,this.x=-a,this},_rotate:function(a){var t=Math.cos(a),s=Math.sin(a),c=s*this.x+t*this.y;return this.x=t*this.x-s*this.y,this.y=c,this},_rotateAround:function(a,t){var s=Math.cos(a),c=Math.sin(a),f=t.y+c*(this.x-t.x)+s*(this.y-t.y);return this.x=t.x+s*(this.x-t.x)-c*(this.y-t.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},L.convert=function(a){return a instanceof L?a:Array.isArray(a)?new L(a[0],a[1]):a};var B=typeof self!="undefined"?self:{};const U=Math.PI/180,V=180/Math.PI;function Y(a){return a*U}function X(a){return a*V}const K=[[0,0],[1,0],[1,1],[0,1]];function G(a){if(a<=0)return 0;if(a>=1)return 1;const t=a*a,s=t*a;return 4*(a<.5?s:3*(a-t)+s-.75)}function me(a,t,s,c){const f=new A(a,t,s,c);return function(p){return f.solve(p)}}const Ae=me(.25,.1,.25,1);function ge(a,t,s){return Math.min(s,Math.max(t,a))}function se(a,t,s){return(s=ge((s-a)/(t-a),0,1))*s*(3-2*s)}function ke(a,t,s){const c=s-t,f=((a-t)%c+c)%c+t;return f===t?s:f}function Ie(a,t,s){if(!a.length)return s(null,[]);let c=a.length;const f=new Array(a.length);let p=null;a.forEach((g,y)=>{t(g,(T,b)=>{T&&(p=T),f[y]=b,--c==0&&s(p,f)})})}function Xe(a){const t=[];for(const s in a)t.push(a[s]);return t}function $e(a,...t){for(const s of t)for(const c in s)a[c]=s[c];return a}let We=1;function dt(){return We++}function Ut(){return function a(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,a)}()}function kt(a){return a<=1?1:Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Bt(a){return!!a&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(a)}function zt(a,t){a.forEach(s=>{t[s]&&(t[s]=t[s].bind(t))})}function gt(a,t){return a.indexOf(t,a.length-t.length)!==-1}function Be(a,t,s){const c={};for(const f in a)c[f]=t.call(s||this,a[f],f,a);return c}function Tt(a,t,s){const c={};for(const f in a)t.call(s||this,a[f],f,a)&&(c[f]=a[f]);return c}function Dt(a){return Array.isArray(a)?a.map(Dt):typeof a=="object"&&a?Be(a,Dt):a}const Ee={};function He(a){Ee[a]||(typeof console!="undefined"&&console.warn(a),Ee[a]=!0)}function Re(a,t,s){return(s.y-a.y)*(t.x-a.x)>(t.y-a.y)*(s.x-a.x)}function Oe(a){let t=0;for(let s,c,f=0,p=a.length,g=p-1;f<p;g=f++)s=a[f],c=a[g],t+=(c.x-s.x)*(s.y+c.y);return t}function at(){return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope}function bt(a){const t={};if(a.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,f,p)=>{const g=f||p;return t[c]=!g||g.toLowerCase(),""}),t["max-age"]){const s=parseInt(t["max-age"],10);isNaN(s)?delete t["max-age"]:t["max-age"]=s}return t}let Ot,At,yt,ar,ve=null;function Cr(a){if(ve==null){const t=a.navigator?a.navigator.userAgent:null;ve=!!a.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return ve}function dr(a){try{const t=B[a];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}}const or={now:()=>yt!==void 0?yt:B.performance.now(),setNow(a){yt=a},restoreNow(){yt=void 0},frame(a){const t=B.requestAnimationFrame(a);return{cancel:()=>B.cancelAnimationFrame(t)}},getImageData(a,t=0){const{width:s,height:c}=a;ar||(ar=B.document.createElement("canvas"));const f=ar.getContext("2d");if(!f)throw new Error("failed to create canvas 2d context");return(s>ar.width||c>ar.height)&&(ar.width=s,ar.height=c),f.clearRect(-t,-t,s+2*t,c+2*t),f.drawImage(a,0,0,s,c),f.getImageData(-t,-t,s+2*t,c+2*t)},resolveURL:a=>(Ot||(Ot=B.document.createElement("a")),Ot.href=a,Ot.href),get devicePixelRatio(){return B.devicePixelRatio},get prefersReducedMotion(){return!!B.matchMedia&&(At==null&&(At=B.matchMedia("(prefers-reduced-motion: reduce)")),At.matches)}};let ir;const ut={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(ir==null){const a=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{ir={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):a}catch{ir=a}}return ir},get EVENTS_URL(){return this.API_URL?this.API_URL.indexOf("https://api.mapbox.cn")===0?"https://events.mapbox.cn/events/v2":this.API_URL.indexOf("https://api.mapbox.com")===0?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ir={supported:!1,testSupport:function(a){!zn&&Xr&&(Wi?ni(a):hn=a)}};let hn,Xr,zn=!1,Wi=!1;function ni(a){const t=a.createTexture();a.bindTexture(a.TEXTURE_2D,t);try{if(a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,Xr),a.isContextLost())return;Ir.supported=!0}catch{}a.deleteTexture(t),zn=!0}B.document&&(Xr=B.document.createElement("img"),Xr.onload=function(){hn&&ni(hn),hn=null,Wi=!0},Xr.onerror=function(){zn=!0,hn=null},Xr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const fn="01",On="NO_ACCESS_TOKEN";function dn(a){return a.indexOf("mapbox:")===0}function Ti(a){return ut.API_URL_REGEX.test(a)}const Rr=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function en(a){const t=a.match(Rr);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function rr(a){const t=a.params.length?`?${a.params.join("&")}`:"";return`${a.protocol}://${a.authority}${a.path}${t}`}function zr(a){if(!a)return null;const t=a.split(".");if(!t||t.length!==3)return null;try{return JSON.parse(decodeURIComponent(B.atob(t[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class pn{constructor(t){this.type=t,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(t){const s=zr(ut.ACCESS_TOKEN);let c="";return c=s&&s.u?B.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(f,p)=>String.fromCharCode(Number("0x"+p)))):ut.ACCESS_TOKEN||"",t?`mapbox.eventData.${t}:${c}`:`mapbox.eventData:${c}`}fetchEventData(){const t=dr("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{const f=B.localStorage.getItem(s);f&&(this.eventData=JSON.parse(f));const p=B.localStorage.getItem(c);p&&(this.anonId=p)}catch{He("Unable to read from LocalStorage")}}saveEventData(){const t=dr("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(t)try{B.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&B.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{He("Unable to write to LocalStorage")}}processRequests(t){}postEvent(t,s,c,f){if(!ut.EVENTS_URL)return;const p=en(ut.EVENTS_URL);p.params.push(`access_token=${f||ut.ACCESS_TOKEN||""}`);const g={event:this.type,created:new Date(t).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:S,skuId:fn,userId:this.anonId},y=s?$e(g,s):g,T={url:rr(p),headers:{"Content-Type":"text/plain"},body:JSON.stringify([y])};this.pendingRequest=Ce(T,b=>{this.pendingRequest=null,c(b),this.saveEventData(),this.processRequests(f)})}queueRequest(t,s){this.queue.push(t),this.processRequests(s)}}const Nr=new class extends pn{constructor(a){super("appUserTurnstile"),this._customAccessToken=a}postTurnstileEvent(a,t){ut.EVENTS_URL&&ut.ACCESS_TOKEN&&Array.isArray(a)&&a.some(s=>dn(s)||Ti(s))&&this.queueRequest(Date.now(),t)}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=zr(ut.ACCESS_TOKEN),s=t?t.u:ut.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;Bt(this.anonId)||(this.anonId=Ut(),c=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const p=new Date(this.eventData.lastSuccess),g=new Date(f),y=(f-this.eventData.lastSuccess)/864e5;c=c||y>=1||y<-1||p.getDate()!==g.getDate()}else c=!0;c?this.postEvent(f,{"enabled.telemetry":!1},p=>{p||(this.eventData.lastSuccess=f,this.eventData.tokenU=s)},a):this.processRequests()}},ha=Nr.postTurnstileEvent.bind(Nr),Zs=new class extends pn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(a,t,s,c){this.skuToken=t,this.errorCb=c,ut.EVENTS_URL&&(s||ut.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},s):this.errorCb(new Error(On)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:s}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),Bt(this.anonId)||(this.anonId=Ut()),this.postEvent(s,{skuToken:this.skuToken},c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},a))}},Ao=Zs.postMapLoadEvent.bind(Zs),ps=new class extends pn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(a,t,s,c){if(!ut.API_URL||!ut.SESSION_PATH)return;const f=en(ut.API_URL+ut.SESSION_PATH);f.params.push(`sku=${t||""}`),f.params.push(`access_token=${c||ut.ACCESS_TOKEN||""}`);const p={url:rr(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Ve(p,g=>{this.pendingRequest=null,s(g),this.saveEventData(),this.processRequests(c)})}getSessionAPI(a,t,s,c){this.skuToken=t,this.errorCb=c,ut.SESSION_PATH&&ut.API_URL&&(s||ut.ACCESS_TOKEN?this.queueRequest({id:a,timestamp:Date.now()},s):this.errorCb(new Error(On)))}processRequests(a){if(this.pendingRequest||this.queue.length===0)return;const{id:t,timestamp:s}=this.queue.shift();t&&this.success[t]||this.getSession(s,this.skuToken,c=>{c?this.errorCb(c):t&&(this.success[t]=!0)},a)}},Hs=ps.getSessionAPI.bind(ps),Aa=new Set,Xs="mapbox-tiles";let Ei,Ca,Zi=500,Ha=50;function ms(){B.caches&&!Ei&&(Ei=B.caches.open(Xs))}function qs(a){const t=a.indexOf("?");return t<0?a:a.slice(0,t)}let _s=1/0;const de={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(de);class j extends Error{constructor(t,s,c){s===401&&Ti(c)&&(t+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(t),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const J=at()?()=>self.worker&&self.worker.referrer:()=>(B.location.protocol==="blob:"?B.parent:B).location.href,ue=function(a,t){if(!(/^file:/.test(s=a.url)||/^file:/.test(J())&&!/^\w+:/.test(s))){if(B.fetch&&B.Request&&B.AbortController&&B.Request.prototype.hasOwnProperty("signal"))return function(c,f){const p=new B.AbortController,g=new B.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:J(),signal:p.signal});let y=!1,T=!1;const b=(C=g.url).indexOf("sku=")>0&&Ti(C);var C;c.type==="json"&&g.headers.set("Accept","application/json");const M=(N,Z,ee)=>{if(T)return;if(N&&N.message!=="SecurityError"&&He(N),Z&&ee)return P(Z);const ae=Date.now();B.fetch(g).then(fe=>{if(fe.ok){const be=b?fe.clone():null;return P(fe,be,ae)}return f(new j(fe.statusText,fe.status,c.url))}).catch(fe=>{fe.code!==20&&f(new Error(fe.message))})},P=(N,Z,ee)=>{(c.type==="arrayBuffer"?N.arrayBuffer():c.type==="json"?N.json():N.text()).then(ae=>{T||(Z&&ee&&function(fe,be,Me){if(ms(),!Ei)return;const Pe={status:be.status,statusText:be.statusText,headers:new B.Headers};be.headers.forEach((Je,et)=>Pe.headers.set(et,Je));const Le=bt(be.headers.get("Cache-Control")||"");if(Le["no-store"])return;Le["max-age"]&&Pe.headers.set("Expires",new Date(Me+1e3*Le["max-age"]).toUTCString());const ze=Pe.headers.get("Expires");ze&&(new Date(ze).getTime()-Me<42e4||function(Je,et){if(Ca===void 0)try{new Response(new ReadableStream),Ca=!0}catch{Ca=!1}Ca?et(Je.body):Je.blob().then(et)}(be,Je=>{const et=new B.Response(Je,Pe);ms(),Ei&&Ei.then(st=>st.put(qs(fe.url),et)).catch(st=>He(st.message))}))}(g,Z,ee),y=!0,f(null,ae,N.headers.get("Cache-Control"),N.headers.get("Expires")))}).catch(ae=>{T||f(new Error(ae.message))})};return b?function(N,Z){if(ms(),!Ei)return Z(null);const ee=qs(N.url);Ei.then(ae=>{ae.match(ee).then(fe=>{const be=function(Me){if(!Me)return!1;const Pe=new Date(Me.headers.get("Expires")||0),Le=bt(Me.headers.get("Cache-Control")||"");return Pe>Date.now()&&!Le["no-cache"]}(fe);ae.delete(ee),be&&ae.put(ee,fe.clone()),Z(null,fe,be)}).catch(Z)}).catch(Z)}(g,M):M(null,null),{cancel:()=>{T=!0,y||p.abort()}}}(a,t);if(at()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",a,t,void 0,!0)}var s;return function(c,f){const p=new B.XMLHttpRequest;p.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(p.responseType="arraybuffer");for(const g in c.headers)p.setRequestHeader(g,c.headers[g]);return c.type==="json"&&(p.responseType="text",p.setRequestHeader("Accept","application/json")),p.withCredentials=c.credentials==="include",p.onerror=()=>{f(new Error(p.statusText))},p.onload=()=>{if((p.status>=200&&p.status<300||p.status===0)&&p.response!==null){let g=p.response;if(c.type==="json")try{g=JSON.parse(p.response)}catch(y){return f(y)}f(null,g,p.getResponseHeader("Cache-Control"),p.getResponseHeader("Expires"))}else f(new j(p.statusText,p.status,c.url))},p.send(c.body),{cancel:()=>p.abort()}}(a,t)},we=function(a,t){return ue($e(a,{type:"arrayBuffer"}),t)},Ce=function(a,t){return ue($e(a,{method:"POST"}),t)},Ve=function(a,t){return ue($e(a,{method:"GET"}),t)};function Ue(a){const t=B.document.createElement("a");return t.href=a,t.protocol===B.document.location.protocol&&t.host===B.document.location.host}const z="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let H,q;H=[],q=0;const ne=function(a,t){if(Ir.supported&&(a.headers||(a.headers={}),a.headers.accept="image/webp,*/*"),q>=ut.MAX_PARALLEL_IMAGE_REQUESTS){const p={requestParameters:a,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return H.push(p),p}q++;let s=!1;const c=()=>{if(!s)for(s=!0,q--;H.length&&q<ut.MAX_PARALLEL_IMAGE_REQUESTS;){const p=H.shift(),{requestParameters:g,callback:y,cancelled:T}=p;T||(p.cancel=ne(g,y).cancel)}},f=we(a,(p,g,y,T)=>{c(),p?t(p):g&&(B.createImageBitmap?function(b,C){const M=new B.Blob([new Uint8Array(b)],{type:"image/png"});B.createImageBitmap(M).then(P=>{C(null,P)}).catch(P=>{C(new Error(`Could not load image because of ${P.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(b,C)=>t(b,C,y,T)):function(b,C){const M=new B.Image,P=B.URL;M.onload=()=>{C(null,M),P.revokeObjectURL(M.src),M.onload=null,B.requestAnimationFrame(()=>{M.src=z})},M.onerror=()=>C(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const N=new B.Blob([new Uint8Array(b)],{type:"image/png"});M.src=b.byteLength?P.createObjectURL(N):z}(g,(b,C)=>t(b,C,y,T)))});return{cancel:()=>{f.cancel(),c()}}};function re(a,t,s){s[a]&&s[a].indexOf(t)!==-1||(s[a]=s[a]||[],s[a].push(t))}function ce(a,t,s){if(s&&s[a]){const c=s[a].indexOf(t);c!==-1&&s[a].splice(c,1)}}class De{constructor(t,s={}){$e(this,s),this.type=t}}class Ne extends De{constructor(t,s={}){super("error",$e({error:t},s))}}class Fe{on(t,s){return this._listeners=this._listeners||{},re(t,s,this._listeners),this}off(t,s){return ce(t,s,this._listeners),ce(t,s,this._oneTimeListeners),this}once(t,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},re(t,s,this._oneTimeListeners),this):new Promise(c=>this.once(t,c))}fire(t,s){typeof t=="string"&&(t=new De(t,s||{}));const c=t.type;if(this.listens(c)){t.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const y of f)y.call(this,t);const p=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const y of p)ce(c,y,this._oneTimeListeners),y.call(this,t);const g=this._eventedParent;g&&($e(t,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),g.fire(t))}else t instanceof Ne&&console.error(t.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,s){return this._eventedParent=t,this._eventedParentData=s,this}}var le=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Ze(a,...t){for(const s of t)for(const c in s)a[c]=s[c];return a}function qe(a){return a instanceof Number||a instanceof String||a instanceof Boolean?a.valueOf():a}function lt(a){if(Array.isArray(a))return a.map(lt);if(a instanceof Object&&!(a instanceof Number||a instanceof String||a instanceof Boolean)){const t={};for(const s in a)t[s]=lt(a[s]);return t}return qe(a)}class pt extends Error{constructor(t,s){super(s),this.message=s,this.key=t}}class wt{constructor(t,s=[]){this.parent=t,this.bindings={};for(const[c,f]of s)this.bindings[c]=f}concat(t){return new wt(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const Mt={kind:"null"},it={kind:"number"},Zt={kind:"string"},Gt={kind:"boolean"},Or={kind:"color"},bi={kind:"object"},Qt={kind:"value"},Si={kind:"collator"},ii={kind:"formatted"},Tn={kind:"resolvedImage"};function tn(a,t){return{kind:"array",itemType:a,N:t}}function Vr(a){if(a.kind==="array"){const t=Vr(a.itemType);return typeof a.N=="number"?`array<${t}, ${a.N}>`:a.itemType.kind==="value"?"array":`array<${t}>`}return a.kind}const b_=[Mt,it,Zt,Gt,Or,ii,bi,tn(Qt),Tn];function Ml(a,t){if(t.kind==="error")return null;if(a.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Ml(a.itemType,t.itemType))&&(typeof a.N!="number"||a.N===t.N))return null}else{if(a.kind===t.kind)return null;if(a.kind==="value"){for(const s of b_)if(!Ml(s,t))return null}}return`Expected ${Vr(a)} but found ${Vr(t)} instead.`}function Uc(a,t){return t.some(s=>s.kind===a.kind)}function Co(a,t){return t.some(s=>s==="null"?a===null:s==="array"?Array.isArray(a):s==="object"?a&&!Array.isArray(a)&&typeof a=="object":s===typeof a)}function Vc(a){var t={exports:{}};return a(t,t.exports),t.exports}var bh=Vc(function(a,t){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function c(y){return(y=Math.round(y))<0?0:y>255?255:y}function f(y){return c(y[y.length-1]==="%"?parseFloat(y)/100*255:parseInt(y))}function p(y){return(T=y[y.length-1]==="%"?parseFloat(y)/100:parseFloat(y))<0?0:T>1?1:T;var T}function g(y,T,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?y+(T-y)*b*6:2*b<1?T:3*b<2?y+(T-y)*(2/3-b)*6:y}try{t.parseCSSColor=function(y){var T,b=y.replace(/ /g,"").toLowerCase();if(b in s)return s[b].slice();if(b[0]==="#")return b.length===4?(T=parseInt(b.substr(1),16))>=0&&T<=4095?[(3840&T)>>4|(3840&T)>>8,240&T|(240&T)>>4,15&T|(15&T)<<4,1]:null:b.length===7&&(T=parseInt(b.substr(1),16))>=0&&T<=16777215?[(16711680&T)>>16,(65280&T)>>8,255&T,1]:null;var C=b.indexOf("("),M=b.indexOf(")");if(C!==-1&&M+1===b.length){var P=b.substr(0,C),N=b.substr(C+1,M-(C+1)).split(","),Z=1;switch(P){case"rgba":if(N.length!==4)return null;Z=p(N.pop());case"rgb":return N.length!==3?null:[f(N[0]),f(N[1]),f(N[2]),Z];case"hsla":if(N.length!==4)return null;Z=p(N.pop());case"hsl":if(N.length!==3)return null;var ee=(parseFloat(N[0])%360+360)%360/360,ae=p(N[1]),fe=p(N[2]),be=fe<=.5?fe*(ae+1):fe+ae-fe*ae,Me=2*fe-be;return[c(255*g(Me,be,ee+1/3)),c(255*g(Me,be,ee)),c(255*g(Me,be,ee-1/3)),Z];default:return null}}return null}}catch{}});class pr{constructor(t,s,c,f=1){this.r=t,this.g=s,this.b=c,this.a=f}static parse(t){if(!t)return;if(t instanceof pr)return t;if(typeof t!="string")return;const s=bh.parseCSSColor(t);return s?new pr(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[t,s,c,f]=this.toArray();return`rgba(${Math.round(t)},${Math.round(s)},${Math.round(c)},${f})`}toArray(){const{r:t,g:s,b:c,a:f}=this;return f===0?[0,0,0,0]:[255*t/f,255*s/f,255*c/f,f]}}pr.black=new pr(0,0,0,1),pr.white=new pr(1,1,1,1),pr.transparent=new pr(0,0,0,0),pr.red=new pr(1,0,0,1),pr.blue=new pr(0,0,1,1);class Io{constructor(t,s,c){this.sensitivity=t?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,s){return this.collator.compare(t,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Sh{constructor(t,s,c,f,p){this.text=t.normalize?t.normalize():t,this.image=s,this.scale=c,this.fontStack=f,this.textColor=p}}class mn{constructor(t){this.sections=t}static fromString(t){return new mn([new Sh(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.name.length!==0)}static factory(t){return t instanceof mn?t:mn.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const s of this.sections){if(s.image){t.push(["image",s.image.name]);continue}t.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toArray())),t.push(c)}return t}}class ki{constructor(t){this.name=t.name,this.available=t.available}toString(){return this.name}static fromString(t){return t?new ki({name:t,available:!1}):null}serialize(){return["image",this.name]}}function fa(a,t,s,c){return typeof a=="number"&&a>=0&&a<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[a,t,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[a,t,s,c]:[a,t,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function jc(a){if(a===null||typeof a=="string"||typeof a=="boolean"||typeof a=="number"||a instanceof pr||a instanceof Io||a instanceof mn||a instanceof ki)return!0;if(Array.isArray(a)){for(const t of a)if(!jc(t))return!1;return!0}if(typeof a=="object"){for(const t in a)if(!jc(a[t]))return!1;return!0}return!1}function an(a){if(a===null)return Mt;if(typeof a=="string")return Zt;if(typeof a=="boolean")return Gt;if(typeof a=="number")return it;if(a instanceof pr)return Or;if(a instanceof Io)return Si;if(a instanceof mn)return ii;if(a instanceof ki)return Tn;if(Array.isArray(a)){const t=a.length;let s;for(const c of a){const f=an(c);if(s){if(s===f)continue;s=Qt;break}s=f}return tn(s||Qt,t)}return bi}function Xa(a){const t=typeof a;return a===null?"":t==="string"||t==="number"||t==="boolean"?String(a):a instanceof pr||a instanceof mn||a instanceof ki?a.toString():JSON.stringify(a)}class qa{constructor(t,s){this.type=t,this.value=s}static parse(t,s){if(t.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!jc(t[1]))return s.error("invalid value");const c=t[1];let f=an(c);const p=s.expectedType;return f.kind!=="array"||f.N!==0||!p||p.kind!=="array"||typeof p.N=="number"&&p.N!==0||(f=p),new qa(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof pr?["rgba"].concat(this.value.toArray()):this.value instanceof mn?this.value.serialize():this.value}}class Bn{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const kh={string:Zt,number:it,boolean:Gt,object:bi};class da{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");let c,f=1;const p=t[0];if(p==="array"){let y,T;if(t.length>2){const b=t[1];if(typeof b!="string"||!(b in kh)||b==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);y=kh[b],f++}else y=Qt;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return s.error('The length argument to "array" must be a positive integer literal',2);T=t[2],f++}c=tn(y,T)}else c=kh[p];const g=[];for(;f<t.length;f++){const y=s.parse(t[f],f,Qt);if(!y)return null;g.push(y)}return new da(c,g)}evaluate(t){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(t);if(!Ml(this.type,an(c)))return c;if(s===this.args.length-1)throw new Bn(`Expected value to be of type ${Vr(this.type)}, but found ${Vr(an(c))} instead.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,s=[t.kind];if(t.kind==="array"){const c=t.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const f=t.N;(typeof f=="number"||this.args.length>1)&&s.push(f)}}return s.concat(this.args.map(c=>c.serialize()))}}class Mo{constructor(t){this.type=ii,this.sections=t}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const c=t[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const f=[];let p=!1;for(let g=1;g<=t.length-1;++g){const y=t[g];if(p&&typeof y=="object"&&!Array.isArray(y)){p=!1;let T=null;if(y["font-scale"]&&(T=s.parse(y["font-scale"],1,it),!T))return null;let b=null;if(y["text-font"]&&(b=s.parse(y["text-font"],1,tn(Zt)),!b))return null;let C=null;if(y["text-color"]&&(C=s.parse(y["text-color"],1,Or),!C))return null;const M=f[f.length-1];M.scale=T,M.font=b,M.textColor=C}else{const T=s.parse(t[g],1,Qt);if(!T)return null;const b=T.type.kind;if(b!=="string"&&b!=="value"&&b!=="null"&&b!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");p=!0,f.push({content:T,scale:null,font:null,textColor:null})}}return new Mo(f)}evaluate(t){return new mn(this.sections.map(s=>{const c=s.content.evaluate(t);return an(c)===Tn?new Sh("",c,null,null,null):new Sh(Xa(c),null,s.scale?s.scale.evaluate(t):null,s.font?s.font.evaluate(t).join(","):null,s.textColor?s.textColor.evaluate(t):null)}))}eachChild(t){for(const s of this.sections)t(s.content),s.scale&&t(s.scale),s.font&&t(s.font),s.textColor&&t(s.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const s of this.sections){t.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),t.push(c)}return t}}class Do{constructor(t){this.type=Tn,this.input=t}static parse(t,s){if(t.length!==2)return s.error("Expected two arguments.");const c=s.parse(t[1],1,Zt);return c?new Do(c):s.error("No image name provided.")}evaluate(t){const s=this.input.evaluate(t),c=ki.fromString(s);return c&&t.availableImages&&(c.available=t.availableImages.indexOf(s)>-1),c}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const S_={"to-boolean":Gt,"to-color":Or,"to-number":it,"to-string":Zt};class pa{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expected at least one argument.");const c=t[0];if((c==="to-boolean"||c==="to-string")&&t.length!==2)return s.error("Expected one argument.");const f=S_[c],p=[];for(let g=1;g<t.length;g++){const y=s.parse(t[g],g,Qt);if(!y)return null;p.push(y)}return new pa(f,p)}evaluate(t){if(this.type.kind==="boolean")return Boolean(this.args[0].evaluate(t));if(this.type.kind==="color"){let s,c;for(const f of this.args){if(s=f.evaluate(t),c=null,s instanceof pr)return s;if(typeof s=="string"){const p=t.parseColor(s);if(p)return p}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:fa(s[0],s[1],s[2],s[3]),!c))return new pr(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Bn(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(t),s===null)return 0;const f=Number(s);if(!isNaN(f))return f}throw new Bn(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?mn.fromString(Xa(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?ki.fromString(Xa(this.args[0].evaluate(t))):Xa(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new Mo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Do(this.args[0]).serialize();const t=[`to-${this.type.kind}`];return this.eachChild(s=>{t.push(s.serialize())}),t}}const k_=["Unknown","Point","LineString","Polygon"];class sp{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature&&this.feature.id?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?k_[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,s=this.featureDistanceData.scale,{x:c,y:f}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(c*s-t[0])+this.featureDistanceData.bearing[1]*(f*s-t[1])}return 0}parseColor(t){let s=this._parseColorCache[t];return s||(s=this._parseColorCache[t]=pr.parse(t)),s}}class Ai{constructor(t,s,c,f){this.name=t,this.type=s,this._evaluate=c,this.args=f}evaluate(t){return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,s){const c=t[0],f=Ai.definitions[c];if(!f)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const p=Array.isArray(f)?f[0]:f.type,g=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,y=g.filter(([b])=>!Array.isArray(b)||b.length===t.length-1);let T=null;for(const[b,C]of y){T=new xs(s.registry,s.path,null,s.scope);const M=[];let P=!1;for(let N=1;N<t.length;N++){const Z=t[N],ee=Array.isArray(b)?b[N-1]:b.type,ae=T.parse(Z,1+M.length,ee);if(!ae){P=!0;break}M.push(ae)}if(!P)if(Array.isArray(b)&&b.length!==M.length)T.error(`Expected ${b.length} arguments, but found ${M.length} instead.`);else{for(let N=0;N<M.length;N++){const Z=Array.isArray(b)?b[N]:b.type,ee=M[N];T.concat(N+1).checkSubtype(Z,ee.type)}if(T.errors.length===0)return new Ai(c,p,C,M)}}if(y.length===1)s.errors.push(...T.errors);else{const b=(y.length?y:g).map(([M])=>{return P=M,Array.isArray(P)?`(${P.map(Vr).join(", ")})`:`(${Vr(P.type)}...)`;var P}).join(" | "),C=[];for(let M=1;M<t.length;M++){const P=s.parse(t[M],1+C.length);if(!P)return null;C.push(Vr(P.type))}s.error(`Expected arguments of type ${b}, but found (${C.join(", ")}) instead.`)}return null}static register(t,s){Ai.definitions=s;for(const c in s)t[c]=Ai}}class Gc{constructor(t,s,c){this.type=Si,this.locale=c,this.caseSensitive=t,this.diacriticSensitive=s}static parse(t,s){if(t.length!==2)return s.error("Expected one argument.");const c=t[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const f=s.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Gt);if(!f)return null;const p=s.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Gt);if(!p)return null;let g=null;return c.locale&&(g=s.parse(c.locale,1,Zt),!g)?null:new Gc(f,p,g)}evaluate(t){return new Io(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}const gs=8192;function Ah(a,t){a[0]=Math.min(a[0],t[0]),a[1]=Math.min(a[1],t[1]),a[2]=Math.max(a[2],t[0]),a[3]=Math.max(a[3],t[1])}function $c(a,t){return!(a[0]<=t[0]||a[2]>=t[2]||a[1]<=t[1]||a[3]>=t[3])}function op(a,t){const s=(180+a[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a[1]*Math.PI/360)))/360,f=Math.pow(2,t.z);return[Math.round(s*f*gs),Math.round(c*f*gs)]}function Wc(a,t,s){const c=a[0]-t[0],f=a[1]-t[1],p=a[0]-s[0],g=a[1]-s[1];return c*g-p*f==0&&c*p<=0&&f*g<=0}function Ch(a,t){let s=!1;for(let g=0,y=t.length;g<y;g++){const T=t[g];for(let b=0,C=T.length;b<C-1;b++){if(Wc(a,T[b],T[b+1]))return!1;(f=T[b])[1]>(c=a)[1]!=(p=T[b+1])[1]>c[1]&&c[0]<(p[0]-f[0])*(c[1]-f[1])/(p[1]-f[1])+f[0]&&(s=!s)}}var c,f,p;return s}function A_(a,t){for(let s=0;s<t.length;s++)if(Ch(a,t[s]))return!0;return!1}function lp(a,t,s,c){const f=c[0]-s[0],p=c[1]-s[1],g=(a[0]-s[0])*p-f*(a[1]-s[1]),y=(t[0]-s[0])*p-f*(t[1]-s[1]);return g>0&&y<0||g<0&&y>0}function C_(a,t,s){for(const b of s)for(let C=0;C<b.length-1;++C)if((y=[(g=b[C+1])[0]-(p=b[C])[0],g[1]-p[1]])[0]*(T=[(f=t)[0]-(c=a)[0],f[1]-c[1]])[1]-y[1]*T[0]!=0&&lp(c,f,p,g)&&lp(p,g,c,f))return!0;var c,f,p,g,y,T;return!1}function cp(a,t){for(let s=0;s<a.length;++s)if(!Ch(a[s],t))return!1;for(let s=0;s<a.length-1;++s)if(C_(a[s],a[s+1],t))return!1;return!0}function I_(a,t){for(let s=0;s<t.length;s++)if(cp(a,t[s]))return!0;return!1}function Zc(a,t,s){const c=[];for(let f=0;f<a.length;f++){const p=[];for(let g=0;g<a[f].length;g++){const y=op(a[f][g],s);Ah(t,y),p.push(y)}c.push(p)}return c}function Dl(a,t,s){const c=[];for(let f=0;f<a.length;f++){const p=Zc(a[f],t,s);c.push(p)}return c}function up(a,t,s,c){if(a[0]<s[0]||a[0]>s[2]){const f=.5*c;let p=a[0]-s[0]>f?-c:s[0]-a[0]>f?c:0;p===0&&(p=a[0]-s[2]>f?-c:s[2]-a[0]>f?c:0),a[0]+=p}Ah(t,a)}function hp(a,t,s,c){const f=Math.pow(2,c.z)*gs,p=[c.x*gs,c.y*gs],g=[];if(!a)return g;for(const y of a)for(const T of y){const b=[T.x+p[0],T.y+p[1]];up(b,t,s,f),g.push(b)}return g}function fp(a,t,s,c){const f=Math.pow(2,c.z)*gs,p=[c.x*gs,c.y*gs],g=[];if(!a)return g;for(const T of a){const b=[];for(const C of T){const M=[C.x+p[0],C.y+p[1]];Ah(t,M),b.push(M)}g.push(b)}if(t[2]-t[0]<=f/2){(y=t)[0]=y[1]=1/0,y[2]=y[3]=-1/0;for(const T of g)for(const b of T)up(b,t,s,f)}var y;return g}class Ks{constructor(t,s){this.type=Gt,this.geojson=t,this.geometries=s}static parse(t,s){if(t.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(jc(t[1])){const c=t[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const p=c.features[f].geometry.type;if(p==="Polygon"||p==="MultiPolygon")return new Ks(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new Ks(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new Ks(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(s,c){const f=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=s.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const y=Zc(c.coordinates,p,g),T=hp(s.geometry(),f,p,g);if(!$c(f,p))return!1;for(const b of T)if(!Ch(b,y))return!1}if(c.type==="MultiPolygon"){const y=Dl(c.coordinates,p,g),T=hp(s.geometry(),f,p,g);if(!$c(f,p))return!1;for(const b of T)if(!A_(b,y))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(s,c){const f=[1/0,1/0,-1/0,-1/0],p=[1/0,1/0,-1/0,-1/0],g=s.canonicalID();if(!g)return!1;if(c.type==="Polygon"){const y=Zc(c.coordinates,p,g),T=fp(s.geometry(),f,p,g);if(!$c(f,p))return!1;for(const b of T)if(!cp(b,y))return!1}if(c.type==="MultiPolygon"){const y=Dl(c.coordinates,p,g),T=fp(s.geometry(),f,p,g);if(!$c(f,p))return!1;for(const b of T)if(!I_(b,y))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function ai(a){if(a instanceof Ai&&(a.name==="get"&&a.args.length===1||a.name==="feature-state"||a.name==="has"&&a.args.length===1||a.name==="properties"||a.name==="geometry-type"||a.name==="id"||/^filter-/.test(a.name))||a instanceof Ks)return!1;let t=!0;return a.eachChild(s=>{t&&!ai(s)&&(t=!1)}),t}function Fl(a){if(a instanceof Ai&&a.name==="feature-state")return!1;let t=!0;return a.eachChild(s=>{t&&!Fl(s)&&(t=!1)}),t}function Pl(a,t){if(a instanceof Ai&&t.indexOf(a.name)>=0)return!1;let s=!0;return a.eachChild(c=>{s&&!Pl(c,t)&&(s=!1)}),s}class Ys{constructor(t,s){this.type=s.type,this.name=t,this.boundExpression=s}static parse(t,s){if(t.length!==2||typeof t[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=t[1];return s.scope.has(c)?new Ys(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class xs{constructor(t,s=[],c,f=new wt,p=[]){this.registry=t,this.path=s,this.key=s.map(g=>`[${g}]`).join(""),this.scope=f,this.errors=p,this.expectedType=c}parse(t,s,c,f,p={}){return s?this.concat(s,c,f)._parse(t,p):this._parse(t,p)}_parse(t,s){function c(f,p,g){return g==="assert"?new da(p,[f]):g==="coerce"?new pa(p,[f]):f}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=t[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const p=this.registry[f];if(p){let g=p.parse(t,this);if(!g)return null;if(this.expectedType){const y=this.expectedType,T=g.type;if(y.kind!=="string"&&y.kind!=="number"&&y.kind!=="boolean"&&y.kind!=="object"&&y.kind!=="array"||T.kind!=="value")if(y.kind!=="color"&&y.kind!=="formatted"&&y.kind!=="resolvedImage"||T.kind!=="value"&&T.kind!=="string"){if(this.checkSubtype(y,T))return null}else g=c(g,y,s.typeAnnotation||"coerce");else g=c(g,y,s.typeAnnotation||"assert")}if(!(g instanceof qa)&&g.type.kind!=="resolvedImage"&&Hc(g)){const y=new sp;try{g=new qa(g.type,g.evaluate(y))}catch(T){return this.error(T.message),null}}return g}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,s,c){const f=typeof t=="number"?this.path.concat(t):this.path,p=c?this.scope.concat(c):this.scope;return new xs(this.registry,f,s||null,p,this.errors)}error(t,...s){const c=`${this.key}${s.map(f=>`[${f}]`).join("")}`;this.errors.push(new pt(c,t))}checkSubtype(t,s){const c=Ml(t,s);return c&&this.error(c),c}}function Hc(a){if(a instanceof Ys)return Hc(a.boundExpression);if(a instanceof Ai&&a.name==="error"||a instanceof Gc||a instanceof Ks)return!1;const t=a instanceof pa||a instanceof da;let s=!0;return a.eachChild(c=>{s=t?s&&Hc(c):s&&c instanceof qa}),!!s&&ai(a)&&Pl(a,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ll(a,t){const s=a.length-1;let c,f,p=0,g=s,y=0;for(;p<=g;)if(y=Math.floor((p+g)/2),c=a[y],f=a[y+1],c<=t){if(y===s||t<f)return y;p=y+1}else{if(!(c>t))throw new Bn("Input is not a number.");g=y-1}return 0}class Rl{constructor(t,s,c){this.type=t,this.input=s,this.labels=[],this.outputs=[];for(const[f,p]of c)this.labels.push(f),this.outputs.push(p)}static parse(t,s){if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(t[1],1,it);if(!c)return null;const f=[];let p=null;s.expectedType&&s.expectedType.kind!=="value"&&(p=s.expectedType);for(let g=1;g<t.length;g+=2){const y=g===1?-1/0:t[g],T=t[g+1],b=g,C=g+1;if(typeof y!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',b);if(f.length&&f[f.length-1][0]>=y)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',b);const M=s.parse(T,C,p);if(!M)return null;p=p||M.type,f.push([y,M])}return new Rl(p,c,f)}evaluate(t){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(t);const f=this.input.evaluate(t);if(f<=s[0])return c[0].evaluate(t);const p=s.length;return f>=s[p-1]?c[p-1].evaluate(t):c[Ll(s,f)].evaluate(t)}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&t.push(this.labels[s]),t.push(this.outputs[s].serialize());return t}}function Wt(a,t,s){return a*(1-s)+t*s}var Xc=Object.freeze({__proto__:null,number:Wt,color:function(a,t,s){return new pr(Wt(a.r,t.r,s),Wt(a.g,t.g,s),Wt(a.b,t.b,s),Wt(a.a,t.a,s))},array:function(a,t,s){return a.map((c,f)=>Wt(c,t[f],s))}});const dp=.95047,pp=1.08883,Ih=4/29,Mh=6/29,Dh=3*Mh*Mh,mp=Math.PI/180,_p=180/Math.PI;function qc(a){return a>.008856451679035631?Math.pow(a,1/3):a/Dh+Ih}function ys(a){return a>Mh?a*a*a:Dh*(a-Ih)}function Fo(a){return 255*(a<=.0031308?12.92*a:1.055*Math.pow(a,1/2.4)-.055)}function Fh(a){return(a/=255)<=.04045?a/12.92:Math.pow((a+.055)/1.055,2.4)}function Kc(a){const t=Fh(a.r),s=Fh(a.g),c=Fh(a.b),f=qc((.4124564*t+.3575761*s+.1804375*c)/dp),p=qc((.2126729*t+.7151522*s+.072175*c)/1);return{l:116*p-16,a:500*(f-p),b:200*(p-qc((.0193339*t+.119192*s+.9503041*c)/pp)),alpha:a.a}}function Ph(a){let t=(a.l+16)/116,s=isNaN(a.a)?t:t+a.a/500,c=isNaN(a.b)?t:t-a.b/200;return t=1*ys(t),s=dp*ys(s),c=pp*ys(c),new pr(Fo(3.2404542*s-1.5371385*t-.4985314*c),Fo(-.969266*s+1.8760108*t+.041556*c),Fo(.0556434*s-.2040259*t+1.0572252*c),a.alpha)}function M_(a,t,s){const c=t-a;return a+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const zl={forward:Kc,reverse:Ph,interpolate:function(a,t,s){return{l:Wt(a.l,t.l,s),a:Wt(a.a,t.a,s),b:Wt(a.b,t.b,s),alpha:Wt(a.alpha,t.alpha,s)}}},Ol={forward:function(a){const{l:t,a:s,b:c}=Kc(a),f=Math.atan2(c,s)*_p;return{h:f<0?f+360:f,c:Math.sqrt(s*s+c*c),l:t,alpha:a.a}},reverse:function(a){const t=a.h*mp,s=a.c;return Ph({l:a.l,a:Math.cos(t)*s,b:Math.sin(t)*s,alpha:a.alpha})},interpolate:function(a,t,s){return{h:M_(a.h,t.h,s),c:Wt(a.c,t.c,s),l:Wt(a.l,t.l,s),alpha:Wt(a.alpha,t.alpha,s)}}};var Lh=Object.freeze({__proto__:null,lab:zl,hcl:Ol});class Ci{constructor(t,s,c,f,p){this.type=t,this.operator=s,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[g,y]of p)this.labels.push(g),this.outputs.push(y)}static interpolationFactor(t,s,c,f){let p=0;if(t.name==="exponential")p=Yc(s,t.base,c,f);else if(t.name==="linear")p=Yc(s,1,c,f);else if(t.name==="cubic-bezier"){const g=t.controlPoints;p=new A(g[0],g[1],g[2],g[3]).solve(Yc(s,1,c,f))}return p}static parse(t,s){let[c,f,p,...g]=t;if(!Array.isArray(f)||f.length===0)return s.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const b=f[1];if(typeof b!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:b}}else{if(f[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const b=f.slice(1);if(b.length!==4||b.some(C=>typeof C!="number"||C<0||C>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:b}}}if(t.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(p=s.parse(p,2,it),!p)return null;const y=[];let T=null;c==="interpolate-hcl"||c==="interpolate-lab"?T=Or:s.expectedType&&s.expectedType.kind!=="value"&&(T=s.expectedType);for(let b=0;b<g.length;b+=2){const C=g[b],M=g[b+1],P=b+3,N=b+4;if(typeof C!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',P);if(y.length&&y[y.length-1][0]>=C)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',P);const Z=s.parse(M,N,T);if(!Z)return null;T=T||Z.type,y.push([C,Z])}return T.kind==="number"||T.kind==="color"||T.kind==="array"&&T.itemType.kind==="number"&&typeof T.N=="number"?new Ci(T,c,f,p,y):s.error(`Type ${Vr(T)} is not interpolatable.`)}evaluate(t){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(t);const f=this.input.evaluate(t);if(f<=s[0])return c[0].evaluate(t);const p=s.length;if(f>=s[p-1])return c[p-1].evaluate(t);const g=Ll(s,f),y=Ci.interpolationFactor(this.interpolation,f,s[g],s[g+1]),T=c[g].evaluate(t),b=c[g+1].evaluate(t);return this.operator==="interpolate"?Xc[this.type.kind.toLowerCase()](T,b,y):this.operator==="interpolate-hcl"?Ol.reverse(Ol.interpolate(Ol.forward(T),Ol.forward(b),y)):zl.reverse(zl.interpolate(zl.forward(T),zl.forward(b),y))}eachChild(t){t(this.input);for(const s of this.outputs)t(s)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,t,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function Yc(a,t,s,c){const f=c-s,p=a-s;return f===0?0:t===1?p/f:(Math.pow(t,p)-1)/(Math.pow(t,f)-1)}class Bl{constructor(t,s){this.type=t,this.args=s}static parse(t,s){if(t.length<2)return s.error("Expectected at least one argument.");let c=null;const f=s.expectedType;f&&f.kind!=="value"&&(c=f);const p=[];for(const y of t.slice(1)){const T=s.parse(y,1+p.length,c,void 0,{typeAnnotation:"omit"});if(!T)return null;c=c||T.type,p.push(T)}const g=f&&p.some(y=>Ml(f,y.type));return new Bl(g?Qt:c,p)}evaluate(t){let s,c=null,f=0;for(const p of this.args){if(f++,c=p.evaluate(t),c&&c instanceof ki&&!c.available&&(s||(s=c),c=null,f===this.args.length))return s;if(c!==null)break}return c}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(s=>{t.push(s.serialize())}),t}}class Nl{constructor(t,s){this.type=s.type,this.bindings=[].concat(t),this.result=s}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const s of this.bindings)t(s[1]);t(this.result)}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const c=[];for(let p=1;p<t.length-1;p+=2){const g=t[p];if(typeof g!="string")return s.error(`Expected string, but found ${typeof g} instead.`,p);if(/[^a-zA-Z0-9_]/.test(g))return s.error("Variable names must contain only alphanumeric characters or '_'.",p);const y=s.parse(t[p+1],p+1);if(!y)return null;c.push([g,y])}const f=s.parse(t[t.length-1],t.length-1,s.expectedType,c);return f?new Nl(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[s,c]of this.bindings)t.push(s,c.serialize());return t.push(this.result.serialize()),t}}class Rh{constructor(t,s,c){this.type=t,this.index=s,this.input=c}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=s.parse(t[1],1,it),f=s.parse(t[2],2,tn(s.expectedType||Qt));return c&&f?new Rh(f.type.itemType,c,f):null}evaluate(t){const s=this.index.evaluate(t),c=this.input.evaluate(t);if(s<0)throw new Bn(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new Bn(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new Bn(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Jc{constructor(t,s){this.type=Gt,this.needle=t,this.haystack=s}static parse(t,s){if(t.length!==3)return s.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const c=s.parse(t[1],1,Qt),f=s.parse(t[2],2,Qt);return c&&f?Uc(c.type,[Gt,Zt,it,Mt,Qt])?new Jc(c,f):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vr(c.type)} instead`):null}evaluate(t){const s=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(c==null)return!1;if(!Co(s,["boolean","string","number","null"]))throw new Bn(`Expected first argument to be of type boolean, string, number or null, but found ${Vr(an(s))} instead.`);if(!Co(c,["string","array"]))throw new Bn(`Expected second argument to be of type array or string, but found ${Vr(an(c))} instead.`);return c.indexOf(s)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Qc{constructor(t,s,c){this.type=it,this.needle=t,this.haystack=s,this.fromIndex=c}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=s.parse(t[1],1,Qt),f=s.parse(t[2],2,Qt);if(!c||!f)return null;if(!Uc(c.type,[Gt,Zt,it,Mt,Qt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Vr(c.type)} instead`);if(t.length===4){const p=s.parse(t[3],3,it);return p?new Qc(c,f,p):null}return new Qc(c,f)}evaluate(t){const s=this.needle.evaluate(t),c=this.haystack.evaluate(t);if(!Co(s,["boolean","string","number","null"]))throw new Bn(`Expected first argument to be of type boolean, string, number or null, but found ${Vr(an(s))} instead.`);if(!Co(c,["string","array"]))throw new Bn(`Expected second argument to be of type array or string, but found ${Vr(an(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(t);return c.indexOf(s,f)}return c.indexOf(s)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class eu{constructor(t,s,c,f,p,g){this.inputType=t,this.type=s,this.input=c,this.cases=f,this.outputs=p,this.otherwise=g}static parse(t,s){if(t.length<5)return s.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return s.error("Expected an even number of arguments.");let c,f;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);const p={},g=[];for(let b=2;b<t.length-1;b+=2){let C=t[b];const M=t[b+1];Array.isArray(C)||(C=[C]);const P=s.concat(b);if(C.length===0)return P.error("Expected at least one branch label.");for(const Z of C){if(typeof Z!="number"&&typeof Z!="string")return P.error("Branch labels must be numbers or strings.");if(typeof Z=="number"&&Math.abs(Z)>Number.MAX_SAFE_INTEGER)return P.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Z=="number"&&Math.floor(Z)!==Z)return P.error("Numeric branch labels must be integer values.");if(c){if(P.checkSubtype(c,an(Z)))return null}else c=an(Z);if(p[String(Z)]!==void 0)return P.error("Branch labels must be unique.");p[String(Z)]=g.length}const N=s.parse(M,b,f);if(!N)return null;f=f||N.type,g.push(N)}const y=s.parse(t[1],1,Qt);if(!y)return null;const T=s.parse(t[t.length-1],t.length-1,f);return T?y.type.kind!=="value"&&s.concat(1).checkSubtype(c,y.type)?null:new eu(c,f,y,p,g,T):null}evaluate(t){const s=this.input.evaluate(t);return(an(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],f={};for(const g of s){const y=f[this.cases[g]];y===void 0?(f[this.cases[g]]=c.length,c.push([this.cases[g],[g]])):c[y][1].push(g)}const p=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,y]of c)t.push(y.length===1?p(y[0]):y.map(p)),t.push(this.outputs[g].serialize());return t.push(this.otherwise.serialize()),t}}class tu{constructor(t,s,c){this.type=t,this.branches=s,this.otherwise=c}static parse(t,s){if(t.length<4)return s.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const f=[];for(let g=1;g<t.length-1;g+=2){const y=s.parse(t[g],g,Gt);if(!y)return null;const T=s.parse(t[g+1],g+1,c);if(!T)return null;f.push([y,T]),c=c||T.type}const p=s.parse(t[t.length-1],t.length-1,c);return p?new tu(c,f,p):null}evaluate(t){for(const[s,c]of this.branches)if(s.evaluate(t))return c.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[s,c]of this.branches)t(s),t(c);t(this.otherwise)}outputDefined(){return this.branches.every(([t,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(s=>{t.push(s.serialize())}),t}}class ru{constructor(t,s,c,f){this.type=t,this.input=s,this.beginIndex=c,this.endIndex=f}static parse(t,s){if(t.length<=2||t.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const c=s.parse(t[1],1,Qt),f=s.parse(t[2],2,it);if(!c||!f)return null;if(!Uc(c.type,[tn(Qt),Zt,Qt]))return s.error(`Expected first argument to be of type array or string, but found ${Vr(c.type)} instead`);if(t.length===4){const p=s.parse(t[3],3,it);return p?new ru(c.type,c,f,p):null}return new ru(c.type,c,f)}evaluate(t){const s=this.input.evaluate(t),c=this.beginIndex.evaluate(t);if(!Co(s,["string","array"]))throw new Bn(`Expected first argument to be of type array or string, but found ${Vr(an(s))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(t);return s.slice(c,f)}return s.slice(c)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function gp(a,t){return a==="=="||a==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function xp(a,t,s,c){return c.compare(t,s)===0}function Po(a,t,s){const c=a!=="=="&&a!=="!=";return class bA{constructor(p,g,y){this.type=Gt,this.lhs=p,this.rhs=g,this.collator=y,this.hasUntypedArgument=p.type.kind==="value"||g.type.kind==="value"}static parse(p,g){if(p.length!==3&&p.length!==4)return g.error("Expected two or three arguments.");const y=p[0];let T=g.parse(p[1],1,Qt);if(!T)return null;if(!gp(y,T.type))return g.concat(1).error(`"${y}" comparisons are not supported for type '${Vr(T.type)}'.`);let b=g.parse(p[2],2,Qt);if(!b)return null;if(!gp(y,b.type))return g.concat(2).error(`"${y}" comparisons are not supported for type '${Vr(b.type)}'.`);if(T.type.kind!==b.type.kind&&T.type.kind!=="value"&&b.type.kind!=="value")return g.error(`Cannot compare types '${Vr(T.type)}' and '${Vr(b.type)}'.`);c&&(T.type.kind==="value"&&b.type.kind!=="value"?T=new da(b.type,[T]):T.type.kind!=="value"&&b.type.kind==="value"&&(b=new da(T.type,[b])));let C=null;if(p.length===4){if(T.type.kind!=="string"&&b.type.kind!=="string"&&T.type.kind!=="value"&&b.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(C=g.parse(p[3],3,Si),!C)return null}return new bA(T,b,C)}evaluate(p){const g=this.lhs.evaluate(p),y=this.rhs.evaluate(p);if(c&&this.hasUntypedArgument){const T=an(g),b=an(y);if(T.kind!==b.kind||T.kind!=="string"&&T.kind!=="number")throw new Bn(`Expected arguments for "${a}" to be (string, string) or (number, number), but found (${T.kind}, ${b.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const T=an(g),b=an(y);if(T.kind!=="string"||b.kind!=="string")return t(p,g,y)}return this.collator?s(p,g,y,this.collator.evaluate(p)):t(p,g,y)}eachChild(p){p(this.lhs),p(this.rhs),this.collator&&p(this.collator)}outputDefined(){return!0}serialize(){const p=[a];return this.eachChild(g=>{p.push(g.serialize())}),p}}}const D_=Po("==",function(a,t,s){return t===s},xp),F_=Po("!=",function(a,t,s){return t!==s},function(a,t,s,c){return!xp(0,t,s,c)}),yp=Po("<",function(a,t,s){return t<s},function(a,t,s,c){return c.compare(t,s)<0}),P_=Po(">",function(a,t,s){return t>s},function(a,t,s,c){return c.compare(t,s)>0}),L_=Po("<=",function(a,t,s){return t<=s},function(a,t,s,c){return c.compare(t,s)<=0}),R_=Po(">=",function(a,t,s){return t>=s},function(a,t,s,c){return c.compare(t,s)>=0});class zh{constructor(t,s,c,f,p){this.type=Zt,this.number=t,this.locale=s,this.currency=c,this.minFractionDigits=f,this.maxFractionDigits=p}static parse(t,s){if(t.length!==3)return s.error("Expected two arguments.");const c=s.parse(t[1],1,it);if(!c)return null;const f=t[2];if(typeof f!="object"||Array.isArray(f))return s.error("NumberFormat options argument must be an object.");let p=null;if(f.locale&&(p=s.parse(f.locale,1,Zt),!p))return null;let g=null;if(f.currency&&(g=s.parse(f.currency,1,Zt),!g))return null;let y=null;if(f["min-fraction-digits"]&&(y=s.parse(f["min-fraction-digits"],1,it),!y))return null;let T=null;return f["max-fraction-digits"]&&(T=s.parse(f["max-fraction-digits"],1,it),!T)?null:new zh(c,p,g,y,T)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class nu{constructor(t){this.type=it,this.input=t}static parse(t,s){if(t.length!==2)return s.error(`Expected 1 argument, but found ${t.length-1} instead.`);const c=s.parse(t[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Vr(c.type)} instead.`):new nu(c):null}evaluate(t){const s=this.input.evaluate(t);if(typeof s=="string"||Array.isArray(s))return s.length;throw new Bn(`Expected value to be of type string or array, but found ${Vr(an(s))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(s=>{t.push(s.serialize())}),t}}const Js={"==":D_,"!=":F_,">":P_,"<":yp,">=":R_,"<=":L_,array:da,at:Rh,boolean:da,case:tu,coalesce:Bl,collator:Gc,format:Mo,image:Do,in:Jc,"index-of":Qc,interpolate:Ci,"interpolate-hcl":Ci,"interpolate-lab":Ci,length:nu,let:Nl,literal:qa,match:eu,number:da,"number-format":zh,object:da,slice:ru,step:Rl,string:da,"to-boolean":pa,"to-color":pa,"to-number":pa,"to-string":pa,var:Ys,within:Ks};function Oh(a,[t,s,c,f]){t=t.evaluate(a),s=s.evaluate(a),c=c.evaluate(a);const p=f?f.evaluate(a):1,g=fa(t,s,c,p);if(g)throw new Bn(g);return new pr(t/255*p,s/255*p,c/255*p,p)}function vp(a,t){return a in t}function Bh(a,t){const s=t[a];return s===void 0?null:s}function vs(a){return{type:a}}function Nh(a){return{result:"success",value:a}}function Qs(a){return{result:"error",value:a}}function Lo(a){return a["property-type"]==="data-driven"||a["property-type"]==="cross-faded-data-driven"}function wp(a){return!!a.expression&&a.expression.parameters.indexOf("zoom")>-1}function Uh(a){return!!a.expression&&a.expression.interpolated}function xr(a){return a instanceof Number?"number":a instanceof String?"string":a instanceof Boolean?"boolean":Array.isArray(a)?"array":a===null?"null":typeof a}function eo(a){return typeof a=="object"&&a!==null&&!Array.isArray(a)}function Tp(a){return a}function Vh(a,t){const s=t.type==="color",c=a.stops&&typeof a.stops[0][0]=="object",f=c||!(c||a.property!==void 0),p=a.type||(Uh(t)?"exponential":"interval");if(s&&((a=Ze({},a)).stops&&(a.stops=a.stops.map(b=>[b[0],pr.parse(b[1])])),a.default=pr.parse(a.default?a.default:t.default)),a.colorSpace&&a.colorSpace!=="rgb"&&!Lh[a.colorSpace])throw new Error(`Unknown color space: ${a.colorSpace}`);let g,y,T;if(p==="exponential")g=jh;else if(p==="interval")g=O_;else if(p==="categorical"){g=z_,y=Object.create(null);for(const b of a.stops)y[b[0]]=b[1];T=typeof a.stops[0][0]}else{if(p!=="identity")throw new Error(`Unknown function type "${p}"`);g=Ep}if(c){const b={},C=[];for(let N=0;N<a.stops.length;N++){const Z=a.stops[N],ee=Z[0].zoom;b[ee]===void 0&&(b[ee]={zoom:ee,type:a.type,property:a.property,default:a.default,stops:[]},C.push(ee)),b[ee].stops.push([Z[0].value,Z[1]])}const M=[];for(const N of C)M.push([b[N].zoom,Vh(b[N],t)]);const P={name:"linear"};return{kind:"composite",interpolationType:P,interpolationFactor:Ci.interpolationFactor.bind(void 0,P),zoomStops:M.map(N=>N[0]),evaluate:({zoom:N},Z)=>jh({stops:M,base:a.base},t,N).evaluate(N,Z)}}if(f){const b=p==="exponential"?{name:"exponential",base:a.base!==void 0?a.base:1}:null;return{kind:"camera",interpolationType:b,interpolationFactor:Ci.interpolationFactor.bind(void 0,b),zoomStops:a.stops.map(C=>C[0]),evaluate:({zoom:C})=>g(a,t,C,y,T)}}return{kind:"source",evaluate(b,C){const M=C&&C.properties?C.properties[a.property]:void 0;return M===void 0?Ul(a.default,t.default):g(a,t,M,y,T)}}}function Ul(a,t,s){return a!==void 0?a:t!==void 0?t:s!==void 0?s:void 0}function z_(a,t,s,c,f){return Ul(typeof s===f?c[s]:void 0,a.default,t.default)}function O_(a,t,s){if(xr(s)!=="number")return Ul(a.default,t.default);const c=a.stops.length;if(c===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[c-1][0])return a.stops[c-1][1];const f=Ll(a.stops.map(p=>p[0]),s);return a.stops[f][1]}function jh(a,t,s){const c=a.base!==void 0?a.base:1;if(xr(s)!=="number")return Ul(a.default,t.default);const f=a.stops.length;if(f===1||s<=a.stops[0][0])return a.stops[0][1];if(s>=a.stops[f-1][0])return a.stops[f-1][1];const p=Ll(a.stops.map(C=>C[0]),s),g=function(C,M,P,N){const Z=N-P,ee=C-P;return Z===0?0:M===1?ee/Z:(Math.pow(M,ee)-1)/(Math.pow(M,Z)-1)}(s,c,a.stops[p][0],a.stops[p+1][0]),y=a.stops[p][1],T=a.stops[p+1][1];let b=Xc[t.type]||Tp;if(a.colorSpace&&a.colorSpace!=="rgb"){const C=Lh[a.colorSpace];b=(M,P)=>C.reverse(C.interpolate(C.forward(M),C.forward(P),g))}return typeof y.evaluate=="function"?{evaluate(...C){const M=y.evaluate.apply(void 0,C),P=T.evaluate.apply(void 0,C);if(M!==void 0&&P!==void 0)return b(M,P,g)}}:b(y,T,g)}function Ep(a,t,s){return t.type==="color"?s=pr.parse(s):t.type==="formatted"?s=mn.fromString(s.toString()):t.type==="resolvedImage"?s=ki.fromString(s.toString()):xr(s)===t.type||t.type==="enum"&&t.values[s]||(s=void 0),Ul(s,a.default,t.default)}Ai.register(Js,{error:[{kind:"error"},[Zt],(a,[t])=>{throw new Bn(t.evaluate(a))}],typeof:[Zt,[Qt],(a,[t])=>Vr(an(t.evaluate(a)))],"to-rgba":[tn(it,4),[Or],(a,[t])=>t.evaluate(a).toArray()],rgb:[Or,[it,it,it],Oh],rgba:[Or,[it,it,it,it],Oh],has:{type:Gt,overloads:[[[Zt],(a,[t])=>vp(t.evaluate(a),a.properties())],[[Zt,bi],(a,[t,s])=>vp(t.evaluate(a),s.evaluate(a))]]},get:{type:Qt,overloads:[[[Zt],(a,[t])=>Bh(t.evaluate(a),a.properties())],[[Zt,bi],(a,[t,s])=>Bh(t.evaluate(a),s.evaluate(a))]]},"feature-state":[Qt,[Zt],(a,[t])=>Bh(t.evaluate(a),a.featureState||{})],properties:[bi,[],a=>a.properties()],"geometry-type":[Zt,[],a=>a.geometryType()],id:[Qt,[],a=>a.id()],zoom:[it,[],a=>a.globals.zoom],pitch:[it,[],a=>a.globals.pitch||0],"distance-from-center":[it,[],a=>a.distanceFromCenter()],"heatmap-density":[it,[],a=>a.globals.heatmapDensity||0],"line-progress":[it,[],a=>a.globals.lineProgress||0],"sky-radial-progress":[it,[],a=>a.globals.skyRadialProgress||0],accumulated:[Qt,[],a=>a.globals.accumulated===void 0?null:a.globals.accumulated],"+":[it,vs(it),(a,t)=>{let s=0;for(const c of t)s+=c.evaluate(a);return s}],"*":[it,vs(it),(a,t)=>{let s=1;for(const c of t)s*=c.evaluate(a);return s}],"-":{type:it,overloads:[[[it,it],(a,[t,s])=>t.evaluate(a)-s.evaluate(a)],[[it],(a,[t])=>-t.evaluate(a)]]},"/":[it,[it,it],(a,[t,s])=>t.evaluate(a)/s.evaluate(a)],"%":[it,[it,it],(a,[t,s])=>t.evaluate(a)%s.evaluate(a)],ln2:[it,[],()=>Math.LN2],pi:[it,[],()=>Math.PI],e:[it,[],()=>Math.E],"^":[it,[it,it],(a,[t,s])=>Math.pow(t.evaluate(a),s.evaluate(a))],sqrt:[it,[it],(a,[t])=>Math.sqrt(t.evaluate(a))],log10:[it,[it],(a,[t])=>Math.log(t.evaluate(a))/Math.LN10],ln:[it,[it],(a,[t])=>Math.log(t.evaluate(a))],log2:[it,[it],(a,[t])=>Math.log(t.evaluate(a))/Math.LN2],sin:[it,[it],(a,[t])=>Math.sin(t.evaluate(a))],cos:[it,[it],(a,[t])=>Math.cos(t.evaluate(a))],tan:[it,[it],(a,[t])=>Math.tan(t.evaluate(a))],asin:[it,[it],(a,[t])=>Math.asin(t.evaluate(a))],acos:[it,[it],(a,[t])=>Math.acos(t.evaluate(a))],atan:[it,[it],(a,[t])=>Math.atan(t.evaluate(a))],min:[it,vs(it),(a,t)=>Math.min(...t.map(s=>s.evaluate(a)))],max:[it,vs(it),(a,t)=>Math.max(...t.map(s=>s.evaluate(a)))],abs:[it,[it],(a,[t])=>Math.abs(t.evaluate(a))],round:[it,[it],(a,[t])=>{const s=t.evaluate(a);return s<0?-Math.round(-s):Math.round(s)}],floor:[it,[it],(a,[t])=>Math.floor(t.evaluate(a))],ceil:[it,[it],(a,[t])=>Math.ceil(t.evaluate(a))],"filter-==":[Gt,[Zt,Qt],(a,[t,s])=>a.properties()[t.value]===s.value],"filter-id-==":[Gt,[Qt],(a,[t])=>a.id()===t.value],"filter-type-==":[Gt,[Zt],(a,[t])=>a.geometryType()===t.value],"filter-<":[Gt,[Zt,Qt],(a,[t,s])=>{const c=a.properties()[t.value],f=s.value;return typeof c==typeof f&&c<f}],"filter-id-<":[Gt,[Qt],(a,[t])=>{const s=a.id(),c=t.value;return typeof s==typeof c&&s<c}],"filter->":[Gt,[Zt,Qt],(a,[t,s])=>{const c=a.properties()[t.value],f=s.value;return typeof c==typeof f&&c>f}],"filter-id->":[Gt,[Qt],(a,[t])=>{const s=a.id(),c=t.value;return typeof s==typeof c&&s>c}],"filter-<=":[Gt,[Zt,Qt],(a,[t,s])=>{const c=a.properties()[t.value],f=s.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[Gt,[Qt],(a,[t])=>{const s=a.id(),c=t.value;return typeof s==typeof c&&s<=c}],"filter->=":[Gt,[Zt,Qt],(a,[t,s])=>{const c=a.properties()[t.value],f=s.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[Gt,[Qt],(a,[t])=>{const s=a.id(),c=t.value;return typeof s==typeof c&&s>=c}],"filter-has":[Gt,[Qt],(a,[t])=>t.value in a.properties()],"filter-has-id":[Gt,[],a=>a.id()!==null&&a.id()!==void 0],"filter-type-in":[Gt,[tn(Zt)],(a,[t])=>t.value.indexOf(a.geometryType())>=0],"filter-id-in":[Gt,[tn(Qt)],(a,[t])=>t.value.indexOf(a.id())>=0],"filter-in-small":[Gt,[Zt,tn(Qt)],(a,[t,s])=>s.value.indexOf(a.properties()[t.value])>=0],"filter-in-large":[Gt,[Zt,tn(Qt)],(a,[t,s])=>function(c,f,p,g){for(;p<=g;){const y=p+g>>1;if(f[y]===c)return!0;f[y]>c?g=y-1:p=y+1}return!1}(a.properties()[t.value],s.value,0,s.value.length-1)],all:{type:Gt,overloads:[[[Gt,Gt],(a,[t,s])=>t.evaluate(a)&&s.evaluate(a)],[vs(Gt),(a,t)=>{for(const s of t)if(!s.evaluate(a))return!1;return!0}]]},any:{type:Gt,overloads:[[[Gt,Gt],(a,[t,s])=>t.evaluate(a)||s.evaluate(a)],[vs(Gt),(a,t)=>{for(const s of t)if(s.evaluate(a))return!0;return!1}]]},"!":[Gt,[Gt],(a,[t])=>!t.evaluate(a)],"is-supported-script":[Gt,[Zt],(a,[t])=>{const s=a.globals&&a.globals.isSupportedScript;return!s||s(t.evaluate(a))}],upcase:[Zt,[Zt],(a,[t])=>t.evaluate(a).toUpperCase()],downcase:[Zt,[Zt],(a,[t])=>t.evaluate(a).toLowerCase()],concat:[Zt,vs(Qt),(a,t)=>t.map(s=>Xa(s.evaluate(a))).join("")],"resolved-locale":[Zt,[Si],(a,[t])=>t.evaluate(a).resolvedLocale()]});class iu{constructor(t,s){this.expression=t,this._warningHistory={},this._evaluator=new sp,this._defaultValue=s?function(c){return c.type==="color"&&eo(c.default)?new pr(0,0,0,0):c.type==="color"?pr.parse(c.default)||null:c.default===void 0?null:c.default}(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(t,s,c,f,p,g,y,T){return this._evaluator.globals=t,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=T||null,this.expression.evaluate(this._evaluator)}evaluate(t,s,c,f,p,g,y,T){this._evaluator.globals=t,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=p||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=y||null,this._evaluator.featureDistanceData=T||null;try{const b=this.expression.evaluate(this._evaluator);if(b==null||typeof b=="number"&&b!=b)return this._defaultValue;if(this._enumValues&&!(b in this._enumValues))throw new Bn(`Expected value to be one of ${Object.keys(this._enumValues).map(C=>JSON.stringify(C)).join(", ")}, but found ${JSON.stringify(b)} instead.`);return b}catch(b){return this._warningHistory[b.message]||(this._warningHistory[b.message]=!0,typeof console!="undefined"&&console.warn(b.message)),this._defaultValue}}}function Ro(a){return Array.isArray(a)&&a.length>0&&typeof a[0]=="string"&&a[0]in Js}function Vl(a,t){const s=new xs(Js,[],t?function(f){const p={color:Or,string:Zt,number:it,enum:Zt,boolean:Gt,formatted:ii,resolvedImage:Tn};return f.type==="array"?tn(p[f.value]||Qt,f.length):p[f.type]}(t):void 0),c=s.parse(a,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?Nh(new iu(c,t)):Qs(s.errors)}class Gh{constructor(t,s){this.kind=t,this._styleExpression=s,this.isStateDependent=t!=="constant"&&!Fl(s.expression)}evaluateWithoutErrorHandling(t,s,c,f,p,g){return this._styleExpression.evaluateWithoutErrorHandling(t,s,c,f,p,g)}evaluate(t,s,c,f,p,g){return this._styleExpression.evaluate(t,s,c,f,p,g)}}class $h{constructor(t,s,c,f){this.kind=t,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=t!=="camera"&&!Fl(s.expression),this.interpolationType=f}evaluateWithoutErrorHandling(t,s,c,f,p,g){return this._styleExpression.evaluateWithoutErrorHandling(t,s,c,f,p,g)}evaluate(t,s,c,f,p,g){return this._styleExpression.evaluate(t,s,c,f,p,g)}interpolationFactor(t,s,c){return this.interpolationType?Ci.interpolationFactor(this.interpolationType,t,s,c):0}}function bp(a,t){if((a=Vl(a,t)).result==="error")return a;const s=a.value.expression,c=ai(s);if(!c&&!Lo(t))return Qs([new pt("","data expressions not supported")]);const f=Pl(s,["zoom","pitch","distance-from-center"]);if(!f&&!wp(t))return Qs([new pt("","zoom expressions not supported")]);const p=su(s);return p||f?p instanceof pt?Qs([p]):p instanceof Ci&&!Uh(t)?Qs([new pt("",'"interpolate" expressions cannot be used with this property')]):Nh(p?new $h(c?"camera":"composite",a.value,p.labels,p instanceof Ci?p.interpolation:void 0):new Gh(c?"constant":"source",a.value)):Qs([new pt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class au{constructor(t,s){this._parameters=t,this._specification=s,Ze(this,Vh(this._parameters,this._specification))}static deserialize(t){return new au(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function su(a){let t=null;if(a instanceof Nl)t=su(a.result);else if(a instanceof Bl){for(const s of a.args)if(t=su(s),t)break}else(a instanceof Rl||a instanceof Ci)&&a.input instanceof Ai&&a.input.name==="zoom"&&(t=a);return t instanceof pt||a.eachChild(s=>{const c=su(s);c instanceof pt?t=c:!t&&c?t=new pt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&c&&t!==c&&(t=new pt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}class St{constructor(t,s,c,f){this.message=(t?`${t}: `:"")+c,f&&(this.identifier=f),s!=null&&s.__line__&&(this.line=s.__line__)}}function Hi(a){const t=a.key,s=a.value,c=a.valueSpec||{},f=a.objectElementValidators||{},p=a.style,g=a.styleSpec;let y=[];const T=xr(s);if(T!=="object")return[new St(t,s,`object expected, ${T} found`)];for(const b in s){const C=b.split(".")[0],M=c[C]||c["*"];let P;f[C]?P=f[C]:c[C]?P=En:f["*"]?P=f["*"]:c["*"]&&(P=En),P?y=y.concat(P({key:(t&&`${t}.`)+b,value:s[b],valueSpec:M,style:p,styleSpec:g,object:s,objectKey:b},s)):y.push(new St(t,s[b],`unknown property "${b}"`))}for(const b in c)f[b]||c[b].required&&c[b].default===void 0&&s[b]===void 0&&y.push(new St(t,s,`missing required property "${b}"`));return y}function jl(a){const t=a.value,s=a.valueSpec,c=a.style,f=a.styleSpec,p=a.key,g=a.arrayElementValidator||En;if(xr(t)!=="array")return[new St(p,t,`array expected, ${xr(t)} found`)];if(s.length&&t.length!==s.length)return[new St(p,t,`array length ${s.length} expected, length ${t.length} found`)];if(s["min-length"]&&t.length<s["min-length"])return[new St(p,t,`array length at least ${s["min-length"]} expected, length ${t.length} found`)];let y={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};f.$version<7&&(y.function=s.function),xr(s.value)==="object"&&(y=s.value);let T=[];for(let b=0;b<t.length;b++)T=T.concat(g({array:t,arrayIndex:b,value:t[b],valueSpec:y,style:c,styleSpec:f,key:`${p}[${b}]`}));return T}function Sp(a){const t=a.key,s=a.value,c=a.valueSpec;let f=xr(s);if(f==="number"&&s!=s&&(f="NaN"),f!=="number")return[new St(t,s,`number expected, ${f} found`)];if("minimum"in c){let p=c.minimum;if(xr(c.minimum)==="array"&&(p=c.minimum[a.arrayIndex]),s<p)return[new St(t,s,`${s} is less than the minimum value ${p}`)]}if("maximum"in c){let p=c.maximum;if(xr(c.maximum)==="array"&&(p=c.maximum[a.arrayIndex]),s>p)return[new St(t,s,`${s} is greater than the maximum value ${p}`)]}return[]}function kp(a){const t=a.valueSpec,s=qe(a.value.type);let c,f,p,g={};const y=s!=="categorical"&&a.value.property===void 0,T=!y,b=xr(a.value.stops)==="array"&&xr(a.value.stops[0])==="array"&&xr(a.value.stops[0][0])==="object",C=Hi({key:a.key,value:a.value,valueSpec:a.styleSpec.function,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{stops:function(N){if(s==="identity")return[new St(N.key,N.value,'identity function may not have a "stops" property')];let Z=[];const ee=N.value;return Z=Z.concat(jl({key:N.key,value:ee,valueSpec:N.valueSpec,style:N.style,styleSpec:N.styleSpec,arrayElementValidator:M})),xr(ee)==="array"&&ee.length===0&&Z.push(new St(N.key,ee,"array must have at least one stop")),Z},default:function(N){return En({key:N.key,value:N.value,valueSpec:t,style:N.style,styleSpec:N.styleSpec})}}});return s==="identity"&&y&&C.push(new St(a.key,a.value,'missing required property "property"')),s==="identity"||a.value.stops||C.push(new St(a.key,a.value,'missing required property "stops"')),s==="exponential"&&a.valueSpec.expression&&!Uh(a.valueSpec)&&C.push(new St(a.key,a.value,"exponential functions not supported")),a.styleSpec.$version>=8&&(T&&!Lo(a.valueSpec)?C.push(new St(a.key,a.value,"property functions not supported")):y&&!wp(a.valueSpec)&&C.push(new St(a.key,a.value,"zoom functions not supported"))),s!=="categorical"&&!b||a.value.property!==void 0||C.push(new St(a.key,a.value,'"property" property is required')),C;function M(N){let Z=[];const ee=N.value,ae=N.key;if(xr(ee)!=="array")return[new St(ae,ee,`array expected, ${xr(ee)} found`)];if(ee.length!==2)return[new St(ae,ee,`array length 2 expected, length ${ee.length} found`)];if(b){if(xr(ee[0])!=="object")return[new St(ae,ee,`object expected, ${xr(ee[0])} found`)];if(ee[0].zoom===void 0)return[new St(ae,ee,"object stop key must have zoom")];if(ee[0].value===void 0)return[new St(ae,ee,"object stop key must have value")];const fe=qe(ee[0].zoom);if(typeof fe!="number")return[new St(ae,ee[0].zoom,"stop zoom values must be numbers")];if(p&&p>fe)return[new St(ae,ee[0].zoom,"stop zoom values must appear in ascending order")];fe!==p&&(p=fe,f=void 0,g={}),Z=Z.concat(Hi({key:`${ae}[0]`,value:ee[0],valueSpec:{zoom:{}},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{zoom:Sp,value:P}}))}else Z=Z.concat(P({key:`${ae}[0]`,value:ee[0],valueSpec:{},style:N.style,styleSpec:N.styleSpec},ee));return Ro(lt(ee[1]))?Z.concat([new St(`${ae}[1]`,ee[1],"expressions are not allowed in function stops.")]):Z.concat(En({key:`${ae}[1]`,value:ee[1],valueSpec:t,style:N.style,styleSpec:N.styleSpec}))}function P(N,Z){const ee=xr(N.value),ae=qe(N.value),fe=N.value!==null?N.value:Z;if(c){if(ee!==c)return[new St(N.key,fe,`${ee} stop domain type must match previous stop domain type ${c}`)]}else c=ee;if(ee!=="number"&&ee!=="string"&&ee!=="boolean"&&typeof ae!="number"&&typeof ae!="string"&&typeof ae!="boolean")return[new St(N.key,fe,"stop domain value must be a number, string, or boolean")];if(ee!=="number"&&s!=="categorical"){let be=`number expected, ${ee} found`;return Lo(t)&&s===void 0&&(be+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new St(N.key,fe,be)]}return s!=="categorical"||ee!=="number"||typeof ae=="number"&&isFinite(ae)&&Math.floor(ae)===ae?s!=="categorical"&&ee==="number"&&typeof ae=="number"&&typeof f=="number"&&f!==void 0&&ae<f?[new St(N.key,fe,"stop domain values must appear in ascending order")]:(f=ae,s==="categorical"&&ae in g?[new St(N.key,fe,"stop domain values must be unique")]:(g[ae]=!0,[])):[new St(N.key,fe,`integer expected, found ${String(ae)}`)]}}function zo(a){const t=(a.expressionContext==="property"?bp:Vl)(lt(a.value),a.valueSpec);if(t.result==="error")return t.value.map(c=>new St(`${a.key}${c.key}`,a.value,c.message));const s=t.value.expression||t.value._styleExpression.expression;if(a.expressionContext==="property"&&a.propertyKey==="text-font"&&!s.outputDefined())return[new St(a.key,a.value,`Invalid data expression for "${a.propertyKey}". Output values must be contained as literals within the expression.`)];if(a.expressionContext==="property"&&a.propertyType==="layout"&&!Fl(s))return[new St(a.key,a.value,'"feature-state" data expressions are not supported with layout properties.')];if(a.expressionContext==="filter")return Ka(s,a);if(a.expressionContext&&a.expressionContext.indexOf("cluster")===0){if(!Pl(s,["zoom","feature-state"]))return[new St(a.key,a.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(a.expressionContext==="cluster-initial"&&!ai(s))return[new St(a.key,a.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Ka(a,t){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const f of t.valueSpec.expression.parameters)s.delete(f);if(s.size===0)return[];const c=[];return a instanceof Ai&&s.has(a.name)?[new St(t.key,t.value,`["${a.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(a.eachChild(f=>{c.push(...Ka(f,t))}),c)}function Gl(a){const t=a.key,s=a.value,c=a.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(qe(s))===-1&&f.push(new St(t,s,`expected one of [${c.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(c.values).indexOf(qe(s))===-1&&f.push(new St(t,s,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(s)} found`)),f}function ws(a){if(a===!0||a===!1)return!0;if(!Array.isArray(a)||a.length===0)return!1;switch(a[0]){case"has":return a.length>=2&&a[1]!=="$id"&&a[1]!=="$type";case"in":return a.length>=3&&(typeof a[1]!="string"||Array.isArray(a[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return a.length!==3||Array.isArray(a[1])||Array.isArray(a[2]);case"any":case"all":for(const t of a.slice(1))if(!ws(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function Ts(a,t="fill"){if(a==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ws(a)||(a=$l(a));const s=a;let c=!0;try{c=function(b){if(!Es(b))return b;let C=lt(b);return Ap(C),C=Wh(C),C}(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const f=le[`filter_${t}`],p=Vl(c,f);let g=null;if(p.result==="error")throw new Error(p.value.map(b=>`${b.key}: ${b.message}`).join(", "));g=(b,C,M)=>p.value.evaluate(b,C,{},M);let y=null,T=null;if(c!==s){const b=Vl(s,f);if(b.result==="error")throw new Error(b.value.map(C=>`${C.key}: ${C.message}`).join(", "));y=(C,M,P,N,Z)=>b.value.evaluate(C,M,{},P,void 0,void 0,N,Z),T=!ai(b.value.expression)}return g=g,{filter:g,dynamicFilter:y||void 0,needGeometry:ou(c),needFeature:!!T}}function Wh(a){if(!Array.isArray(a))return a;const t=function(s){if(Cp.has(s[0])){for(let c=1;c<s.length;c++)if(Es(s[c]))return!0}return s}(a);return t===!0?t:t.map(s=>Wh(s))}function Ap(a){let t=!1;const s=[];if(a[0]==="case"){for(let c=1;c<a.length-1;c+=2)t=t||Es(a[c]),s.push(a[c+1]);s.push(a[a.length-1])}else if(a[0]==="match"){t=t||Es(a[1]);for(let c=2;c<a.length-1;c+=2)s.push(a[c+1]);s.push(a[a.length-1])}else if(a[0]==="step"){t=t||Es(a[1]);for(let c=1;c<a.length-1;c+=2)s.push(a[c+1])}t&&(a.length=0,a.push("any",...s));for(let c=1;c<a.length;c++)Ap(a[c])}function Es(a){if(!Array.isArray(a))return!1;if((t=a[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let s=1;s<a.length;s++)if(Es(a[s]))return!0;return!1}const Cp=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Zh(a,t){return a<t?-1:a>t?1:0}function ou(a){if(!Array.isArray(a))return!1;if(a[0]==="within")return!0;for(let t=1;t<a.length;t++)if(ou(a[t]))return!0;return!1}function $l(a){if(!a)return!0;const t=a[0];return a.length<=1?t!=="any":t==="=="?Wl(a[1],a[2],"=="):t==="!="?Zl(Wl(a[1],a[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Wl(a[1],a[2],t):t==="any"?(s=a.slice(1),["any"].concat(s.map($l))):t==="all"?["all"].concat(a.slice(1).map($l)):t==="none"?["all"].concat(a.slice(1).map($l).map(Zl)):t==="in"?Hh(a[1],a.slice(2)):t==="!in"?Zl(Hh(a[1],a.slice(2))):t==="has"?Xh(a[1]):t==="!has"?Zl(Xh(a[1])):t!=="within"||a;var s}function Wl(a,t,s){switch(a){case"$type":return[`filter-type-${s}`,t];case"$id":return[`filter-id-${s}`,t];default:return[`filter-${s}`,a,t]}}function Hh(a,t){if(t.length===0)return!1;switch(a){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(s=>typeof s!=typeof t[0])?["filter-in-large",a,["literal",t.sort(Zh)]]:["filter-in-small",a,["literal",t]]}}function Xh(a){switch(a){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",a]}}function Zl(a){return["!",a]}function bs(a){return ws(lt(a.value))?zo(Ze({},a,{expressionContext:"filter",valueSpec:a.styleSpec[`filter_${a.layerType||"fill"}`]})):qh(a)}function qh(a){const t=a.value,s=a.key;if(xr(t)!=="array")return[new St(s,t,`array expected, ${xr(t)} found`)];const c=a.styleSpec;let f,p=[];if(t.length<1)return[new St(s,t,"filter array must have at least 1 element")];switch(p=p.concat(Gl({key:`${s}[0]`,value:t[0],valueSpec:c.filter_operator,style:a.style,styleSpec:a.styleSpec})),qe(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&qe(t[1])==="$type"&&p.push(new St(s,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":t.length!==3&&p.push(new St(s,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(f=xr(t[1]),f!=="string"&&p.push(new St(`${s}[1]`,t[1],`string expected, ${f} found`)));for(let g=2;g<t.length;g++)f=xr(t[g]),qe(t[1])==="$type"?p=p.concat(Gl({key:`${s}[${g}]`,value:t[g],valueSpec:c.geometry_type,style:a.style,styleSpec:a.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&p.push(new St(`${s}[${g}]`,t[g],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let g=1;g<t.length;g++)p=p.concat(qh({key:`${s}[${g}]`,value:t[g],style:a.style,styleSpec:a.styleSpec}));break;case"has":case"!has":f=xr(t[1]),t.length!==2?p.push(new St(s,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="string"&&p.push(new St(`${s}[1]`,t[1],`string expected, ${f} found`));break;case"within":f=xr(t[1]),t.length!==2?p.push(new St(s,t,`filter array for "${t[0]}" operator must have 2 elements`)):f!=="object"&&p.push(new St(`${s}[1]`,t[1],`object expected, ${f} found`))}return p}function Kh(a,t){const s=a.key,c=a.style,f=a.styleSpec,p=a.value,g=a.objectKey,y=f[`${t}_${a.layerType}`];if(!y)return[];const T=g.match(/^(.*)-transition$/);if(t==="paint"&&T&&y[T[1]]&&y[T[1]].transition)return En({key:s,value:p,valueSpec:f.transition,style:c,styleSpec:f});const b=a.valueSpec||y[g];if(!b)return[new St(s,p,`unknown property "${g}"`)];let C;if(xr(p)==="string"&&Lo(b)&&!b.tokens&&(C=/^{([^}]+)}$/.exec(p)))return[new St(s,p,`"${g}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(C[1])} }\`.`)];const M=[];return a.layerType==="symbol"&&(g==="text-field"&&c&&!c.glyphs&&M.push(new St(s,p,'use of "text-field" requires a style "glyphs" property')),g==="text-font"&&eo(lt(p))&&qe(p.type)==="identity"&&M.push(new St(s,p,'"text-font" does not support identity functions'))),M.concat(En({key:a.key,value:p,valueSpec:b,style:c,styleSpec:f,expressionContext:"property",propertyType:t,propertyKey:g}))}function lu(a){return Kh(a,"paint")}function Yh(a){return Kh(a,"layout")}function Ip(a){let t=[];const s=a.value,c=a.key,f=a.style,p=a.styleSpec;s.type||s.ref||t.push(new St(c,s,'either "type" or "ref" is required'));let g=qe(s.type);const y=qe(s.ref);if(s.id){const T=qe(s.id);for(let b=0;b<a.arrayIndex;b++){const C=f.layers[b];qe(C.id)===T&&t.push(new St(c,s.id,`duplicate layer id "${s.id}", previously used at line ${C.id.__line__}`))}}if("ref"in s){let T;["type","source","source-layer","filter","layout"].forEach(b=>{b in s&&t.push(new St(c,s[b],`"${b}" is prohibited for ref layers`))}),f.layers.forEach(b=>{qe(b.id)===y&&(T=b)}),T?T.ref?t.push(new St(c,s.ref,"ref cannot reference another ref layer")):g=qe(T.type):typeof y=="string"&&t.push(new St(c,s.ref,`ref layer "${y}" not found`))}else if(g!=="background"&&g!=="sky")if(s.source){const T=f.sources&&f.sources[s.source],b=T&&qe(T.type);T?b==="vector"&&g==="raster"?t.push(new St(c,s.source,`layer "${s.id}" requires a raster source`)):b==="raster"&&g!=="raster"?t.push(new St(c,s.source,`layer "${s.id}" requires a vector source`)):b!=="vector"||s["source-layer"]?b==="raster-dem"&&g!=="hillshade"?t.push(new St(c,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):g!=="line"||!s.paint||!s.paint["line-gradient"]||b==="geojson"&&T.lineMetrics||t.push(new St(c,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new St(c,s,`layer "${s.id}" must specify a "source-layer"`)):t.push(new St(c,s.source,`source "${s.source}" not found`))}else t.push(new St(c,s,'missing required property "source"'));return t=t.concat(Hi({key:c,value:s,valueSpec:p.layer,style:a.style,styleSpec:a.styleSpec,objectElementValidators:{"*":()=>[],type:()=>En({key:`${c}.type`,value:s.type,valueSpec:p.layer.type,style:a.style,styleSpec:a.styleSpec,object:s,objectKey:"type"}),filter:T=>bs(Ze({layerType:g},T)),layout:T=>Hi({layer:s,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":b=>Yh(Ze({layerType:g},b))}}),paint:T=>Hi({layer:s,key:T.key,value:T.value,valueSpec:{},style:T.style,styleSpec:T.styleSpec,objectElementValidators:{"*":b=>lu(Ze({layerType:g},b))}})}})),t}function Ya(a){const t=a.value,s=a.key,c=xr(t);return c!=="string"?[new St(s,t,`string expected, ${c} found`)]:[]}const Mp={promoteId:function({key:a,value:t}){if(xr(t)==="string")return Ya({key:a,value:t});{const s=[];for(const c in t)s.push(...Ya({key:`${a}.${c}`,value:t[c]}));return s}}};function Dp(a){const t=a.value,s=a.key,c=a.styleSpec,f=a.style;if(!t.type)return[new St(s,t,'"type" is required')];const p=qe(t.type);let g;switch(p){case"vector":case"raster":case"raster-dem":return g=Hi({key:s,value:t,valueSpec:c[`source_${p.replace("-","_")}`],style:a.style,styleSpec:c,objectElementValidators:Mp}),g;case"geojson":if(g=Hi({key:s,value:t,valueSpec:c.source_geojson,style:f,styleSpec:c,objectElementValidators:Mp}),t.cluster)for(const y in t.clusterProperties){const[T,b]=t.clusterProperties[y],C=typeof T=="string"?[T,["accumulated"],["get",y]]:T;g.push(...zo({key:`${s}.${y}.map`,value:b,expressionContext:"cluster-map"})),g.push(...zo({key:`${s}.${y}.reduce`,value:C,expressionContext:"cluster-reduce"}))}return g;case"video":return Hi({key:s,value:t,valueSpec:c.source_video,style:f,styleSpec:c});case"image":return Hi({key:s,value:t,valueSpec:c.source_image,style:f,styleSpec:c});case"canvas":return[new St(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Gl({key:`${s}.type`,value:t.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:f,styleSpec:c})}}function Fp(a){const t=a.value,s=a.styleSpec,c=s.light,f=a.style;let p=[];const g=xr(t);if(t===void 0)return p;if(g!=="object")return p=p.concat([new St("light",t,`object expected, ${g} found`)]),p;for(const y in t){const T=y.match(/^(.*)-transition$/);p=p.concat(T&&c[T[1]]&&c[T[1]].transition?En({key:y,value:t[y],valueSpec:s.transition,style:f,styleSpec:s}):c[y]?En({key:y,value:t[y],valueSpec:c[y],style:f,styleSpec:s}):[new St(y,t[y],`unknown property "${y}"`)])}return p}function Pp(a){const t=a.value,s=a.key,c=a.style,f=a.styleSpec,p=f.terrain;let g=[];const y=xr(t);if(t===void 0)return g;if(y!=="object")return g=g.concat([new St("terrain",t,`object expected, ${y} found`)]),g;for(const T in t){const b=T.match(/^(.*)-transition$/);g=g.concat(b&&p[b[1]]&&p[b[1]].transition?En({key:T,value:t[T],valueSpec:f.transition,style:c,styleSpec:f}):p[T]?En({key:T,value:t[T],valueSpec:p[T],style:c,styleSpec:f}):[new St(T,t[T],`unknown property "${T}"`)])}if(t.source){const T=c.sources&&c.sources[t.source],b=T&&qe(T.type);T?b!=="raster-dem"&&g.push(new St(s,t.source,`terrain cannot be used with a source of type ${String(b)}, it only be used with a "raster-dem" source type`)):g.push(new St(s,t.source,`source "${t.source}" not found`))}else g.push(new St(s,t,'terrain is missing required property "source"'));return g}function Lp(a){const t=a.value,s=a.style,c=a.styleSpec,f=c.fog;let p=[];const g=xr(t);if(t===void 0)return p;if(g!=="object")return p=p.concat([new St("fog",t,`object expected, ${g} found`)]),p;for(const y in t){const T=y.match(/^(.*)-transition$/);p=p.concat(T&&f[T[1]]&&f[T[1]].transition?En({key:y,value:t[y],valueSpec:c.transition,style:s,styleSpec:c}):f[y]?En({key:y,value:t[y],valueSpec:f[y],style:s,styleSpec:c}):[new St(y,t[y],`unknown property "${y}"`)])}return p}const Hl={"*":()=>[],array:jl,boolean:function(a){const t=a.value,s=a.key,c=xr(t);return c!=="boolean"?[new St(s,t,`boolean expected, ${c} found`)]:[]},number:Sp,color:function(a){const t=a.key,s=a.value,c=xr(s);return c!=="string"?[new St(t,s,`color expected, ${c} found`)]:bh.parseCSSColor(s)===null?[new St(t,s,`color expected, "${s}" found`)]:[]},enum:Gl,filter:bs,function:kp,layer:Ip,object:Hi,source:Dp,light:Fp,terrain:Pp,fog:Lp,string:Ya,formatted:function(a){return Ya(a).length===0?[]:zo(a)},resolvedImage:function(a){return Ya(a).length===0?[]:zo(a)},projection:function(a){const t=a.value,s=a.styleSpec,c=s.projection,f=a.style;let p=[];const g=xr(t);if(g==="object")for(const y in t)p=p.concat(En({key:y,value:t[y],valueSpec:c[y],style:f,styleSpec:s}));else g!=="string"&&(p=p.concat([new St("projection",t,`object or string expected, ${g} found`)]));return p}};function En(a){const t=a.value,s=a.valueSpec,c=a.styleSpec;return s.expression&&eo(qe(t))?kp(a):s.expression&&Ro(lt(t))?zo(a):s.type&&Hl[s.type]?Hl[s.type](a):Hi(Ze({},a,{valueSpec:s.type?c[s.type]:s}))}function Ii(a){const t=a.value,s=a.key,c=Ya(a);return c.length||(t.indexOf("{fontstack}")===-1&&c.push(new St(s,t,'"glyphs" url must include a "{fontstack}" token')),t.indexOf("{range}")===-1&&c.push(new St(s,t,'"glyphs" url must include a "{range}" token'))),c}function Xl(a,t=le){return Ja(En({key:"",value:a,valueSpec:t.$root,styleSpec:t,style:a,objectElementValidators:{glyphs:Ii,"*":()=>[]}}))}const B_=a=>Ja(lu(a)),N_=a=>Ja(Yh(a));function Ja(a){return a.slice().sort((t,s)=>t.line&&s.line?t.line-s.line:0)}function Rp(a,t){let s=!1;if(t&&t.length)for(const c of t)a.fire(new Ne(new Error(c.message))),s=!0;return s}var Ss=Ia;function Ia(a,t,s){var c=this.cells=[];if(a instanceof ArrayBuffer){this.arrayBuffer=a;var f=new Int32Array(this.arrayBuffer);a=f[0],this.d=(t=f[1])+2*(s=f[2]);for(var p=0;p<this.d*this.d;p++){var g=f[3+p],y=f[3+p+1];c.push(g===y?null:f.subarray(g,y))}var T=f[3+c.length+1];this.keys=f.subarray(f[3+c.length],T),this.bboxes=f.subarray(T),this.insert=this._insertReadonly}else{this.d=t+2*s;for(var b=0;b<this.d*this.d;b++)c.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=a,this.padding=s,this.scale=t/a,this.uid=0;var C=s/t*a;this.min=-C,this.max=a+C}Ia.prototype.insert=function(a,t,s,c,f){this._forEachCell(t,s,c,f,this._insertCell,this.uid++),this.keys.push(a),this.bboxes.push(t),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(f)},Ia.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ia.prototype._insertCell=function(a,t,s,c,f,p){this.cells[f].push(p)},Ia.prototype.query=function(a,t,s,c,f){var p=this.min,g=this.max;if(a<=p&&t<=p&&g<=s&&g<=c&&!f)return Array.prototype.slice.call(this.keys);var y=[];return this._forEachCell(a,t,s,c,this._queryCell,y,{},f),y},Ia.prototype._queryCell=function(a,t,s,c,f,p,g,y){var T=this.cells[f];if(T!==null)for(var b=this.keys,C=this.bboxes,M=0;M<T.length;M++){var P=T[M];if(g[P]===void 0){var N=4*P;(y?y(C[N+0],C[N+1],C[N+2],C[N+3]):a<=C[N+2]&&t<=C[N+3]&&s>=C[N+0]&&c>=C[N+1])?(g[P]=!0,p.push(b[P])):g[P]=!1}}},Ia.prototype._forEachCell=function(a,t,s,c,f,p,g,y){for(var T=this._convertToCellCoord(a),b=this._convertToCellCoord(t),C=this._convertToCellCoord(s),M=this._convertToCellCoord(c),P=T;P<=C;P++)for(var N=b;N<=M;N++){var Z=this.d*N+P;if((!y||y(this._convertFromCellCoord(P),this._convertFromCellCoord(N),this._convertFromCellCoord(P+1),this._convertFromCellCoord(N+1)))&&f.call(this,a,t,s,c,Z,p,g,y))return}},Ia.prototype._convertFromCellCoord=function(a){return(a-this.padding)/this.scale},Ia.prototype._convertToCellCoord=function(a){return Math.max(0,Math.min(this.d-1,Math.floor(a*this.scale)+this.padding))},Ia.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var a=this.cells,t=3+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var f=new Int32Array(t+s+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var p=t,g=0;g<a.length;g++){var y=a[g];f[3+g]=p,f.set(y,p),p+=y.length}return f[3+a.length]=p,f.set(this.keys,p),f[3+a.length+1]=p+=this.keys.length,f.set(this.bboxes,p),p+=this.bboxes.length,f.buffer};const Oo={};function It(a,t,s={}){Object.defineProperty(a,"_classRegistryKey",{value:t,writeable:!1}),Oo[t]={klass:a,omit:s.omit||[]}}It(Object,"Object"),Ss.serialize=function(a,t){const s=a.toArrayBuffer();return t&&t.push(s),{buffer:s}},Ss.deserialize=function(a){return new Ss(a.buffer)},Object.defineProperty(Ss,"name",{value:"Grid"}),It(Ss,"Grid"),It(pr,"Color"),It(Error,"Error"),It(j,"AJAXError"),It(ki,"ResolvedImage"),It(au,"StylePropertyFunction"),It(iu,"StyleExpression",{omit:["_evaluator"]}),It($h,"ZoomDependentExpression"),It(Gh,"ZoomConstantExpression"),It(Ai,"CompoundExpression",{omit:["_evaluate"]});for(const a in Js)Oo[Js[a]._classRegistryKey]||It(Js[a],`Expression${a}`);function zp(a){return a&&typeof ArrayBuffer!="undefined"&&(a instanceof ArrayBuffer||a.constructor&&a.constructor.name==="ArrayBuffer")}function cu(a){return B.ImageBitmap&&a instanceof B.ImageBitmap}function ql(a,t){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp)return a;if(zp(a)||cu(a))return t&&t.push(a),a;if(ArrayBuffer.isView(a)){const s=a;return t&&t.push(s.buffer),s}if(a instanceof B.ImageData)return t&&t.push(a.data.buffer),a;if(Array.isArray(a)){const s=[];for(const c of a)s.push(ql(c,t));return s}if(typeof a=="object"){const s=a.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const f=s.serialize?s.serialize(a,t):{};if(!s.serialize){for(const p in a)a.hasOwnProperty(p)&&(Oo[c].omit.indexOf(p)>=0||(f[p]=ql(a[p],t)));a instanceof Error&&(f.message=a.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof a)}function Bo(a){if(a==null||typeof a=="boolean"||typeof a=="number"||typeof a=="string"||a instanceof Boolean||a instanceof Number||a instanceof String||a instanceof Date||a instanceof RegExp||zp(a)||cu(a)||ArrayBuffer.isView(a)||a instanceof B.ImageData)return a;if(Array.isArray(a))return a.map(Bo);if(typeof a=="object"){const t=a.$name||"Object",{klass:s}=Oo[t];if(!s)throw new Error(`can't deserialize unregistered class ${t}`);if(s.deserialize)return s.deserialize(a);const c=Object.create(s.prototype);for(const f of Object.keys(a))f!=="$name"&&(c[f]=Bo(a[f]));return c}throw new Error("can't deserialize object of type "+typeof a)}class Jh{constructor(){this.first=!0}update(t,s){const c=Math.floor(t);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=t,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=s),t!==this.lastZoom&&(this.lastZoom=t,this.lastFloorZoom=c,!0))}}const Op=a=>a>=1536&&a<=1791,uu=a=>a>=1872&&a<=1919,Kl=a=>a>=2208&&a<=2303,Qh=a=>a>=11904&&a<=12031,Bp=a=>a>=12032&&a<=12255,ef=a=>a>=12272&&a<=12287,hu=a=>a>=12288&&a<=12351,Yl=a=>a>=12352&&a<=12447,fu=a=>a>=12448&&a<=12543,Np=a=>a>=12544&&a<=12591,Up=a=>a>=12704&&a<=12735,Vp=a=>a>=12736&&a<=12783,tf=a=>a>=12784&&a<=12799,jp=a=>a>=12800&&a<=13055,Gp=a=>a>=13056&&a<=13311,$p=a=>a>=13312&&a<=19903,rf=a=>a>=19968&&a<=40959,Wp=a=>a>=40960&&a<=42127,Zp=a=>a>=42128&&a<=42191,Hp=a=>a>=44032&&a<=55215,Jl=a=>a>=63744&&a<=64255,nf=a=>a>=64336&&a<=65023,Xp=a=>a>=65040&&a<=65055,No=a=>a>=65072&&a<=65103,qp=a=>a>=65104&&a<=65135,du=a=>a>=65136&&a<=65279,af=a=>a>=65280&&a<=65519;function pu(a){for(const t of a)if(mu(t.charCodeAt(0)))return!0;return!1}function Kp(a){for(const t of a)if(!Yp(t.charCodeAt(0)))return!1;return!0}function Yp(a){return!(Op(a)||uu(a)||Kl(a)||nf(a)||du(a))}function mu(a){return!(a!==746&&a!==747&&(a<4352||!(Up(a)||Np(a)||No(a)&&!(a>=65097&&a<=65103)||Jl(a)||Gp(a)||Qh(a)||Vp(a)||!(!hu(a)||a>=12296&&a<=12305||a>=12308&&a<=12319||a===12336)||$p(a)||rf(a)||jp(a)||(t=>t>=12592&&t<=12687)(a)||(t=>t>=43360&&t<=43391)(a)||(t=>t>=55216&&t<=55295)(a)||(t=>t>=4352&&t<=4607)(a)||Hp(a)||Yl(a)||ef(a)||(t=>t>=12688&&t<=12703)(a)||Bp(a)||tf(a)||fu(a)&&a!==12540||!(!af(a)||a===65288||a===65289||a===65293||a>=65306&&a<=65310||a===65339||a===65341||a===65343||a>=65371&&a<=65503||a===65507||a>=65512&&a<=65519)||!(!qp(a)||a>=65112&&a<=65118||a>=65123&&a<=65126)||(t=>t>=5120&&t<=5759)(a)||(t=>t>=6320&&t<=6399)(a)||Xp(a)||(t=>t>=19904&&t<=19967)(a)||Wp(a)||Zp(a))))}function _u(a){return!(mu(a)||function(t){return!!((s=>s>=128&&s<=255)(t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||(s=>s>=8192&&s<=8303)(t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||(s=>s>=8448&&s<=8527)(t)||(s=>s>=8528&&s<=8591)(t)||(s=>s>=8960&&s<=9215)(t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||(s=>s>=9216&&s<=9279)(t)&&t!==9251||(s=>s>=9280&&s<=9311)(t)||(s=>s>=9312&&s<=9471)(t)||(s=>s>=9632&&s<=9727)(t)||(s=>s>=9728&&s<=9983)(t)&&!(t>=9754&&t<=9759)||(s=>s>=11008&&s<=11263)(t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||hu(t)||fu(t)||(s=>s>=57344&&s<=63743)(t)||No(t)||qp(t)||af(t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(a))}function gu(a){return a>=1424&&a<=2303||nf(a)||du(a)}function U_(a,t){return!(!t&&gu(a)||a>=2304&&a<=3583||a>=3840&&a<=4255||(s=>s>=6016&&s<=6143)(a))}function V_(a){for(const t of a)if(gu(t.charCodeAt(0)))return!0;return!1}const sf="deferred",Ql="loading",of="loaded";let lf=null,si="unavailable",Mi=null;const ec=function(a){a&&typeof a=="string"&&a.indexOf("NetworkError")>-1&&(si="error"),lf&&lf(a)};function to(){cf.fire(new De("pluginStateChange",{pluginStatus:si,pluginURL:Mi}))}const cf=new Fe,xu=function(){return si},Uo=function(){if(si!==sf||!Mi)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");si=Ql,to(),Mi&&we({url:Mi},a=>{a?ec(a):(si=of,to())})},Xi={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>si===of||Xi.applyArabicShaping!=null,isLoading:()=>si===Ql,setState(a){si=a.pluginStatus,Mi=a.pluginURL},isParsed:()=>Xi.applyArabicShaping!=null&&Xi.processBidirectionalText!=null&&Xi.processStyledBidirectionalText!=null,getPluginURL:()=>Mi};class Fr{constructor(t,s){this.zoom=t,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition,this.pitch=s.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Jh,this.transition={},this.pitch=0)}isSupportedScript(t){return function(s,c){for(const f of s)if(!U_(f.charCodeAt(0),c))return!1;return!0}(t,Xi.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const t=this.zoom,s=t-Math.floor(t),c=this.crossFadingFactor();return t>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*s}}}class tc{constructor(t,s){this.property=t,this.value=s,this.expression=function(c,f){if(eo(c))return new au(c,f);if(Ro(c)){const p=bp(c,f);if(p.result==="error")throw new Error(p.value.map(g=>`${g.key}: ${g.message}`).join(", "));return p.value}{let p=c;return typeof c=="string"&&f.type==="color"&&(p=pr.parse(c)),{kind:"constant",evaluate:()=>p}}}(s===void 0?t.specification.default:s,t.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,s,c){return this.property.possiblyEvaluate(this,t,s,c)}}class Vo{constructor(t){this.property=t,this.value=new tc(t,void 0)}transitioned(t,s){return new i(this.property,this.value,s,$e({},t.transition,this.transition),t.now)}untransitioned(){return new i(this.property,this.value,null,{},0)}}class d{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues)}getValue(t){return Dt(this._values[t].value.value)}setValue(t,s){this._values.hasOwnProperty(t)||(this._values[t]=new Vo(this._values[t].property)),this._values[t].value=new tc(this._values[t].property,s===null?void 0:Dt(s))}getTransition(t){return Dt(this._values[t].transition)}setTransition(t,s){this._values.hasOwnProperty(t)||(this._values[t]=new Vo(this._values[t].property)),this._values[t].transition=Dt(s)||void 0}serialize(){const t={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(t[s]=c);const f=this.getTransition(s);f!==void 0&&(t[`${s}-transition`]=f)}return t}transitioned(t,s){const c=new h(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(t,s._values[f]);return c}untransitioned(){const t=new h(this._properties);for(const s of Object.keys(this._values))t._values[s]=this._values[s].untransitioned();return t}}class i{constructor(t,s,c,f,p){const g=f.delay||0,y=f.duration||0;p=p||0,this.property=t,this.value=s,this.begin=p+g,this.end=this.begin+y,t.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(t,s,c){const f=t.now||0,p=this.value.possiblyEvaluate(t,s,c),g=this.prior;if(g){if(f>this.end)return this.prior=null,p;if(this.value.isDataDriven())return this.prior=null,p;if(f<this.begin)return g.possiblyEvaluate(t,s,c);{const y=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,s,c),p,G(y))}}return p}}class h{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,s,c){const f=new w(this._properties);for(const p of Object.keys(this._values))f._values[p]=this._values[p].possiblyEvaluate(t,s,c);return f}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class _{constructor(t){this._properties=t,this._values=Object.create(t.defaultPropertyValues)}getValue(t){return Dt(this._values[t].value)}setValue(t,s){this._values[t]=new tc(this._values[t].property,s===null?void 0:Dt(s))}serialize(){const t={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(t[s]=c)}return t}possiblyEvaluate(t,s,c){const f=new w(this._properties);for(const p of Object.keys(this._values))f._values[p]=this._values[p].possiblyEvaluate(t,s,c);return f}}class v{constructor(t,s,c){this.property=t,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,s,c,f){return this.property.evaluate(this.value,this.parameters,t,s,c,f)}}class w{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class E{constructor(t){this.specification=t}possiblyEvaluate(t,s){return t.expression.evaluate(s)}interpolate(t,s,c){const f=Xc[this.specification.type];return f?f(t,s,c):t}}class k{constructor(t,s){this.specification=t,this.overrides=s}possiblyEvaluate(t,s,c,f){return new v(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(s,null,{},c,f)}:t.expression,s)}interpolate(t,s,c){if(t.value.kind!=="constant"||s.value.kind!=="constant")return t;if(t.value.value===void 0||s.value.value===void 0)return new v(this,{kind:"constant",value:void 0},t.parameters);const f=Xc[this.specification.type];return f?new v(this,{kind:"constant",value:f(t.value.value,s.value.value,c)},t.parameters):t}evaluate(t,s,c,f,p,g){return t.kind==="constant"?t.value:t.evaluate(s,c,f,p,g)}}class F extends k{possiblyEvaluate(t,s,c,f){if(t.value===void 0)return new v(this,{kind:"constant",value:void 0},s);if(t.expression.kind==="constant"){const p=t.expression.evaluate(s,null,{},c,f),g=t.property.specification.type==="resolvedImage"&&typeof p!="string"?p.name:p,y=this._calculate(g,g,g,s);return new v(this,{kind:"constant",value:y},s)}if(t.expression.kind==="camera"){const p=this._calculate(t.expression.evaluate({zoom:s.zoom-1}),t.expression.evaluate({zoom:s.zoom}),t.expression.evaluate({zoom:s.zoom+1}),s);return new v(this,{kind:"constant",value:p},s)}return new v(this,t.expression,s)}evaluate(t,s,c,f,p,g){if(t.kind==="source"){const y=t.evaluate(s,c,f,p,g);return this._calculate(y,y,y,s)}return t.kind==="composite"?this._calculate(t.evaluate({zoom:Math.floor(s.zoom)-1},c,f),t.evaluate({zoom:Math.floor(s.zoom)},c,f),t.evaluate({zoom:Math.floor(s.zoom)+1},c,f),s):t.value}_calculate(t,s,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:s,other:c}:{from:c,to:s,other:t}}interpolate(t){return t}}class R{constructor(t){this.specification=t}possiblyEvaluate(t,s,c,f){if(t.value!==void 0){if(t.expression.kind==="constant"){const p=t.expression.evaluate(s,null,{},c,f);return this._calculate(p,p,p,s)}return this._calculate(t.expression.evaluate(new Fr(Math.floor(s.zoom-1),s)),t.expression.evaluate(new Fr(Math.floor(s.zoom),s)),t.expression.evaluate(new Fr(Math.floor(s.zoom+1),s)),s)}}_calculate(t,s,c,f){return f.zoom>f.zoomHistory.lastIntegerZoom?{from:t,to:s}:{from:c,to:s}}interpolate(t){return t}}class O{constructor(t){this.specification=t}possiblyEvaluate(t,s,c,f){return!!t.expression.evaluate(s,null,{},c,f)}interpolate(){return!1}}class W{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in t){const c=t[s];c.specification.overridable&&this.overridableProperties.push(s);const f=this.defaultPropertyValues[s]=new tc(c,void 0),p=this.defaultTransitionablePropertyValues[s]=new Vo(c);this.defaultTransitioningPropertyValues[s]=p.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=f.possiblyEvaluate({})}}}function te(a,t){return 256*(a=ge(Math.floor(a),0,255))+ge(Math.floor(t),0,255)}It(k,"DataDrivenProperty"),It(E,"DataConstantProperty"),It(F,"CrossFadedDataDrivenProperty"),It(R,"CrossFadedProperty"),It(O,"ColorRampProperty");const oe={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ie{constructor(t,s){this._structArray=t,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Q{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,s){return t._trim(),s&&(t.isTransferred=!0,s.push(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const s=Object.create(this.prototype);return s.arrayBuffer=t.arrayBuffer,s.length=t.length,s.capacity=t.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ye(a,t=1){let s=0,c=0;return{members:a.map(f=>{const p=oe[f.type].BYTES_PER_ELEMENT,g=s=he(s,Math.max(t,p)),y=f.components||1;return c=Math.max(c,p),s+=p*y,{name:f.name,type:f.type,components:y,offset:g}}),size:he(s,Math.max(c,t)),alignment:t}}function he(a,t){return Math.ceil(a/t)*t}class _e extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,s)}emplace(t,s,c){const f=2*t;return this.int16[f+0]=s,this.int16[f+1]=c,t}}_e.prototype.bytesPerElement=4,It(_e,"StructArrayLayout2i4");class xe extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,s,c)}emplace(t,s,c,f){const p=3*t;return this.int16[p+0]=s,this.int16[p+1]=c,this.int16[p+2]=f,t}}xe.prototype.bytesPerElement=6,It(xe,"StructArrayLayout3i6");class Te extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,t,s,c,f)}emplace(t,s,c,f,p){const g=4*t;return this.int16[g+0]=s,this.int16[g+1]=c,this.int16[g+2]=f,this.int16[g+3]=p,t}}Te.prototype.bytesPerElement=8,It(Te,"StructArrayLayout4i8");class pe extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,s,c,f,p,g,y)}emplace(t,s,c,f,p,g,y,T){const b=6*t,C=12*t,M=3*t;return this.int16[b+0]=s,this.int16[b+1]=c,this.uint8[C+4]=f,this.uint8[C+5]=p,this.uint8[C+6]=g,this.uint8[C+7]=y,this.float32[M+2]=T,t}}pe.prototype.bytesPerElement=12,It(pe,"StructArrayLayout2i4ub1f12");class Se extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,t,s,c,f)}emplace(t,s,c,f,p){const g=4*t;return this.float32[g+0]=s,this.float32[g+1]=c,this.float32[g+2]=f,this.float32[g+3]=p,t}}Se.prototype.bytesPerElement=16,It(Se,"StructArrayLayout4f16");class je extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y,T,b,C){const M=this.length;return this.resize(M+1),this.emplace(M,t,s,c,f,p,g,y,T,b,C)}emplace(t,s,c,f,p,g,y,T,b,C,M){const P=10*t;return this.uint16[P+0]=s,this.uint16[P+1]=c,this.uint16[P+2]=f,this.uint16[P+3]=p,this.uint16[P+4]=g,this.uint16[P+5]=y,this.uint16[P+6]=T,this.uint16[P+7]=b,this.uint16[P+8]=C,this.uint16[P+9]=M,t}}je.prototype.bytesPerElement=20,It(je,"StructArrayLayout10ui20");class Ye extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y,T){const b=this.length;return this.resize(b+1),this.emplace(b,t,s,c,f,p,g,y,T)}emplace(t,s,c,f,p,g,y,T,b){const C=8*t;return this.uint16[C+0]=s,this.uint16[C+1]=c,this.uint16[C+2]=f,this.uint16[C+3]=p,this.uint16[C+4]=g,this.uint16[C+5]=y,this.uint16[C+6]=T,this.uint16[C+7]=b,t}}Ye.prototype.bytesPerElement=16,It(Ye,"StructArrayLayout8ui16");class tt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g){const y=this.length;return this.resize(y+1),this.emplace(y,t,s,c,f,p,g)}emplace(t,s,c,f,p,g,y){const T=6*t;return this.int16[T+0]=s,this.int16[T+1]=c,this.int16[T+2]=f,this.int16[T+3]=p,this.int16[T+4]=g,this.int16[T+5]=y,t}}tt.prototype.bytesPerElement=12,It(tt,"StructArrayLayout6i12");class Qe extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae){const fe=this.length;return this.resize(fe+1),this.emplace(fe,t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae)}emplace(t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae,fe){const be=16*t;return this.int16[be+0]=s,this.int16[be+1]=c,this.int16[be+2]=f,this.int16[be+3]=p,this.uint16[be+4]=g,this.uint16[be+5]=y,this.uint16[be+6]=T,this.uint16[be+7]=b,this.int16[be+8]=C,this.int16[be+9]=M,this.int16[be+10]=P,this.int16[be+11]=N,this.int16[be+12]=Z,this.int16[be+13]=ee,this.int16[be+14]=ae,this.int16[be+15]=fe,t}}Qe.prototype.bytesPerElement=32,It(Qe,"StructArrayLayout4i4ui4i4i32");class mt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,s,c)}emplace(t,s,c,f){const p=3*t;return this.float32[p+0]=s,this.float32[p+1]=c,this.float32[p+2]=f,t}}mt.prototype.bytesPerElement=12,It(mt,"StructArrayLayout3f12");class Ge extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint32[1*t+0]=s,t}}Ge.prototype.bytesPerElement=4,It(Ge,"StructArrayLayout1ul4");class _t extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y,T,b,C,M,P,N){const Z=this.length;return this.resize(Z+1),this.emplace(Z,t,s,c,f,p,g,y,T,b,C,M,P,N)}emplace(t,s,c,f,p,g,y,T,b,C,M,P,N,Z){const ee=20*t,ae=10*t;return this.int16[ee+0]=s,this.int16[ee+1]=c,this.int16[ee+2]=f,this.int16[ee+3]=p,this.int16[ee+4]=g,this.float32[ae+3]=y,this.float32[ae+4]=T,this.float32[ae+5]=b,this.float32[ae+6]=C,this.int16[ee+14]=M,this.uint32[ae+8]=P,this.uint16[ee+18]=N,this.uint16[ee+19]=Z,t}}_t.prototype.bytesPerElement=40,It(_t,"StructArrayLayout5i4f1i1ul2ui40");class ht extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,s,c,f,p,g,y)}emplace(t,s,c,f,p,g,y,T){const b=8*t;return this.int16[b+0]=s,this.int16[b+1]=c,this.int16[b+2]=f,this.int16[b+4]=p,this.int16[b+5]=g,this.int16[b+6]=y,this.int16[b+7]=T,t}}ht.prototype.bytesPerElement=16,It(ht,"StructArrayLayout3i2i2i16");class Rt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,s,c,f,p)}emplace(t,s,c,f,p,g){const y=4*t,T=8*t;return this.float32[y+0]=s,this.float32[y+1]=c,this.float32[y+2]=f,this.int16[T+6]=p,this.int16[T+7]=g,t}}Rt.prototype.bytesPerElement=16,It(Rt,"StructArrayLayout2f1f2i16");class rt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,t,s,c,f)}emplace(t,s,c,f,p){const g=12*t,y=3*t;return this.uint8[g+0]=s,this.uint8[g+1]=c,this.float32[y+1]=f,this.float32[y+2]=p,t}}rt.prototype.bytesPerElement=12,It(rt,"StructArrayLayout2ub2f12");class Ft extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,t,s,c)}emplace(t,s,c,f){const p=3*t;return this.uint16[p+0]=s,this.uint16[p+1]=c,this.uint16[p+2]=f,t}}Ft.prototype.bytesPerElement=6,It(Ft,"StructArrayLayout3ui6");class $t extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae,fe,be,Me,Pe,Le){const ze=this.length;return this.resize(ze+1),this.emplace(ze,t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae,fe,be,Me,Pe,Le)}emplace(t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae,fe,be,Me,Pe,Le,ze){const Je=30*t,et=15*t,st=60*t;return this.int16[Je+0]=s,this.int16[Je+1]=c,this.int16[Je+2]=f,this.float32[et+2]=p,this.float32[et+3]=g,this.uint16[Je+8]=y,this.uint16[Je+9]=T,this.uint32[et+5]=b,this.uint32[et+6]=C,this.uint32[et+7]=M,this.uint16[Je+16]=P,this.uint16[Je+17]=N,this.uint16[Je+18]=Z,this.float32[et+10]=ee,this.float32[et+11]=ae,this.uint8[st+48]=fe,this.uint8[st+49]=be,this.uint8[st+50]=Me,this.uint32[et+13]=Pe,this.int16[Je+28]=Le,this.uint8[st+58]=ze,t}}$t.prototype.bytesPerElement=60,It($t,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Pt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae,fe,be,Me,Pe,Le,ze,Je,et,st,ot,Ke,nt,ct,vt){const ft=this.length;return this.resize(ft+1),this.emplace(ft,t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae,fe,be,Me,Pe,Le,ze,Je,et,st,ot,Ke,nt,ct,vt)}emplace(t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae,fe,be,Me,Pe,Le,ze,Je,et,st,ot,Ke,nt,ct,vt,ft){const xt=38*t,Kt=19*t;return this.int16[xt+0]=s,this.int16[xt+1]=c,this.int16[xt+2]=f,this.float32[Kt+2]=p,this.float32[Kt+3]=g,this.int16[xt+8]=y,this.int16[xt+9]=T,this.int16[xt+10]=b,this.int16[xt+11]=C,this.int16[xt+12]=M,this.int16[xt+13]=P,this.uint16[xt+14]=N,this.uint16[xt+15]=Z,this.uint16[xt+16]=ee,this.uint16[xt+17]=ae,this.uint16[xt+18]=fe,this.uint16[xt+19]=be,this.uint16[xt+20]=Me,this.uint16[xt+21]=Pe,this.uint16[xt+22]=Le,this.uint16[xt+23]=ze,this.uint16[xt+24]=Je,this.uint16[xt+25]=et,this.uint16[xt+26]=st,this.uint16[xt+27]=ot,this.uint16[xt+28]=Ke,this.uint32[Kt+15]=nt,this.float32[Kt+16]=ct,this.float32[Kt+17]=vt,this.float32[Kt+18]=ft,t}}Pt.prototype.bytesPerElement=76,It(Pt,"StructArrayLayout3i2f6i15ui1ul3f76");class Lt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.float32[1*t+0]=s,t}}Lt.prototype.bytesPerElement=4,It(Lt,"StructArrayLayout1f4");class Ht extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,s,c,f,p,g,y)}emplace(t,s,c,f,p,g,y,T){const b=7*t;return this.float32[b+0]=s,this.float32[b+1]=c,this.float32[b+2]=f,this.float32[b+3]=p,this.float32[b+4]=g,this.float32[b+5]=y,this.float32[b+6]=T,t}}Ht.prototype.bytesPerElement=28,It(Ht,"StructArrayLayout7f28");class er extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p){const g=this.length;return this.resize(g+1),this.emplace(g,t,s,c,f,p)}emplace(t,s,c,f,p,g){const y=5*t;return this.float32[y+0]=s,this.float32[y+1]=c,this.float32[y+2]=f,this.float32[y+3]=p,this.float32[y+4]=g,t}}er.prototype.bytesPerElement=20,It(er,"StructArrayLayout5f20");class jt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s,c,f){const p=this.length;return this.resize(p+1),this.emplace(p,t,s,c,f)}emplace(t,s,c,f,p){const g=6*t;return this.uint32[3*t+0]=s,this.uint16[g+2]=c,this.uint16[g+3]=f,this.uint16[g+4]=p,t}}jt.prototype.bytesPerElement=12,It(jt,"StructArrayLayout1ul3ui12");class qt extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,s)}emplace(t,s,c){const f=2*t;return this.uint16[f+0]=s,this.uint16[f+1]=c,t}}qt.prototype.bytesPerElement=4,It(qt,"StructArrayLayout2ui4");class fr extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const s=this.length;return this.resize(s+1),this.emplace(s,t)}emplace(t,s){return this.uint16[1*t+0]=s,t}}fr.prototype.bytesPerElement=2,It(fr,"StructArrayLayout1ui2");class jr extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s){const c=this.length;return this.resize(c+1),this.emplace(c,t,s)}emplace(t,s,c){const f=2*t;return this.float32[f+0]=s,this.float32[f+1]=c,t}}jr.prototype.bytesPerElement=8,It(jr,"StructArrayLayout2f8");class $n extends Q{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,s,c,f,p,g,y){const T=this.length;return this.resize(T+1),this.emplace(T,t,s,c,f,p,g,y)}emplace(t,s,c,f,p,g,y,T){const b=8*t,C=4*t;return this.int16[b+0]=s,this.int16[b+1]=c,this.int16[b+2]=f,this.int16[b+3]=p,this.int16[b+4]=g,this.int16[b+5]=y,this.float32[C+3]=T,t}}$n.prototype.bytesPerElement=16,It($n,"StructArrayLayout6i1f16");class Wn extends ie{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}}Wn.prototype.size=12;class Di extends tt{get(t){return new Wn(this,t)}}It(Di,"FillExtrusionExtArray");class ma extends ie{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ma.prototype.size=40;class Qa extends _t{get(t){return new ma(this,t)}}It(Qa,"CollisionBoxArray");class ks extends ie{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}ks.prototype.size=60;class es extends $t{get(t){return new ks(this,t)}}It(es,"PlacedSymbolArray");class $r extends ie{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(t){this._structArray.uint32[this._pos4+15]=t}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}$r.prototype.size=76;class qr extends Pt{get(t){return new $r(this,t)}}It(qr,"SymbolInstanceArray");class mr extends Lt{getoffsetX(t){return this.float32[1*t+0]}}It(mr,"GlyphOffsetArray");class sn extends xe{getx(t){return this.int16[3*t+0]}gety(t){return this.int16[3*t+1]}gettileUnitDistanceFromAnchor(t){return this.int16[3*t+2]}}It(sn,"SymbolLineVertexArray");class Fi extends ie{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Fi.prototype.size=12;class Gr extends jt{get(t){return new Fi(this,t)}}It(Gr,"FeatureIndexArray");class qi extends ie{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}qi.prototype.size=4;class rc extends qt{get(t){return new qi(this,t)}}It(rc,"FillExtrusionCentroidArray");class Pi extends ie{get a_pos_30(){return this._structArray.int16[this._pos2+0]}get a_pos_31(){return this._structArray.int16[this._pos2+1]}get a_pos_32(){return this._structArray.int16[this._pos2+2]}get a_pos_normal_30(){return this._structArray.int16[this._pos2+3]}get a_pos_normal_31(){return this._structArray.int16[this._pos2+4]}get a_pos_normal_32(){return this._structArray.int16[this._pos2+5]}get a_scale(){return this._structArray.float32[this._pos4+3]}}Pi.prototype.size=16;class ro extends $n{get(t){return new Pi(this,t)}}It(ro,"CircleGlobeExtArray");const Jp=ye([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),uf=ye([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var jo=Vc(function(a){a.exports=function(t,s){var c,f,p,g,y,T,b,C;for(f=t.length-(c=3&t.length),p=s,y=3432918353,T=461845907,C=0;C<f;)b=255&t.charCodeAt(C)|(255&t.charCodeAt(++C))<<8|(255&t.charCodeAt(++C))<<16|(255&t.charCodeAt(++C))<<24,++C,p=27492+(65535&(g=5*(65535&(p=(p^=b=(65535&(b=(b=(65535&b)*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*T+(((b>>>16)*T&65535)<<16)&4294967295)<<13|p>>>19))+((5*(p>>>16)&65535)<<16)&4294967295))+((58964+(g>>>16)&65535)<<16);switch(b=0,c){case 3:b^=(255&t.charCodeAt(C+2))<<16;case 2:b^=(255&t.charCodeAt(C+1))<<8;case 1:p^=b=(65535&(b=(b=(65535&(b^=255&t.charCodeAt(C)))*y+(((b>>>16)*y&65535)<<16)&4294967295)<<15|b>>>17))*T+(((b>>>16)*T&65535)<<16)&4294967295}return p^=t.length,p=2246822507*(65535&(p^=p>>>16))+((2246822507*(p>>>16)&65535)<<16)&4294967295,p=3266489909*(65535&(p^=p>>>13))+((3266489909*(p>>>16)&65535)<<16)&4294967295,(p^=p>>>16)>>>0}}),j_=Vc(function(a){a.exports=function(t,s){for(var c,f=t.length,p=s^f,g=0;f>=4;)c=1540483477*(65535&(c=255&t.charCodeAt(g)|(255&t.charCodeAt(++g))<<8|(255&t.charCodeAt(++g))<<16|(255&t.charCodeAt(++g))<<24))+((1540483477*(c>>>16)&65535)<<16),p=1540483477*(65535&p)+((1540483477*(p>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),f-=4,++g;switch(f){case 3:p^=(255&t.charCodeAt(g+2))<<16;case 2:p^=(255&t.charCodeAt(g+1))<<8;case 1:p=1540483477*(65535&(p^=255&t.charCodeAt(g)))+((1540483477*(p>>>16)&65535)<<16)}return p=1540483477*(65535&(p^=p>>>13))+((1540483477*(p>>>16)&65535)<<16),(p^=p>>>15)>>>0}}),As=jo,hf=j_;As.murmur3=jo,As.murmur2=hf;class Qp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(t,s,c,f){this.ids.push(ev(t)),this.positions.push(s,c,f)}getPositions(t){const s=ev(t);let c=0,f=this.ids.length-1;for(;c<f;){const g=c+f>>1;this.ids[g]>=s?f=g:c=g+1}const p=[];for(;this.ids[c]===s;)p.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return p}static serialize(t,s){const c=new Float64Array(t.ids),f=new Uint32Array(t.positions);return G_(c,f,0,c.length-1),s&&s.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(t){const s=new Qp;return s.ids=t.ids,s.positions=t.positions,s.indexed=!0,s}}function ev(a){const t=+a;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:As(String(a))}function G_(a,t,s,c){for(;s<c;){const f=a[s+c>>1];let p=s-1,g=c+1;for(;;){do p++;while(a[p]<f);do g--;while(a[g]>f);if(p>=g)break;e0(a,p,g),e0(t,3*p,3*g),e0(t,3*p+1,3*g+1),e0(t,3*p+2,3*g+2)}g-s<c-g?(G_(a,t,s,g),s=g+1):(G_(a,t,g+1,c),c=g)}}function e0(a,t,s){const c=a[t];a[t]=a[s],a[s]=c}It(Qp,"FeaturePositionMap");class no{constructor(t,s){this.gl=t.gl,this.location=s}}class t0 extends no{constructor(t,s){super(t,s),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1f(this.location,t))}}class tv extends no{constructor(t,s){super(t,s),this.current=[0,0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]&&t[3]===this.current[3]||(this.current=t,this.gl.uniform4f(this.location,t[0],t[1],t[2],t[3]))}}class rv extends no{constructor(t,s){super(t,s),this.current=pr.transparent}set(t){t.r===this.current.r&&t.g===this.current.g&&t.b===this.current.b&&t.a===this.current.a||(this.current=t,this.gl.uniform4f(this.location,t.r,t.g,t.b,t.a))}}const AA=new Float32Array(16),CA=new Float32Array(9),IA=new Float32Array(4);function $_(a){return[te(255*a.r,255*a.g),te(255*a.b,255*a.a)]}class ff{constructor(t,s,c){this.value=t,this.uniformNames=s.map(f=>`u_${f}`),this.type=c}setUniform(t,s,c){t.set(c.constantOr(this.value))}getBinding(t,s,c){return this.type==="color"?new rv(t,s):new t0(t,s)}}class yu{constructor(t,s){this.uniformNames=s.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(t,s){this.pixelRatioFrom=s.pixelRatio||1,this.pixelRatioTo=t.pixelRatio||1,this.patternFrom=s.tl.concat(s.br),this.patternTo=t.tl.concat(t.br)}setUniform(t,s,c,f){const p=f==="u_pattern_to"||f==="u_dash_to"?this.patternTo:f==="u_pattern_from"||f==="u_dash_from"?this.patternFrom:f==="u_pixel_ratio_to"?this.pixelRatioTo:f==="u_pixel_ratio_from"?this.pixelRatioFrom:null;p&&t.set(p)}getBinding(t,s,c){return c==="u_pattern_from"||c==="u_pattern_to"||c==="u_dash_from"||c==="u_dash_to"?new tv(t,s):new t0(t,s)}}class io{constructor(t,s,c,f){this.expression=t,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(p=>({name:`a_${p}`,type:"Float32",components:c==="color"?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(t,s,c,f,p,g){const y=this.paintVertexArray.length,T=this.expression.evaluate(new Fr(0),s,{},p,f,g);this.paintVertexArray.resize(t),this._setPaintValue(y,t,T)}updatePaintArray(t,s,c,f,p){const g=this.expression.evaluate({zoom:0},c,f,void 0,p);this._setPaintValue(t,s,g)}_setPaintValue(t,s,c){if(this.type==="color"){const f=$_(c);for(let p=t;p<s;p++)this.paintVertexArray.emplace(p,f[0],f[1])}else{for(let f=t;f<s;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ts{constructor(t,s,c,f,p,g){this.expression=t,this.uniformNames=s.map(y=>`u_${y}_t`),this.type=c,this.useIntegerZoom=f,this.zoom=p,this.maxValue=0,this.paintVertexAttributes=s.map(y=>({name:`a_${y}`,type:"Float32",components:c==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,s,c,f,p,g){const y=this.expression.evaluate(new Fr(this.zoom),s,{},p,f,g),T=this.expression.evaluate(new Fr(this.zoom+1),s,{},p,f,g),b=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(b,t,y,T)}updatePaintArray(t,s,c,f,p){const g=this.expression.evaluate({zoom:this.zoom},c,f,void 0,p),y=this.expression.evaluate({zoom:this.zoom+1},c,f,void 0,p);this._setPaintValue(t,s,g,y)}_setPaintValue(t,s,c,f){if(this.type==="color"){const p=$_(c),g=$_(f);for(let y=t;y<s;y++)this.paintVertexArray.emplace(y,p[0],p[1],g[0],g[1])}else{for(let p=t;p<s;p++)this.paintVertexArray.emplace(p,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,s){const c=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,f=ge(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);t.set(f)}getBinding(t,s,c){return new t0(t,s)}}class Go{constructor(t,s,c,f,p,g,y){this.expression=t,this.type=c,this.useIntegerZoom=f,this.zoom=p,this.layerId=y,this.paintVertexAttributes=(c==="array"?uf:Jp).members;for(let T=0;T<s.length;++T);this.zoomInPaintVertexArray=new g,this.zoomOutPaintVertexArray=new g}populatePaintArray(t,s,c){const f=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(t),this.zoomOutPaintVertexArray.resize(t),this._setPaintValues(f,t,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(t,s,c,f,p,g){this._setPaintValues(t,s,c.patterns&&c.patterns[this.layerId],g)}_setPaintValues(t,s,c,f){if(!f||!c)return;const{min:p,mid:g,max:y}=c,T=f[p],b=f[g],C=f[y];if(T&&b&&C)for(let M=t;M<s;M++)this._setPaintValue(this.zoomInPaintVertexArray,M,b,T),this._setPaintValue(this.zoomOutPaintVertexArray,M,b,C)}_setPaintValue(t,s,c,f){t.emplace(s,c.tl[0],c.tl[1],c.br[0],c.br[1],f.tl[0],f.tl[1],f.br[0],f.br[1],c.pixelRatio,f.pixelRatio)}upload(t){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=t.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=t.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class $o{constructor(t,s,c=()=>!0){this.binders={},this._buffers=[];const f=[];for(const p in t.paint._values){if(!c(p))continue;const g=t.paint.get(p);if(!(g instanceof v&&Lo(g.property.specification)))continue;const y=DA(p,t.type),T=g.value,b=g.property.specification.type,C=g.property.useIntegerZoom,M=g.property.specification["property-type"],P=M==="cross-faded"||M==="cross-faded-data-driven",N=String(p)==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(T.kind!=="constant"||N)if(T.kind==="source"||N||P){const Z=nv(p,b,"source");this.binders[p]=P?new Go(T,y,b,C,s,Z,t.id):new io(T,y,b,Z),f.push(`/a_${p}`)}else{const Z=nv(p,b,"composite");this.binders[p]=new ts(T,y,b,C,s,Z),f.push(`/z_${p}`)}else this.binders[p]=P?new yu(T.value,y):new ff(T.value,y,b),f.push(`/u_${p}`)}this.cacheKey=f.sort().join("")}getMaxValue(t){const s=this.binders[t];return s instanceof io||s instanceof ts?s.maxValue:0}populatePaintArrays(t,s,c,f,p,g){for(const y in this.binders){const T=this.binders[y];(T instanceof io||T instanceof ts||T instanceof Go)&&T.populatePaintArray(t,s,c,f,p,g)}}setConstantPatternPositions(t,s){for(const c in this.binders){const f=this.binders[c];f instanceof yu&&f.setConstantPatternPositions(t,s)}}updatePaintArrays(t,s,c,f,p,g){let y=!1;for(const T in t){const b=s.getPositions(T);for(const C of b){const M=c.feature(C.index);for(const P in this.binders){const N=this.binders[P];if((N instanceof io||N instanceof ts||N instanceof Go)&&N.expression.isStateDependent===!0){const Z=f.paint.get(P);N.expression=Z.value,N.updatePaintArray(C.start,C.end,M,t[T],p,g),y=!0}}}}return y}defines(){const t=[];for(const s in this.binders){const c=this.binders[s];(c instanceof ff||c instanceof yu)&&t.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return t}getBinderAttributes(){const t=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof io||c instanceof ts||c instanceof Go)for(let f=0;f<c.paintVertexAttributes.length;f++)t.push(c.paintVertexAttributes[f].name)}return t}getBinderUniforms(){const t=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof ff||c instanceof yu||c instanceof ts)for(const f of c.uniformNames)t.push(f)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t,s){const c=[];for(const f in this.binders){const p=this.binders[f];if(p instanceof ff||p instanceof yu||p instanceof ts){for(const g of p.uniformNames)if(s[g]){const y=p.getBinding(t,s[g],g);c.push({name:g,property:f,binding:y})}}}return c}setUniforms(t,s,c,f){for(const{name:p,property:g,binding:y}of s)this.binders[g].setUniform(y,f,c.get(g),p)}updatePaintBuffers(t){this._buffers=[];for(const s in this.binders){const c=this.binders[s];if(t&&c instanceof Go){const f=t.fromScale===2?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;f&&this._buffers.push(f)}else(c instanceof io||c instanceof ts)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(t){for(const s in this.binders){const c=this.binders[s];(c instanceof io||c instanceof ts||c instanceof Go)&&c.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const s=this.binders[t];(s instanceof io||s instanceof ts||s instanceof Go)&&s.destroy()}}}class nc{constructor(t,s,c=()=>!0){this.programConfigurations={};for(const f of t)this.programConfigurations[f.id]=new $o(f,s,c);this.needsUpload=!1,this._featureMap=new Qp,this._bufferOffset=0}populatePaintArrays(t,s,c,f,p,g,y){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(t,s,f,p,g,y);s.id!==void 0&&this._featureMap.add(s.id,c,this._bufferOffset,t),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,s,c,f,p){for(const g of c)this.needsUpload=this.programConfigurations[g.id].updatePaintArrays(t,this._featureMap,s,g,f,p)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const MA={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function DA(a,t){return MA[a]||[a.replace(`${t}-`,"").replace(/-/g,"_")]}const FA={"line-pattern":{source:je,composite:je},"fill-pattern":{source:je,composite:je},"fill-extrusion-pattern":{source:je,composite:je},"line-dasharray":{source:Ye,composite:Ye}},PA={color:{source:jr,composite:Se},number:{source:Lt,composite:jr}};function nv(a,t,s){const c=FA[a];return c&&c[s]||PA[t][s]}It(ff,"ConstantBinder"),It(yu,"CrossFadedConstantBinder"),It(io,"SourceExpressionBinder"),It(Go,"CrossFadedCompositeBinder"),It(ts,"CompositeExpressionBinder"),It($o,"ProgramConfiguration",{omit:["_buffers"]}),It(nc,"ProgramConfigurationSet");const r0="-transition";class rs extends Fe{constructor(t,s){if(super(),this.id=t.id,this.type=t.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,t.type!=="custom"&&(this.metadata=(t=t).metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type!=="background"&&t.type!=="sky"&&(this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter),s.layout&&(this._unevaluatedLayout=new _(s.layout)),s.paint)){this._transitionablePaint=new d(s.paint);for(const c in t.paint)this.setPaintProperty(c,t.paint[c],{validate:!1});for(const c in t.layout)this.setLayoutProperty(c,t.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new w(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,s,c={}){s!=null&&this._validate(N_,`layers.${this.id}.layout.${t}`,t,s,c)||(t!=="visibility"?this._unevaluatedLayout.setValue(t,s):this.visibility=s)}getPaintProperty(t){return gt(t,r0)?this._transitionablePaint.getTransition(t.slice(0,-r0.length)):this._transitionablePaint.getValue(t)}setPaintProperty(t,s,c={}){if(s!=null&&this._validate(B_,`layers.${this.id}.paint.${t}`,t,s,c))return!1;if(gt(t,r0))return this._transitionablePaint.setTransition(t.slice(0,-r0.length),s||void 0),!1;{const f=this._transitionablePaint._values[t],p=f.property.specification["property-type"]==="cross-faded-data-driven",g=f.value.isDataDriven(),y=f.value;this._transitionablePaint.setValue(t,s),this._handleSpecialPaintPropertyUpdate(t);const T=this._transitionablePaint._values[t].value;return T.isDataDriven()||g||p||this._handleOverridablePaintPropertyUpdate(t,y,T)}}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getProgramConfiguration(t){return null}_handleOverridablePaintPropertyUpdate(t,s,c){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,s){t.getCrossfadeParameters&&(this._crossfadeParameters=t.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,s)}serialize(){const t={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(t.layout=t.layout||{},t.layout.visibility=this.visibility),Tt(t,(s,c)=>!(s===void 0||c==="layout"&&!Object.keys(s).length||c==="paint"&&!Object.keys(s).length))}_validate(t,s,c,f,p={}){return(!p||p.validate!==!1)&&Rp(this,t.call(Xl,{key:s,layerType:this.type,objectKey:c,value:f,styleSpec:le,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const t in this.paint._values){const s=this.paint.get(t);if(s instanceof v&&Lo(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Ts(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const LA=ye([{name:"a_pos",components:2,type:"Int16"}],4),RA=ye([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"},{name:"a_scale",components:1,type:"Float32"}]);class Kr{constructor(t=[]){this.segments=t}prepareSegment(t,s,c,f){let p=this.segments[this.segments.length-1];return t>Kr.MAX_VERTEX_ARRAY_LENGTH&&He(`Max vertices per segment is ${Kr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!p||p.vertexLength+t>Kr.MAX_VERTEX_ARRAY_LENGTH||p.sortKey!==f)&&(p={vertexOffset:s.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},f!==void 0&&(p.sortKey=f),this.segments.push(p)),p}get(){return this.segments}destroy(){for(const t of this.segments)for(const s in t.vaos)t.vaos[s].destroy()}static simpleSegment(t,s,c,f){return new Kr([{vertexOffset:t,primitiveOffset:s,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}Kr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,It(Kr,"SegmentVector");var Jt=8192;class Wo{constructor(t,s){t&&(s?this.setSouthWest(t).setNorthEast(s):t.length===4?this.setSouthWest([t[0],t[1]]).setNorthEast([t[2],t[3]]):this.setSouthWest(t[0]).setNorthEast(t[1]))}setNorthEast(t){return this._ne=t instanceof Sr?new Sr(t.lng,t.lat):Sr.convert(t),this}setSouthWest(t){return this._sw=t instanceof Sr?new Sr(t.lng,t.lat):Sr.convert(t),this}extend(t){const s=this._sw,c=this._ne;let f,p;if(t instanceof Sr)f=t,p=t;else{if(!(t instanceof Wo))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Wo.convert(t)):this.extend(Sr.convert(t)):this;if(f=t._sw,p=t._ne,!f||!p)return this}return s||c?(s.lng=Math.min(f.lng,s.lng),s.lat=Math.min(f.lat,s.lat),c.lng=Math.max(p.lng,c.lng),c.lat=Math.max(p.lat,c.lat)):(this._sw=new Sr(f.lng,f.lat),this._ne=new Sr(p.lng,p.lat)),this}getCenter(){return new Sr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Sr(this.getWest(),this.getNorth())}getSouthEast(){return new Sr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:s,lat:c}=Sr.convert(t);let f=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(t){return!t||t instanceof Wo?t:new Wo(t)}}const W_=63710088e-1;class Sr{constructor(t,s){if(isNaN(t)||isNaN(s))throw new Error(`Invalid LngLat object: (${t}, ${s})`);if(this.lng=+t,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Sr(ke(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const s=Math.PI/180,c=this.lat*s,f=t.lat*s,p=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((t.lng-this.lng)*s);return W_*Math.acos(Math.min(p,1))}toBounds(t=0){const s=360*t/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new Wo(new Sr(this.lng-c,this.lat-s),new Sr(this.lng+c,this.lat+s))}static convert(t){if(t instanceof Sr)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new Sr(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new Sr(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const iv=2*Math.PI*W_;function Z_(a){return iv*Math.cos(a*Math.PI/180)}function df(a){return(180+a)/360}function vu(a){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+a*Math.PI/360)))/360}function wu(a,t){return a/Z_(t)}function Ma(a){return 360*a-180}function Zn(a){return 360/Math.PI*Math.atan(Math.exp((180-360*a)*Math.PI/180))-90}function av(a,t){return a*Z_(Zn(t))}const Cs=85.051129;class n0{constructor(t,s,c=0){this.x=+t,this.y=+s,this.z=+c}static fromLngLat(t,s=0){const c=Sr.convert(t);return new n0(df(c.lng),vu(c.lat),wu(s,c.lat))}toLngLat(){return new Sr(Ma(this.x),Zn(this.y))}toAltitude(){return av(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/iv*(t=Zn(this.y),1/Math.cos(t*Math.PI/180));var t}}function H_(a,t,s,c,f,p,g,y,T){const b=(t+c)/2,C=(s+f)/2,M=new D(b,C);y(M),function(P,N,Z,ee,ae,fe){const be=Z-ae,Me=ee-fe;return Math.abs((ee-N)*be-(Z-P)*Me)/Math.hypot(be,Me)}(M.x,M.y,p.x,p.y,g.x,g.y)>=T?(H_(a,t,s,b,C,p,M,y,T),H_(a,b,C,c,f,M,g,y,T)):a.push(g)}function zA(a,t,s){let c=a[0],f=c.x,p=c.y;t(c);const g=[c];for(let y=1;y<a.length;y++){const T=a[y],{x:b,y:C}=T;t(T),H_(g,f,p,b,C,c,T,t,s),f=b,p=C,c=T}return g}const X_=Math.pow(2,14)-1,sv=-X_-1;function OA(a,t){const s=Math.round(a.x*t),c=Math.round(a.y*t);return a.x=ge(s,sv,X_),a.y=ge(c,sv,X_),(s<a.x||s>a.x+1||c<a.y||c>a.y+1)&&He("Geometry exceeds allowed extent, reduce your vector tile buffer size"),a}function ao(a,t,s){const c=a.loadGeometry(),f=a.extent,p=Jt/f;if(t&&s&&s.projection.isReprojectedInTileSpace){const g=1<<t.z,{scale:y,x:T,y:b,projection:C}=s,M=P=>{const N=Ma((t.x+P.x/f)/g),Z=Zn((t.y+P.y/f)/g),ee=C.project(N,Z);P.x=(ee.x*y-T)*f,P.y=(ee.y*y-b)*f};for(let P=0;P<c.length;P++)if(a.type!==1)c[P]=zA(c[P],M,1);else{const N=[];for(const Z of c[P])Z.x<0||Z.x>=f||Z.y<0||Z.y>=f||(M(Z),N.push(Z));c[P]=N}}for(const g of c)for(const y of g)OA(y,p);return c}function ic(a,t){return{type:a.type,id:a.id,properties:a.properties,geometry:t?ao(a):[]}}function i0(a,t,s,c,f){a.emplaceBack(2*t+(c+1)/2,2*s+(f+1)/2)}function a0(a,t,s,c){a.emplaceBack(t.x,t.y,t.z,s[0]*16384,s[1]*16384,s[2]*16384,c)}class q_{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new _e,this.indexArray=new Ft,this.segments=new Kr,this.programConfigurations=new nc(t.layers,t.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,c,f){const p=this.layers[0],g=[];let y=null;p.type==="circle"&&(y=p.layout.get("circle-sort-key"));for(const{feature:b,id:C,index:M,sourceLayerIndex:P}of t){const N=this.layers[0]._featureFilter.needGeometry,Z=ic(b,N);if(!this.layers[0]._featureFilter.filter(new Fr(this.zoom),Z,c))continue;const ee=y?y.evaluate(Z,{},c):void 0,ae={id:C,properties:b.properties,type:b.type,sourceLayerIndex:P,index:M,geometry:N?Z.geometry:ao(b,c,f),patterns:{},sortKey:ee};g.push(ae)}y&&g.sort((b,C)=>b.sortKey-C.sortKey);let T=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new ro,T=f.projection);for(const b of g){const{geometry:C,index:M,sourceLayerIndex:P}=b,N=t[M].feature;this.addFeature(b,C,M,s.availableImages,c,T),s.featureIndex.insert(N,C,M,P,this.index)}}update(t,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,LA.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,RA.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,s,c,f,p,g){for(const y of s)for(const T of y){const b=T.x,C=T.y;if(b<0||b>=Jt||C<0||C>=Jt)continue;if(g){const N=g.projectTilePoint(b,C,p),Z=g.upVector(p,b,C),ee=Zn((C/Jt+p.y)/(1<<p.z)),ae=g.pixelsPerMeter(ee,1)/wu(1,ee),fe=this.globeExtVertexArray;a0(fe,N,Z,ae),a0(fe,N,Z,ae),a0(fe,N,Z,ae),a0(fe,N,Z,ae)}const M=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),P=M.vertexLength;i0(this.layoutVertexArray,b,C,-1,-1),i0(this.layoutVertexArray,b,C,1,-1),i0(this.layoutVertexArray,b,C,1,1),i0(this.layoutVertexArray,b,C,-1,1),this.indexArray.emplaceBack(P,P+1,P+2),this.indexArray.emplaceBack(P,P+3,P+2),M.vertexLength+=4,M.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,{},f,p)}}function ov(a,t){for(let s=0;s<a.length;s++)if(Tu(t,a[s]))return!0;for(let s=0;s<t.length;s++)if(Tu(a,t[s]))return!0;return!!K_(a,t)}function BA(a,t,s){return!!Tu(a,t)||!!Y_(t,a,s)}function lv(a,t){if(a.length===1)return uv(t,a[0]);for(let s=0;s<t.length;s++){const c=t[s];for(let f=0;f<c.length;f++)if(Tu(a,c[f]))return!0}for(let s=0;s<a.length;s++)if(uv(t,a[s]))return!0;for(let s=0;s<t.length;s++)if(K_(a,t[s]))return!0;return!1}function NA(a,t,s){if(a.length>1){if(K_(a,t))return!0;for(let c=0;c<t.length;c++)if(Y_(t[c],a,s))return!0}for(let c=0;c<a.length;c++)if(Y_(a[c],t,s))return!0;return!1}function K_(a,t){if(a.length===0||t.length===0)return!1;for(let s=0;s<a.length-1;s++){const c=a[s],f=a[s+1];for(let p=0;p<t.length-1;p++)if(UA(c,f,t[p],t[p+1]))return!0}return!1}function UA(a,t,s,c){return Re(a,s,c)!==Re(t,s,c)&&Re(a,t,s)!==Re(a,t,c)}function Y_(a,t,s){const c=s*s;if(t.length===1)return a.distSqr(t[0])<c;for(let f=1;f<t.length;f++)if(cv(a,t[f-1],t[f])<c)return!0;return!1}function cv(a,t,s){const c=t.distSqr(s);if(c===0)return a.distSqr(t);const f=((a.x-t.x)*(s.x-t.x)+(a.y-t.y)*(s.y-t.y))/c;return a.distSqr(f<0?t:f>1?s:s.sub(t)._mult(f)._add(t))}function uv(a,t){let s,c,f,p=!1;for(let g=0;g<a.length;g++){s=a[g];for(let y=0,T=s.length-1;y<s.length;T=y++)c=s[y],f=s[T],c.y>t.y!=f.y>t.y&&t.x<(f.x-c.x)*(t.y-c.y)/(f.y-c.y)+c.x&&(p=!p)}return p}function Tu(a,t){let s=!1;for(let c=0,f=a.length-1;c<a.length;f=c++){const p=a[c],g=a[f];p.y>t.y!=g.y>t.y&&t.x<(g.x-p.x)*(t.y-p.y)/(g.y-p.y)+p.x&&(s=!s)}return s}function hv(a,t,s,c,f){for(const g of a)if(t<=g.x&&s<=g.y&&c>=g.x&&f>=g.y)return!0;const p=[new D(t,s),new D(t,f),new D(c,f),new D(c,s)];if(a.length>2){for(const g of p)if(Tu(a,g))return!0}for(let g=0;g<a.length-1;g++)if(VA(a[g],a[g+1],p))return!0;return!1}function VA(a,t,s){const c=s[0],f=s[2];if(a.x<c.x&&t.x<c.x||a.x>f.x&&t.x>f.x||a.y<c.y&&t.y<c.y||a.y>f.y&&t.y>f.y)return!1;const p=Re(a,t,s[0]);return p!==Re(a,t,s[1])||p!==Re(a,t,s[2])||p!==Re(a,t,s[3])}function Eu(a,t,s){const c=t.paint.get(a).value;return c.kind==="constant"?c.value:s.programConfigurations.get(t.id).getMaxValue(a)}function s0(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])}function fv(a,t,s,c,f){if(!t[0]&&!t[1])return a;const p=D.convert(t)._mult(f);s==="viewport"&&p._rotate(-c);const g=[];for(let y=0;y<a.length;y++)g.push(a[y].sub(p));return g}function dv(a,t,s,c){const f=D.convert(a)._mult(c);return t==="viewport"&&f._rotate(-s),f}It(q_,"CircleBucket",{omit:["layers"]});const jA=new W({"circle-sort-key":new k(le.layout_circle["circle-sort-key"])});var GA={paint:new W({"circle-radius":new k(le.paint_circle["circle-radius"]),"circle-color":new k(le.paint_circle["circle-color"]),"circle-blur":new k(le.paint_circle["circle-blur"]),"circle-opacity":new k(le.paint_circle["circle-opacity"]),"circle-translate":new E(le.paint_circle["circle-translate"]),"circle-translate-anchor":new E(le.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new E(le.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new E(le.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new k(le.paint_circle["circle-stroke-width"]),"circle-stroke-color":new k(le.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new k(le.paint_circle["circle-stroke-opacity"])}),layout:jA},J_=1e-6,Ki=typeof Float32Array!="undefined"?Float32Array:Array;function pv(){var a=new Ki(9);return Ki!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function Is(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a}function Q_(a,t,s){var c=t[0],f=t[1],p=t[2],g=t[3],y=t[4],T=t[5],b=t[6],C=t[7],M=t[8],P=t[9],N=t[10],Z=t[11],ee=t[12],ae=t[13],fe=t[14],be=t[15],Me=s[0],Pe=s[1],Le=s[2],ze=s[3];return a[0]=Me*c+Pe*y+Le*M+ze*ee,a[1]=Me*f+Pe*T+Le*P+ze*ae,a[2]=Me*p+Pe*b+Le*N+ze*fe,a[3]=Me*g+Pe*C+Le*Z+ze*be,a[4]=(Me=s[4])*c+(Pe=s[5])*y+(Le=s[6])*M+(ze=s[7])*ee,a[5]=Me*f+Pe*T+Le*P+ze*ae,a[6]=Me*p+Pe*b+Le*N+ze*fe,a[7]=Me*g+Pe*C+Le*Z+ze*be,a[8]=(Me=s[8])*c+(Pe=s[9])*y+(Le=s[10])*M+(ze=s[11])*ee,a[9]=Me*f+Pe*T+Le*P+ze*ae,a[10]=Me*p+Pe*b+Le*N+ze*fe,a[11]=Me*g+Pe*C+Le*Z+ze*be,a[12]=(Me=s[12])*c+(Pe=s[13])*y+(Le=s[14])*M+(ze=s[15])*ee,a[13]=Me*f+Pe*T+Le*P+ze*ae,a[14]=Me*p+Pe*b+Le*N+ze*fe,a[15]=Me*g+Pe*C+Le*Z+ze*be,a}function ac(a,t,s){var c,f,p,g,y,T,b,C,M,P,N,Z,ee=s[0],ae=s[1],fe=s[2];return t===a?(a[12]=t[0]*ee+t[4]*ae+t[8]*fe+t[12],a[13]=t[1]*ee+t[5]*ae+t[9]*fe+t[13],a[14]=t[2]*ee+t[6]*ae+t[10]*fe+t[14],a[15]=t[3]*ee+t[7]*ae+t[11]*fe+t[15]):(f=t[1],p=t[2],g=t[3],y=t[4],T=t[5],b=t[6],C=t[7],M=t[8],P=t[9],N=t[10],Z=t[11],a[0]=c=t[0],a[1]=f,a[2]=p,a[3]=g,a[4]=y,a[5]=T,a[6]=b,a[7]=C,a[8]=M,a[9]=P,a[10]=N,a[11]=Z,a[12]=c*ee+y*ae+M*fe+t[12],a[13]=f*ee+T*ae+P*fe+t[13],a[14]=p*ee+b*ae+N*fe+t[14],a[15]=g*ee+C*ae+Z*fe+t[15]),a}function Zo(a,t,s){var c=s[0],f=s[1],p=s[2];return a[0]=t[0]*c,a[1]=t[1]*c,a[2]=t[2]*c,a[3]=t[3]*c,a[4]=t[4]*f,a[5]=t[5]*f,a[6]=t[6]*f,a[7]=t[7]*f,a[8]=t[8]*p,a[9]=t[9]*p,a[10]=t[10]*p,a[11]=t[11]*p,a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15],a}function eg(a,t,s){var c=Math.sin(s),f=Math.cos(s),p=t[4],g=t[5],y=t[6],T=t[7],b=t[8],C=t[9],M=t[10],P=t[11];return t!==a&&(a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[3],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[4]=p*f+b*c,a[5]=g*f+C*c,a[6]=y*f+M*c,a[7]=T*f+P*c,a[8]=b*f-p*c,a[9]=C*f-g*c,a[10]=M*f-y*c,a[11]=P*f-T*c,a}function tg(a,t,s){var c=Math.sin(s),f=Math.cos(s),p=t[0],g=t[1],y=t[2],T=t[3],b=t[8],C=t[9],M=t[10],P=t[11];return t!==a&&(a[4]=t[4],a[5]=t[5],a[6]=t[6],a[7]=t[7],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=p*f-b*c,a[1]=g*f-C*c,a[2]=y*f-M*c,a[3]=T*f-P*c,a[8]=p*c+b*f,a[9]=g*c+C*f,a[10]=y*c+M*f,a[11]=T*c+P*f,a}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)});var $A=Q_;function rg(){var a=new Ki(3);return Ki!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function mv(a){var t=new Ki(3);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t}function _v(a){return Math.hypot(a[0],a[1],a[2])}function pf(a,t,s){var c=new Ki(3);return c[0]=a,c[1]=t,c[2]=s,c}function gv(a,t,s){return a[0]=t[0]+s[0],a[1]=t[1]+s[1],a[2]=t[2]+s[2],a}function xv(a,t,s){return a[0]=t[0]-s[0],a[1]=t[1]-s[1],a[2]=t[2]-s[2],a}function yv(a,t,s){return a[0]=t[0]*s[0],a[1]=t[1]*s[1],a[2]=t[2]*s[2],a}function ng(a,t,s){return a[0]=Math.min(t[0],s[0]),a[1]=Math.min(t[1],s[1]),a[2]=Math.min(t[2],s[2]),a}function ig(a,t,s){return a[0]=Math.max(t[0],s[0]),a[1]=Math.max(t[1],s[1]),a[2]=Math.max(t[2],s[2]),a}function mf(a,t,s){return a[0]=t[0]*s,a[1]=t[1]*s,a[2]=t[2]*s,a}function ag(a,t,s,c){return a[0]=t[0]+s[0]*c,a[1]=t[1]+s[1]*c,a[2]=t[2]+s[2]*c,a}function _f(a,t){var s=t[0],c=t[1],f=t[2],p=s*s+c*c+f*f;return p>0&&(p=1/Math.sqrt(p)),a[0]=t[0]*p,a[1]=t[1]*p,a[2]=t[2]*p,a}function gf(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]}function vv(a,t,s){var c=t[0],f=t[1],p=t[2],g=s[0],y=s[1],T=s[2];return a[0]=f*T-p*y,a[1]=p*g-c*T,a[2]=c*y-f*g,a}function sc(a,t,s){var c=t[0],f=t[1],p=t[2],g=s[3]*c+s[7]*f+s[11]*p+s[15];return a[0]=(s[0]*c+s[4]*f+s[8]*p+s[12])/(g=g||1),a[1]=(s[1]*c+s[5]*f+s[9]*p+s[13])/g,a[2]=(s[2]*c+s[6]*f+s[10]*p+s[14])/g,a}function wv(a,t,s){var c=s[0],f=s[1],p=s[2],g=t[0],y=t[1],T=t[2],b=f*T-p*y,C=p*g-c*T,M=c*y-f*g,P=f*M-p*C,N=p*b-c*M,Z=c*C-f*b,ee=2*s[3];return C*=ee,M*=ee,N*=2,Z*=2,a[0]=g+(b*=ee)+(P*=2),a[1]=y+C+N,a[2]=T+M+Z,a}var xf,bu=xv,WA=yv,ZA=_v;function Su(a,t,s){var c=t[0],f=t[1],p=t[2],g=t[3];return a[0]=s[0]*c+s[4]*f+s[8]*p+s[12]*g,a[1]=s[1]*c+s[5]*f+s[9]*p+s[13]*g,a[2]=s[2]*c+s[6]*f+s[10]*p+s[14]*g,a[3]=s[3]*c+s[7]*f+s[11]*p+s[15]*g,a}function Tv(){var a=new Ki(4);return Ki!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function Ev(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function bv(a,t,s){s*=.5;var c=t[0],f=t[1],p=t[2],g=t[3],y=Math.sin(s),T=Math.cos(s);return a[0]=c*T+g*y,a[1]=f*T+p*y,a[2]=p*T-f*y,a[3]=g*T-c*y,a}rg(),xf=new Ki(4),Ki!=Float32Array&&(xf[0]=0,xf[1]=0,xf[2]=0,xf[3]=0),rg(),pf(1,0,0),pf(0,1,0),Tv(),Tv(),pv();class sg{constructor(t,s){this.points=t,this.planes=s}static fromInvProjectionMatrix(t,s,c,f){const p=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(T=>{const b=Su([],T,t),C=1/b[3]/s*p;return function(M,P,N){return M[0]=P[0]*N[0],M[1]=P[1]*N[1],M[2]=P[2]*N[2],M[3]=P[3]*N[3],M}(b,b,[C,C,f?1/b[3]:C,C])}),y=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(T=>{const b=_f([],vv([],bu([],g[T[0]],g[T[1]]),bu([],g[T[2]],g[T[1]]))),C=-gf(b,g[T[1]]);return b.concat(C)});return new sg(g,y)}}class _a{constructor(t,s){this.min=t,this.max=s,this.center=mf([],gv([],this.min,this.max),.5)}quadrant(t){const s=[t%2==0,t<2],c=mv(this.min),f=mv(this.max);for(let p=0;p<s.length;p++)c[p]=s[p]?this.min[p]:this.center[p],f[p]=s[p]?this.center[p]:this.max[p];return f[2]=this.max[2],new _a(c,f)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,s=this.max;return[[t[0],t[1],t[2]],[s[0],t[1],t[2]],[s[0],s[1],t[2]],[t[0],s[1],t[2]],[t[0],t[1],s[2]],[s[0],t[1],s[2]],[s[0],s[1],s[2]],[t[0],s[1],s[2]]]}intersects(t){const s=this.getCorners();let c=!0;for(let f=0;f<t.planes.length;f++){const p=t.planes[f];let g=0;for(let y=0;y<s.length;y++)g+=gf(p,s[y])+p[3]>=0;if(g===0)return 0;g!==s.length&&(c=!1)}if(c)return 2;for(let f=0;f<3;f++){let p=Number.MAX_VALUE,g=-Number.MAX_VALUE;for(let y=0;y<t.points.length;y++){const T=t.points[y][f]-this.min[f];p=Math.min(p,T),g=Math.max(g,T)}if(g<0||p>this.max[f]-this.min[f])return 0}return 1}}function Sv(a,t,s,c,f,p,g,y,T){if(p&&a.queryGeometry.isAboveHorizon)return!1;p&&(T*=a.pixelToTileUnitsFactor);for(const b of t)for(const C of b){const M=C.add(y),P=f&&s.elevation?s.elevation.exaggeration()*f.getElevationAt(M.x,M.y,!0):0,N=p?M:HA(M,P,c),Z=p?a.tilespaceRays.map(ae=>qA(ae,P)):a.queryGeometry.screenGeometry,ee=Su([],[C.x,C.y,P,1],c);if(!g&&p?T*=ee[3]/s.cameraToCenterDistance:g&&!p&&(T*=s.cameraToCenterDistance/ee[3]),BA(Z,N,T))return!0}return!1}function HA(a,t,s){const c=Su([],[a.x,a.y,t,1],s);return new D(c[0]/c[3],c[1]/c[3])}const kv=pf(0,0,0),XA=pf(0,0,1);function qA(a,t){const s=rg();return kv[2]=t,a.intersectsPlane(kv,XA,s),new D(s[0],s[1])}class Av extends q_{}function Cv(a,{width:t,height:s},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==t*s*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(t*s*c);return a.width=t,a.height=s,a.data=f,a}function Iv(a,t,s){const{width:c,height:f}=t;c===a.width&&f===a.height||(og(a,t,{x:0,y:0},{x:0,y:0},{width:Math.min(a.width,c),height:Math.min(a.height,f)},s),a.width=c,a.height=f,a.data=t.data)}function og(a,t,s,c,f,p){if(f.width===0||f.height===0)return t;if(f.width>a.width||f.height>a.height||s.x>a.width-f.width||s.y>a.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>t.width||f.height>t.height||c.x>t.width-f.width||c.y>t.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const g=a.data,y=t.data;for(let T=0;T<f.height;T++){const b=((s.y+T)*a.width+s.x)*p,C=((c.y+T)*t.width+c.x)*p;for(let M=0;M<f.width*p;M++)y[C+M]=g[b+M]}return t}It(Av,"HeatmapBucket",{omit:["layers"]});class so{constructor(t,s){Cv(this,t,1,s)}resize(t){Iv(this,new so(t),1)}clone(){return new so({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,c,f,p){og(t,s,c,f,p,1)}}class Yi{constructor(t,s){Cv(this,t,4,s)}resize(t){Iv(this,new Yi(t),4)}replace(t,s){s?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new Yi({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,s,c,f,p){og(t,s,c,f,p,4)}}It(so,"AlphaImage"),It(Yi,"RGBAImage");var KA={paint:new W({"heatmap-radius":new k(le.paint_heatmap["heatmap-radius"]),"heatmap-weight":new k(le.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new E(le.paint_heatmap["heatmap-intensity"]),"heatmap-color":new O(le.paint_heatmap["heatmap-color"]),"heatmap-opacity":new E(le.paint_heatmap["heatmap-opacity"])})};function lg(a){const t={},s=a.resolution||256,c=a.clips?a.clips.length:1,f=a.image||new Yi({width:s,height:c}),p=(g,y,T)=>{t[a.evaluationKey]=T;const b=a.expression.evaluate(t);f.data[g+y+0]=Math.floor(255*b.r/b.a),f.data[g+y+1]=Math.floor(255*b.g/b.a),f.data[g+y+2]=Math.floor(255*b.b/b.a),f.data[g+y+3]=Math.floor(255*b.a)};if(a.clips)for(let g=0,y=0;g<c;++g,y+=4*s)for(let T=0,b=0;T<s;T++,b+=4){const C=T/(s-1),{start:M,end:P}=a.clips[g];p(y,b,M*(1-C)+P*C)}else for(let g=0,y=0;g<s;g++,y+=4)p(0,y,g/(s-1));return f}var YA={paint:new W({"hillshade-illumination-direction":new E(le.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new E(le.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new E(le.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new E(le.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new E(le.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new E(le.paint_hillshade["hillshade-accent-color"])})};const JA=ye([{name:"a_pos",components:2,type:"Int16"}],4),{members:QA}=JA;var o0=l0,eC=l0;function l0(a,t,s){s=s||2;var c,f,p,g,y,T,b,C=t&&t.length,M=C?t[0]*s:a.length,P=Mv(a,0,M,s,!0),N=[];if(!P||P.next===P.prev)return N;if(C&&(P=function(ee,ae,fe,be){var Me,Pe,Le,ze=[];for(Me=0,Pe=ae.length;Me<Pe;Me++)(Le=Mv(ee,ae[Me]*be,Me<Pe-1?ae[Me+1]*be:ee.length,be,!1))===Le.next&&(Le.steiner=!0),ze.push(lC(Le));for(ze.sort(aC),Me=0;Me<ze.length;Me++)fe=Ho(fe=sC(ze[Me],fe),fe.next);return fe}(a,t,P,s)),a.length>80*s){c=p=a[0],f=g=a[1];for(var Z=s;Z<M;Z+=s)(y=a[Z])<c&&(c=y),(T=a[Z+1])<f&&(f=T),y>p&&(p=y),T>g&&(g=T);b=(b=Math.max(p-c,g-f))!==0?1/b:0}return yf(P,N,s,c,f,b),N}function Mv(a,t,s,c,f){var p,g;if(f===hg(a,t,s,c)>0)for(p=t;p<s;p+=c)g=Pv(p,a[p],a[p+1],g);else for(p=s-c;p>=t;p-=c)g=Pv(p,a[p],a[p+1],g);return g&&c0(g,g.next)&&(wf(g),g=g.next),g}function Ho(a,t){if(!a)return a;t||(t=a);var s,c=a;do if(s=!1,c.steiner||!c0(c,c.next)&&on(c.prev,c,c.next)!==0)c=c.next;else{if(wf(c),(c=t=c.prev)===c.next)break;s=!0}while(s||c!==t);return t}function yf(a,t,s,c,f,p,g){if(a){!g&&p&&function(C,M,P,N){var Z=C;do Z.z===null&&(Z.z=cg(Z.x,Z.y,M,P,N)),Z.prevZ=Z.prev,Z.nextZ=Z.next,Z=Z.next;while(Z!==C);Z.prevZ.nextZ=null,Z.prevZ=null,function(ee){var ae,fe,be,Me,Pe,Le,ze,Je,et=1;do{for(fe=ee,ee=null,Pe=null,Le=0;fe;){for(Le++,be=fe,ze=0,ae=0;ae<et&&(ze++,be=be.nextZ);ae++);for(Je=et;ze>0||Je>0&&be;)ze!==0&&(Je===0||!be||fe.z<=be.z)?(Me=fe,fe=fe.nextZ,ze--):(Me=be,be=be.nextZ,Je--),Pe?Pe.nextZ=Me:ee=Me,Me.prevZ=Pe,Pe=Me;fe=be}Pe.nextZ=null,et*=2}while(Le>1)}(Z)}(a,c,f,p);for(var y,T,b=a;a.prev!==a.next;)if(y=a.prev,T=a.next,p?rC(a,c,f,p):tC(a))t.push(y.i/s),t.push(a.i/s),t.push(T.i/s),wf(a),a=T.next,b=T.next;else if((a=T)===b){g?g===1?yf(a=nC(Ho(a),t,s),t,s,c,f,p,2):g===2&&iC(a,t,s,c,f,p):yf(Ho(a),t,s,c,f,p,1);break}}}function tC(a){var t=a.prev,s=a,c=a.next;if(on(t,s,c)>=0)return!1;for(var f=a.next.next;f!==a.prev;){if(ku(t.x,t.y,s.x,s.y,c.x,c.y,f.x,f.y)&&on(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function rC(a,t,s,c){var f=a.prev,p=a,g=a.next;if(on(f,p,g)>=0)return!1;for(var y=f.x>p.x?f.x>g.x?f.x:g.x:p.x>g.x?p.x:g.x,T=f.y>p.y?f.y>g.y?f.y:g.y:p.y>g.y?p.y:g.y,b=cg(f.x<p.x?f.x<g.x?f.x:g.x:p.x<g.x?p.x:g.x,f.y<p.y?f.y<g.y?f.y:g.y:p.y<g.y?p.y:g.y,t,s,c),C=cg(y,T,t,s,c),M=a.prevZ,P=a.nextZ;M&&M.z>=b&&P&&P.z<=C;){if(M!==a.prev&&M!==a.next&&ku(f.x,f.y,p.x,p.y,g.x,g.y,M.x,M.y)&&on(M.prev,M,M.next)>=0||(M=M.prevZ,P!==a.prev&&P!==a.next&&ku(f.x,f.y,p.x,p.y,g.x,g.y,P.x,P.y)&&on(P.prev,P,P.next)>=0))return!1;P=P.nextZ}for(;M&&M.z>=b;){if(M!==a.prev&&M!==a.next&&ku(f.x,f.y,p.x,p.y,g.x,g.y,M.x,M.y)&&on(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;P&&P.z<=C;){if(P!==a.prev&&P!==a.next&&ku(f.x,f.y,p.x,p.y,g.x,g.y,P.x,P.y)&&on(P.prev,P,P.next)>=0)return!1;P=P.nextZ}return!0}function nC(a,t,s){var c=a;do{var f=c.prev,p=c.next.next;!c0(f,p)&&Dv(f,c,c.next,p)&&vf(f,p)&&vf(p,f)&&(t.push(f.i/s),t.push(c.i/s),t.push(p.i/s),wf(c),wf(c.next),c=a=p),c=c.next}while(c!==a);return Ho(c)}function iC(a,t,s,c,f,p){var g=a;do{for(var y=g.next.next;y!==g.prev;){if(g.i!==y.i&&cC(g,y)){var T=Fv(g,y);return g=Ho(g,g.next),T=Ho(T,T.next),yf(g,t,s,c,f,p),void yf(T,t,s,c,f,p)}y=y.next}g=g.next}while(g!==a)}function aC(a,t){return a.x-t.x}function sC(a,t){var s=function(p,g){var y,T=g,b=p.x,C=p.y,M=-1/0;do{if(C<=T.y&&C>=T.next.y&&T.next.y!==T.y){var P=T.x+(C-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(P<=b&&P>M){if(M=P,P===b){if(C===T.y)return T;if(C===T.next.y)return T.next}y=T.x<T.next.x?T:T.next}}T=T.next}while(T!==g);if(!y)return null;if(b===M)return y;var N,Z=y,ee=y.x,ae=y.y,fe=1/0;T=y;do b>=T.x&&T.x>=ee&&b!==T.x&&ku(C<ae?b:M,C,ee,ae,C<ae?M:b,C,T.x,T.y)&&(N=Math.abs(C-T.y)/(b-T.x),vf(T,p)&&(N<fe||N===fe&&(T.x>y.x||T.x===y.x&&oC(y,T)))&&(y=T,fe=N)),T=T.next;while(T!==Z);return y}(a,t);if(!s)return t;var c=Fv(s,a),f=Ho(s,s.next);return Ho(c,c.next),t===s?f:t}function oC(a,t){return on(a.prev,a,t.prev)<0&&on(t.next,a,a.next)<0}function cg(a,t,s,c,f){return(a=1431655765&((a=858993459&((a=252645135&((a=16711935&((a=32767*(a-s)*f)|a<<8))|a<<4))|a<<2))|a<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-c)*f)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function lC(a){var t=a,s=a;do(t.x<s.x||t.x===s.x&&t.y<s.y)&&(s=t),t=t.next;while(t!==a);return s}function ku(a,t,s,c,f,p,g,y){return(f-g)*(t-y)-(a-g)*(p-y)>=0&&(a-g)*(c-y)-(s-g)*(t-y)>=0&&(s-g)*(p-y)-(f-g)*(c-y)>=0}function cC(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!function(s,c){var f=s;do{if(f.i!==s.i&&f.next.i!==s.i&&f.i!==c.i&&f.next.i!==c.i&&Dv(f,f.next,s,c))return!0;f=f.next}while(f!==s);return!1}(a,t)&&(vf(a,t)&&vf(t,a)&&function(s,c){var f=s,p=!1,g=(s.x+c.x)/2,y=(s.y+c.y)/2;do f.y>y!=f.next.y>y&&f.next.y!==f.y&&g<(f.next.x-f.x)*(y-f.y)/(f.next.y-f.y)+f.x&&(p=!p),f=f.next;while(f!==s);return p}(a,t)&&(on(a.prev,a,t.prev)||on(a,t.prev,t))||c0(a,t)&&on(a.prev,a,a.next)>0&&on(t.prev,t,t.next)>0)}function on(a,t,s){return(t.y-a.y)*(s.x-t.x)-(t.x-a.x)*(s.y-t.y)}function c0(a,t){return a.x===t.x&&a.y===t.y}function Dv(a,t,s,c){var f=h0(on(a,t,s)),p=h0(on(a,t,c)),g=h0(on(s,c,a)),y=h0(on(s,c,t));return f!==p&&g!==y||!(f!==0||!u0(a,s,t))||!(p!==0||!u0(a,c,t))||!(g!==0||!u0(s,a,c))||!(y!==0||!u0(s,t,c))}function u0(a,t,s){return t.x<=Math.max(a.x,s.x)&&t.x>=Math.min(a.x,s.x)&&t.y<=Math.max(a.y,s.y)&&t.y>=Math.min(a.y,s.y)}function h0(a){return a>0?1:a<0?-1:0}function vf(a,t){return on(a.prev,a,a.next)<0?on(a,t,a.next)>=0&&on(a,a.prev,t)>=0:on(a,t,a.prev)<0||on(a,a.next,t)<0}function Fv(a,t){var s=new ug(a.i,a.x,a.y),c=new ug(t.i,t.x,t.y),f=a.next,p=t.prev;return a.next=t,t.prev=a,s.next=f,f.prev=s,c.next=s,s.prev=c,p.next=c,c.prev=p,c}function Pv(a,t,s,c){var f=new ug(a,t,s);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function wf(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function ug(a,t,s){this.i=a,this.x=t,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hg(a,t,s,c){for(var f=0,p=t,g=s-c;p<s;p+=c)f+=(a[g]-a[p])*(a[p+1]+a[g+1]),g=p;return f}function uC(a,t,s,c,f){Lv(a,t,s||0,c||a.length-1,f||hC)}function Lv(a,t,s,c,f){for(;c>s;){if(c-s>600){var p=c-s+1,g=t-s+1,y=Math.log(p),T=.5*Math.exp(2*y/3),b=.5*Math.sqrt(y*T*(p-T)/p)*(g-p/2<0?-1:1);Lv(a,t,Math.max(s,Math.floor(t-g*T/p+b)),Math.min(c,Math.floor(t+(p-g)*T/p+b)),f)}var C=a[t],M=s,P=c;for(Tf(a,s,t),f(a[c],C)>0&&Tf(a,s,c);M<P;){for(Tf(a,M,P),M++,P--;f(a[M],C)<0;)M++;for(;f(a[P],C)>0;)P--}f(a[s],C)===0?Tf(a,s,P):Tf(a,++P,c),P<=t&&(s=P+1),t<=P&&(c=P-1)}}function Tf(a,t,s){var c=a[t];a[t]=a[s],a[s]=c}function hC(a,t){return a<t?-1:a>t?1:0}function fg(a,t){const s=a.length;if(s<=1)return[a];const c=[];let f,p;for(let g=0;g<s;g++){const y=Oe(a[g]);y!==0&&(a[g].area=Math.abs(y),p===void 0&&(p=y<0),p===y<0?(f&&c.push(f),f=[a[g]]):f.push(a[g]))}if(f&&c.push(f),t>1)for(let g=0;g<c.length;g++)c[g].length<=t||(uC(c[g],t,1,c[g].length-1,fC),c[g]=c[g].slice(0,t));return c}function fC(a,t){return t.area-a.area}function dg(a,t,s){const c=s.patternDependencies;let f=!1;for(const p of t){const g=p.paint.get(`${a}-pattern`);g.isConstant()||(f=!0);const y=g.constantOr(null);y&&(f=!0,c[y.to]=!0,c[y.from]=!0)}return f}function pg(a,t,s,c,f){const p=f.patternDependencies;for(const g of t){const y=g.paint.get(`${a}-pattern`).value;if(y.kind!=="constant"){let T=y.evaluate({zoom:c-1},s,{},f.availableImages),b=y.evaluate({zoom:c},s,{},f.availableImages),C=y.evaluate({zoom:c+1},s,{},f.availableImages);T=T&&T.name?T.name:T,b=b&&b.name?b.name:b,C=C&&C.name?C.name:C,p[T]=!0,p[b]=!0,p[C]=!0,s.patterns[g.id]={min:T,mid:b,max:C}}}return s}l0.deviation=function(a,t,s,c){var f=t&&t.length,p=Math.abs(hg(a,0,f?t[0]*s:a.length,s));if(f)for(var g=0,y=t.length;g<y;g++)p-=Math.abs(hg(a,t[g]*s,g<y-1?t[g+1]*s:a.length,s));var T=0;for(g=0;g<c.length;g+=3){var b=c[g]*s,C=c[g+1]*s,M=c[g+2]*s;T+=Math.abs((a[b]-a[M])*(a[C+1]-a[b+1])-(a[b]-a[C])*(a[M+1]-a[b+1]))}return p===0&&T===0?0:Math.abs((T-p)/p)},l0.flatten=function(a){for(var t=a[0][0].length,s={vertices:[],holes:[],dimensions:t},c=0,f=0;f<a.length;f++){for(var p=0;p<a[f].length;p++)for(var g=0;g<t;g++)s.vertices.push(a[f][p][g]);f>0&&s.holes.push(c+=a[f-1].length)}return s},o0.default=eC;class f0{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _e,this.indexArray=new Ft,this.indexArray2=new qt,this.programConfigurations=new nc(t.layers,t.zoom),this.segments=new Kr,this.segments2=new Kr,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=t.projection}populate(t,s,c,f){this.hasPattern=dg("fill",this.layers,s);const p=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:y,id:T,index:b,sourceLayerIndex:C}of t){const M=this.layers[0]._featureFilter.needGeometry,P=ic(y,M);if(!this.layers[0]._featureFilter.filter(new Fr(this.zoom),P,c))continue;const N=p?p.evaluate(P,{},c,s.availableImages):void 0,Z={id:T,properties:y.properties,type:y.type,sourceLayerIndex:C,index:b,geometry:M?P.geometry:ao(y,c,f),patterns:{},sortKey:N};g.push(Z)}p&&g.sort((y,T)=>y.sortKey-T.sortKey);for(const y of g){const{geometry:T,index:b,sourceLayerIndex:C}=y;if(this.hasPattern){const M=pg("fill",this.layers,y,this.zoom,s);this.patternFeatures.push(M)}else this.addFeature(y,T,b,c,{},s.availableImages);s.featureIndex.insert(t[b].feature,T,b,C,this.index)}}update(t,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,c,f)}addFeatures(t,s,c,f,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,s,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,QA),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,s,c,f,p,g=[]){for(const y of fg(s,500)){let T=0;for(const Z of y)T+=Z.length;const b=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),C=b.vertexLength,M=[],P=[];for(const Z of y){if(Z.length===0)continue;Z!==y[0]&&P.push(M.length/2);const ee=this.segments2.prepareSegment(Z.length,this.layoutVertexArray,this.indexArray2),ae=ee.vertexLength;this.layoutVertexArray.emplaceBack(Z[0].x,Z[0].y),this.indexArray2.emplaceBack(ae+Z.length-1,ae),M.push(Z[0].x),M.push(Z[0].y);for(let fe=1;fe<Z.length;fe++)this.layoutVertexArray.emplaceBack(Z[fe].x,Z[fe].y),this.indexArray2.emplaceBack(ae+fe-1,ae+fe),M.push(Z[fe].x),M.push(Z[fe].y);ee.vertexLength+=Z.length,ee.primitiveLength+=Z.length}const N=o0(M,P);for(let Z=0;Z<N.length;Z+=3)this.indexArray.emplaceBack(C+N[Z],C+N[Z+1],C+N[Z+2]);b.vertexLength+=T,b.primitiveLength+=N.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,p,g,f)}}It(f0,"FillBucket",{omit:["layers","patternFeatures"]});const dC=new W({"fill-sort-key":new k(le.layout_fill["fill-sort-key"])});var pC={paint:new W({"fill-antialias":new E(le.paint_fill["fill-antialias"]),"fill-opacity":new k(le.paint_fill["fill-opacity"]),"fill-color":new k(le.paint_fill["fill-color"]),"fill-outline-color":new k(le.paint_fill["fill-outline-color"]),"fill-translate":new E(le.paint_fill["fill-translate"]),"fill-translate-anchor":new E(le.paint_fill["fill-translate-anchor"]),"fill-pattern":new F(le.paint_fill["fill-pattern"])}),layout:dC};const mC=ye([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),_C=ye([{name:"a_centroid_pos",components:2,type:"Uint16"}]),gC=ye([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:xC}=mC;var Rv=Au;function Au(a,t,s,c,f){this.properties={},this.extent=s,this.type=0,this._pbf=a,this._geometry=-1,this._keys=c,this._values=f,a.readFields(yC,this,t)}function yC(a,t,s){a==1?t.id=s.readVarint():a==2?function(c,f){for(var p=c.readVarint()+c.pos;c.pos<p;){var g=f._keys[c.readVarint()],y=f._values[c.readVarint()];f.properties[g]=y}}(s,t):a==3?t.type=s.readVarint():a==4&&(t._geometry=s.pos)}function vC(a){for(var t,s,c=0,f=0,p=a.length,g=p-1;f<p;g=f++)c+=((s=a[g]).x-(t=a[f]).x)*(t.y+s.y);return c}Au.types=["Unknown","Point","LineString","Polygon"],Au.prototype.loadGeometry=function(){var a=this._pbf;a.pos=this._geometry;for(var t,s=a.readVarint()+a.pos,c=1,f=0,p=0,g=0,y=[];a.pos<s;){if(f<=0){var T=a.readVarint();c=7&T,f=T>>3}if(f--,c===1||c===2)p+=a.readSVarint(),g+=a.readSVarint(),c===1&&(t&&y.push(t),t=[]),t.push(new D(p,g));else{if(c!==7)throw new Error("unknown command "+c);t&&t.push(t[0].clone())}}return t&&y.push(t),y},Au.prototype.bbox=function(){var a=this._pbf;a.pos=this._geometry;for(var t=a.readVarint()+a.pos,s=1,c=0,f=0,p=0,g=1/0,y=-1/0,T=1/0,b=-1/0;a.pos<t;){if(c<=0){var C=a.readVarint();s=7&C,c=C>>3}if(c--,s===1||s===2)(f+=a.readSVarint())<g&&(g=f),f>y&&(y=f),(p+=a.readSVarint())<T&&(T=p),p>b&&(b=p);else if(s!==7)throw new Error("unknown command "+s)}return[g,T,y,b]},Au.prototype.toGeoJSON=function(a,t,s){var c,f,p=this.extent*Math.pow(2,s),g=this.extent*a,y=this.extent*t,T=this.loadGeometry(),b=Au.types[this.type];function C(N){for(var Z=0;Z<N.length;Z++){var ee=N[Z];N[Z]=[360*(ee.x+g)/p-180,360/Math.PI*Math.atan(Math.exp((180-360*(ee.y+y)/p)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(c=0;c<T.length;c++)M[c]=T[c][0];C(T=M);break;case 2:for(c=0;c<T.length;c++)C(T[c]);break;case 3:for(T=function(N){var Z=N.length;if(Z<=1)return[N];for(var ee,ae,fe=[],be=0;be<Z;be++){var Me=vC(N[be]);Me!==0&&(ae===void 0&&(ae=Me<0),ae===Me<0?(ee&&fe.push(ee),ee=[N[be]]):ee.push(N[be]))}return ee&&fe.push(ee),fe}(T),c=0;c<T.length;c++)for(f=0;f<T[c].length;f++)C(T[c][f])}T.length===1?T=T[0]:b="Multi"+b;var P={type:"Feature",geometry:{type:b,coordinates:T},properties:this.properties};return"id"in this&&(P.id=this.id),P};var zv=Ov;function Ov(a,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=a,this._keys=[],this._values=[],this._features=[],a.readFields(wC,this,t),this.length=this._features.length}function wC(a,t,s){a===15?t.version=s.readVarint():a===1?t.name=s.readString():a===5?t.extent=s.readVarint():a===2?t._features.push(s.pos):a===3?t._keys.push(s.readString()):a===4&&t._values.push(function(c){for(var f=null,p=c.readVarint()+c.pos;c.pos<p;){var g=c.readVarint()>>3;f=g===1?c.readString():g===2?c.readFloat():g===3?c.readDouble():g===4?c.readVarint64():g===5?c.readVarint():g===6?c.readSVarint():g===7?c.readBoolean():null}return f}(s))}function TC(a,t,s){if(a===3){var c=new zv(s,s.readVarint()+s.pos);c.length&&(t[c.name]=c)}}Ov.prototype.feature=function(a){if(a<0||a>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[a];var t=this._pbf.readVarint()+this._pbf.pos;return new Rv(this._pbf,t,this.extent,this._keys,this._values)};var oc={VectorTile:function(a,t){this.layers=a.readFields(TC,{},t)},VectorTileFeature:Rv,VectorTileLayer:zv};function d0(a,t,s,c){const f=[],p=c===0?(g,y,T,b,C,M)=>{g.push(new D(M,T+(M-y)/(b-y)*(C-T)))}:(g,y,T,b,C,M)=>{g.push(new D(y+(M-T)/(C-T)*(b-y),M))};for(const g of a){const y=[];for(const T of g){if(T.length<=2)continue;const b=[];for(let P=0;P<T.length-1;P++){const N=T[P].x,Z=T[P].y,ee=T[P+1].x,ae=T[P+1].y,fe=c===0?N:Z,be=c===0?ee:ae;fe<t?be>t&&p(b,N,Z,ee,ae,t):fe>s?be<s&&p(b,N,Z,ee,ae,s):b.push(T[P]),be<t&&fe>=t&&p(b,N,Z,ee,ae,t),be>s&&fe<=s&&p(b,N,Z,ee,ae,s)}let C=T[T.length-1];const M=c===0?C.x:C.y;M>=t&&M<=s&&b.push(C),b.length&&(C=b[b.length-1],b[0].x===C.x&&b[0].y===C.y||b.push(b[0]),y.push(b))}y.length&&f.push(y)}return f}const EC=oc.VectorTileFeature.types,bC=Math.pow(2,13);function Ef(a,t,s,c,f,p,g,y){a.emplaceBack((t<<1)+g,(s<<1)+p,(Math.floor(c*bC)<<1)+f,Math.round(y))}function bf(a,t,s){a.emplaceBack(t.x,t.y,t.z,s[0]*16384,s[1]*16384,s[2]*16384)}class Bv{constructor(){this.acc=new D(0,0),this.polyCount=[]}startRing(t){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new D(t.x,t.y),this.max=new D(t.x,t.y))}append(t,s){this.currentPolyCount.edges++,this.acc._add(t);const c=this.min,f=this.max;t.x<c.x?c.x=t.x:t.x>f.x&&(f.x=t.x),t.y<c.y?c.y=t.y:t.y>f.y&&(f.y=t.y),((t.x===0||t.x===Jt)&&t.x===s.x)!=((t.y===0||t.y===Jt)&&t.y===s.y)&&this.processBorderOverlap(t,s),s.x<0!=t.x<0&&this.addBorderIntersection(0,Wt(s.y,t.y,(0-s.x)/(t.x-s.x))),s.x>Jt!=t.x>Jt&&this.addBorderIntersection(1,Wt(s.y,t.y,(Jt-s.x)/(t.x-s.x))),s.y<0!=t.y<0&&this.addBorderIntersection(2,Wt(s.x,t.x,(0-s.y)/(t.y-s.y))),s.y>Jt!=t.y>Jt&&this.addBorderIntersection(3,Wt(s.x,t.x,(Jt-s.y)/(t.y-s.y)))}addBorderIntersection(t,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[t];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(t,s){if(t.x===s.x){if(t.y===s.y)return;const c=t.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,t.y)}else{const c=t.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,t.x)}}centroid(){const t=this.polyCount.reduce((s,c)=>s+c.edges,0);return t!==0?this.acc.div(t)._round():new D(0,0)}span(){return new D(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((t,s)=>t+ +(s[0]!==Number.MAX_VALUE),0)}}class Sf{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new Te,this.centroidVertexArray=new rc,this.indexArray=new Ft,this.programConfigurations=new nc(t.layers,t.zoom),this.segments=new Kr,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.enableTerrain=t.enableTerrain}populate(t,s,c,f){this.features=[],this.hasPattern=dg("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(p){const g=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*g/(g*g+1)/Jt/(1<<p.z)}(c);for(const{feature:p,id:g,index:y,sourceLayerIndex:T}of t){const b=this.layers[0]._featureFilter.needGeometry,C=ic(p,b);if(!this.layers[0]._featureFilter.filter(new Fr(this.zoom),C,c))continue;const M={id:g,sourceLayerIndex:T,index:y,geometry:b?C.geometry:ao(p,c,f),properties:p.properties,type:p.type,patterns:{}},P=this.layoutVertexArray.length;this.hasPattern?this.features.push(pg("fill-extrusion",this.layers,M,this.zoom,s)):this.addFeature(M,M.geometry,y,c,{},s.availableImages,f),s.featureIndex.insert(p,M.geometry,y,T,this.index,P)}this.sortBorders()}addFeatures(t,s,c,f,p){for(const g of this.features){const{geometry:y}=g;this.addFeature(g,y,g.index,s,c,f,p)}this.sortBorders()}update(t,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,xC),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,gC.members,!0))),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,_C.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,s,c,f,p,g,y){const T=[new D(0,0),new D(Jt,Jt)],b=y.projection,C=b.name==="globe",M=this.enableTerrain&&!C?new Bv:null;C&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Di);const P=fg(s,500);for(let ee=P.length-1;ee>=0;ee--){const ae=P[ee];(ae.length===0||(N=ae[0]).every(fe=>fe.x<=0)||N.every(fe=>fe.x>=Jt)||N.every(fe=>fe.y<=0)||N.every(fe=>fe.y>=Jt))&&P.splice(ee,1)}var N;let Z;if(C){const ae=1<<f.z,fe=Ma(f.x/ae),be=Ma((f.x+1)/ae),Me=Zn(f.y/ae),Pe=Zn((f.y+1)/ae);Z=function(Le,ze,Je,et,st=0,ot){const Ke=[];if(!Le.length||!Je||!et)return Ke;const nt=(Yt,tr)=>{for(const Nt of Yt)Ke.push({polygon:Nt,bounds:tr})},ct=Math.ceil(Math.log2(Je)),vt=Math.ceil(Math.log2(et)),ft=ct-vt,xt=[];for(let Yt=0;Yt<Math.abs(ft);Yt++)xt.push(ft>0?0:1);for(let Yt=0;Yt<Math.min(ct,vt);Yt++)xt.push(0),xt.push(1);let Kt=Le;if(Kt=d0(Kt,ze[0].y-st,ze[1].y+st,1),Kt=d0(Kt,ze[0].x-st,ze[1].x+st,0),!Kt.length)return Ke;const sr=[];for(xt.length?sr.push({polygons:Kt,bounds:ze,depth:0}):nt(Kt,ze);sr.length;){const Yt=sr.pop(),tr=Yt.depth,Nt=xt[tr],Ct=Yt.bounds[0],cr=Yt.bounds[1],_r=Nt===0?Ct.x:Ct.y,_n=Nt===0?cr.x:cr.y,Pr=ot?ot(Nt,_r,_n):.5*(_r+_n),gn=d0(Yt.polygons,_r-st,Pr+st,Nt),gr=d0(Yt.polygons,Pr-st,_n+st,Nt);if(gn.length){const ur=[Ct,new D(Nt===0?Pr:cr.x,Nt===1?Pr:cr.y)];xt.length>tr+1?sr.push({polygons:gn,bounds:ur,depth:tr+1}):nt(gn,ur)}if(gr.length){const ur=[new D(Nt===0?Pr:Ct.x,Nt===1?Pr:Ct.y),cr];xt.length>tr+1?sr.push({polygons:gr,bounds:ur,depth:tr+1}):nt(gr,ur)}}return Ke}(P,T,Math.ceil((be-fe)/11.25),Math.ceil((Me-Pe)/11.25),1,(Le,ze,Je)=>{if(Le===0)return .5*(ze+Je);{const et=Zn((f.y+ze/Jt)/ae);return(vu(.5*(Zn((f.y+Je/Jt)/ae)+et))*ae-f.y)*Jt}})}else{Z=[];for(const ee of P)Z.push({polygon:ee,bounds:T})}for(const ee of Z){const ae=ee.polygon;let fe=0,be=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(let Je=0;Je<ae.length;Je++){const et=ae[Je];if(et.length===0)continue;fe+=et.length;let st=0;M&&M.startRing(et[0]);for(let ot=0;ot<et.length;ot++){const Ke=et[ot];if(ot>=1){const nt=et[ot-1];if(!SC(Ke,nt,ee.bounds)){M&&M.append(Ke,nt),be.vertexLength+4>Kr.MAX_VERTEX_ARRAY_LENGTH&&(be=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ct=Ke.sub(nt)._perp(),vt=ct.x/(Math.abs(ct.x)+Math.abs(ct.y)),ft=ct.y>0?1:0,xt=nt.dist(Ke);st+xt>32768&&(st=0),Ef(this.layoutVertexArray,Ke.x,Ke.y,vt,ft,0,0,st),Ef(this.layoutVertexArray,Ke.x,Ke.y,vt,ft,0,1,st),st+=xt,Ef(this.layoutVertexArray,nt.x,nt.y,vt,ft,0,0,st),Ef(this.layoutVertexArray,nt.x,nt.y,vt,ft,0,1,st);const Kt=be.vertexLength;if(this.indexArray.emplaceBack(Kt,Kt+2,Kt+1),this.indexArray.emplaceBack(Kt+1,Kt+2,Kt+3),be.vertexLength+=4,be.primitiveLength+=2,C){const sr=this.layoutVertexExtArray,Yt=b.projectTilePoint(Ke.x,Ke.y,f),tr=b.projectTilePoint(nt.x,nt.y,f),Nt=b.upVector(f,Ke.x,Ke.y),Ct=b.upVector(f,nt.x,nt.y);bf(sr,Yt,Nt),bf(sr,Yt,Nt),bf(sr,tr,Ct),bf(sr,tr,Ct)}}}}}if(be.vertexLength+fe>Kr.MAX_VERTEX_ARRAY_LENGTH&&(be=this.segments.prepareSegment(fe,this.layoutVertexArray,this.indexArray)),EC[t.type]!=="Polygon")continue;const Me=[],Pe=[],Le=be.vertexLength;for(let Je=0;Je<ae.length;Je++){const et=ae[Je];if(et.length!==0){et!==ae[0]&&Pe.push(Me.length/2);for(let st=0;st<et.length;st++){const ot=et[st];Ef(this.layoutVertexArray,ot.x,ot.y,0,0,1,1,0),Me.push(ot.x),Me.push(ot.y),M&&M.currentPolyCount.top++,C&&bf(this.layoutVertexExtArray,b.projectTilePoint(ot.x,ot.y,f),b.upVector(f,ot.x,ot.y))}}}const ze=o0(Me,Pe);for(let Je=0;Je<ze.length;Je+=3)this.indexArray.emplaceBack(Le+ze[Je],Le+ze[Je+2],Le+ze[Je+1]);be.primitiveLength+=ze.length/3,be.vertexLength+=fe}if(M&&M.polyCount.length>0){if(M.borders){M.vertexArrayOffset=this.centroidVertexArray.length;const ee=M.borders,ae=this.featuresOnBorder.push(M)-1;for(let fe=0;fe<4;fe++)ee[fe][0]!==Number.MAX_VALUE&&this.borders[fe].push(ae)}this.encodeCentroid(M.borders?void 0:M.centroid(),M)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,p,g,f)}sortBorders(){for(let t=0;t<4;t++)this.borders[t].sort((s,c)=>this.featuresOnBorder[s].borders[t][0]-this.featuresOnBorder[c].borders[t][0])}encodeCentroid(t,s,c=!0){let f,p;if(t)if(t.y!==0){const y=s.span()._mult(this.tileToMeter);f=(Math.max(t.x,1)<<3)+Math.min(7,Math.round(y.x/10)),p=(Math.max(t.y,1)<<3)+Math.min(7,Math.round(y.y/10))}else f=Math.ceil(7*(t.x+450)),p=0;else f=0,p=+c;let g=c?this.centroidVertexArray.length:s.vertexArrayOffset;for(const y of s.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*y.edges+y.top);for(let T=0;T<2*y.edges;T++)this.centroidVertexArray.emplace(g++,0,p),this.centroidVertexArray.emplace(g++,f,p);for(let T=0;T<y.top;T++)this.centroidVertexArray.emplace(g++,f,p)}}}function SC(a,t,s){return a.x===t.x&&(a.x<s[0].x||a.x>s[1].x)||a.y===t.y&&(a.y<s[0].y||a.y>s[1].y)}It(Sf,"FillExtrusionBucket",{omit:["layers","features"]}),It(Bv,"PartMetadata");var kC={paint:new W({"fill-extrusion-opacity":new E(le["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new k(le["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new E(le["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new E(le["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new F(le["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new k(le["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new k(le["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new E(le["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function kf(a,t){return a.x*t.x+a.y*t.y}function Nv(a,t){if(a.length===1){let s=0;const c=t[s++];let f;for(;!f||c.equals(f);)if(f=t[s++],!f)return 1/0;for(;s<t.length;s++){const p=t[s],g=a[0],y=f.sub(c),T=p.sub(c),b=g.sub(c),C=kf(y,y),M=kf(y,T),P=kf(T,T),N=kf(b,y),Z=kf(b,T),ee=C*P-M*M,ae=(P*N-M*Z)/ee,fe=(C*Z-M*N)/ee,be=c.z*(1-ae-fe)+f.z*ae+p.z*fe;if(isFinite(be))return be}return 1/0}{let s=1/0;for(const c of t)s=Math.min(s,c.z);return s}}function Uv(a){const t=new D(a[0],a[1]);return t.z=a[2],t}function AC(a,t,s,c,f,p,g,y){const T=g*f.getElevationAt(a,t,!0,!0),b=p[0]!==0,C=b?p[1]===0?g*(p[0]/7-450):g*function(M,P,N){const Z=Math.floor(P[0]/8),ee=Math.floor(P[1]/8),ae=10*(P[0]-8*Z),fe=10*(P[1]-8*ee),be=M.getElevationAt(Z,ee,!0,!0),Me=M.getMeterToDEM(N),Pe=Math.floor(.5*(ae*Me-1)),Le=Math.floor(.5*(fe*Me-1)),ze=M.tileCoordToPixel(Z,ee),Je=2*Pe+1,et=2*Le+1,st=function(ft,xt,Kt,sr,Yt){return[ft.getElevationAtPixel(xt,Kt,!0),ft.getElevationAtPixel(xt+Yt,Kt,!0),ft.getElevationAtPixel(xt,Kt+Yt,!0),ft.getElevationAtPixel(xt+sr,Kt+Yt,!0)]}(M,ze.x-Pe,ze.y-Le,Je,et),ot=Math.abs(st[0]-st[1]),Ke=Math.abs(st[2]-st[3]),nt=Math.abs(st[0]-st[2])+Math.abs(st[1]-st[3]),ct=Math.min(.25,.5*Me*(ot+Ke)/Je),vt=Math.min(.25,.5*Me*nt/et);return be+Math.max(ct*ae,vt*fe)}(f,p,y):T;return{base:T+(s===0)?-1:s,top:b?Math.max(C+c,T+s+2):T+c}}const CC=ye([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:IC}=CC,MC=ye([{name:"a_packed",components:3,type:"Float32"}]),{members:DC}=MC,FC=oc.VectorTileFeature.types,PC=Math.cos(Math.PI/180*37.5);class p0{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(s=>s.id),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new pe,this.layoutVertexArray2=new mt,this.indexArray=new Ft,this.programConfigurations=new nc(t.layers,t.zoom),this.segments=new Kr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(t,s,c,f){this.hasPattern=dg("line",this.layers,s);const p=this.layers[0].layout.get("line-sort-key"),g=[];for(const{feature:C,id:M,index:P,sourceLayerIndex:N}of t){const Z=this.layers[0]._featureFilter.needGeometry,ee=ic(C,Z);if(!this.layers[0]._featureFilter.filter(new Fr(this.zoom),ee,c))continue;const ae=p?p.evaluate(ee,{},c):void 0,fe={id:M,properties:C.properties,type:C.type,sourceLayerIndex:N,index:P,geometry:Z?ee.geometry:ao(C,c,f),patterns:{},sortKey:ae};g.push(fe)}p&&g.sort((C,M)=>C.sortKey-M.sortKey);const{lineAtlas:y,featureIndex:T}=s,b=this.addConstantDashes(y);for(const C of g){const{geometry:M,index:P,sourceLayerIndex:N}=C;if(b&&this.addFeatureDashes(C,y),this.hasPattern){const Z=pg("line",this.layers,C,this.zoom,s);this.patternFeatures.push(Z)}else this.addFeature(C,M,P,c,y.positions,s.availableImages);T.insert(t[P].feature,M,P,N,this.index)}}addConstantDashes(t){let s=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,p=c.layout.get("line-cap").value;if(f.kind!=="constant"||p.kind!=="constant")s=!0;else{const g=p.value,y=f.value;if(!y)continue;t.addDash(y.from,g),t.addDash(y.to,g),y.other&&t.addDash(y.other,g)}}return s}addFeatureDashes(t,s){const c=this.zoom;for(const f of this.layers){const p=f.paint.get("line-dasharray").value,g=f.layout.get("line-cap").value;if(p.kind==="constant"&&g.kind==="constant")continue;let y,T,b,C,M,P;if(p.kind==="constant"){const ae=p.value;if(!ae)continue;y=ae.other||ae.to,T=ae.to,b=ae.from}else y=p.evaluate({zoom:c-1},t),T=p.evaluate({zoom:c},t),b=p.evaluate({zoom:c+1},t);g.kind==="constant"?C=M=P=g.value:(C=g.evaluate({zoom:c-1},t),M=g.evaluate({zoom:c},t),P=g.evaluate({zoom:c+1},t)),s.addDash(y,C),s.addDash(T,M),s.addDash(b,P);const N=s.getKey(y,C),Z=s.getKey(T,M),ee=s.getKey(b,P);t.patterns[f.id]={min:N,mid:Z,max:ee}}}update(t,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(t,s,this.stateDependentLayers,c,f)}addFeatures(t,s,c,f,p){for(const g of this.patternFeatures)this.addFeature(g,g.geometry,g.index,s,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,DC)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,IC),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,s,c,f,p,g){const y=this.layers[0].layout,T=y.get("line-join").evaluate(t,{}),b=y.get("line-cap").evaluate(t,{}),C=y.get("line-miter-limit"),M=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(t);for(const P of s)this.addLine(P,t,T,b,C,M);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,c,p,g,f)}addLine(t,s,c,f,p,g){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let fe=0;fe<t.length-1;fe++)this.totalDistance+=t[fe].dist(t[fe+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const y=FC[s.type]==="Polygon";let T=t.length;for(;T>=2&&t[T-1].equals(t[T-2]);)T--;let b=0;for(;b<T-1&&t[b].equals(t[b+1]);)b++;if(T<(y?3:2))return;c==="bevel"&&(p=1.05);const C=this.overscaling<=16?122880/(512*this.overscaling):0,M=this.segments.prepareSegment(10*T,this.layoutVertexArray,this.indexArray);let P,N,Z,ee,ae;this.e1=this.e2=-1,y&&(P=t[T-2],ae=t[b].sub(P)._unit()._perp());for(let fe=b;fe<T;fe++){if(Z=fe===T-1?y?t[b+1]:void 0:t[fe+1],Z&&t[fe].equals(Z))continue;ae&&(ee=ae),P&&(N=P),P=t[fe],ae=Z?Z.sub(P)._unit()._perp():ee,ee=ee||ae;let be=ee.add(ae);be.x===0&&be.y===0||be._unit();const Me=ee.x*ae.x+ee.y*ae.y,Pe=be.x*ae.x+be.y*ae.y,Le=Pe!==0?1/Pe:1/0,ze=2*Math.sqrt(2-2*Pe),Je=Pe<PC&&N&&Z,et=ee.x*ae.y-ee.y*ae.x>0;if(Je&&fe>b){const Ke=P.dist(N);if(Ke>2*C){const nt=P.sub(P.sub(N)._mult(C/Ke)._round());this.updateDistance(N,nt),this.addCurrentVertex(nt,ee,0,0,M),N=nt}}const st=N&&Z;let ot=st?c:y?"butt":f;if(st&&ot==="round"&&(Le<g?ot="miter":Le<=2&&(ot="fakeround")),ot==="miter"&&Le>p&&(ot="bevel"),ot==="bevel"&&(Le>2&&(ot="flipbevel"),Le<p&&(ot="miter")),N&&this.updateDistance(N,P),ot==="miter")be._mult(Le),this.addCurrentVertex(P,be,0,0,M);else if(ot==="flipbevel"){if(Le>100)be=ae.mult(-1);else{const Ke=Le*ee.add(ae).mag()/ee.sub(ae).mag();be._perp()._mult(Ke*(et?-1:1))}this.addCurrentVertex(P,be,0,0,M),this.addCurrentVertex(P,be.mult(-1),0,0,M)}else if(ot==="bevel"||ot==="fakeround"){const Ke=-Math.sqrt(Le*Le-1),nt=et?Ke:0,ct=et?0:Ke;if(N&&this.addCurrentVertex(P,ee,nt,ct,M),ot==="fakeround"){const vt=Math.round(180*ze/Math.PI/20);for(let ft=1;ft<vt;ft++){let xt=ft/vt;if(xt!==.5){const sr=xt-.5;xt+=xt*sr*(xt-1)*((1.0904+Me*(Me*(3.55645-1.43519*Me)-3.2452))*sr*sr+(.848013+Me*(.215638*Me-1.06021)))}const Kt=ae.sub(ee)._mult(xt)._add(ee)._unit()._mult(et?-1:1);this.addHalfVertex(P,Kt.x,Kt.y,!1,et,0,M)}}Z&&this.addCurrentVertex(P,ae,-nt,-ct,M)}else if(ot==="butt")this.addCurrentVertex(P,be,0,0,M);else if(ot==="square"){const Ke=N?1:-1;N||this.addCurrentVertex(P,be,Ke,Ke,M),this.addCurrentVertex(P,be,0,0,M),N&&this.addCurrentVertex(P,be,Ke,Ke,M)}else ot==="round"&&(N&&(this.addCurrentVertex(P,ee,0,0,M),this.addCurrentVertex(P,ee,1,1,M,!0)),Z&&(this.addCurrentVertex(P,ae,-1,-1,M,!0),this.addCurrentVertex(P,ae,0,0,M)));if(Je&&fe<T-1){const Ke=P.dist(Z);if(Ke>2*C){const nt=P.add(Z.sub(P)._mult(C/Ke)._round());this.updateDistance(P,nt),this.addCurrentVertex(nt,ae,0,0,M),P=nt}}}}addCurrentVertex(t,s,c,f,p,g=!1){const y=s.y*f-s.x,T=-s.y-s.x*f;this.addHalfVertex(t,s.x+s.y*c,s.y-s.x*c,g,!1,c,p),this.addHalfVertex(t,y,T,g,!0,-f,p)}addHalfVertex({x:t,y:s},c,f,p,g,y,T){this.layoutVertexArray.emplaceBack((t<<1)+(p?1:0),(s<<1)+(g?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(y===0?0:y<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const b=T.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,b),T.primitiveLength++),g?this.e2=b:this.e1=b}updateScaledDistance(){if(this.lineClips){const t=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=t*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(t,s){this.distance+=t.dist(s),this.updateScaledDistance()}}It(p0,"LineBucket",{omit:["layers","patternFeatures"]});const LC=new W({"line-cap":new k(le.layout_line["line-cap"]),"line-join":new k(le.layout_line["line-join"]),"line-miter-limit":new E(le.layout_line["line-miter-limit"]),"line-round-limit":new E(le.layout_line["line-round-limit"]),"line-sort-key":new k(le.layout_line["line-sort-key"])});var Vv={paint:new W({"line-opacity":new k(le.paint_line["line-opacity"]),"line-color":new k(le.paint_line["line-color"]),"line-translate":new E(le.paint_line["line-translate"]),"line-translate-anchor":new E(le.paint_line["line-translate-anchor"]),"line-width":new k(le.paint_line["line-width"]),"line-gap-width":new k(le.paint_line["line-gap-width"]),"line-offset":new k(le.paint_line["line-offset"]),"line-blur":new k(le.paint_line["line-blur"]),"line-dasharray":new F(le.paint_line["line-dasharray"]),"line-pattern":new F(le.paint_line["line-pattern"]),"line-gradient":new O(le.paint_line["line-gradient"])}),layout:LC};const jv=new class extends k{possiblyEvaluate(a,t){return t=new Fr(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,zoomHistory:t.zoomHistory,transition:t.transition}),super.possiblyEvaluate(a,t)}evaluate(a,t,s,c){return t=$e({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(a,t,s,c)}}(Vv.paint.properties["line-width"].specification);function Gv(a,t){return t>0?t+2*a:a}jv.useIntegerZoom=!0;const RC=ye([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),zC=ye([{name:"a_projected_pos",components:3,type:"Float32"}],4);ye([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const OC=ye([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),BC=ye([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const $v=ye([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),NC=ye([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ye([{name:"triangle",components:3,type:"Uint16"}]),ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ye([{type:"Float32",name:"offsetX"}]),ye([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);var Hn=24;const Ms=128;function mg(a,t){const{expression:s}=t;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new Fr(a+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=s;let p=0;for(;p<c.length&&c[p]<=a;)p++;p=Math.max(0,p-1);let g=p;for(;g<c.length&&c[g]<a+1;)g++;g=Math.min(c.length-1,g);const y=c[p],T=c[g];return s.kind==="composite"?{kind:"composite",minZoom:y,maxZoom:T,interpolationType:f}:{kind:"camera",minZoom:y,maxZoom:T,minSize:s.evaluate(new Fr(y)),maxSize:s.evaluate(new Fr(T)),interpolationType:f}}}function m0(a,{uSize:t,uSizeT:s},{lowerSize:c,upperSize:f}){return a.kind==="source"?c/Ms:a.kind==="composite"?Wt(c/Ms,f/Ms,s):t}function Cu(a,t){let s=0,c=0;if(a.kind==="constant")c=a.layoutSize;else if(a.kind!=="source"){const{interpolationType:f,minZoom:p,maxZoom:g}=a,y=f?ge(Ci.interpolationFactor(f,t,p,g),0,1):0;a.kind==="camera"?c=Wt(a.minSize,a.maxSize,y):s=y}return{uSizeT:s,uSize:c}}var UC=Object.freeze({__proto__:null,getSizeData:mg,evaluateSizeForFeature:m0,evaluateSizeForZoom:Cu,SIZE_PACK_FACTOR:Ms});function VC(a,t,s){return a.sections.forEach(c=>{c.text=function(f,p,g){const y=p.layout.get("text-transform").evaluate(g,{});return y==="uppercase"?f=f.toLocaleUpperCase():y==="lowercase"&&(f=f.toLocaleLowerCase()),Xi.applyArabicShaping&&(f=Xi.applyArabicShaping(f)),f}(c.text,t,s)}),a}const Af={"!":"\uFE15","#":"\uFF03",$:"\uFF04","%":"\uFF05","&":"\uFF06","(":"\uFE35",")":"\uFE36","*":"\uFF0A","+":"\uFF0B",",":"\uFE10","-":"\uFE32",".":"\u30FB","/":"\uFF0F",":":"\uFE13",";":"\uFE14","<":"\uFE3F","=":"\uFF1D",">":"\uFE40","?":"\uFE16","@":"\uFF20","[":"\uFE47","\\":"\uFF3C","]":"\uFE48","^":"\uFF3E",_:"\uFE33","`":"\uFF40","{":"\uFE37","|":"\u2015","}":"\uFE38","~":"\uFF5E","\xA2":"\uFFE0","\xA3":"\uFFE1","\xA5":"\uFFE5","\xA6":"\uFFE4","\xAC":"\uFFE2","\xAF":"\uFFE3","\u2013":"\uFE32","\u2014":"\uFE31","\u2018":"\uFE43","\u2019":"\uFE44","\u201C":"\uFE41","\u201D":"\uFE42","\u2026":"\uFE19","\u2027":"\u30FB","\u20A9":"\uFFE6","\u3001":"\uFE11","\u3002":"\uFE12","\u3008":"\uFE3F","\u3009":"\uFE40","\u300A":"\uFE3D","\u300B":"\uFE3E","\u300C":"\uFE41","\u300D":"\uFE42","\u300E":"\uFE43","\u300F":"\uFE44","\u3010":"\uFE3B","\u3011":"\uFE3C","\u3014":"\uFE39","\u3015":"\uFE3A","\u3016":"\uFE17","\u3017":"\uFE18","\uFF01":"\uFE15","\uFF08":"\uFE35","\uFF09":"\uFE36","\uFF0C":"\uFE10","\uFF0D":"\uFE32","\uFF0E":"\u30FB","\uFF1A":"\uFE13","\uFF1B":"\uFE14","\uFF1C":"\uFE3F","\uFF1E":"\uFE40","\uFF1F":"\uFE16","\uFF3B":"\uFE47","\uFF3D":"\uFE48","\uFF3F":"\uFE33","\uFF5B":"\uFE37","\uFF5C":"\u2015","\uFF5D":"\uFE38","\uFF5F":"\uFE35","\uFF60":"\uFE36","\uFF61":"\uFE12","\uFF62":"\uFE41","\uFF63":"\uFE42"};function jC(a){return a==="\uFE36"||a==="\uFE48"||a==="\uFE38"||a==="\uFE44"||a==="\uFE42"||a==="\uFE3E"||a==="\uFE3C"||a==="\uFE3A"||a==="\uFE18"||a==="\uFE40"||a==="\uFE10"||a==="\uFE13"||a==="\uFE14"||a==="\uFF40"||a==="\uFFE3"||a==="\uFE11"||a==="\uFE12"}function GC(a){return a==="\uFE35"||a==="\uFE47"||a==="\uFE37"||a==="\uFE43"||a==="\uFE41"||a==="\uFE3D"||a==="\uFE3B"||a==="\uFE39"||a==="\uFE17"||a==="\uFE3F"}var Wv=function(a,t,s,c,f){var p,g,y=8*f-c-1,T=(1<<y)-1,b=T>>1,C=-7,M=s?f-1:0,P=s?-1:1,N=a[t+M];for(M+=P,p=N&(1<<-C)-1,N>>=-C,C+=y;C>0;p=256*p+a[t+M],M+=P,C-=8);for(g=p&(1<<-C)-1,p>>=-C,C+=c;C>0;g=256*g+a[t+M],M+=P,C-=8);if(p===0)p=1-b;else{if(p===T)return g?NaN:1/0*(N?-1:1);g+=Math.pow(2,c),p-=b}return(N?-1:1)*g*Math.pow(2,p-c)},Zv=function(a,t,s,c,f,p){var g,y,T,b=8*p-f-1,C=(1<<b)-1,M=C>>1,P=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,N=c?0:p-1,Z=c?1:-1,ee=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(y=isNaN(t)?1:0,g=C):(g=Math.floor(Math.log(t)/Math.LN2),t*(T=Math.pow(2,-g))<1&&(g--,T*=2),(t+=g+M>=1?P/T:P*Math.pow(2,1-M))*T>=2&&(g++,T/=2),g+M>=C?(y=0,g=C):g+M>=1?(y=(t*T-1)*Math.pow(2,f),g+=M):(y=t*Math.pow(2,M-1)*Math.pow(2,f),g=0));f>=8;a[s+N]=255&y,N+=Z,y/=256,f-=8);for(g=g<<f|y,b+=f;b>0;a[s+N]=255&g,N+=Z,g/=256,b-=8);a[s+N-Z]|=128*ee},Cf=Dr;function Dr(a){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(a)?a:new Uint8Array(a||0),this.pos=0,this.type=0,this.length=this.buf.length}Dr.Varint=0,Dr.Fixed64=1,Dr.Bytes=2,Dr.Fixed32=5;var _g=4294967296,Hv=1/_g,Xv=typeof TextDecoder=="undefined"?null:new TextDecoder("utf8");function oo(a){return a.type===Dr.Bytes?a.readVarint()+a.pos:a.pos+1}function Iu(a,t,s){return s?4294967296*t+(a>>>0):4294967296*(t>>>0)+(a>>>0)}function qv(a,t,s){var c=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));s.realloc(c);for(var f=s.pos-1;f>=a;f--)s.buf[f+c]=s.buf[f]}function $C(a,t){for(var s=0;s<a.length;s++)t.writeVarint(a[s])}function WC(a,t){for(var s=0;s<a.length;s++)t.writeSVarint(a[s])}function ZC(a,t){for(var s=0;s<a.length;s++)t.writeFloat(a[s])}function HC(a,t){for(var s=0;s<a.length;s++)t.writeDouble(a[s])}function XC(a,t){for(var s=0;s<a.length;s++)t.writeBoolean(a[s])}function qC(a,t){for(var s=0;s<a.length;s++)t.writeFixed32(a[s])}function KC(a,t){for(var s=0;s<a.length;s++)t.writeSFixed32(a[s])}function YC(a,t){for(var s=0;s<a.length;s++)t.writeFixed64(a[s])}function JC(a,t){for(var s=0;s<a.length;s++)t.writeSFixed64(a[s])}function _0(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+16777216*a[t+3]}function Mu(a,t,s){a[s]=t,a[s+1]=t>>>8,a[s+2]=t>>>16,a[s+3]=t>>>24}function Kv(a,t){return(a[t]|a[t+1]<<8|a[t+2]<<16)+(a[t+3]<<24)}function QC(a,t,s){t.glyphs=[],a===1&&s.readMessage(e3,t)}function e3(a,t,s){if(a===3){const{id:c,bitmap:f,width:p,height:g,left:y,top:T,advance:b}=s.readMessage(t3,{});t.glyphs.push({id:c,bitmap:new so({width:p+6,height:g+6},f),metrics:{width:p,height:g,left:y,top:T,advance:b}})}else a===4?t.ascender=s.readSVarint():a===5&&(t.descender=s.readSVarint())}function t3(a,t,s){a===1?t.id=s.readVarint():a===2?t.bitmap=s.readBytes():a===3?t.width=s.readVarint():a===4?t.height=s.readVarint():a===5?t.left=s.readSVarint():a===6?t.top=s.readSVarint():a===7&&(t.advance=s.readVarint())}function gg(a){let t=0,s=0;for(const g of a)t+=g.w*g.h,s=Math.max(s,g.w);a.sort((g,y)=>y.h-g.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),s),h:1/0}];let f=0,p=0;for(const g of a)for(let y=c.length-1;y>=0;y--){const T=c[y];if(!(g.w>T.w||g.h>T.h)){if(g.x=T.x,g.y=T.y,p=Math.max(p,g.y+g.h),f=Math.max(f,g.x+g.w),g.w===T.w&&g.h===T.h){const b=c.pop();y<c.length&&(c[y]=b)}else g.h===T.h?(T.x+=g.w,T.w-=g.w):g.w===T.w?(T.y+=g.h,T.h-=g.h):(c.push({x:T.x+g.w,y:T.y,w:T.w-g.w,h:g.h}),T.y+=g.h,T.h-=g.h);break}}return{w:f,h:p,fill:t/(f*p)||0}}Dr.prototype={destroy:function(){this.buf=null},readFields:function(a,t,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),f=c>>3,p=this.pos;this.type=7&c,a(f,t,this),this.pos===p&&this.skip(c)}return t},readMessage:function(a,t){return this.readFields(a,t,this.readVarint()+this.pos)},readFixed32:function(){var a=_0(this.buf,this.pos);return this.pos+=4,a},readSFixed32:function(){var a=Kv(this.buf,this.pos);return this.pos+=4,a},readFixed64:function(){var a=_0(this.buf,this.pos)+_0(this.buf,this.pos+4)*_g;return this.pos+=8,a},readSFixed64:function(){var a=_0(this.buf,this.pos)+Kv(this.buf,this.pos+4)*_g;return this.pos+=8,a},readFloat:function(){var a=Wv(this.buf,this.pos,!0,23,4);return this.pos+=4,a},readDouble:function(){var a=Wv(this.buf,this.pos,!0,52,8);return this.pos+=8,a},readVarint:function(a){var t,s,c=this.buf;return t=127&(s=c[this.pos++]),s<128?t:(t|=(127&(s=c[this.pos++]))<<7,s<128?t:(t|=(127&(s=c[this.pos++]))<<14,s<128?t:(t|=(127&(s=c[this.pos++]))<<21,s<128?t:function(f,p,g){var y,T,b=g.buf;if(y=(112&(T=b[g.pos++]))>>4,T<128||(y|=(127&(T=b[g.pos++]))<<3,T<128)||(y|=(127&(T=b[g.pos++]))<<10,T<128)||(y|=(127&(T=b[g.pos++]))<<17,T<128)||(y|=(127&(T=b[g.pos++]))<<24,T<128)||(y|=(1&(T=b[g.pos++]))<<31,T<128))return Iu(f,y,p);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(s=c[this.pos]))<<28,a,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var a=this.readVarint();return a%2==1?(a+1)/-2:a/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var a=this.readVarint()+this.pos,t=this.pos;return this.pos=a,a-t>=12&&Xv?function(s,c,f){return Xv.decode(s.subarray(c,f))}(this.buf,t,a):function(s,c,f){for(var p="",g=c;g<f;){var y,T,b,C=s[g],M=null,P=C>239?4:C>223?3:C>191?2:1;if(g+P>f)break;P===1?C<128&&(M=C):P===2?(192&(y=s[g+1]))==128&&(M=(31&C)<<6|63&y)<=127&&(M=null):P===3?(T=s[g+2],(192&(y=s[g+1]))==128&&(192&T)==128&&((M=(15&C)<<12|(63&y)<<6|63&T)<=2047||M>=55296&&M<=57343)&&(M=null)):P===4&&(T=s[g+2],b=s[g+3],(192&(y=s[g+1]))==128&&(192&T)==128&&(192&b)==128&&((M=(15&C)<<18|(63&y)<<12|(63&T)<<6|63&b)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,P=1):M>65535&&(M-=65536,p+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),p+=String.fromCharCode(M),g+=P}return p}(this.buf,t,a)},readBytes:function(){var a=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,a);return this.pos=a,t},readPackedVarint:function(a,t){if(this.type!==Dr.Bytes)return a.push(this.readVarint(t));var s=oo(this);for(a=a||[];this.pos<s;)a.push(this.readVarint(t));return a},readPackedSVarint:function(a){if(this.type!==Dr.Bytes)return a.push(this.readSVarint());var t=oo(this);for(a=a||[];this.pos<t;)a.push(this.readSVarint());return a},readPackedBoolean:function(a){if(this.type!==Dr.Bytes)return a.push(this.readBoolean());var t=oo(this);for(a=a||[];this.pos<t;)a.push(this.readBoolean());return a},readPackedFloat:function(a){if(this.type!==Dr.Bytes)return a.push(this.readFloat());var t=oo(this);for(a=a||[];this.pos<t;)a.push(this.readFloat());return a},readPackedDouble:function(a){if(this.type!==Dr.Bytes)return a.push(this.readDouble());var t=oo(this);for(a=a||[];this.pos<t;)a.push(this.readDouble());return a},readPackedFixed32:function(a){if(this.type!==Dr.Bytes)return a.push(this.readFixed32());var t=oo(this);for(a=a||[];this.pos<t;)a.push(this.readFixed32());return a},readPackedSFixed32:function(a){if(this.type!==Dr.Bytes)return a.push(this.readSFixed32());var t=oo(this);for(a=a||[];this.pos<t;)a.push(this.readSFixed32());return a},readPackedFixed64:function(a){if(this.type!==Dr.Bytes)return a.push(this.readFixed64());var t=oo(this);for(a=a||[];this.pos<t;)a.push(this.readFixed64());return a},readPackedSFixed64:function(a){if(this.type!==Dr.Bytes)return a.push(this.readSFixed64());var t=oo(this);for(a=a||[];this.pos<t;)a.push(this.readSFixed64());return a},skip:function(a){var t=7&a;if(t===Dr.Varint)for(;this.buf[this.pos++]>127;);else if(t===Dr.Bytes)this.pos=this.readVarint()+this.pos;else if(t===Dr.Fixed32)this.pos+=4;else{if(t!==Dr.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(a,t){this.writeVarint(a<<3|t)},realloc:function(a){for(var t=this.length||16;t<this.pos+a;)t*=2;if(t!==this.length){var s=new Uint8Array(t);s.set(this.buf),this.buf=s,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(a){this.realloc(4),Mu(this.buf,a,this.pos),this.pos+=4},writeSFixed32:function(a){this.realloc(4),Mu(this.buf,a,this.pos),this.pos+=4},writeFixed64:function(a){this.realloc(8),Mu(this.buf,-1&a,this.pos),Mu(this.buf,Math.floor(a*Hv),this.pos+4),this.pos+=8},writeSFixed64:function(a){this.realloc(8),Mu(this.buf,-1&a,this.pos),Mu(this.buf,Math.floor(a*Hv),this.pos+4),this.pos+=8},writeVarint:function(a){(a=+a||0)>268435455||a<0?function(t,s){var c,f;if(t>=0?(c=t%4294967296|0,f=t/4294967296|0):(f=~(-t/4294967296),4294967295^(c=~(-t%4294967296))?c=c+1|0:(c=0,f=f+1|0)),t>=18446744073709552e3||t<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(p,g,y){y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,p>>>=7,y.buf[y.pos++]=127&p|128,y.buf[y.pos]=127&(p>>>=7)}(c,0,s),function(p,g){var y=(7&p)<<4;g.buf[g.pos++]|=y|((p>>>=3)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p|((p>>>=7)?128:0),p&&(g.buf[g.pos++]=127&p)))))}(f,s)}(a,this):(this.realloc(4),this.buf[this.pos++]=127&a|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=127&(a>>>=7)|(a>127?128:0),a<=127||(this.buf[this.pos++]=a>>>7&127))))},writeSVarint:function(a){this.writeVarint(a<0?2*-a-1:2*a)},writeBoolean:function(a){this.writeVarint(Boolean(a))},writeString:function(a){a=String(a),this.realloc(4*a.length),this.pos++;var t=this.pos;this.pos=function(c,f,p){for(var g,y,T=0;T<f.length;T++){if((g=f.charCodeAt(T))>55295&&g<57344){if(!y){g>56319||T+1===f.length?(c[p++]=239,c[p++]=191,c[p++]=189):y=g;continue}if(g<56320){c[p++]=239,c[p++]=191,c[p++]=189,y=g;continue}g=y-55296<<10|g-56320|65536,y=null}else y&&(c[p++]=239,c[p++]=191,c[p++]=189,y=null);g<128?c[p++]=g:(g<2048?c[p++]=g>>6|192:(g<65536?c[p++]=g>>12|224:(c[p++]=g>>18|240,c[p++]=g>>12&63|128),c[p++]=g>>6&63|128),c[p++]=63&g|128)}return p}(this.buf,a,this.pos);var s=this.pos-t;s>=128&&qv(t,s,this),this.pos=t-1,this.writeVarint(s),this.pos+=s},writeFloat:function(a){this.realloc(4),Zv(this.buf,a,this.pos,!0,23,4),this.pos+=4},writeDouble:function(a){this.realloc(8),Zv(this.buf,a,this.pos,!0,52,8),this.pos+=8},writeBytes:function(a){var t=a.length;this.writeVarint(t),this.realloc(t);for(var s=0;s<t;s++)this.buf[this.pos++]=a[s]},writeRawMessage:function(a,t){this.pos++;var s=this.pos;a(t,this);var c=this.pos-s;c>=128&&qv(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(a,t,s){this.writeTag(a,Dr.Bytes),this.writeRawMessage(t,s)},writePackedVarint:function(a,t){t.length&&this.writeMessage(a,$C,t)},writePackedSVarint:function(a,t){t.length&&this.writeMessage(a,WC,t)},writePackedBoolean:function(a,t){t.length&&this.writeMessage(a,XC,t)},writePackedFloat:function(a,t){t.length&&this.writeMessage(a,ZC,t)},writePackedDouble:function(a,t){t.length&&this.writeMessage(a,HC,t)},writePackedFixed32:function(a,t){t.length&&this.writeMessage(a,qC,t)},writePackedSFixed32:function(a,t){t.length&&this.writeMessage(a,KC,t)},writePackedFixed64:function(a,t){t.length&&this.writeMessage(a,YC,t)},writePackedSFixed64:function(a,t){t.length&&this.writeMessage(a,JC,t)},writeBytesField:function(a,t){this.writeTag(a,Dr.Bytes),this.writeBytes(t)},writeFixed32Field:function(a,t){this.writeTag(a,Dr.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(a,t){this.writeTag(a,Dr.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(a,t){this.writeTag(a,Dr.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(a,t){this.writeTag(a,Dr.Fixed64),this.writeSFixed64(t)},writeVarintField:function(a,t){this.writeTag(a,Dr.Varint),this.writeVarint(t)},writeSVarintField:function(a,t){this.writeTag(a,Dr.Varint),this.writeSVarint(t)},writeStringField:function(a,t){this.writeTag(a,Dr.Bytes),this.writeString(t)},writeFloatField:function(a,t){this.writeTag(a,Dr.Fixed32),this.writeFloat(t)},writeDoubleField:function(a,t){this.writeTag(a,Dr.Fixed64),this.writeDouble(t)},writeBooleanField:function(a,t){this.writeVarintField(a,Boolean(t))}};class xg{constructor(t,{pixelRatio:s,version:c,stretchX:f,stretchY:p,content:g}){this.paddedRect=t,this.pixelRatio=s,this.stretchX=f,this.stretchY=p,this.content=g,this.version=c}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Yv{constructor(t,s){const c={},f={};this.haveRenderCallbacks=[];const p=[];this.addImages(t,c,p),this.addImages(s,f,p);const{w:g,h:y}=gg(p),T=new Yi({width:g||1,height:y||1});for(const b in t){const C=t[b],M=c[b].paddedRect;Yi.copy(C.data,T,{x:0,y:0},{x:M.x+1,y:M.y+1},C.data)}for(const b in s){const C=s[b],M=f[b].paddedRect,P=M.x+1,N=M.y+1,Z=C.data.width,ee=C.data.height;Yi.copy(C.data,T,{x:0,y:0},{x:P,y:N},C.data),Yi.copy(C.data,T,{x:0,y:ee-1},{x:P,y:N-1},{width:Z,height:1}),Yi.copy(C.data,T,{x:0,y:0},{x:P,y:N+ee},{width:Z,height:1}),Yi.copy(C.data,T,{x:Z-1,y:0},{x:P-1,y:N},{width:1,height:ee}),Yi.copy(C.data,T,{x:0,y:0},{x:P+Z,y:N},{width:1,height:ee})}this.image=T,this.iconPositions=c,this.patternPositions=f}addImages(t,s,c){for(const f in t){const p=t[f],g={x:0,y:0,w:p.data.width+2,h:p.data.height+2};c.push(g),s[f]=new xg(g,p),p.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(t,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>t.hasImage(c)),t.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in t.updatedImages)this.patchUpdatedImage(this.iconPositions[c],t.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],t.getImage(c),s)}patchUpdatedImage(t,s,c){if(!t||!s||t.version===s.version)return;t.version=s.version;const[f,p]=t.tl;c.update(s.data,void 0,{x:f,y:p})}}It(xg,"ImagePosition"),It(Yv,"ImageAtlas");const ga={horizontal:1,vertical:2,horizontalOnly:3};class If{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(t,s){const c=new If;return c.scale=t||1,c.fontStack=s,c}static forImage(t){const s=new If;return s.imageName=t,s}}class Du{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,s){const c=new Du;for(let f=0;f<t.sections.length;f++){const p=t.sections[f];p.image?c.addImageSection(p):c.addTextSection(p,s)}return c}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCharCode(t){return this.text.charCodeAt(t)}verticalizePunctuation(t){this.text=function(s,c){let f="";for(let p=0;p<s.length;p++){const g=s.charCodeAt(p+1)||null,y=s.charCodeAt(p-1)||null;f+=!c&&(g&&_u(g)&&!Af[s[p+1]]||y&&_u(y)&&!Af[s[p-1]])||!Af[s[p]]?s[p]:Af[s[p]]}return f}(this.text,t)}trim(){let t=0;for(let c=0;c<this.text.length&&g0[this.text.charCodeAt(c)];c++)t++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=t&&g0[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(t,s),this.sectionIndex=this.sectionIndex.slice(t,s)}substring(t,s){const c=new Du;return c.text=this.text.substring(t,s),c.sectionIndex=this.sectionIndex.slice(t,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,s)=>Math.max(t,this.sections[s].scale),0)}addTextSection(t,s){this.text+=t.text,this.sections.push(If.forText(t.scale,t.fontStack||s));const c=this.sections.length-1;for(let f=0;f<t.text.length;++f)this.sectionIndex.push(c)}addImageSection(t){const s=t.image?t.image.name:"";if(s.length===0)return void He("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(If.forImage(s)),this.sectionIndex.push(this.sections.length-1)):He("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function yg(a,t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee){const ae=Du.fromFeature(a,f);let fe;M===ga.vertical&&ae.verticalizePunctuation(P);const{processBidirectionalText:be,processStyledBidirectionalText:Me}=Xi;if(be&&ae.sections.length===1){fe=[];const ze=be(ae.toString(),vg(ae,b,p,t,c,N,Z));for(const Je of ze){const et=new Du;et.text=Je,et.sections=ae.sections;for(let st=0;st<Je.length;st++)et.sectionIndex.push(0);fe.push(et)}}else if(Me){fe=[];const ze=Me(ae.text,ae.sectionIndex,vg(ae,b,p,t,c,N,Z));for(const Je of ze){const et=new Du;et.text=Je[0],et.sectionIndex=Je[1],et.sections=ae.sections,fe.push(et)}}else fe=function(ze,Je){const et=[],st=ze.text;let ot=0;for(const Ke of Je)et.push(ze.substring(ot,Ke)),ot=Ke;return ot<st.length&&et.push(ze.substring(ot,st.length)),et}(ae,vg(ae,b,p,t,c,N,Z));const Pe=[],Le={positionedLines:Pe,text:ae.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:M,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ze,Je,et,st,ot,Ke,nt,ct,vt,ft,xt,Kt){let sr=0,Yt=0,tr=0;const Nt=ct==="right"?1:ct==="left"?0:.5;let Ct=!1;for(const gr of ot){const ur=gr.getSections();for(const kr of ur){if(kr.imageName)continue;const Wr=Je[kr.fontStack];if(Wr&&(Ct=Wr.ascender!==void 0&&Wr.descender!==void 0,!Ct))break}if(!Ct)break}let cr=0;for(const gr of ot){gr.trim();const ur=gr.getMaxScale(),kr=(ur-1)*Hn,Wr={positionedGlyphs:[],lineOffset:0};ze.positionedLines[cr]=Wr;const Yr=Wr.positionedGlyphs;let xn=0;if(!gr.length()){Yt+=Ke,++cr;continue}let An=0,ea=0;for(let Mr=0;Mr<gr.length();Mr++){const li=gr.getSection(Mr),ta=gr.getSectionIndex(Mr),Nn=gr.getCharCode(Mr);let Cn=li.scale,Ur=null,Lr=null,Ri=null,ci=Hn,ln=0;const ui=!(vt===ga.horizontal||!xt&&!mu(Nn)||xt&&(g0[Nn]||(_r=Nn,Op(_r)||uu(_r)||Kl(_r)||nf(_r)||du(_r))));if(li.imageName){const Yn=st[li.imageName];if(!Yn)continue;Ri=li.imageName,ze.iconsInText=ze.iconsInText||!0,Lr=Yn.paddedRect;const In=Yn.displaySize;Cn=Cn*Hn/Kt,Ur={width:In[0],height:In[1],left:1,top:-3,advance:ui?In[1]:In[0],localGlyph:!1},ln=Ct?-Ur.height*Cn:ur*Hn-17-In[1]*Cn,ci=Ur.advance;const Fa=(ui?In[0]:In[1])*Cn-Hn*ur;Fa>0&&Fa>xn&&(xn=Fa)}else{const Yn=et[li.fontStack];if(!Yn)continue;Yn[Nn]&&(Lr=Yn[Nn]);const In=Je[li.fontStack];if(!In)continue;const Fa=In.glyphs[Nn];if(!Fa)continue;if(Ur=Fa.metrics,ci=Nn!==8203?Hn:0,Ct){const el=In.ascender!==void 0?Math.abs(In.ascender):0,Nf=In.descender!==void 0?Math.abs(In.descender):0,Uf=(el+Nf)*Cn;An<Uf&&(An=Uf,ea=(el-Nf)/2*Cn),ln=-el*Cn}else ln=(ur-Cn)*Hn-17}ui?(ze.verticalizable=!0,Yr.push({glyph:Nn,imageName:Ri,x:sr,y:Yt+ln,vertical:ui,scale:Cn,localGlyph:Ur.localGlyph,fontStack:li.fontStack,sectionIndex:ta,metrics:Ur,rect:Lr}),sr+=ci*Cn+ft):(Yr.push({glyph:Nn,imageName:Ri,x:sr,y:Yt+ln,vertical:ui,scale:Cn,localGlyph:Ur.localGlyph,fontStack:li.fontStack,sectionIndex:ta,metrics:Ur,rect:Lr}),sr+=Ur.advance*Cn+ft)}Yr.length!==0&&(tr=Math.max(sr-ft,tr),Ct?r2(Yr,Nt,xn,ea,Ke*ur/2):r2(Yr,Nt,xn,0,Ke/2)),sr=0;const Li=Ke*ur+xn;Wr.lineOffset=Math.max(xn,kr),Yt+=Li,++cr}var _r;const _n=Yt,{horizontalAlign:Pr,verticalAlign:gn}=wg(nt);(function(gr,ur,kr,Wr,Yr,xn){const An=(ur-kr)*Yr,ea=-xn*Wr;for(const Li of gr)for(const Mr of Li.positionedGlyphs)Mr.x+=An,Mr.y+=ea})(ze.positionedLines,Nt,Pr,gn,tr,_n),ze.top+=-gn*_n,ze.bottom=ze.top+_n,ze.left+=-Pr*tr,ze.right=ze.left+tr,ze.hasBaseline=Ct}(Le,t,s,c,fe,g,y,T,M,b,P,ee),!function(ze){for(const Je of ze)if(Je.positionedGlyphs.length!==0)return!1;return!0}(Pe)&&Le}const g0={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},r3={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Jv(a,t,s,c,f,p){if(t.imageName){const g=c[t.imageName];return g?g.displaySize[0]*t.scale*Hn/p+f:0}{const g=s[t.fontStack],y=g&&g.glyphs[a];return y?y.metrics.advance*t.scale+f:0}}function Qv(a,t,s,c){const f=Math.pow(a-t,2);return c?a<t?f/2:2*f:f+Math.abs(s)*s}function n3(a,t,s){let c=0;return a===10&&(c-=1e4),s&&(c+=150),a!==40&&a!==65288||(c+=50),t!==41&&t!==65289||(c+=50),c}function e2(a,t,s,c,f,p){let g=null,y=Qv(t,s,f,p);for(const T of c){const b=Qv(t-T.x,s,f,p)+T.badness;b<=y&&(g=T,y=b)}return{index:a,x:t,priorBreak:g,badness:y}}function t2(a){return a?t2(a.priorBreak).concat(a.index):[]}function vg(a,t,s,c,f,p,g){if(p!=="point")return[];if(!a)return[];const y=[],T=function(P,N,Z,ee,ae,fe){let be=0;for(let Me=0;Me<P.length();Me++){const Pe=P.getSection(Me);be+=Jv(P.getCharCode(Me),Pe,ee,ae,N,fe)}return be/Math.max(1,Math.ceil(be/Z))}(a,t,s,c,f,g),b=a.text.indexOf("\u200B")>=0;let C=0;for(let P=0;P<a.length();P++){const N=a.getSection(P),Z=a.getCharCode(P);if(g0[Z]||(C+=Jv(Z,N,c,f,t,g)),P<a.length()-1){const ee=!((M=Z)<11904||!(Up(M)||Np(M)||No(M)||Jl(M)||Gp(M)||Qh(M)||Vp(M)||hu(M)||$p(M)||rf(M)||jp(M)||af(M)||Yl(M)||ef(M)||Bp(M)||tf(M)||fu(M)||Xp(M)||Zp(M)||Wp(M)));(r3[Z]||ee||N.imageName)&&y.push(e2(P+1,C,T,y,n3(Z,a.getCharCode(P+1),ee&&b),!1))}}var M;return t2(e2(a.length(),C,T,y,0,!0))}function wg(a){let t=.5,s=.5;switch(a){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(a){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:t,verticalAlign:s}}function r2(a,t,s,c,f){if(!(t||s||c||f))return;const p=a.length-1,g=a[p],y=(g.x+g.metrics.advance*g.scale)*t;for(let T=0;T<=p;T++)a[T].x-=y,a[T].y+=s+c+f}function i3(a,t,s){const{horizontalAlign:c,verticalAlign:f}=wg(s),p=t[0]-a.displaySize[0]*c,g=t[1]-a.displaySize[1]*f;return{image:a,top:g,bottom:g+a.displaySize[1],left:p,right:p+a.displaySize[0]}}function n2(a,t,s,c,f,p){const g=a.image;let y;if(g.content){const ae=g.content,fe=g.pixelRatio||1;y=[ae[0]/fe,ae[1]/fe,g.displaySize[0]-ae[2]/fe,g.displaySize[1]-ae[3]/fe]}const T=t.left*p,b=t.right*p;let C,M,P,N;s==="width"||s==="both"?(N=f[0]+T-c[3],M=f[0]+b+c[1]):(N=f[0]+(T+b-g.displaySize[0])/2,M=N+g.displaySize[0]);const Z=t.top*p,ee=t.bottom*p;return s==="height"||s==="both"?(C=f[1]+Z-c[0],P=f[1]+ee+c[2]):(C=f[1]+(Z+ee-g.displaySize[1])/2,P=C+g.displaySize[1]),{image:g,top:C,right:M,bottom:P,left:N,collisionPadding:y}}class lo extends D{constructor(t,s,c,f,p){super(t,s),this.angle=f,this.z=c,p!==void 0&&(this.segment=p)}clone(){return new lo(this.x,this.y,this.z,this.angle,this.segment)}}function i2(a,t,s,c,f){if(t.segment===void 0)return!0;let p=t,g=t.segment+1,y=0;for(;y>-s/2;){if(g--,g<0)return!1;y-=a[g].dist(p),p=a[g]}y+=a[g].dist(a[g+1]),g++;const T=[];let b=0;for(;y<s/2;){const C=a[g],M=a[g+1];if(!M)return!1;let P=a[g-1].angleTo(C)-C.angleTo(M);for(P=Math.abs((P+3*Math.PI)%(2*Math.PI)-Math.PI),T.push({distance:y,angleDelta:P}),b+=P;y-T[0].distance>c;)b-=T.shift().angleDelta;if(b>f)return!1;g++,y+=C.dist(M)}return!0}function a2(a){let t=0;for(let s=0;s<a.length-1;s++)t+=a[s].dist(a[s+1]);return t}function s2(a,t,s){return a?.6*t*s:0}function o2(a,t){return Math.max(a?a.right-a.left:0,t?t.right-t.left:0)}function a3(a,t,s,c,f,p){const g=s2(s,f,p),y=o2(s,c)*p;let T=0;const b=a2(a)/2;for(let C=0;C<a.length-1;C++){const M=a[C],P=a[C+1],N=M.dist(P);if(T+N>b){const Z=(b-T)/N,ee=Wt(M.x,P.x,Z),ae=Wt(M.y,P.y,Z),fe=new lo(ee,ae,0,P.angleTo(M),C);return!g||i2(a,fe,y,g,t)?fe:void 0}T+=N}}function s3(a,t,s,c,f,p,g,y,T){const b=s2(c,p,g),C=o2(c,f),M=C*g,P=a[0].x===0||a[0].x===T||a[0].y===0||a[0].y===T;return t-M<t/4&&(t=M+t/4),l2(a,P?t/2*y%t:(C/2+2*p)*g*y%t,t,b,s,M,P,!1,T)}function l2(a,t,s,c,f,p,g,y,T){const b=p/2,C=a2(a);let M=0,P=t-s,N=[];for(let Z=0;Z<a.length-1;Z++){const ee=a[Z],ae=a[Z+1],fe=ee.dist(ae),be=ae.angleTo(ee);for(;P+s<M+fe;){P+=s;const Me=(P-M)/fe,Pe=Wt(ee.x,ae.x,Me),Le=Wt(ee.y,ae.y,Me);if(Pe>=0&&Pe<T&&Le>=0&&Le<T&&P-b>=0&&P+b<=C){const ze=new lo(Pe,Le,0,be,Z);ze._round(),c&&!i2(a,ze,p,c,f)||N.push(ze)}}M+=fe}return y||N.length||g||(N=l2(a,M/2,s,c,f,p,g,!0,T)),N}function c2(a,t,s,c,f){const p=[];for(let g=0;g<a.length;g++){const y=a[g];let T;for(let b=0;b<y.length-1;b++){let C=y[b],M=y[b+1];C.x<t&&M.x<t||(C.x<t?C=new D(t,C.y+(t-C.x)/(M.x-C.x)*(M.y-C.y))._round():M.x<t&&(M=new D(t,C.y+(t-C.x)/(M.x-C.x)*(M.y-C.y))._round()),C.y<s&&M.y<s||(C.y<s?C=new D(C.x+(s-C.y)/(M.y-C.y)*(M.x-C.x),s)._round():M.y<s&&(M=new D(C.x+(s-C.y)/(M.y-C.y)*(M.x-C.x),s)._round()),C.x>=c&&M.x>=c||(C.x>=c?C=new D(c,C.y+(c-C.x)/(M.x-C.x)*(M.y-C.y))._round():M.x>=c&&(M=new D(c,C.y+(c-C.x)/(M.x-C.x)*(M.y-C.y))._round()),C.y>=f&&M.y>=f||(C.y>=f?C=new D(C.x+(f-C.y)/(M.y-C.y)*(M.x-C.x),f)._round():M.y>=f&&(M=new D(C.x+(f-C.y)/(M.y-C.y)*(M.x-C.x),f)._round()),T&&C.equals(T[T.length-1])||(T=[C],p.push(T)),T.push(M)))))}}return p}It(lo,"Anchor");const Mf=1e20;function u2(a,t,s,c,f,p,g,y,T){for(let b=t;b<t+c;b++)h2(a,s*p+b,p,f,g,y,T);for(let b=s;b<s+f;b++)h2(a,b*p+t,1,c,g,y,T)}function h2(a,t,s,c,f,p,g){p[0]=0,g[0]=-Mf,g[1]=Mf,f[0]=a[t];for(let y=1,T=0,b=0;y<c;y++){f[y]=a[t+y*s];const C=y*y;do{const M=p[T];b=(f[y]-f[M]+C-M*M)/(y-M)/2}while(b<=g[T]&&--T>-1);T++,p[T]=y,g[T]=b,g[T+1]=Mf}for(let y=0,T=0;y<c;y++){for(;g[T+1]<y;)T++;const b=p[T],C=y-b;a[t+y*s]=f[b]+C*C}}const Tg={none:0,ideographs:1,all:2};class Fu{constructor(t,s,c){this.requestManager=t,this.localGlyphMode=s,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t){this.url=t}getGlyphs(t,s){const c=[];for(const f in t)for(const p of t[f])c.push({stack:f,id:p});Ie(c,({stack:f,id:p},g)=>{let y=this.entries[f];y||(y=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let T=y.glyphs[p];if(T!==void 0)return void g(null,{stack:f,id:p,glyph:T});if(T=this._tinySDF(y,f,p),T)return y.glyphs[p]=T,void g(null,{stack:f,id:p,glyph:T});const b=Math.floor(p/256);if(256*b>65535)return void g(new Error("glyphs > 65535 not supported"));if(y.ranges[b])return void g(null,{stack:f,id:p,glyph:T});let C=y.requests[b];C||(C=y.requests[b]=[],Fu.loadGlyphRange(f,b,this.url,this.requestManager,(M,P)=>{if(P){y.ascender=P.ascender,y.descender=P.descender;for(const N in P.glyphs)this._doesCharSupportLocalGlyph(+N)||(y.glyphs[+N]=P.glyphs[+N]);y.ranges[b]=!0}for(const N of C)N(M,P);delete y.requests[b]})),C.push((M,P)=>{M?g(M):P&&g(null,{stack:f,id:p,glyph:P.glyphs[p]||null})})},(f,p)=>{if(f)s(f);else if(p){const g={};for(const{stack:y,id:T,glyph:b}of p)g[y]===void 0&&(g[y]={}),g[y].glyphs===void 0&&(g[y].glyphs={}),g[y].glyphs[T]=b&&{id:b.id,bitmap:b.bitmap.clone(),metrics:b.metrics},g[y].ascender=this.entries[y].ascender,g[y].descender=this.entries[y].descender;s(null,g)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Tg.none&&(this.localGlyphMode===Tg.all?!!this.localFontFamily:!!this.localFontFamily&&(rf(t)||Hp(t)||Yl(t)||fu(t)||hu(t)))}_tinySDF(t,s,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let p=t.tinySDF;if(!p){let ee="400";/bold/i.test(s)?ee="900":/medium/i.test(s)?ee="500":/light/i.test(s)&&(ee="200"),p=t.tinySDF=new Fu.TinySDF({fontFamily:f,fontWeight:ee,fontSize:48,buffer:6,radius:16}),p.fontWeight=ee}if(this.localGlyphs[p.fontWeight][c])return this.localGlyphs[p.fontWeight][c];const g=String.fromCharCode(c),{data:y,width:T,height:b,glyphWidth:C,glyphHeight:M,glyphLeft:P,glyphTop:N,glyphAdvance:Z}=p.draw(g);return this.localGlyphs[p.fontWeight][c]={id:c,bitmap:new so({width:T,height:b},y),metrics:{width:C/2,height:M/2,left:P/2,top:N/2-27,advance:Z/2,localGlyph:!0}}}}function f2(a,t,s,c){const f=[],p=a.image,g=p.pixelRatio,y=p.paddedRect.w-2,T=p.paddedRect.h-2,b=a.right-a.left,C=a.bottom-a.top,M=p.stretchX||[[0,y]],P=p.stretchY||[[0,T]],N=(Ke,nt)=>Ke+nt[1]-nt[0],Z=M.reduce(N,0),ee=P.reduce(N,0),ae=y-Z,fe=T-ee;let be=0,Me=Z,Pe=0,Le=ee,ze=0,Je=ae,et=0,st=fe;if(p.content&&c){const Ke=p.content;be=x0(M,0,Ke[0]),Pe=x0(P,0,Ke[1]),Me=x0(M,Ke[0],Ke[2]),Le=x0(P,Ke[1],Ke[3]),ze=Ke[0]-be,et=Ke[1]-Pe,Je=Ke[2]-Ke[0]-Me,st=Ke[3]-Ke[1]-Le}const ot=(Ke,nt,ct,vt)=>{const ft=y0(Ke.stretch-be,Me,b,a.left),xt=v0(Ke.fixed-ze,Je,Ke.stretch,Z),Kt=y0(nt.stretch-Pe,Le,C,a.top),sr=v0(nt.fixed-et,st,nt.stretch,ee),Yt=y0(ct.stretch-be,Me,b,a.left),tr=v0(ct.fixed-ze,Je,ct.stretch,Z),Nt=y0(vt.stretch-Pe,Le,C,a.top),Ct=v0(vt.fixed-et,st,vt.stretch,ee),cr=new D(ft,Kt),_r=new D(Yt,Kt),_n=new D(Yt,Nt),Pr=new D(ft,Nt),gn=new D(xt/g,sr/g),gr=new D(tr/g,Ct/g),ur=t*Math.PI/180;if(ur){const Yr=Math.sin(ur),xn=Math.cos(ur),An=[xn,-Yr,Yr,xn];cr._matMult(An),_r._matMult(An),Pr._matMult(An),_n._matMult(An)}const kr=Ke.stretch+Ke.fixed,Wr=nt.stretch+nt.fixed;return{tl:cr,tr:_r,bl:Pr,br:_n,tex:{x:p.paddedRect.x+1+kr,y:p.paddedRect.y+1+Wr,w:ct.stretch+ct.fixed-kr,h:vt.stretch+vt.fixed-Wr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:gn,pixelOffsetBR:gr,minFontScaleX:Je/g/b,minFontScaleY:st/g/C,isSDF:s}};if(c&&(p.stretchX||p.stretchY)){const Ke=d2(M,ae,Z),nt=d2(P,fe,ee);for(let ct=0;ct<Ke.length-1;ct++){const vt=Ke[ct],ft=Ke[ct+1];for(let xt=0;xt<nt.length-1;xt++)f.push(ot(vt,nt[xt],ft,nt[xt+1]))}}else f.push(ot({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:y+1},{fixed:0,stretch:T+1}));return f}function x0(a,t,s){let c=0;for(const f of a)c+=Math.max(t,Math.min(s,f[1]))-Math.max(t,Math.min(s,f[0]));return c}function d2(a,t,s){const c=[{fixed:-1,stretch:0}];for(const[f,p]of a){const g=c[c.length-1];c.push({fixed:f-g.stretch,stretch:g.stretch}),c.push({fixed:f-g.stretch,stretch:g.stretch+(p-f)})}return c.push({fixed:t+1,stretch:s}),c}function y0(a,t,s,c){return a/t*s+c}function v0(a,t,s,c){return a-t*s/c}function o3(a,t,s,c){const f=t+a.positionedLines[c].lineOffset;return c===0?s+f/2:s+(f+(t+a.positionedLines[c-1].lineOffset))/2}Fu.loadGlyphRange=function(a,t,s,c,f){const p=256*t,g=p+255,y=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",a).replace("{range}",`${p}-${g}`),de.Glyphs);we(y,(T,b)=>{if(T)f(T);else if(b){const C={},M=function(P){return new Cf(P).readFields(QC,{})}(b);for(const P of M.glyphs)C[P.id]=P;f(null,{glyphs:C,ascender:M.ascender,descender:M.descender})}})},Fu.TinySDF=class{constructor({fontSize:a=24,buffer:t=3,radius:s=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:p="normal",fontStyle:g="normal"}){this.buffer=t,this.cutoff=c,this.radius=s;const y=this.size=a+4*t,T=this._createCanvas(y),b=this.ctx=T.getContext("2d",{willReadFrequently:!0});b.font=`${g} ${p} ${a}px ${f}`,b.textBaseline="alphabetic",b.textAlign="left",b.fillStyle="black",this.gridOuter=new Float64Array(y*y),this.gridInner=new Float64Array(y*y),this.f=new Float64Array(y),this.z=new Float64Array(y+1),this.v=new Uint16Array(y)}_createCanvas(a){const t=document.createElement("canvas");return t.width=t.height=a,t}draw(a){const{width:t,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:p}=this.ctx.measureText(a),g=Math.floor(s),y=Math.min(this.size-this.buffer,Math.ceil(p-f)),T=Math.min(this.size-this.buffer,Math.ceil(s)+Math.ceil(c)),b=y+2*this.buffer,C=T+2*this.buffer,M=b*C,P=new Uint8ClampedArray(M),N={data:P,width:b,height:C,glyphWidth:y,glyphHeight:T,glyphTop:g,glyphLeft:0,glyphAdvance:t};if(y===0||T===0)return N;const{ctx:Z,buffer:ee,gridInner:ae,gridOuter:fe}=this;Z.clearRect(ee,ee,y,T),Z.fillText(a,ee,ee+g+1);const be=Z.getImageData(ee,ee,y,T);fe.fill(Mf,0,M),ae.fill(0,0,M);for(let Me=0;Me<T;Me++)for(let Pe=0;Pe<y;Pe++){const Le=be.data[4*(Me*y+Pe)+3]/255;if(Le===0)continue;const ze=(Me+ee)*b+Pe+ee;if(Le===1)fe[ze]=0,ae[ze]=Mf;else{const Je=.5-Le;fe[ze]=Je>0?Je*Je:0,ae[ze]=Je<0?Je*Je:0}}u2(fe,0,0,b,C,b,this.f,this.v,this.z),u2(ae,ee,ee,y,T,b,this.f,this.v,this.z);for(let Me=0;Me<M;Me++){const Pe=Math.sqrt(fe[Me])-Math.sqrt(ae[Me]);P[Me]=Math.round(255-255*(Pe/this.radius+this.cutoff))}return N}};class l3{constructor(t=[],s=c3){if(this.data=t,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(t){this.data.push(t),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const t=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:s,compare:c}=this,f=s[t];for(;t>0;){const p=t-1>>1,g=s[p];if(c(f,g)>=0)break;s[t]=g,t=p}s[t]=f}_down(t){const{data:s,compare:c}=this,f=this.length>>1,p=s[t];for(;t<f;){let g=1+(t<<1),y=s[g];const T=g+1;if(T<this.length&&c(s[T],y)<0&&(g=T,y=s[T]),c(y,p)>=0)break;s[t]=y,t=g}s[t]=p}}function c3(a,t){return a<t?-1:a>t?1:0}function u3(a,t=1,s=!1){let c=1/0,f=1/0,p=-1/0,g=-1/0;const y=a[0];for(let N=0;N<y.length;N++){const Z=y[N];(!N||Z.x<c)&&(c=Z.x),(!N||Z.y<f)&&(f=Z.y),(!N||Z.x>p)&&(p=Z.x),(!N||Z.y>g)&&(g=Z.y)}const T=Math.min(p-c,g-f);let b=T/2;const C=new l3([],h3);if(T===0)return new D(c,f);for(let N=c;N<p;N+=T)for(let Z=f;Z<g;Z+=T)C.push(new Pu(N+b,Z+b,b,a));let M=function(N){let Z=0,ee=0,ae=0;const fe=N[0];for(let be=0,Me=fe.length,Pe=Me-1;be<Me;Pe=be++){const Le=fe[be],ze=fe[Pe],Je=Le.x*ze.y-ze.x*Le.y;ee+=(Le.x+ze.x)*Je,ae+=(Le.y+ze.y)*Je,Z+=3*Je}return new Pu(ee/Z,ae/Z,0,N)}(a),P=C.length;for(;C.length;){const N=C.pop();(N.d>M.d||!M.d)&&(M=N,s&&console.log("found best %d after %d probes",Math.round(1e4*N.d)/1e4,P)),N.max-M.d<=t||(b=N.h/2,C.push(new Pu(N.p.x-b,N.p.y-b,b,a)),C.push(new Pu(N.p.x+b,N.p.y-b,b,a)),C.push(new Pu(N.p.x-b,N.p.y+b,b,a)),C.push(new Pu(N.p.x+b,N.p.y+b,b,a)),P+=4)}return s&&(console.log(`num probes: ${P}`),console.log(`best distance: ${M.d}`)),M.p}function h3(a,t){return t.max-a.max}function Pu(a,t,s,c){this.p=new D(a,t),this.h=s,this.d=function(f,p){let g=!1,y=1/0;for(let T=0;T<p.length;T++){const b=p[T];for(let C=0,M=b.length,P=M-1;C<M;P=C++){const N=b[C],Z=b[P];N.y>f.y!=Z.y>f.y&&f.x<(Z.x-N.x)*(f.y-N.y)/(Z.y-N.y)+N.x&&(g=!g),y=Math.min(y,cv(f,N,Z))}}return(g?1:-1)*Math.sqrt(y)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}const Eg=Number.POSITIVE_INFINITY,f3=Math.sqrt(2);function p2(a,t){return t[1]!==Eg?function(s,c,f){let p=0,g=0;switch(c=Math.abs(c),f=Math.abs(f),s){case"top-right":case"top-left":case"top":g=f-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-f}switch(s){case"top-right":case"bottom-right":case"right":p=-c;break;case"top-left":case"bottom-left":case"left":p=c}return[p,g]}(a,t[0],t[1]):function(s,c){let f=0,p=0;c<0&&(c=0);const g=c/f3;switch(s){case"top-right":case"top-left":p=g-7;break;case"bottom-right":case"bottom-left":p=7-g;break;case"bottom":p=7-c;break;case"top":p=c-7}switch(s){case"top-right":case"bottom-right":f=-g;break;case"top-left":case"bottom-left":f=g;break;case"left":f=c;break;case"right":f=-c}return[f,p]}(a,t[0])}function d3(a,t,s,c,f,p,g,y,T,b){a.createArrays(),a.tilePixelRatio=Jt/(512*a.overscaling),a.compareText={},a.iconsNeedLinear=!1;const C=a.layers[0].layout,M=a.layers[0]._unevaluatedLayout._values,P={};if(a.textSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ae}=a.textSizeData;P.compositeTextSizes=[M["text-size"].possiblyEvaluate(new Fr(ee),y),M["text-size"].possiblyEvaluate(new Fr(ae),y)]}if(a.iconSizeData.kind==="composite"){const{minZoom:ee,maxZoom:ae}=a.iconSizeData;P.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new Fr(ee),y),M["icon-size"].possiblyEvaluate(new Fr(ae),y)]}P.layoutTextSize=M["text-size"].possiblyEvaluate(new Fr(T+1),y),P.layoutIconSize=M["icon-size"].possiblyEvaluate(new Fr(T+1),y),P.textMaxSize=M["text-size"].possiblyEvaluate(new Fr(18),y);const N=C.get("text-rotation-alignment")==="map"&&C.get("symbol-placement")!=="point",Z=C.get("text-size");for(const ee of a.features){const ae=C.get("text-font").evaluate(ee,{},y).join(","),fe=Z.evaluate(ee,{},y),be=P.layoutTextSize.evaluate(ee,{},y),Me=(P.layoutIconSize.evaluate(ee,{},y),{horizontal:{},vertical:void 0}),Pe=ee.text;let Le,ze=[0,0];if(Pe){const st=Pe.toString(),ot=C.get("text-letter-spacing").evaluate(ee,{},y)*Hn,Ke=C.get("text-line-height").evaluate(ee,{},y)*Hn,nt=Kp(st)?ot:0,ct=C.get("text-anchor").evaluate(ee,{},y),vt=C.get("text-variable-anchor");if(!vt){const tr=C.get("text-radial-offset").evaluate(ee,{},y);ze=tr?p2(ct,[tr*Hn,Eg]):C.get("text-offset").evaluate(ee,{},y).map(Nt=>Nt*Hn)}let ft=N?"center":C.get("text-justify").evaluate(ee,{},y);const xt=C.get("symbol-placement"),Kt=xt==="point",sr=xt==="point"?C.get("text-max-width").evaluate(ee,{},y)*Hn:0,Yt=tr=>{a.allowVerticalPlacement&&pu(st)&&(Me.vertical=yg(Pe,t,s,f,ae,sr,Ke,ct,tr,nt,ze,ga.vertical,!0,xt,be,fe))};if(!N&&vt){const tr=ft==="auto"?vt.map(Ct=>bg(Ct)):[ft];let Nt=!1;for(let Ct=0;Ct<tr.length;Ct++){const cr=tr[Ct];if(!Me.horizontal[cr])if(Nt)Me.horizontal[cr]=Me.horizontal[0];else{const _r=yg(Pe,t,s,f,ae,sr,Ke,"center",cr,nt,ze,ga.horizontal,!1,xt,be,fe);_r&&(Me.horizontal[cr]=_r,Nt=_r.positionedLines.length===1)}}Yt("left")}else{if(ft==="auto"&&(ft=bg(ct)),Kt||C.get("text-writing-mode").indexOf("horizontal")>=0||!pu(st)){const tr=yg(Pe,t,s,f,ae,sr,Ke,ct,ft,nt,ze,ga.horizontal,!1,xt,be,fe);tr&&(Me.horizontal[ft]=tr)}Yt(xt==="point"?"left":ft)}}let Je=!1;if(ee.icon&&ee.icon.name){const st=c[ee.icon.name];st&&(Le=i3(f[ee.icon.name],C.get("icon-offset").evaluate(ee,{},y),C.get("icon-anchor").evaluate(ee,{},y)),Je=st.sdf,a.sdfIcons===void 0?a.sdfIcons=st.sdf:a.sdfIcons!==st.sdf&&He("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(st.pixelRatio!==a.pixelRatio||C.get("icon-rotate").constantOr(1)!==0)&&(a.iconsNeedLinear=!0))}const et=_2(Me.horizontal)||Me.vertical;a.iconsInText||(a.iconsInText=!!et&&et.iconsInText),(et||Le)&&p3(a,ee,Me,Le,c,P,be,0,ze,Je,g,y,b)}p&&a.generateCollisionDebugBuffers(T,a.collisionBoxArray)}function bg(a){switch(a){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function p3(a,t,s,c,f,p,g,y,T,b,C,M,P){let N=p.textMaxSize.evaluate(t,{},M);N===void 0&&(N=g);const Z=a.layers[0].layout,ee=Z.get("icon-offset").evaluate(t,{},M),ae=_2(s.horizontal)||s.vertical,fe=g/24,be=a.tilePixelRatio*N/24,Me=(Ke=a.overscaling,a.zoom>18&&Ke>2&&(Ke>>=1),Math.max(Jt/(512*Ke),1)*Z.get("symbol-spacing")),Pe=Z.get("text-padding")*a.tilePixelRatio,Le=Z.get("icon-padding")*a.tilePixelRatio,ze=Y(Z.get("text-max-angle")),Je=Z.get("text-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",et=Z.get("icon-rotation-alignment")==="map"&&Z.get("symbol-placement")!=="point",st=Z.get("symbol-placement"),ot=Me/2;var Ke;const nt=Z.get("icon-text-fit");let ct;c&&nt!=="none"&&(a.allowVerticalPlacement&&s.vertical&&(ct=n2(c,s.vertical,nt,Z.get("icon-text-fit-padding"),ee,fe)),ae&&(c=n2(c,ae,nt,Z.get("icon-text-fit-padding"),ee,fe)));const vt=(ft,xt,Kt)=>{if(xt.x<0||xt.x>=Jt||xt.y<0||xt.y>=Jt)return;const{x:sr,y:Yt,z:tr}=P.projectTilePoint(xt.x,xt.y,Kt),Nt=new lo(sr,Yt,tr,0,void 0);(function(Ct,cr,_r,_n,Pr,gn,gr,ur,kr,Wr,Yr,xn,An,ea,Li,Mr,li,ta,Nn,Cn,Ur,Lr,Ri,ci,ln){const ui=Ct.addToLineVertexArray(cr,_n);let Yn,In,Fa,el,Nf,Uf,J2,Q2=0,ew=0,tw=0,rw=0,Vg=-1,jg=-1;const Ls={};let nw=As(""),Gg=0,$g=0;if(kr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Gg,$g]=kr.layout.get("text-offset").evaluate(Ur,{},ln).map(ra=>ra*Hn):(Gg=kr.layout.get("text-radial-offset").evaluate(Ur,{},ln)*Hn,$g=Eg),Ct.allowVerticalPlacement&&Pr.vertical){const ra=Pr.vertical;if(Li)Uf=Sg(ra),ur&&(J2=Sg(ur));else{const na=kr.layout.get("text-rotate").evaluate(Ur,{},ln)+90;Fa=w0(Wr,_r,cr,Yr,xn,An,ra,ea,na,Mr),ur&&(el=w0(Wr,_r,cr,Yr,xn,An,ur,ta,na))}}if(gn){const ra=kr.layout.get("icon-rotate").evaluate(Ur,{},ln),na=kr.layout.get("icon-text-fit")!=="none",Vf=f2(gn,ra,Ri,na),Zg=ur?f2(ur,ra,Ri,na):void 0;In=w0(Wr,_r,cr,Yr,xn,An,gn,ta,ra),Q2=4*Vf.length;const iw=Ct.iconSizeData;let uc=null;iw.kind==="source"?(uc=[Ms*kr.layout.get("icon-size").evaluate(Ur,{},ln)],uc[0]>Xo&&He(`${Ct.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):iw.kind==="composite"&&(uc=[Ms*Lr.compositeIconSizes[0].evaluate(Ur,{},ln),Ms*Lr.compositeIconSizes[1].evaluate(Ur,{},ln)],(uc[0]>Xo||uc[1]>Xo)&&He(`${Ct.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Ct.addSymbols(Ct.icon,Vf,uc,Cn,Nn,Ur,!1,_r,cr,ui.lineStartIndex,ui.lineLength,-1,ci,ln),Vg=Ct.icon.placedSymbolArray.length-1,Zg&&(ew=4*Zg.length,Ct.addSymbols(Ct.icon,Zg,uc,Cn,Nn,Ur,ga.vertical,_r,cr,ui.lineStartIndex,ui.lineLength,-1,ci,ln),jg=Ct.icon.placedSymbolArray.length-1)}for(const ra in Pr.horizontal){const na=Pr.horizontal[ra];Yn||(nw=As(na.text),Li?Nf=Sg(na):Yn=w0(Wr,_r,cr,Yr,xn,An,na,ea,kr.layout.get("text-rotate").evaluate(Ur,{},ln),Mr));const Vf=na.positionedLines.length===1;if(tw+=m2(Ct,_r,cr,na,gr,kr,Li,Ur,Mr,ui,Pr.vertical?ga.horizontal:ga.horizontalOnly,Vf?Object.keys(Pr.horizontal):[ra],Ls,Vg,Lr,ci,ln),Vf)break}Pr.vertical&&(rw+=m2(Ct,_r,cr,Pr.vertical,gr,kr,Li,Ur,Mr,ui,ga.vertical,["vertical"],Ls,jg,Lr,ci,ln));let tl=-1;const Wg=(ra,na)=>ra?Math.max(ra,na):na;tl=Wg(Nf,tl),tl=Wg(Uf,tl),tl=Wg(J2,tl);const X3=tl>-1?1:0;Ct.glyphOffsetArray.length>=qo.MAX_GLYPHS&&He("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Ur.sortKey!==void 0&&Ct.addToSortKeyRanges(Ct.symbolInstances.length,Ur.sortKey),Ct.symbolInstances.emplaceBack(_r.x,_r.y,_r.z,cr.x,cr.y,Ls.right>=0?Ls.right:-1,Ls.center>=0?Ls.center:-1,Ls.left>=0?Ls.left:-1,Ls.vertical>=0?Ls.vertical:-1,Vg,jg,nw,Yn!==void 0?Yn:Ct.collisionBoxArray.length,Yn!==void 0?Yn+1:Ct.collisionBoxArray.length,Fa!==void 0?Fa:Ct.collisionBoxArray.length,Fa!==void 0?Fa+1:Ct.collisionBoxArray.length,In!==void 0?In:Ct.collisionBoxArray.length,In!==void 0?In+1:Ct.collisionBoxArray.length,el||Ct.collisionBoxArray.length,el?el+1:Ct.collisionBoxArray.length,Yr,tw,rw,Q2,ew,X3,0,Gg,$g,tl)})(a,xt,Nt,ft,s,c,f,ct,a.layers[0],a.collisionBoxArray,t.index,t.sourceLayerIndex,a.index,Pe,Je,T,0,Le,et,ee,t,p,b,C,M)};if(st==="line")for(const ft of c2(t.geometry,0,0,Jt,Jt)){const xt=s3(ft,Me,ze,s.vertical||ae,c,24,be,a.overscaling,Jt);for(const Kt of xt){const sr=ae;sr&&m3(a,sr.text,ot,Kt)||vt(ft,Kt,M)}}else if(st==="line-center"){for(const ft of t.geometry)if(ft.length>1){const xt=a3(ft,ze,s.vertical||ae,c,24,be);xt&&vt(ft,xt,M)}}else if(t.type==="Polygon")for(const ft of fg(t.geometry,0)){const xt=u3(ft,16);vt(ft[0],new lo(xt.x,xt.y,0,0,void 0),M)}else if(t.type==="LineString")for(const ft of t.geometry)vt(ft,new lo(ft[0].x,ft[0].y,0,0,void 0),M);else if(t.type==="Point")for(const ft of t.geometry)for(const xt of ft)vt([xt],new lo(xt.x,xt.y,0,0,void 0),M)}const Xo=32640;function m2(a,t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee,ae){const fe=function(Pe,Le,ze,Je,et,st,ot,Ke){const nt=[];if(Le.positionedLines.length===0)return nt;const ct=Je.layout.get("text-rotate").evaluate(st,{})*Math.PI/180,vt=function(Yt){const tr=Yt[0],Nt=Yt[1],Ct=tr*Nt;return Ct>0?[tr,-Nt]:Ct<0?[-tr,Nt]:tr===0?[Nt,tr]:[Nt,-tr]}(ze);let ft=Math.abs(Le.top-Le.bottom);for(const Yt of Le.positionedLines)ft-=Yt.lineOffset;const xt=Le.positionedLines.length,Kt=ft/xt;let sr=Le.top-ze[1];for(let Yt=0;Yt<xt;++Yt){const tr=Le.positionedLines[Yt];sr=o3(Le,Kt,sr,Yt);for(const Nt of tr.positionedGlyphs){if(!Nt.rect)continue;const Ct=Nt.rect||{};let cr=4,_r=!0,_n=1,Pr=0;if(Nt.imageName){const Lr=ot[Nt.imageName];if(!Lr)continue;if(Lr.sdf){He("SDF images are not supported in formatted text and will be ignored.");continue}_r=!1,_n=Lr.pixelRatio,cr=1/_n}const gn=(et||Ke)&&Nt.vertical,gr=Nt.metrics.advance*Nt.scale/2,ur=Nt.metrics,kr=Nt.rect;if(kr===null)continue;Ke&&Le.verticalizable&&(Pr=Nt.imageName?gr-Nt.metrics.width*Nt.scale/2:0);const Wr=et?[Nt.x+gr,Nt.y]:[0,0];let Yr=[0,0],xn=[0,0],An=!1;et||(gn?(xn=[Nt.x+gr+vt[0],Nt.y+vt[1]-Pr],An=!0):Yr=[Nt.x+gr+ze[0],Nt.y+ze[1]-Pr]);const ea=kr.w*Nt.scale/(_n*(Nt.localGlyph?2:1)),Li=kr.h*Nt.scale/(_n*(Nt.localGlyph?2:1));let Mr,li,ta,Nn;if(gn){const Lr=Nt.y-sr,Ri=new D(-gr,gr-Lr),ci=-Math.PI/2,ln=new D(...xn);Mr=new D(-gr+Yr[0],Yr[1]),Mr._rotateAround(ci,Ri)._add(ln),Mr.x+=-Lr+gr,Mr.y-=(ur.left-cr)*Nt.scale;const ui=Nt.imageName?ur.advance*Nt.scale:Hn*Nt.scale,Yn=String.fromCharCode(Nt.glyph);jC(Yn)?Mr.x+=(1-cr)*Nt.scale:GC(Yn)?Mr.x+=ui-ur.height*Nt.scale+(-cr-1)*Nt.scale:Mr.x+=Nt.imageName||ur.width+2*cr===kr.w&&ur.height+2*cr===kr.h?(ui-Li)/2:(ui-(ur.height+2*cr)*Nt.scale)/2,li=new D(Mr.x,Mr.y-ea),ta=new D(Mr.x+Li,Mr.y),Nn=new D(Mr.x+Li,Mr.y-ea)}else{const Lr=(ur.left-cr)*Nt.scale-gr+Yr[0],Ri=(-ur.top-cr)*Nt.scale+Yr[1],ci=Lr+ea,ln=Ri+Li;Mr=new D(Lr,Ri),li=new D(ci,Ri),ta=new D(Lr,ln),Nn=new D(ci,ln)}if(ct){let Lr;Lr=et?new D(0,0):An?new D(vt[0],vt[1]):new D(ze[0],ze[1]),Mr._rotateAround(ct,Lr),li._rotateAround(ct,Lr),ta._rotateAround(ct,Lr),Nn._rotateAround(ct,Lr)}const Cn=new D(0,0),Ur=new D(0,0);nt.push({tl:Mr,tr:li,bl:ta,br:Nn,tex:Ct,writingMode:Le.writingMode,glyphOffset:Wr,sectionIndex:Nt.sectionIndex,isSDF:_r,pixelOffsetTL:Cn,pixelOffsetBR:Ur,minFontScaleX:0,minFontScaleY:0})}}return nt}(0,c,T,p,g,y,f,a.allowVerticalPlacement),be=a.textSizeData;let Me=null;be.kind==="source"?(Me=[Ms*p.layout.get("text-size").evaluate(y,{},ae)],Me[0]>Xo&&He(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):be.kind==="composite"&&(Me=[Ms*Z.compositeTextSizes[0].evaluate(y,{},ae),Ms*Z.compositeTextSizes[1].evaluate(y,{},ae)],(Me[0]>Xo||Me[1]>Xo)&&He(`${a.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),a.addSymbols(a.text,fe,Me,T,g,y,C,t,s,b.lineStartIndex,b.lineLength,N,ee,ae);for(const Pe of M)P[Pe]=a.text.placedSymbolArray.length-1;return 4*fe.length}function _2(a){for(const t in a)return a[t];return null}function w0(a,t,s,c,f,p,g,y,T,b){let C=g.top,M=g.bottom,P=g.left,N=g.right;const Z=g.collisionPadding;if(Z&&(P-=Z[0],C-=Z[1],N+=Z[2],M+=Z[3]),T){const ee=new D(P,C),ae=new D(N,C),fe=new D(P,M),be=new D(N,M),Me=Y(T);let Pe=new D(0,0);b&&(Pe=new D(b[0],b[1])),ee._rotateAround(Me,Pe),ae._rotateAround(Me,Pe),fe._rotateAround(Me,Pe),be._rotateAround(Me,Pe),P=Math.min(ee.x,ae.x,fe.x,be.x),N=Math.max(ee.x,ae.x,fe.x,be.x),C=Math.min(ee.y,ae.y,fe.y,be.y),M=Math.max(ee.y,ae.y,fe.y,be.y)}return a.emplaceBack(t.x,t.y,t.z,s.x,s.y,P,C,N,M,y,c,f,p),a.length-1}function Sg(a){a.collisionPadding&&(a.top-=a.collisionPadding[1],a.bottom+=a.collisionPadding[3]);const t=a.bottom-a.top;return t>0?Math.max(10,t):null}function m3(a,t,s,c){const f=a.compareText;if(t in f){const p=f[t];for(let g=p.length-1;g>=0;g--)if(c.dist(p[g])<s)return!0}else f[t]=[];return f[t].push(c),!1}const _3=oc.VectorTileFeature.types,g3=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function T0(a,t,s,c,f,p,g,y,T,b,C,M,P,N,Z,ee){const ae=C?Math.min(Xo,Math.round(C[0])):0,fe=C?Math.min(Xo,Math.round(C[1])):0;a.emplaceBack(t,s,Math.round(32*g),Math.round(32*y),T,b,(ae<<1)+(M?1:0),fe,16*P,16*N,256*Z,256*ee,c,f,p,0)}function kg(a,t,s){a.emplaceBack(t.x,t.y,s),a.emplaceBack(t.x,t.y,s),a.emplaceBack(t.x,t.y,s),a.emplaceBack(t.x,t.y,s)}function x3(a){for(const t of a.sections)if(V_(t.text))return!0;return!1}class Ag{constructor(t){this.layoutVertexArray=new Qe,this.indexArray=new Ft,this.programConfigurations=t,this.segments=new Kr,this.dynamicLayoutVertexArray=new mt,this.opacityVertexArray=new Ge,this.placedSymbolArray=new es}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(t,s,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,RC.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,zC.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,g3,!0),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}It(Ag,"SymbolBuffers");class Cg{constructor(t,s,c){this.layoutVertexArray=new t,this.layoutAttributes=s,this.indexArray=new c,this.segments=new Kr,this.collisionVertexArray=new rt,this.collisionVertexArrayExt=new mt}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,OC.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,BC.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}It(Cg,"CollisionBuffers");class qo{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(g=>g.id),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Is([]),this.placementViewportMatrix=Is([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=mg(this.zoom,s["text-size"]),this.iconSizeData=mg(this.zoom,s["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),p=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=p!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(p==="viewport-y"||p==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(g=>ga[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=t.sourceID,this.projection=t.projection}createArrays(){this.text=new Ag(new nc(this.layers,this.zoom,t=>/^text/.test(t))),this.icon=new Ag(new nc(this.layers,this.zoom,t=>/^icon/.test(t))),this.glyphOffsetArray=new mr,this.lineVertexArray=new sn,this.symbolInstances=new qr}calculateGlyphDependencies(t,s,c,f,p){for(let g=0;g<t.length;g++)if(s[t.charCodeAt(g)]=!0,f&&p){const y=Af[t.charAt(g)];y&&(s[y.charCodeAt(0)]=!0)}}populate(t,s,c,f){const p=this.layers[0],g=p.layout,y=g.get("text-font"),T=g.get("text-field"),b=g.get("icon-image"),C=(T.value.kind!=="constant"||T.value.value instanceof mn&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),M=b.value.kind!=="constant"||!!b.value.value||Object.keys(b.parameters).length>0,P=g.get("symbol-sort-key");if(this.features=[],!C&&!M)return;const N=s.iconDependencies,Z=s.glyphDependencies,ee=s.availableImages,ae=new Fr(this.zoom);for(const{feature:fe,id:be,index:Me,sourceLayerIndex:Pe}of t){const Le=p._featureFilter.needGeometry,ze=ic(fe,Le);if(!p._featureFilter.filter(ae,ze,c))continue;let Je,et;if(Le||(ze.geometry=ao(fe,c,f)),C){const ot=p.getValueAndResolveTokens("text-field",ze,c,ee),Ke=mn.factory(ot);x3(Ke)&&(this.hasRTLText=!0),(!this.hasRTLText||xu()==="unavailable"||this.hasRTLText&&Xi.isParsed())&&(Je=VC(Ke,p,ze))}if(M){const ot=p.getValueAndResolveTokens("icon-image",ze,c,ee);et=ot instanceof ki?ot:ki.fromString(ot)}if(!Je&&!et)continue;const st=this.sortFeaturesByKey?P.evaluate(ze,{},c):void 0;if(this.features.push({id:be,text:Je,icon:et,index:Me,sourceLayerIndex:Pe,geometry:ze.geometry,properties:fe.properties,type:_3[fe.type],sortKey:st}),et&&(N[et.name]=!0),Je){const ot=y.evaluate(ze,{},c).join(","),Ke=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ga.vertical)>=0;for(const nt of Je.sections)if(nt.image)N[nt.image.name]=!0;else{const ct=pu(Je.toString()),vt=nt.fontStack||ot,ft=Z[vt]=Z[vt]||{};this.calculateGlyphDependencies(nt.text,ft,Ke,this.allowVerticalPlacement,ct)}}}g.get("symbol-placement")==="line"&&(this.features=function(fe){const be={},Me={},Pe=[];let Le=0;function ze(ot){Pe.push(fe[ot]),Le++}function Je(ot,Ke,nt){const ct=Me[ot];return delete Me[ot],Me[Ke]=ct,Pe[ct].geometry[0].pop(),Pe[ct].geometry[0]=Pe[ct].geometry[0].concat(nt[0]),ct}function et(ot,Ke,nt){const ct=be[Ke];return delete be[Ke],be[ot]=ct,Pe[ct].geometry[0].shift(),Pe[ct].geometry[0]=nt[0].concat(Pe[ct].geometry[0]),ct}function st(ot,Ke,nt){const ct=nt?Ke[0][Ke[0].length-1]:Ke[0][0];return`${ot}:${ct.x}:${ct.y}`}for(let ot=0;ot<fe.length;ot++){const Ke=fe[ot],nt=Ke.geometry,ct=Ke.text?Ke.text.toString():null;if(!ct){ze(ot);continue}const vt=st(ct,nt),ft=st(ct,nt,!0);if(vt in Me&&ft in be&&Me[vt]!==be[ft]){const xt=et(vt,ft,nt),Kt=Je(vt,ft,Pe[xt].geometry);delete be[vt],delete Me[ft],Me[st(ct,Pe[Kt].geometry,!0)]=Kt,Pe[xt].geometry=null}else vt in Me?Je(vt,ft,nt):ft in be?et(vt,ft,nt):(ze(ot),be[vt]=Le-1,Me[ft]=Le-1)}return Pe.filter(ot=>ot.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((fe,be)=>fe.sortKey-be.sortKey)}update(t,s,c,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(t,s,this.layers,c,f),this.icon.programConfigurations.updatePaintArrays(t,s,this.layers,c,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,s){const c=this.lineVertexArray.length,f=t.segment;if(f!==void 0){let p=t.dist(s[f+1]),g=t.dist(s[f]);const y={};for(let T=f+1;T<s.length;T++)y[T]={x:s[T].x,y:s[T].y,tileUnitDistanceFromAnchor:p},T<s.length-1&&(p+=s[T+1].dist(s[T]));for(let T=f||0;T>=0;T--)y[T]={x:s[T].x,y:s[T].y,tileUnitDistanceFromAnchor:g},T>0&&(g+=s[T-1].dist(s[T]));for(let T=0;T<s.length;T++){const b=y[T];this.lineVertexArray.emplaceBack(b.x,b.y,b.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(t,s,c,f,p,g,y,T,b,C,M,P,N,Z){const ee=t.indexArray,ae=t.layoutVertexArray,fe=t.segments.prepareSegment(4*s.length,ae,ee,this.canOverlap?g.sortKey:void 0),be=this.glyphOffsetArray.length,Me=fe.vertexLength,Pe=this.allowVerticalPlacement&&y===ga.vertical?Math.PI/2:0,Le=g.text&&g.text.sections;for(let ze=0;ze<s.length;ze++){const{tl:Je,tr:et,bl:st,br:ot,tex:Ke,pixelOffsetTL:nt,pixelOffsetBR:ct,minFontScaleX:vt,minFontScaleY:ft,glyphOffset:xt,isSDF:Kt,sectionIndex:sr}=s[ze],Yt=fe.vertexLength,tr=xt[1];T0(ae,T.x,T.y,T.z,b.x,b.y,Je.x,tr+Je.y,Ke.x,Ke.y,c,Kt,nt.x,nt.y,vt,ft),T0(ae,T.x,T.y,T.z,b.x,b.y,et.x,tr+et.y,Ke.x+Ke.w,Ke.y,c,Kt,ct.x,nt.y,vt,ft),T0(ae,T.x,T.y,T.z,b.x,b.y,st.x,tr+st.y,Ke.x,Ke.y+Ke.h,c,Kt,nt.x,ct.y,vt,ft),T0(ae,T.x,T.y,T.z,b.x,b.y,ot.x,tr+ot.y,Ke.x+Ke.w,Ke.y+Ke.h,c,Kt,ct.x,ct.y,vt,ft),kg(t.dynamicLayoutVertexArray,T,Pe),ee.emplaceBack(Yt,Yt+1,Yt+2),ee.emplaceBack(Yt+1,Yt+2,Yt+3),fe.vertexLength+=4,fe.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(xt[0]),ze!==s.length-1&&sr===s[ze+1].sectionIndex||t.programConfigurations.populatePaintArrays(ae.length,g,g.index,{},N,Z,Le&&Le[sr])}t.placedSymbolArray.emplaceBack(T.x,T.y,T.z,b.x,b.y,be,this.glyphOffsetArray.length-be,Me,C,M,b.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],y,0,!1,0,P,0)}_commitLayoutVertex(t,s,c,f,p,g,y){t.emplaceBack(s,c,f,p,g,Math.round(y.x),Math.round(y.y))}_addCollisionDebugVertices(t,s,c,f,p,g,y){const T=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),b=T.vertexLength,C=y.tileAnchorX,M=y.tileAnchorY;for(let N=0;N<4;N++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(s,-t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(s,t.padding,-t.padding),c.collisionVertexArrayExt.emplaceBack(s,t.padding,t.padding),c.collisionVertexArrayExt.emplaceBack(s,-t.padding,t.padding),this._commitLayoutVertex(c.layoutVertexArray,f,p,g,C,M,new D(t.x1,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,p,g,C,M,new D(t.x2,t.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,p,g,C,M,new D(t.x2,t.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,p,g,C,M,new D(t.x1,t.y2)),T.vertexLength+=4;const P=c.indexArray;P.emplaceBack(b,b+1),P.emplaceBack(b+1,b+2),P.emplaceBack(b+2,b+3),P.emplaceBack(b+3,b),T.primitiveLength+=4}_addTextDebugCollisionBoxes(t,s,c,f,p,g){for(let y=f;y<p;y++){const T=c.get(y),b=this.getSymbolInstanceTextSize(t,g,s,y);this._addCollisionDebugVertices(T,b,this.textCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(t,s,c,f,p,g){for(let y=f;y<p;y++){const T=c.get(y),b=this.getSymbolInstanceIconSize(t,s,y);this._addCollisionDebugVertices(T,b,this.iconCollisionBox,T.projectedAnchorX,T.projectedAnchorY,T.projectedAnchorZ,g)}}generateCollisionDebugBuffers(t,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cg(ht,$v.members,qt),this.iconCollisionBox=new Cg(ht,$v.members,qt);const c=Cu(this.iconSizeData,t),f=Cu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p);this._addTextDebugCollisionBoxes(f,t,s,g.textBoxStartIndex,g.textBoxEndIndex,g),this._addTextDebugCollisionBoxes(f,t,s,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._addIconDebugCollisionBoxes(c,t,s,g.iconBoxStartIndex,g.iconBoxEndIndex,g),this._addIconDebugCollisionBoxes(c,t,s,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex,g)}}getSymbolInstanceTextSize(t,s,c,f){const p=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:f),g=m0(this.textSizeData,t,p)/Hn;return this.tilePixelRatio*g}getSymbolInstanceIconSize(t,s,c){const f=this.icon.placedSymbolArray.get(c),p=m0(this.iconSizeData,t,f);return this.tilePixelRatio*p}_commitDebugCollisionVertexUpdate(t,s,c){t.emplaceBack(s,-c,-c),t.emplaceBack(s,c,-c),t.emplaceBack(s,c,c),t.emplaceBack(s,-c,c)}_updateTextDebugCollisionBoxes(t,s,c,f,p,g){for(let y=f;y<p;y++){const T=c.get(y),b=this.getSymbolInstanceTextSize(t,g,s,y);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,b,T.padding)}}_updateIconDebugCollisionBoxes(t,s,c,f,p){for(let g=f;g<p;g++){const y=c.get(g),T=this.getSymbolInstanceIconSize(t,s,g);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,T,y.padding)}}updateCollisionDebugBuffers(t,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Cu(this.iconSizeData,t),f=Cu(this.textSizeData,t);for(let p=0;p<this.symbolInstances.length;p++){const g=this.symbolInstances.get(p);this._updateTextDebugCollisionBoxes(f,t,s,g.textBoxStartIndex,g.textBoxEndIndex,g),this._updateTextDebugCollisionBoxes(f,t,s,g.verticalTextBoxStartIndex,g.verticalTextBoxEndIndex,g),this._updateIconDebugCollisionBoxes(c,t,s,g.iconBoxStartIndex,g.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(c,t,s,g.verticalIconBoxStartIndex,g.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,s,c,f,p,g,y,T,b){const C={};for(let M=s;M<c;M++){const P=t.get(M);C.textBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,padding:P.padding,projectedAnchorX:P.projectedAnchorX,projectedAnchorY:P.projectedAnchorY,projectedAnchorZ:P.projectedAnchorZ,tileAnchorX:P.tileAnchorX,tileAnchorY:P.tileAnchorY},C.textFeatureIndex=P.featureIndex;break}for(let M=f;M<p;M++){const P=t.get(M);C.verticalTextBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,padding:P.padding,projectedAnchorX:P.projectedAnchorX,projectedAnchorY:P.projectedAnchorY,projectedAnchorZ:P.projectedAnchorZ,tileAnchorX:P.tileAnchorX,tileAnchorY:P.tileAnchorY},C.verticalTextFeatureIndex=P.featureIndex;break}for(let M=g;M<y;M++){const P=t.get(M);C.iconBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,padding:P.padding,projectedAnchorX:P.projectedAnchorX,projectedAnchorY:P.projectedAnchorY,projectedAnchorZ:P.projectedAnchorZ,tileAnchorX:P.tileAnchorX,tileAnchorY:P.tileAnchorY},C.iconFeatureIndex=P.featureIndex;break}for(let M=T;M<b;M++){const P=t.get(M);C.verticalIconBox={x1:P.x1,y1:P.y1,x2:P.x2,y2:P.y2,padding:P.padding,projectedAnchorX:P.projectedAnchorX,projectedAnchorY:P.projectedAnchorY,projectedAnchorZ:P.projectedAnchorZ,tileAnchorX:P.tileAnchorX,tileAnchorY:P.tileAnchorY},C.verticalIconFeatureIndex=P.featureIndex;break}return C}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(t,s){const c=t.placedSymbolArray.get(s),f=c.vertexStartIndex+4*c.numGlyphs;for(let p=c.vertexStartIndex;p<f;p+=4)t.indexArray.emplaceBack(p,p+1,p+2),t.indexArray.emplaceBack(p+1,p+2,p+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(t),c=Math.cos(t),f=[],p=[],g=[];for(let y=0;y<this.symbolInstances.length;++y){g.push(y);const T=this.symbolInstances.get(y);f.push(0|Math.round(s*T.tileAnchorX+c*T.tileAnchorY)),p.push(T.featureIndex)}return g.sort((y,T)=>f[y]-f[T]||p[T]-p[y]),g}addToSortKeyRanges(t,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((f,p,g)=>{f>=0&&g.indexOf(f)===p&&this.addIndicesForPlacedSymbol(this.text,f)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}It(qo,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),qo.MAX_GLYPHS=65535,qo.addDynamicAttributes=kg;const y3=new W({"symbol-placement":new E(le.layout_symbol["symbol-placement"]),"symbol-spacing":new E(le.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new E(le.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new k(le.layout_symbol["symbol-sort-key"]),"symbol-z-order":new E(le.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new E(le.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new E(le.layout_symbol["icon-ignore-placement"]),"icon-optional":new E(le.layout_symbol["icon-optional"]),"icon-rotation-alignment":new E(le.layout_symbol["icon-rotation-alignment"]),"icon-size":new k(le.layout_symbol["icon-size"]),"icon-text-fit":new E(le.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new E(le.layout_symbol["icon-text-fit-padding"]),"icon-image":new k(le.layout_symbol["icon-image"]),"icon-rotate":new k(le.layout_symbol["icon-rotate"]),"icon-padding":new E(le.layout_symbol["icon-padding"]),"icon-keep-upright":new E(le.layout_symbol["icon-keep-upright"]),"icon-offset":new k(le.layout_symbol["icon-offset"]),"icon-anchor":new k(le.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new E(le.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new E(le.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new E(le.layout_symbol["text-rotation-alignment"]),"text-field":new k(le.layout_symbol["text-field"]),"text-font":new k(le.layout_symbol["text-font"]),"text-size":new k(le.layout_symbol["text-size"]),"text-max-width":new k(le.layout_symbol["text-max-width"]),"text-line-height":new k(le.layout_symbol["text-line-height"]),"text-letter-spacing":new k(le.layout_symbol["text-letter-spacing"]),"text-justify":new k(le.layout_symbol["text-justify"]),"text-radial-offset":new k(le.layout_symbol["text-radial-offset"]),"text-variable-anchor":new E(le.layout_symbol["text-variable-anchor"]),"text-anchor":new k(le.layout_symbol["text-anchor"]),"text-max-angle":new E(le.layout_symbol["text-max-angle"]),"text-writing-mode":new E(le.layout_symbol["text-writing-mode"]),"text-rotate":new k(le.layout_symbol["text-rotate"]),"text-padding":new E(le.layout_symbol["text-padding"]),"text-keep-upright":new E(le.layout_symbol["text-keep-upright"]),"text-transform":new k(le.layout_symbol["text-transform"]),"text-offset":new k(le.layout_symbol["text-offset"]),"text-allow-overlap":new E(le.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new E(le.layout_symbol["text-ignore-placement"]),"text-optional":new E(le.layout_symbol["text-optional"])});var Ig={paint:new W({"icon-opacity":new k(le.paint_symbol["icon-opacity"]),"icon-color":new k(le.paint_symbol["icon-color"]),"icon-halo-color":new k(le.paint_symbol["icon-halo-color"]),"icon-halo-width":new k(le.paint_symbol["icon-halo-width"]),"icon-halo-blur":new k(le.paint_symbol["icon-halo-blur"]),"icon-translate":new E(le.paint_symbol["icon-translate"]),"icon-translate-anchor":new E(le.paint_symbol["icon-translate-anchor"]),"text-opacity":new k(le.paint_symbol["text-opacity"]),"text-color":new k(le.paint_symbol["text-color"],{runtimeType:Or,getOverride:a=>a.textColor,hasOverride:a=>!!a.textColor}),"text-halo-color":new k(le.paint_symbol["text-halo-color"]),"text-halo-width":new k(le.paint_symbol["text-halo-width"]),"text-halo-blur":new k(le.paint_symbol["text-halo-blur"]),"text-translate":new E(le.paint_symbol["text-translate"]),"text-translate-anchor":new E(le.paint_symbol["text-translate-anchor"])}),layout:y3};class g2{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:Mt,this.defaultValue=t}evaluate(t){if(t.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(t.formattedSection))return s.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}It(g2,"FormatSectionOverride",{omit:["defaultValue"]});class E0 extends rs{constructor(t){super(t,Ig)}recalculate(t,s){super.recalculate(t,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const p of c)f.indexOf(p)<0&&f.push(p);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(t,s,c,f){const p=this.layout.get(t).evaluate(s,{},c,f),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||Ro(g.value)||!p?p:function(y,T){return T.replace(/{([^{}]+)}/g,(b,C)=>C in y?String(y[C]):"")}(s.properties,p)}createBucket(t){return new qo(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Ig.paint.overridableProperties){if(!E0.hasPaintOverride(this.layout,t))continue;const s=this.paint.get(t),c=new g2(s),f=new iu(c,s.property.specification);let p=null;p=s.value.kind==="constant"||s.value.kind==="source"?new Gh("source",f):new $h("composite",f,s.value.zoomStops,s.value._interpolationType),this.paint._values[t]=new v(s.property,p,s.parameters)}}_handleOverridablePaintPropertyUpdate(t,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&E0.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,s){const c=t.get("text-field"),f=Ig.paint.properties[s];let p=!1;const g=y=>{for(const T of y)if(f.overrides&&f.overrides.hasOverride(T))return void(p=!0)};if(c.value.kind==="constant"&&c.value.value instanceof mn)g(c.value.value.sections);else if(c.value.kind==="source"){const y=b=>{p||(b instanceof qa&&an(b.value)===ii?g(b.value.sections):b instanceof Mo?g(b.sections):b.eachChild(y))},T=c.value;T._styleExpression&&y(T._styleExpression.expression)}return p}getProgramConfiguration(t){return new $o(this,t)}}var v3={paint:new W({"background-color":new E(le.paint_background["background-color"]),"background-pattern":new R(le.paint_background["background-pattern"]),"background-opacity":new E(le.paint_background["background-opacity"])})},w3={paint:new W({"raster-opacity":new E(le.paint_raster["raster-opacity"]),"raster-hue-rotate":new E(le.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new E(le.paint_raster["raster-brightness-min"]),"raster-brightness-max":new E(le.paint_raster["raster-brightness-max"]),"raster-saturation":new E(le.paint_raster["raster-saturation"]),"raster-contrast":new E(le.paint_raster["raster-contrast"]),"raster-resampling":new E(le.paint_raster["raster-resampling"]),"raster-fade-duration":new E(le.paint_raster["raster-fade-duration"])})};class T3 extends rs{constructor(t){super(t,{}),this.implementation=t}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}var E3={paint:new W({"sky-type":new E(le.paint_sky["sky-type"]),"sky-atmosphere-sun":new E(le.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new E(le.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new E(le.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new E(le.paint_sky["sky-gradient-radius"]),"sky-gradient":new O(le.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new E(le.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new E(le.paint_sky["sky-atmosphere-color"]),"sky-opacity":new E(le.paint_sky["sky-opacity"])})};function Mg(a,t,s){const c=[0,0,1],f=Ev([]);return function(p,g,y){y*=.5;var T=g[0],b=g[1],C=g[2],M=g[3],P=Math.sin(y),N=Math.cos(y);p[0]=T*N-C*P,p[1]=b*N+M*P,p[2]=C*N+T*P,p[3]=M*N-b*P}(f,f,s?-Y(a)+Math.PI:Y(a)),bv(f,f,-Y(t)),wv(c,c,f),_f(c,c)}const b3={circle:class extends rs{constructor(a){super(a,GA)}createBucket(a){return new q_(a)}queryRadius(a){const t=a;return Eu("circle-radius",this,t)+Eu("circle-stroke-width",this,t)+s0(this.paint.get("circle-translate"))}queryIntersectsFeature(a,t,s,c,f,p,g,y){const T=dv(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),p.angle,a.pixelToTileUnitsFactor),b=this.paint.get("circle-radius").evaluate(t,s)+this.paint.get("circle-stroke-width").evaluate(t,s);return Sv(a,c,p,g,y,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",T,b)}getProgramIds(){return["circle"]}getProgramConfiguration(a){return new $o(this,a)}},heatmap:class extends rs{createBucket(a){return new Av(a)}constructor(a){super(a,KA),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=lg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(a){return Eu("heatmap-radius",this,a)}queryIntersectsFeature(a,t,s,c,f,p,g,y){const T=this.paint.get("heatmap-radius").evaluate(t,s);return Sv(a,c,p,g,y,!0,!0,new D(0,0),T)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(a){return new $o(this,a)}},hillshade:class extends rs{constructor(a){super(a,YA)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends rs{constructor(a){super(a,pC)}getProgramIds(){const a=this.paint.get("fill-pattern"),t=a&&a.constantOr(1),s=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(a){return new $o(this,a)}recalculate(a,t){super.recalculate(a,t);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(a){return new f0(a)}queryRadius(){return s0(this.paint.get("fill-translate"))}queryIntersectsFeature(a,t,s,c,f,p){return!a.queryGeometry.isAboveHorizon&&lv(fv(a.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),p.angle,a.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends rs{constructor(a){super(a,kC)}createBucket(a){return new Sf(a)}queryRadius(){return s0(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(a){return new $o(this,a)}queryIntersectsFeature(a,t,s,c,f,p,g,y,T){const b=dv(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),p.angle,a.pixelToTileUnitsFactor),C=this.paint.get("fill-extrusion-height").evaluate(t,s),M=this.paint.get("fill-extrusion-base").evaluate(t,s),P=[0,0],N=y&&p.elevation,Z=p.elevation?p.elevation.exaggeration():1,ee=a.tile.getBucket(this);if(N&&ee instanceof Sf){const be=ee.centroidVertexArray,Me=T+1;if(Me<be.length){const Pe=be.get(Me);P[0]=Pe.a_centroid_pos0,P[1]=Pe.a_centroid_pos1}}if(P[0]===0&&P[1]===1)return!1;const ae=function(be,Me,Pe,Le,ze,Je,et,st,ot){return Je?function(Ke,nt,ct,vt,ft,xt,Kt,sr,Yt){const tr=[],Nt=[],Ct=[0,0,0,1];for(const cr of Ke){const _r=[],_n=[];for(const Pr of cr){const gn=Pr.x+vt.x,gr=Pr.y+vt.y,ur=AC(gn,gr,nt,ct,xt,Kt,sr,Yt);Ct[0]=gn,Ct[1]=gr,Ct[2]=ur.base,Ct[3]=1,Su(Ct,Ct,ft),Ct[3]=Math.max(Ct[3],1e-5);const kr=Uv([Ct[0]/Ct[3],Ct[1]/Ct[3],Ct[2]/Ct[3]]);Ct[0]=gn,Ct[1]=gr,Ct[2]=ur.top,Ct[3]=1,Su(Ct,Ct,ft),Ct[3]=Math.max(Ct[3],1e-5);const Wr=Uv([Ct[0]/Ct[3],Ct[1]/Ct[3],Ct[2]/Ct[3]]);_r.push(kr),_n.push(Wr)}tr.push(_r),Nt.push(_n)}return[tr,Nt]}(be,Me,Pe,Le,ze,Je,et,st,ot):function(Ke,nt,ct,vt,ft){const xt=[],Kt=[],sr=ft[8]*nt,Yt=ft[9]*nt,tr=ft[10]*nt,Nt=ft[11]*nt,Ct=ft[8]*ct,cr=ft[9]*ct,_r=ft[10]*ct,_n=ft[11]*ct;for(const Pr of Ke){const gn=[],gr=[];for(const ur of Pr){const kr=ur.x+vt.x,Wr=ur.y+vt.y,Yr=ft[0]*kr+ft[4]*Wr+ft[12],xn=ft[1]*kr+ft[5]*Wr+ft[13],An=ft[2]*kr+ft[6]*Wr+ft[14],ea=ft[3]*kr+ft[7]*Wr+ft[15],Li=Yr+sr,Mr=xn+Yt,li=An+tr,ta=Math.max(ea+Nt,1e-5),Nn=Yr+Ct,Cn=xn+cr,Ur=An+_r,Lr=Math.max(ea+_n,1e-5),Ri=new D(Li/ta,Mr/ta);Ri.z=li/ta,gn.push(Ri);const ci=new D(Nn/Lr,Cn/Lr);ci.z=Ur/Lr,gr.push(ci)}xt.push(gn),Kt.push(gr)}return[xt,Kt]}(be,Me,Pe,Le,ze)}(c,M,C,b,g,N?y:null,P,Z,p.center.lat),fe=a.queryGeometry;return function(be,Me,Pe){let Le=1/0;lv(Pe,Me)&&(Le=Nv(Pe,Me[0]));for(let ze=0;ze<Me.length;ze++){const Je=Me[ze],et=be[ze];for(let st=0;st<Je.length-1;st++){const ot=Je[st],Ke=[ot,Je[st+1],et[st+1],et[st],ot];ov(Pe,Ke)&&(Le=Math.min(Le,Nv(Pe,Ke)))}}return Le!==1/0&&Le}(ae[0],ae[1],fe.isPointQuery()?fe.screenBounds:fe.screenGeometry)}},line:class extends rs{constructor(a){super(a,Vv),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(a){if(a==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof Rl,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(a,t){super.recalculate(a,t),this.paint._values["line-floorwidth"]=jv.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,a)}createBucket(a){return new p0(a)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(a){return new $o(this,a)}queryRadius(a){const t=a,s=Gv(Eu("line-width",this,t),Eu("line-gap-width",this,t)),c=Eu("line-offset",this,t);return s/2+Math.abs(c)+s0(this.paint.get("line-translate"))}queryIntersectsFeature(a,t,s,c,f,p){if(a.queryGeometry.isAboveHorizon)return!1;const g=fv(a.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),p.angle,a.pixelToTileUnitsFactor),y=a.pixelToTileUnitsFactor/2*Gv(this.paint.get("line-width").evaluate(t,s),this.paint.get("line-gap-width").evaluate(t,s)),T=this.paint.get("line-offset").evaluate(t,s);return T&&(c=function(b,C){const M=[],P=new D(0,0);for(let N=0;N<b.length;N++){const Z=b[N],ee=[];for(let ae=0;ae<Z.length;ae++){const fe=Z[ae-1],be=Z[ae],Me=Z[ae+1],Pe=ae===0?P:be.sub(fe)._unit()._perp(),Le=ae===Z.length-1?P:Me.sub(be)._unit()._perp(),ze=Pe._add(Le)._unit();ze._mult(1/(ze.x*Le.x+ze.y*Le.y)),ee.push(ze._mult(C)._add(be))}M.push(ee)}return M}(c,T*a.pixelToTileUnitsFactor)),function(b,C,M){for(let P=0;P<C.length;P++){const N=C[P];if(b.length>=3){for(let Z=0;Z<N.length;Z++)if(Tu(b,N[Z]))return!0}if(NA(b,N,M))return!0}return!1}(g,c,y)}isTileClipped(){return!0}},symbol:E0,background:class extends rs{constructor(a){super(a,v3)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends rs{constructor(a){super(a,w3)}getProgramIds(){return["raster"]}},sky:class extends rs{constructor(a){super(a,E3),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(a){a==="sky-gradient"?this._updateColorRamp():a!=="sky-atmosphere-sun"&&a!=="sky-atmosphere-halo-color"&&a!=="sky-atmosphere-color"&&a!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=lg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(a){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=a.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(a,t){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),f=!c,p=a.style.light,g=p.properties.get("position");return f&&p.properties.get("anchor")==="viewport"&&He("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?Mg(g.azimuthal,90-g.polar,t):Mg(c[0],90-c[1],t)}const s=this.paint.get("sky-gradient-center");return Mg(s[0],90-s[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(a){this._skyboxInvalidated=!1,this._lightPosition=a.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const a=this.paint.get("sky-type");return a==="atmosphere"?["skyboxCapture","skybox"]:a==="gradient"?["skyboxGradient"]:null}}};class Df{constructor(t,s,c,f){this.context=t,this.format=c,this.texture=t.gl.createTexture(),this.update(s,f)}update(t,s,c){const{width:f,height:p}=t,{context:g}=this,{gl:y}=g,{HTMLImageElement:T,HTMLCanvasElement:b,HTMLVideoElement:C,ImageData:M,ImageBitmap:P}=B;if(y.bindTexture(y.TEXTURE_2D,this.texture),g.pixelStoreUnpackFlipY.set(!1),g.pixelStoreUnpack.set(1),g.pixelStoreUnpackPremultiplyAlpha.set(this.format===y.RGBA&&(!s||s.premultiply!==!1)),c||this.size&&this.size[0]===f&&this.size[1]===p){const{x:N,y:Z}=c||{x:0,y:0};t instanceof T||t instanceof b||t instanceof C||t instanceof M||P&&t instanceof P?y.texSubImage2D(y.TEXTURE_2D,0,N,Z,y.RGBA,y.UNSIGNED_BYTE,t):y.texSubImage2D(y.TEXTURE_2D,0,N,Z,f,p,y.RGBA,y.UNSIGNED_BYTE,t.data)}else this.size=[f,p],t instanceof T||t instanceof b||t instanceof C||t instanceof M||P&&t instanceof P?y.texImage2D(y.TEXTURE_2D,0,this.format,this.format,y.UNSIGNED_BYTE,t):y.texImage2D(y.TEXTURE_2D,0,this.format,f,p,0,this.format,y.UNSIGNED_BYTE,t.data);this.useMipmap=Boolean(s&&s.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&y.generateMipmap(y.TEXTURE_2D)}bind(t,s){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),t!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,t),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?t===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:t),this.filter=t),s!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class Dg{constructor(t,s){this.width=t,this.height=s,this.nextRow=0,this.image=new so({width:t,height:s}),this.positions={},this.uploaded=!1}getDash(t,s){const c=this.getKey(t,s);return this.positions[c]}trim(){const t=this.width,s=this.height=kt(this.nextRow);this.image.resize({width:t,height:s})}getKey(t,s){return t.join(",")+s}getDashRanges(t,s,c){const f=[];let p=t.length%2==1?-t[t.length-1]*c:0,g=t[0]*c,y=!0;f.push({left:p,right:g,isDash:y,zeroLength:t[0]===0});let T=t[0];for(let b=1;b<t.length;b++){y=!y;const C=t[b];p=T*c,T+=C,g=T*c,f.push({left:p,right:g,isDash:y,zeroLength:C===0})}return f}addRoundDash(t,s,c){const f=s/2;for(let p=-c;p<=c;p++){const g=this.width*(this.nextRow+c+p);let y=0,T=t[y];for(let b=0;b<this.width;b++){b/T.right>1&&(T=t[++y]);const C=Math.abs(b-T.left),M=Math.abs(b-T.right),P=Math.min(C,M);let N;const Z=p/c*(f+1);if(T.isDash){const ee=f-Math.abs(Z);N=Math.sqrt(P*P+ee*ee)}else N=f-Math.sqrt(P*P+Z*Z);this.image.data[g+b]=Math.max(0,Math.min(255,N+128))}}}addRegularDash(t,s){for(let T=t.length-1;T>=0;--T){const b=t[T],C=t[T+1];b.zeroLength?t.splice(T,1):C&&C.isDash===b.isDash&&(C.left=b.left,t.splice(T,1))}const c=t[0],f=t[t.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const p=this.width*this.nextRow;let g=0,y=t[g];for(let T=0;T<this.width;T++){T/y.right>1&&(y=t[++g]);const b=Math.abs(T-y.left),C=Math.abs(T-y.right),M=Math.min(b,C);this.image.data[p+T]=Math.max(0,Math.min(255,(y.isDash?M:-M)+s+128))}}addDash(t,s){const c=this.getKey(t,s);if(this.positions[c])return this.positions[c];const f=s==="round",p=f?7:0,g=2*p+1;if(this.nextRow+g>this.height)return He("LineAtlas out of space"),null;t.length===0&&t.push(1);let y=0;for(let C=0;C<t.length;C++)t[C]<0&&(He("Negative value is found in line dasharray, replacing values with 0"),t[C]=0),y+=t[C];if(y!==0){const C=this.width/y,M=this.getDashRanges(t,this.width,C);f?this.addRoundDash(M,C,p):this.addRegularDash(M,s==="square"?.5*C:0)}const T=this.nextRow+p;this.nextRow+=g;const b={tl:[T,p],br:[y,0]};return this.positions[c]=b,b}}It(Dg,"LineAtlas");class S3{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel!="undefined"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}const k3=B.performance;function x2(a){const t=a?a.url.toString():void 0;return k3.getEntriesByName(t)}class A3{constructor(){this.tasks={},this.taskQueue=[],zt(["process"],this),this.invoker=new S3(this.process),this.nextId=0}add(t,s){const c=this.nextId++,f=function({type:p,isSymbolTile:g,zoom:y}){return y=y||0,p==="message"?0:p!=="maybePrepare"||g?p!=="parseTile"||g?p==="parseTile"&&g?300-y:p==="maybePrepare"&&g?400-y:500:200-y:100-y}(s);if(f===0){at();try{t()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:t,metadata:s,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){at();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const s=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let t=null,s=1/0;for(let f=0;f<this.taskQueue.length;f++){const p=this.tasks[this.taskQueue[f]];p.priority<s&&(s=p.priority,t=f)}if(t===null)return null;const c=this.taskQueue[t];return this.taskQueue.splice(t,1),c}remove(){this.invoker.remove()}}const C3=ye([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),I3=ye([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:y2}=C3,v2=ye([{name:"a_pos_3",components:3,type:"Int16"}]);var Ff=ye([{name:"a_pos",type:"Int16",components:2}]);const Lu=Jt/Math.PI/2,Ji=-Lu,Qi=Lu,M3=[new _a([Ji,Ji,Ji],[Qi,Qi,Qi]),new _a([Ji,Ji,Ji],[0,0,Qi]),new _a([0,Ji,Ji],[Qi,0,Qi]),new _a([Ji,0,Ji],[0,Qi,Qi]),new _a([0,0,Ji],[Qi,Qi,Qi])];class D3{constructor(t,s,c){this.a=bu([],t,c),this.b=bu([],s,c),this.center=c;const f=_f([],this.a),p=_f([],this.b);this.angle=Math.acos(gf(f,p))}}function Fg(a,t){if(a.angle===0)return null;let s;return s=a.a[t]===0?1/a.angle*.5*Math.PI:1/a.angle*Math.atan(a.b[t]/a.a[t]/Math.sin(a.angle)-1/Math.tan(a.angle)),s<0||s>1?null:function(c,f,p,g){const y=Math.sin(p);return c*(Math.sin((1-g)*p)/y)+f*(Math.sin(g*p)/y)}(a.a[t],a.b[t],a.angle,ge(s,0,1))+a.center[t]}function Pf(a){if(a.z<=1)return M3[a.z+2*a.y+a.x];const[t,s]=Pg(a),c=[co(t[0],t[1]),co(t[0],s[1]),co(s[0],t[1]),co(s[0],s[1])],f=[Qi,Qi,Qi],p=[Ji,Ji,Ji];for(const g of c)f[0]=Math.min(f[0],g[0]),f[1]=Math.min(f[1],g[1]),f[2]=Math.min(f[2],g[2]),p[0]=Math.max(p[0],g[0]),p[1]=Math.max(p[1],g[1]),p[2]=Math.max(p[2],g[2]);return new _a(f,p)}function F3(a,t,s){const c=t/a.worldSize,f=(nt,ct)=>{mf(nt,nt,c),mf(ct,ct,c)},p=Number.MAX_VALUE,g=[-p,-p,-p],y=[p,p,p],T=S2(a);if(s.z<=1){const nt=Pf(s).getCorners();for(let ct=0;ct<nt.length;ct++)sc(nt[ct],nt[ct],T),ng(y,y,nt[ct]),ig(g,g,nt[ct]);return f(y,g),new _a(y,g)}const[b,C]=Pg(s),M=new Wo;M.setSouthWest([b[1],C[0]]),M.setNorthEast([C[1],b[0]]);const P=[co(M.getSouth(),M.getWest()),co(M.getSouth(),M.getEast()),co(M.getNorth(),M.getEast()),co(M.getNorth(),M.getWest())];for(let nt=0;nt<P.length;nt++)sc(P[nt],P[nt],T),ng(y,y,P[nt]),ig(g,g,P[nt]);if(M.contains(a.center))return g[2]=0,f(y,g),new _a(y,g);const N=[T[12],T[13],T[14]],Z=a.center.lng,ee=ge(a.center.lat,-85.051129,Cs),ae=[df(Z),vu(ee)],fe=M.getCenter().lng,be=ge(M.getCenter().lat,-85.051129,Cs),Me=[df(fe),vu(be)];let Pe=new Array(3),Le=0;const ze=ae[0]-Me[0],Je=ae[1]-Me[1];if(Math.abs(ze)>Math.abs(Je))Le=ze>=0?1:3,Pe=N;else{Le=Je>=0?0:2;const nt=[T[4],T[5],T[6]];let ct;ct=Je>=0?-Math.sin(Y(M.getSouth()))*Lu:-Math.sin(Y(M.getNorth()))*Lu,Pe=ag(Pe,N,nt,ct)}const et=P[Le],st=P[(Le+1)%4],ot=new D3(et,st,Pe),Ke=[Fg(ot,0)||et[0],Fg(ot,1)||et[1],Fg(ot,2)||et[2]];return y[2]=Math.min(et[2],st[2]),ng(y,y,Ke),ig(g,g,Ke),f(y,g),new _a(y,g)}function Pg(a){const t=1<<a.z,s=a.x/t,c=(a.x+1)/t,f=(a.y+1)/t;return[[Zn(a.y/t),Ma(s)],[Zn(f),Ma(c)]]}function w2(a,t,s,c=Lu){return s=Y(s),[a*Math.sin(s)*c,-t*c,a*Math.cos(s)*c]}function co(a,t,s){return w2(Math.cos(Y(a)),Math.sin(Y(a)),t,s)}function T2(a,t,s){const c=Math.pow(2,s.z),f=(a/Jt+s.x)/c;return co(Zn((t/Jt+s.y)/c),Ma(f))}function Lg(a){return 16383/Math.max(...bu([],a.max,a.min))}function E2(a){const t=Is(new Float64Array(16)),s=Lg(a);var c,f;return Zo(t,t,[s,s,s]),ac(t,t,((c=[])[0]=-(f=a.min)[0],c[1]=-f[1],c[2]=-f[2],c)),t}function b2(a,t,s,c,f){const p=function(T){const b=Jt/(2*Math.PI);return T/(2*Math.PI)/b}(s),g=[a,t,-s/(2*Math.PI)],y=Is(new Float64Array(16));return ac(y,y,g),Zo(y,y,[p,p,p]),eg(y,y,Y(-f)),tg(y,y,Y(-c)),y}function S2(a){const{x:t,y:s}=a.point,{lng:c,lat:f}=a._center;return b2(t,s,a.worldSize,c,f)}const k2=Y(85),P3=Math.cos(k2),L3=Math.sin(k2);function A2(a,t,s){var c=2*Math.PI*6378137/256/Math.pow(2,s);return[a*c-2*Math.PI*6378137/2,t*c-2*Math.PI*6378137/2]}class b0{constructor(t,s,c){this.z=t,this.x=s,this.y=c,this.key=Lf(0,t,t,s,c)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,s){const c=function(p,g,y){var T=A2(256*p,256*(g=Math.pow(2,y)-g-1),y),b=A2(256*(p+1),256*(g+1),y);return T[0]+","+T[1]+","+b[0]+","+b[1]}(this.x,this.y,this.z),f=function(p,g,y){let T,b="";for(let C=p;C>0;C--)T=1<<C-1,b+=(g&T?1:0)+(y&T?2:0);return b}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class C2{constructor(t,s){this.wrap=t,this.canonical=s,this.key=Lf(t,s.z,s.z,s.x,s.y)}}class oi{constructor(t,s,c,f,p){this.overscaledZ=t,this.wrap=s,this.canonical=new b0(c,+f,+p),this.key=s===0&&t===c?this.canonical.key:Lf(s,t,c,f,p)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const s=this.canonical.z-t;return t>this.canonical.z?new oi(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new oi(t,this.wrap,t,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(t,s=!0){if(this.overscaledZ===t&&s)return this.key;if(t>this.canonical.z)return Lf(this.wrap*+s,t,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-t;return Lf(this.wrap*+s,t,t,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const s=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.x===this.canonical.x>>s&&t.canonical.y===this.canonical.y>>s}children(t){if(this.overscaledZ>=t)return[new oi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new oi(s,this.wrap,s,c,f),new oi(s,this.wrap,s,c+1,f),new oi(s,this.wrap,s,c,f+1),new oi(s,this.wrap,s,c+1,f+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new oi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new oi(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new C2(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Lf(a,t,s,c,f){const p=1<<Math.min(s,22);let g=p*(f%p)+c%p;return a&&s<22&&(g+=p*p*((a<0?-2*a-1:2*a)%(1<<2*(22-s)))),16*(32*g+s)+(t-s)}function lc(a,t){if(!t.isReprojectedInTileSpace)return{scale:1<<a.z,x:a.x,y:a.y,x2:a.x+1,y2:a.y+1,projection:t};const s=Math.pow(2,-a.z),c=a.x*s,f=(a.x+1)*s,p=a.y*s,g=(a.y+1)*s,y=Ma(c),T=Ma(f),b=Zn(p),C=Zn(g),M=t.project(y,b),P=t.project(T,b),N=t.project(T,C),Z=t.project(y,C);let ee=Math.min(M.x,P.x,N.x,Z.x),ae=Math.min(M.y,P.y,N.y,Z.y),fe=Math.max(M.x,P.x,N.x,Z.x),be=Math.max(M.y,P.y,N.y,Z.y);const Me=s/16;function Pe(ze,Je,et,st,ot,Ke){const nt=(et+ot)/2,ct=(st+Ke)/2,vt=t.project(Ma(nt),Zn(ct)),ft=Math.max(0,ee-vt.x,ae-vt.y,vt.x-fe,vt.y-be);ee=Math.min(ee,vt.x),fe=Math.max(fe,vt.x),ae=Math.min(ae,vt.y),be=Math.max(be,vt.y),ft>Me&&(Pe(ze,vt,et,st,nt,ct),Pe(vt,Je,nt,ct,ot,Ke))}Pe(M,P,c,p,f,p),Pe(P,N,f,p,f,g),Pe(N,Z,f,g,c,g),Pe(Z,M,c,g,c,p),ee-=Me,ae-=Me,fe+=Me,be+=Me;const Le=1/Math.max(fe-ee,be-ae);return{scale:Le,x:ee*Le,y:ae*Le,x2:fe*Le,y2:be*Le,projection:t}}It(b0,"CanonicalTileID"),It(oi,"OverscaledTileID",{omit:["projMatrix"]});class I2{constructor(t){this._stringToNumber={},this._numberToString=[];for(let s=0;s<t.length;s++){const c=t[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const R3=["tile","layer","source","sourceLayer","state"];class M2{constructor(t,s,c,f,p){this.type="Feature",this._vectorTileFeature=t,this._z=s,this._x=c,this._y=f,this.properties=t.properties,this.id=p}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",geometry:this.geometry,properties:this.properties};this.id!==void 0&&(t.id=this.id);for(const s of R3)this[s]!==void 0&&(t[s]=this[s]);return t}}const Da=32,Ds=33,Ko=new Uint16Array(8184);for(let a=0;a<2046;a++){let t=a+2,s=0,c=0,f=0,p=0,g=0,y=0;for(1&t?f=p=g=Da:s=c=y=Da;(t>>=1)>1;){const b=s+f>>1,C=c+p>>1;1&t?(f=s,p=c,s=g,c=y):(s=f,c=p,f=g,p=y),g=b,y=C}const T=4*a;Ko[T+0]=s,Ko[T+1]=c,Ko[T+2]=f,Ko[T+3]=p}const Fs=new Uint16Array(2178),Yo=new Uint8Array(1089),S0=new Uint16Array(1089);function D2(a){return a===0?-.03125:a===32?.03125:0}var F2=ye([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const P2={type:2,extent:Jt,loadGeometry:()=>[[new D(0,0),new D(8193,0),new D(8193,8193),new D(0,8193),new D(0,0)]]};class Rg{constructor(t,s,c,f,p){this.tileID=t,this.uid=dt(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=p,this.expiredRequestCount=0,this.state="loading",f&&f.transform&&(this.projection=f.transform.projection)}registerFadeDuration(t){const s=t+this.timeAdded;s<or.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=lc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(t,s,c){if(this.unloadVectorData(),this.state="loaded",t){t.featureIndex&&(this.latestFeatureIndex=t.featureIndex,t.rawTileData?(this.latestRawTileData=t.rawTileData,this.latestFeatureIndex.rawTileData=t.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=t.collisionBoxArray,this.buckets=function(f,p){const g={};if(!p)return g;for(const y of f){const T=y.layerIds.map(b=>p.getLayer(b)).filter(Boolean);if(T.length!==0){y.layers=T,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(b=>T.filter(C=>C.id===b)[0]));for(const b of T)g[b.id]=y}}return g}(t.buckets,s.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const p=this.buckets[f];if(p instanceof qo){if(this.hasSymbolBuckets=!0,!c)break;p.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const p=this.buckets[f];if(p instanceof qo&&p.hasRTLText){this.hasRTLText=!0,Xi.isLoading()||Xi.isLoaded()||xu()!=="deferred"||Uo();break}}this.queryPadding=0;for(const f in this.buckets){const p=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(f).queryRadius(p))}t.imageAtlas&&(this.imageAtlas=t.imageAtlas),t.glyphAtlasImage&&(this.glyphAtlasImage=t.glyphAtlasImage),t.lineAtlas&&(this.lineAtlas=t.lineAtlas)}else this.collisionBoxArray=new Qa}unloadVectorData(){if(this.hasData()){for(const t in this.buckets)this.buckets[t].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(t){return this.buckets[t.id]}upload(t){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(t)}const s=t.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Df(t,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Df(t,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Df(t,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(t){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(t,this.imageAtlasTexture)}queryRenderedFeatures(t,s,c,f,p,g,y,T){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:y,transform:g,params:p,tileTransform:this.tileTransform},t,s,c):{}}querySourceFeatures(t,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),p=s?s.sourceLayer:"",g=f._geojsonTileLayer||f[p];if(!g)return;const y=Ts(s&&s.filter),{z:T,x:b,y:C}=this.tileID.canonical,M={z:T,x:b,y:C};for(let P=0;P<g.length;P++){const N=g.feature(P);if(y.needGeometry){const ae=ic(N,!0);if(!y.filter(new Fr(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!y.filter(new Fr(this.tileID.overscaledZ),N))continue;const Z=c.getId(N,p),ee=new M2(N,T,b,C,Z);ee.tile=M,t.push(ee)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(t){const s=this.expirationTime;if(t.cacheControl){const c=bt(t.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else t.expires&&(this.expirationTime=new Date(t.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(s)if(this.expirationTime<s)f=!0;else{const p=this.expirationTime-s;p?this.expirationTime=c+Math.max(p,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(t,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(t).length===0||!s)return;const c=this.latestFeatureIndex.loadVTLayers(),f=s.style.listImages();for(const p in this.buckets){if(!s.style.hasLayer(p))continue;const g=this.buckets[p],y=g.layers[0].sourceLayer||"_geojsonTileLayer",T=c[y],b=t[y];if(!T||!b||Object.keys(b).length===0)continue;if(g.update(b,T,f,this.imageAtlas&&this.imageAtlas.patternPositions||{}),g instanceof p0||g instanceof f0){const M=s.style._getSourceCache(g.layers[0].source);s._terrain&&s._terrain.enabled&&M&&g.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(M.id,this.tileID)}const C=s&&s.style&&s.style.getLayer(p);C&&(this.queryPadding=Math.max(this.queryPadding,C.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<or.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(t){this.symbolFadeHoldUntil=or.now()+t}setTexture(t,s){const c=s.context,f=c.gl;this.texture=s.getTileTexture(t.width),this.texture?this.texture.update(t,{useMipmap:!0}):(this.texture=new Df(c,t,f.RGBA,{useMipmap:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE),c.extTextureFilterAnisotropic&&f.texParameterf(f.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax))}setDependencies(t,s){const c={};for(const f of s)c[f]=!0;this.dependencies[t]=c}hasDependency(t,s){for(const c of t){const f=this.dependencies[c];if(f){for(const p of s)if(f[p])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(t,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const c=ao(P2,this.tileID.canonical,this.tileTransform)[0],f=new _e,p=new fr;for(let g=0;g<c.length;g++){const{x:y,y:T}=c[g];f.emplaceBack(y,T),p.emplaceBack(g)}p.emplaceBack(0),this._tileDebugIndexBuffer=t.createIndexBuffer(p),this._tileDebugBuffer=t.createVertexBuffer(f,Ff.members),this._tileDebugSegments=Kr.simpleSegment(0,0,f.length,p.length)}_makeTileBoundsBuffers(t,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const c=ao(P2,this.tileID.canonical,this.tileTransform)[0];let f,p;if(this.isRaster){const g=function(y,T){const b=lc(y,T),C=Math.pow(2,y.z);for(let ae=0;ae<Ds;ae++)for(let fe=0;fe<Ds;fe++){const be=Ma((y.x+(fe+D2(fe))/Da)/C),Me=Zn((y.y+(ae+D2(ae))/Da)/C),Pe=T.project(be,Me),Le=ae*Ds+fe;Fs[2*Le+0]=Math.round((Pe.x*b.scale-b.x)*Jt),Fs[2*Le+1]=Math.round((Pe.y*b.scale-b.y)*Jt)}Yo.fill(0),S0.fill(0);for(let ae=2045;ae>=0;ae--){const fe=4*ae,be=Ko[fe+0],Me=Ko[fe+1],Pe=Ko[fe+2],Le=Ko[fe+3],ze=be+Pe>>1,Je=Me+Le>>1,et=ze+Je-Me,st=Je+be-ze,ot=Me*Ds+be,Ke=Le*Ds+Pe,nt=Je*Ds+ze,ct=Math.hypot((Fs[2*ot+0]+Fs[2*Ke+0])/2-Fs[2*nt+0],(Fs[2*ot+1]+Fs[2*Ke+1])/2-Fs[2*nt+1])>=16;if(Yo[nt]=Yo[nt]||(ct?1:0),ae<1022){const vt=(Me+st>>1)*Ds+(be+et>>1),ft=(Le+st>>1)*Ds+(Pe+et>>1);Yo[nt]=Yo[nt]||Yo[vt]||Yo[ft]}}const M=new Te,P=new Ft;let N=0;function Z(ae,fe){const be=fe*Ds+ae;return S0[be]===0&&(M.emplaceBack(Fs[2*be+0],Fs[2*be+1],ae*Jt/Da,fe*Jt/Da),S0[be]=++N),S0[be]-1}function ee(ae,fe,be,Me,Pe,Le){const ze=ae+be>>1,Je=fe+Me>>1;if(Math.abs(ae-Pe)+Math.abs(fe-Le)>1&&Yo[Je*Ds+ze])ee(Pe,Le,ae,fe,ze,Je),ee(be,Me,Pe,Le,ze,Je);else{const et=Z(ae,fe),st=Z(be,Me),ot=Z(Pe,Le);P.emplaceBack(et,st,ot)}}return ee(0,0,Da,Da,Da,0),ee(Da,Da,0,0,0,Da),{vertices:M,indices:P}}(this.tileID.canonical,s);f=g.vertices,p=g.indices}else{f=new Te,p=new Ft;for(const{x:y,y:T}of c)f.emplaceBack(y,T,0,0);const g=o0(f.int16,void 0,4);for(let y=0;y<g.length;y+=3)p.emplaceBack(g[y],g[y+1],g[y+2])}this._tileBoundsBuffer=t.createVertexBuffer(f,F2.members),this._tileBoundsIndexBuffer=t.createIndexBuffer(p),this._tileBoundsSegments=Kr.simpleSegment(0,0,f.length,p.length)}_makeGlobeTileDebugBuffers(t,s){if(this._globeTileDebugBorderBuffer||this._globeTileDebugTextBuffer||!s||s.name!=="globe")return;const c=this.tileID.canonical,f=E2(Pf(c));this._makeGlobeTileDebugBorderBuffer(t,c,f),this._makeGlobeTileDebugTextBuffer(t,c,f)}_makeGlobeTileDebugBorderBuffer(t,s,c){const f=new _e,p=new fr,g=new xe,y=(b,C,M,P,N)=>{const Z=(M-b)/(N-1),ee=(P-C)/(N-1),ae=f.length;for(let fe=0;fe<N;fe++){const be=b+fe*Z,Me=C+fe*ee;f.emplaceBack(be,Me);const Pe=T2(be,Me,s),Le=sc(Pe,Pe,c);g.emplaceBack(Le[0],Le[1],Le[2]),p.emplaceBack(ae+fe)}},T=Jt;y(0,0,T,0,16),y(T,0,T,T,16),y(T,T,0,T,16),y(0,T,0,0,16),this._tileDebugIndexBuffer=t.createIndexBuffer(p),this._tileDebugBuffer=t.createVertexBuffer(f,Ff.members),this._globeTileDebugBorderBuffer=t.createVertexBuffer(g,v2.members),this._tileDebugSegments=Kr.simpleSegment(0,0,f.length,p.length)}_makeGlobeTileDebugTextBuffer(t,s,c){const f=new _e,p=new Ft,g=new xe,y=25;p.reserve(32),f.reserve(y),g.reserve(y);const T=(b,C)=>y*b+C;for(let b=0;b<y;b++){const C=2048*b;for(let M=0;M<y;M++){const P=2048*M;f.emplaceBack(P,C);const N=T2(P,C,s),Z=sc(N,N,c);g.emplaceBack(Z[0],Z[1],Z[2])}}for(let b=0;b<4;b++)for(let C=0;C<4;C++){const M=T(b,C),P=T(b,C+1),N=T(b+1,C),Z=T(b+1,C+1);p.emplaceBack(M,P,N),p.emplaceBack(N,P,Z)}this._tileDebugTextIndexBuffer=t.createIndexBuffer(p),this._tileDebugTextBuffer=t.createVertexBuffer(f,Ff.members),this._globeTileDebugTextBuffer=t.createVertexBuffer(g,v2.members),this._tileDebugTextSegments=Kr.simpleSegment(0,0,y,32)}}class z3{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(t,s,c){const f=String(s);if(this.stateChanges[t]=this.stateChanges[t]||{},this.stateChanges[t][f]=this.stateChanges[t][f]||{},$e(this.stateChanges[t][f],c),this.deletedStates[t]===null){this.deletedStates[t]={};for(const p in this.state[t])p!==f&&(this.deletedStates[t][p]=null)}else if(this.deletedStates[t]&&this.deletedStates[t][f]===null){this.deletedStates[t][f]={};for(const p in this.state[t][f])c[p]||(this.deletedStates[t][f][p]=null)}else for(const p in c)this.deletedStates[t]&&this.deletedStates[t][f]&&this.deletedStates[t][f][p]===null&&delete this.deletedStates[t][f][p]}removeFeatureState(t,s,c){if(this.deletedStates[t]===null)return;const f=String(s);if(this.deletedStates[t]=this.deletedStates[t]||{},c&&s!==void 0)this.deletedStates[t][f]!==null&&(this.deletedStates[t][f]=this.deletedStates[t][f]||{},this.deletedStates[t][f][c]=null);else if(s!==void 0)if(this.stateChanges[t]&&this.stateChanges[t][f])for(c in this.deletedStates[t][f]={},this.stateChanges[t][f])this.deletedStates[t][f][c]=null;else this.deletedStates[t][f]=null;else this.deletedStates[t]=null}getState(t,s){const c=String(s),f=$e({},(this.state[t]||{})[c],(this.stateChanges[t]||{})[c]);if(this.deletedStates[t]===null)return{};if(this.deletedStates[t]){const p=this.deletedStates[t][s];if(p===null)return{};for(const g in p)delete f[g]}return f}initializeTileState(t,s){t.setFeatureState(this.state,s)}coalesceChanges(t,s){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const p={};for(const g in this.stateChanges[f])this.state[f][g]||(this.state[f][g]={}),$e(this.state[f][g],this.stateChanges[f][g]),p[g]=this.state[f][g];c[f]=p}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const p={};if(this.deletedStates[f]===null)for(const g in this.state[f])p[g]={},this.state[f][g]={};else for(const g in this.deletedStates[f]){if(this.deletedStates[f][g]===null)this.state[f][g]={};else for(const y of Object.keys(this.deletedStates[f][g]))delete this.state[f][g][y];p[g]=this.state[f][g]}c[f]=c[f]||{},$e(c[f],p)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in t)t[f].setFeatureState(c,s)}}class L2{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,s){const c=this.toIdx(t,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(t,s){return this.leaves[this.toIdx(t,s)]}toIdx(t,s){return s*this.size+t}}function R2(a,t,s,c){let f=0,p=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(c[g])<1e-15){if(s[g]<a[g]||s[g]>t[g])return null}else{const y=1/c[g];let T=(a[g]-s[g])*y,b=(t[g]-s[g])*y;if(T>b){const C=T;T=b,b=C}if(T>f&&(f=T),b<p&&(p=b),f>p)return null}return f}function z2(a,t,s,c,f,p,g,y,T,b,C){const M=c-a,P=f-t,N=p-s,Z=g-a,ee=y-t,ae=T-s,fe=C[1]*ae-C[2]*ee,be=C[2]*Z-C[0]*ae,Me=C[0]*ee-C[1]*Z,Pe=M*fe+P*be+N*Me;if(Math.abs(Pe)<1e-15)return null;const Le=1/Pe,ze=b[0]-a,Je=b[1]-t,et=b[2]-s,st=(ze*fe+Je*be+et*Me)*Le;if(st<0||st>1)return null;const ot=Je*N-et*P,Ke=et*M-ze*N,nt=ze*P-Je*M,ct=(C[0]*ot+C[1]*Ke+C[2]*nt)*Le;return ct<0||st+ct>1?null:(Z*ot+ee*Ke+ae*nt)*Le}function O2(a,t,s){return(a-t)/(s-t)}function B2(a,t,s,c,f,p,g,y,T){const b=1<<s,C=p-c,M=g-f,P=(a+1)/b*C+c,N=(t+0)/b*M+f,Z=(t+1)/b*M+f;y[0]=(a+0)/b*C+c,y[1]=N,T[0]=P,T[1]=Z}class N2{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(p){const g=Math.ceil(Math.log2(p.dim/8)),y=[];let T=Math.ceil(Math.pow(2,g));const b=1/T,C=(N,Z,ee,ae,fe)=>{const be=ae?1:0,Me=(N+1)*ee-be,Pe=Z*ee,Le=(Z+1)*ee-be;fe[0]=N*ee,fe[1]=Pe,fe[2]=Me,fe[3]=Le};let M=new L2(T);const P=[];for(let N=0;N<T*T;N++){C(N%T,Math.floor(N/T),b,!1,P);const Z=Jo(P[0],P[1],p),ee=Jo(P[2],P[1],p),ae=Jo(P[2],P[3],p),fe=Jo(P[0],P[3],p);M.minimums.push(Math.min(Z,ee,ae,fe)),M.maximums.push(Math.max(Z,ee,ae,fe)),M.leaves.push(1)}for(y.push(M),T/=2;T>=1;T/=2){const N=y[y.length-1];M=new L2(T);for(let Z=0;Z<T*T;Z++){C(Z%T,Math.floor(Z/T),2,!0,P);const ee=N.getElevation(P[0],P[1]),ae=N.getElevation(P[2],P[1]),fe=N.getElevation(P[2],P[3]),be=N.getElevation(P[0],P[3]),Me=N.isLeaf(P[0],P[1]),Pe=N.isLeaf(P[2],P[1]),Le=N.isLeaf(P[2],P[3]),ze=N.isLeaf(P[0],P[3]),Je=Math.min(ee.min,ae.min,fe.min,be.min),et=Math.max(ee.max,ae.max,fe.max,be.max),st=Me&&Pe&&Le&&ze;M.maximums.push(et),M.minimums.push(Je),M.leaves.push(et-Je<=5&&st?1:0)}y.push(M)}return y}(this.dem),c=s.length-1,f=s[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(t,s,c,f,p,g,y=1){return R2([t,s,-100],[c,f,this.maximums[0]*y],p,g)}raycast(t,s,c,f,p,g,y=1){if(!this.nodeCount)return null;const T=this.raycastRoot(t,s,c,f,p,g,y);if(T==null)return null;const b=[],C=[],M=[],P=[],N=[{idx:0,t:T,nodex:0,nodey:0,depth:0}];for(;N.length>0;){const{idx:Z,t:ee,nodex:ae,nodey:fe,depth:be}=N.pop();if(this.leaves[Z]){B2(ae,fe,be,t,s,c,f,M,P);const Pe=1<<be,Le=(ae+0)/Pe,ze=(ae+1)/Pe,Je=(fe+0)/Pe,et=(fe+1)/Pe,st=Jo(Le,Je,this.dem)*y,ot=Jo(ze,Je,this.dem)*y,Ke=Jo(ze,et,this.dem)*y,nt=Jo(Le,et,this.dem)*y,ct=z2(M[0],M[1],st,P[0],M[1],ot,P[0],P[1],Ke,p,g),vt=z2(P[0],P[1],Ke,M[0],P[1],nt,M[0],M[1],st,p,g),ft=Math.min(ct!==null?ct:Number.MAX_VALUE,vt!==null?vt:Number.MAX_VALUE);if(ft!==Number.MAX_VALUE)return ft;{const xt=ag([],p,g,ee);if(U2(st,ot,nt,Ke,O2(xt[0],M[0],P[0]),O2(xt[1],M[1],P[1]))>=xt[2])return ee}continue}let Me=0;for(let Pe=0;Pe<this._siblingOffset.length;Pe++){B2((ae<<1)+this._siblingOffset[Pe][0],(fe<<1)+this._siblingOffset[Pe][1],be+1,t,s,c,f,M,P),M[2]=-100,P[2]=this.maximums[this.childOffsets[Z]+Pe]*y;const Le=R2(M,P,p,g);if(Le!=null){const ze=Le;b[Pe]=ze;let Je=!1;for(let et=0;et<Me&&!Je;et++)ze>=b[C[et]]&&(C.splice(et,0,Pe),Je=!0);Je||(C[Me]=Pe),Me++}}for(let Pe=0;Pe<Me;Pe++){const Le=C[Pe];N.push({idx:this.childOffsets[Z]+Le,t:b[Le],nodex:(ae<<1)+this._siblingOffset[Le][0],nodey:(fe<<1)+this._siblingOffset[Le][1],depth:be+1})}}return null}_addNode(t,s,c){return this.minimums.push(t),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(t,s,c,f,p){if(t[f].isLeaf(s,c)===1)return;this.childOffsets[p]||(this.childOffsets[p]=this.nodeCount);const g=f-1,y=t[g];let T=0,b=0;for(let C=0;C<this._siblingOffset.length;C++){const M=2*s+this._siblingOffset[C][0],P=2*c+this._siblingOffset[C][1],N=y.getElevation(M,P),Z=y.isLeaf(M,P),ee=this._addNode(N.min,N.max,Z);Z&&(T|=1<<C),b||(b=ee)}for(let C=0;C<this._siblingOffset.length;C++)T&1<<C||this._construct(t,2*s+this._siblingOffset[C][0],2*c+this._siblingOffset[C][1],g,b+C)}}function U2(a,t,s,c,f,p){return Wt(Wt(a,s,p),Wt(t,c,p),f)}function Jo(a,t,s){const c=s.dim,f=ge(a*c-.5,0,c-1),p=ge(t*c-.5,0,c-1),g=Math.floor(f),y=Math.floor(p),T=Math.min(g+1,c-1),b=Math.min(y+1,c-1);return U2(s.get(g,y),s.get(T,y),s.get(g,b),s.get(T,b),f-g,p-y)}const V2={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class k0{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,s,c,f=!1,p=!1){if(this.uid=t,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return He(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const g=this.dim=s.height-2,y=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.encoding=c||"mapbox",this.borderReady=f,!f){for(let T=0;T<g;T++)y[this._idx(-1,T)]=y[this._idx(0,T)],y[this._idx(g,T)]=y[this._idx(g-1,T)],y[this._idx(T,-1)]=y[this._idx(T,0)],y[this._idx(T,g)]=y[this._idx(T,g-1)];y[this._idx(-1,-1)]=y[this._idx(0,0)],y[this._idx(g,-1)]=y[this._idx(g-1,0)],y[this._idx(-1,g)]=y[this._idx(0,g-1)],y[this._idx(g,g)]=y[this._idx(g-1,g-1)],p&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new N2(this)}get(t,s,c=!1){c&&(t=ge(t,-1,this.dim),s=ge(s,-1,this.dim));const f=4*this._idx(t,s);return(this.encoding==="terrarium"?this._unpackTerrarium:this._unpackMapbox)(this.pixels[f],this.pixels[f+1],this.pixels[f+2])}static getUnpackVector(t){return V2[t]}get unpackVector(){return V2[this.encoding]}_idx(t,s){if(t<-1||t>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(t+1)}_unpackMapbox(t,s,c){return(256*t*256+256*s+c)/10-1e4}_unpackTerrarium(t,s,c){return 256*t+s+c/256-32768}static pack(t,s){const c=[0,0,0,0],f=k0.getUnpackVector(s);let p=Math.floor((t+f[3])/f[2]);return c[2]=p%256,p=Math.floor(p/256),c[1]=p%256,p=Math.floor(p/256),c[0]=p,c}getPixels(){return new Yi({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,s,c){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let f=s*this.dim,p=s*this.dim+this.dim,g=c*this.dim,y=c*this.dim+this.dim;switch(s){case-1:f=p-1;break;case 1:p=f+1}switch(c){case-1:g=y-1;break;case 1:y=g+1}const T=-s*this.dim,b=-c*this.dim;for(let C=g;C<y;C++)for(let M=f;M<p;M++){const P=4*this._idx(M,C),N=4*this._idx(M+T,C+b);this.pixels[P+0]=t.pixels[N+0],this.pixels[P+1]=t.pixels[N+1],this.pixels[P+2]=t.pixels[N+2],this.pixels[P+3]=t.pixels[N+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}It(k0,"DEMData"),It(N2,"DemMinMaxQuadTree",{omit:["dem"]});class O3{constructor(t,s){this.max=t,this.onRemove=s,this.reset()}reset(){for(const t in this.data)for(const s of this.data[t])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(t,s,c){const f=t.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const p={value:s,timeout:void 0};if(c!==void 0&&(p.timeout=setTimeout(()=>{this.remove(t,p)},c)),this.data[f].push(p),this.order.push(f),this.order.length>this.max){const g=this._getAndRemoveByKey(this.order[0]);g&&this.onRemove(g)}return this}has(t){return t.wrapped().key in this.data}getAndRemove(t){return this.has(t)?this._getAndRemoveByKey(t.wrapped().key):null}_getAndRemoveByKey(t){const s=this.data[t].shift();return s.timeout&&clearTimeout(s.timeout),this.data[t].length===0&&delete this.data[t],this.order.splice(this.order.indexOf(t),1),s.value}getByKey(t){const s=this.data[t];return s?s[0].value:null}get(t){return this.has(t)?this.data[t.wrapped().key][0].value:null}remove(t,s){if(!this.has(t))return this;const c=t.wrapped().key,f=s===void 0?0:this.data[c].indexOf(s),p=this.data[c][f];return this.data[c].splice(f,1),p.timeout&&clearTimeout(p.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(p.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(t){for(this.max=t;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(t){const s=[];for(const c in this.data)for(const f of this.data[c])t(f.value)||s.push(f);for(const c of s)this.remove(c.value.tileID,c)}}class Ru{constructor(t,s,c){this.func=t,this.mask=s,this.range=c}}Ru.ReadOnly=!1,Ru.ReadWrite=!0,Ru.disabled=new Ru(519,Ru.ReadOnly,[0,1]);const zg=7680;class Og{constructor(t,s,c,f,p,g){this.test=t,this.ref=s,this.mask=c,this.fail=f,this.depthFail=p,this.pass=g}}Og.disabled=new Og({func:519,mask:0},0,0,zg,zg,zg);class Ps{constructor(t,s,c){this.blendFunction=t,this.blendColor=s,this.mask=c}}Ps.Replace=[1,0],Ps.disabled=new Ps(Ps.Replace,pr.transparent,[!1,!1,!1,!1]),Ps.unblended=new Ps(Ps.Replace,pr.transparent,[!0,!0,!0,!0]),Ps.alphaBlended=new Ps([1,771],pr.transparent,[!0,!0,!0,!0]);const Bg=1029,Ng=2305;class ns{constructor(t,s,c){this.enable=t,this.mode=s,this.frontFace=c}}ns.disabled=new ns(!1,Bg,Ng),ns.backCCW=new ns(!0,Bg,Ng),ns.backCW=new ns(!0,Bg,2304),ns.frontCW=new ns(!0,1028,2304),ns.frontCCW=new ns(!0,1028,Ng);class cc extends Fe{constructor(t,s,c){super(),this.id=t,this._onlySymbols=c,s.on("data",f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new O3(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new z3,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(t){this.map=t,this._minTileCacheSize=this._minTileCacheSize===void 0&&t?t._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&t?t._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const t in this._tiles){const s=this._tiles[t];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const t=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,t&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(t,s){return t.isSymbolTile=this._onlySymbols,this._source.loadTile(t,s)}_unloadTile(t){if(this._source.unloadTile)return this._source.unloadTile(t,()=>{})}_abortTile(t){if(this._source.abortTile)return this._source.abortTile(t,()=>{})}serialize(){return this._source.serialize()}prepare(t){if(this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null),this._source.prepareTile)for(const s in this._tiles){const c=this._tiles[s];this._source.prepareTile(c)&&this.map.painter.terrain&&this.map.painter.terrain._clearRenderCacheForTile(this.id,c.tileID),c.upload(t),c.prepare(this.map.style.imageManager)}else for(const s in this._tiles){const c=this._tiles[s];c.upload(t),c.prepare(this.map.style.imageManager)}}getIds(){return Xe(this._tiles).map(t=>t.tileID).sort(j2).map(t=>t.key)}getRenderableIds(t){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,t)&&s.push(this._tiles[c]);return t?s.sort((c,f)=>{const p=c.tileID,g=f.tileID,y=new D(p.canonical.x,p.canonical.y)._rotate(this.transform.angle),T=new D(g.canonical.x,g.canonical.y)._rotate(this.transform.angle);return p.overscaledZ-g.overscaledZ||T.y-y.y||T.x-y.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(j2).map(c=>c.key)}hasRenderableParent(t){const s=this.findLoadedParent(t,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(t,s){return this._tiles[t]&&this._tiles[t].hasData()&&!this._coveredTiles[t]&&(s||!this._tiles[t].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const t in this._tiles)this._tiles[t].state!=="errored"&&this._reloadTile(+t,"reloading")}}_reloadTile(t,s){const c=this._tiles[t];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,t,s)))}_tileLoaded(t,s,c,f){if(f)if(t.state="errored",f.status!==404)this._source.fire(new Ne(f,{tile:t}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const p=this.map.painter.terrain;this.update(this.transform,p.getScaledDemTileSize(),!0),p.resetTileLookupCache(this.id)}else this.update(this.transform);else t.timeAdded=or.now(),c==="expired"&&(t.refreshedUponExpiration=!0),this._setTileReloadTimer(s,t),this._source.type==="raster-dem"&&t.dem&&this._backfillDEM(t),this._state.initializeTileState(t,this.map?this.map.painter:null),this._source.fire(new De("data",{dataType:"source",tile:t,coord:t.tileID,sourceCacheId:this.id}))}_backfillDEM(t){const s=this.getRenderableIds();for(let f=0;f<s.length;f++){const p=s[f];if(t.neighboringTiles&&t.neighboringTiles[p]){const g=this.getTileByID(p);c(t,g),c(g,t)}}function c(f,p){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let g=p.tileID.canonical.x-f.tileID.canonical.x;const y=p.tileID.canonical.y-f.tileID.canonical.y,T=Math.pow(2,f.tileID.canonical.z),b=p.tileID.key;g===0&&y===0||Math.abs(y)>1||(Math.abs(g)>1&&(Math.abs(g+T)===1?g+=T:Math.abs(g-T)===1&&(g-=T)),p.dem&&f.dem&&(f.dem.backfillBorder(p.dem,g,y),f.neighboringTiles&&f.neighboringTiles[b]&&(f.neighboringTiles[b].backfilled=!0)))}}getTile(t){return this.getTileByID(t.key)}getTileByID(t){return this._tiles[t]}_retainLoadedChildren(t,s,c,f){for(const p in this._tiles){let g=this._tiles[p];if(f[p]||!g.hasData()||g.tileID.overscaledZ<=s||g.tileID.overscaledZ>c)continue;let y=g.tileID;for(;g&&g.tileID.overscaledZ>s+1;){const b=g.tileID.scaledTo(g.tileID.overscaledZ-1);g=this._tiles[b.key],g&&g.hasData()&&(y=b)}let T=y;for(;T.overscaledZ>s;)if(T=T.scaledTo(T.overscaledZ-1),t[T.key]){f[y.key]=y;break}}}findLoadedParent(t,s){if(t.key in this._loadedParentTiles){const c=this._loadedParentTiles[t.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=t.overscaledZ-1;c>=s;c--){const f=t.scaledTo(c),p=this._getLoadedTile(f);if(p)return p}}_getLoadedTile(t){const s=this._tiles[t.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?t.wrapped().key:t.canonical.key)}updateCacheSize(t,s){s=s||this._source.tileSize;const c=Math.ceil(t.width/s)+1,f=Math.ceil(t.height/s)+1,p=Math.floor(c*f*5),g=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,p):p,y=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,g):g;this._cache.setMaxSize(y)}handleWrapJump(t){const s=Math.round((t-(this._prevLng===void 0?t:this._prevLng))/360);if(this._prevLng=t,s){const c={};for(const f in this._tiles){const p=this._tiles[f];p.tileID=p.tileID.unwrapTo(p.tileID.wrap+s),c[p.tileID.key]=p}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(t,s,c){if(this.transform=t,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let f;this.updateCacheSize(t,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=t.getVisibleUnwrappedCoordinates(this._source.tileID).map(y=>new oi(y.canonical.z,y.wrap,y.canonical.z,y.canonical.x,y.canonical.y)):(f=t.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter(y=>this._source.hasTile(y)))):f=[];const p=this._updateRetainedTiles(f);if(G2(this._source.type)&&f.length!==0){const y={},T={},b=Object.keys(p);for(const M of b){const P=p[M],N=this._tiles[M];if(!N||N.fadeEndTime&&N.fadeEndTime<=or.now())continue;const Z=this.findLoadedParent(P,Math.max(P.overscaledZ-cc.maxOverzooming,this._source.minzoom));Z&&(this._addTile(Z.tileID),y[Z.tileID.key]=Z.tileID),T[M]=P}const C=f[f.length-1].overscaledZ;for(const M in this._tiles){const P=this._tiles[M];if(p[M]||!P.hasData())continue;let N=P.tileID;for(;N.overscaledZ>C;){N=N.scaledTo(N.overscaledZ-1);const Z=this._tiles[N.key];if(Z&&Z.hasData()&&T[N.key]){p[M]=P.tileID;break}}}for(const M in y)p[M]||(this._coveredTiles[M]=!0,p[M]=y[M])}for(const y in p)this._tiles[y].clearFadeHold();const g=function(y,T){const b=[];for(const C in y)C in T||b.push(C);return b}(this._tiles,p);for(const y of g){const T=this._tiles[y];T.hasSymbolBuckets&&!T.holdingForFade()?T.setHoldDuration(this.map._fadeDuration):T.hasSymbolBuckets&&!T.symbolFadeFinished()||this._removeTile(+y)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const t in this._tiles)this._tiles[t].holdingForFade()&&this._removeTile(+t)}_updateRetainedTiles(t){const s={};if(t.length===0)return s;const c={},f=t.reduce((b,C)=>Math.min(b,C.overscaledZ),1/0),p=t[0].overscaledZ,g=Math.max(p-cc.maxOverzooming,this._source.minzoom),y=Math.max(p+cc.maxUnderzooming,this._source.minzoom),T={};for(const b of t){const C=this._addTile(b);s[b.key]=b,C.hasData()||f<this._source.maxzoom&&(T[b.key]=b)}this._retainLoadedChildren(T,f,y,s);for(const b of t){let C=this._tiles[b.key];if(C.hasData())continue;if(b.canonical.z>=this._source.maxzoom){const P=b.children(this._source.maxzoom)[0],N=this.getTile(P);if(N&&N.hasData()){s[P.key]=P;continue}}else{const P=b.children(this._source.maxzoom);if(s[P[0].key]&&s[P[1].key]&&s[P[2].key]&&s[P[3].key])continue}let M=C.wasRequested();for(let P=b.overscaledZ-1;P>=g;--P){const N=b.scaledTo(P);if(c[N.key]||(c[N.key]=!0,C=this.getTile(N),!C&&M&&(C=this._addTile(N)),C&&(s[N.key]=N,M=C.wasRequested(),C.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const t in this._tiles){const s=[];let c,f=this._tiles[t].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}s.push(f.key);const p=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(p),c)break;f=p}for(const p of s)this._loadedParentTiles[p]=c}}_addTile(t){let s=this._tiles[t.key];if(s)return this._source.prepareTile&&this._source.prepareTile(s),s;s=this._cache.getAndRemove(t),s&&(this._setTileReloadTimer(t.key,s),s.tileID=t,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[t.key]&&(clearTimeout(this._cacheTimers[t.key]),delete this._cacheTimers[t.key],this._setTileReloadTimer(t.key,s)));const c=Boolean(s);if(!c){const f=this.map?this.map.painter:null;s=new Rg(t,this._source.tileSize*t.overscaleFactor(),this.transform.tileZoom,f,this._isRaster),this._source.prepareTile&&this._source.prepareTile(s)||this._loadTile(s,this._tileLoaded.bind(this,s,t.key,s.state))}return s?(s.uses++,this._tiles[t.key]=s,c||this._source.fire(new De("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(t,s){t in this._timers&&(clearTimeout(this._timers[t]),delete this._timers[t]);const c=s.getExpiryTimeout();c&&(this._timers[t]=setTimeout(()=>{this._reloadTile(t,"expired"),delete this._timers[t]},c))}_removeTile(t){const s=this._tiles[t];s&&(s.uses--,delete this._tiles[t],this._timers[t]&&(clearTimeout(this._timers[t]),delete this._timers[t]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const t in this._tiles)this._removeTile(+t);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(t,s,c){const f=[],p=this.transform;if(!p)return f;for(const g in this._tiles){const y=this._tiles[g];if(c&&y.clearQueryDebugViz(),y.holdingForFade())continue;const T=t.containsTile(y,p,s);T&&f.push(T)}return f}getVisibleCoordinates(t){const s=this.getRenderableIds(t).map(c=>this._tiles[c].tileID);for(const c of s)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(G2(this._source.type))for(const t in this._tiles){const s=this._tiles[t];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=or.now())return!0}return!1}setFeatureState(t,s,c){this._state.updateState(t=t||"_geojsonTileLayer",s,c)}removeFeatureState(t,s,c){this._state.removeFeatureState(t=t||"_geojsonTileLayer",s,c)}getFeatureState(t,s){return this._state.getState(t=t||"_geojsonTileLayer",s)}setDependencies(t,s,c){const f=this._tiles[t];f&&f.setDependencies(s,c)}reloadTilesForDependencies(t,s){for(const c in this._tiles)this._tiles[c].hasDependency(t,s)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(t,s))}_preloadTiles(t,s){const c=new Map,f=Array.isArray(t)?t:[t],p=this.map.painter.terrain,g=this.usedForTerrain&&p?p.getScaledDemTileSize():this._source.tileSize;for(const y of f){const T=y.coveringTiles({tileSize:g,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const b of T)c.set(b.key,b);this.usedForTerrain&&y.updateElevation(!1)}Ie(Array.from(c.values()),(y,T)=>{const b=new Rg(y,this._source.tileSize*y.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(b,C=>{this._source.type==="raster-dem"&&b.dem&&this._backfillDEM(b),T(C,b)})},s)}}function j2(a,t){const s=Math.abs(2*a.wrap)-+(a.wrap<0),c=Math.abs(2*t.wrap)-+(t.wrap<0);return a.overscaledZ-t.overscaledZ||c-s||t.canonical.y-a.canonical.y||t.canonical.x-a.canonical.x}function G2(a){return a==="raster"||a==="image"||a==="video"}cc.maxOverzooming=10,cc.maxUnderzooming=3;class A0{constructor(t,s,c){this._demTile=t,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(t,s,c){const f=c||t.findDEMTileFor(s);if(!f||!f.dem)return;const p=f.dem,g=f.tileID,y=1<<s.canonical.z-g.canonical.z;return new A0(f,f.tileSize/Jt/y,[(s.canonical.x/y-g.canonical.x)*p.dim,(s.canonical.y/y-g.canonical.y)*p.dim])}tileCoordToPixel(t,s){const c=s*this._scale+this._offset[1],f=Math.floor(t*this._scale+this._offset[0]),p=Math.floor(c);return new D(f,p)}getElevationAt(t,s,c,f){const p=t*this._scale+this._offset[0],g=s*this._scale+this._offset[1],y=Math.floor(p),T=Math.floor(g),b=this._dem;return f=!!f,c?Wt(Wt(b.get(y,T,f),b.get(y,T+1,f),g-T),Wt(b.get(y+1,T,f),b.get(y+1,T+1,f),g-T),p-y):b.get(y,T,f)}getElevationAtPixel(t,s,c){return this._dem.get(t,s,!!c)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*wu(1,t)*this._dem.stride}}class $2{constructor(t,s){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new Ss(Jt,16,0),this.featureIndexArray=new Gr,this.promoteId=s}insert(t,s,c,f,p,g=0){const y=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,p,g);const T=this.grid;for(let b=0;b<s.length;b++){const C=s[b],M=[1/0,1/0,-1/0,-1/0];for(let P=0;P<C.length;P++){const N=C[P];M[0]=Math.min(M[0],N.x),M[1]=Math.min(M[1],N.y),M[2]=Math.max(M[2],N.x),M[3]=Math.max(M[3],N.y)}M[0]<Jt&&M[1]<Jt&&M[2]>=0&&M[3]>=0&&T.insert(y,M[0],M[1],M[2],M[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new oc.VectorTile(new Cf(this.rawTileData)).layers,this.sourceLayerCoder=new I2(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,s,c,f){this.loadVTLayers();const p=t.params||{},g=Ts(p.filter),y=t.tileResult,T=t.transform,b=y.bufferedTilespaceBounds,C=this.grid.query(b.min.x,b.min.y,b.max.x,b.max.y,(Z,ee,ae,fe)=>hv(y.bufferedTilespaceGeometry,Z,ee,ae,fe));C.sort(B3);let M=null;T.elevation&&C.length>0&&(M=A0.create(T.elevation,this.tileID));const P={};let N;for(let Z=0;Z<C.length;Z++){const ee=C[Z];if(ee===N)continue;N=ee;const ae=this.featureIndexArray.get(ee);let fe=null;this.loadMatchingFeature(P,ae,g,p.layers,p.availableImages,s,c,f,(be,Me,Pe,Le=0)=>(fe||(fe=ao(be,this.tileID.canonical,t.tileTransform)),Me.queryIntersectsFeature(y,be,Pe,fe,this.z,t.transform,t.pixelPosMatrix,M,Le)))}return P}loadMatchingFeature(t,s,c,f,p,g,y,T,b){const{featureIndex:C,bucketIndex:M,sourceLayerIndex:P,layoutVertexArrayOffset:N}=s,Z=this.bucketLayerIDs[M];if(f&&!function(be,Me){for(let Pe=0;Pe<be.length;Pe++)if(Me.indexOf(be[Pe])>=0)return!0;return!1}(f,Z))return;const ee=this.sourceLayerCoder.decode(P),ae=this.vtLayers[ee].feature(C);if(c.needGeometry){const be=ic(ae,!0);if(!c.filter(new Fr(this.tileID.overscaledZ),be,this.tileID.canonical))return}else if(!c.filter(new Fr(this.tileID.overscaledZ),ae))return;const fe=this.getId(ae,ee);for(let be=0;be<Z.length;be++){const Me=Z[be];if(f&&f.indexOf(Me)<0)continue;const Pe=g[Me];if(!Pe)continue;let Le={};fe!==void 0&&T&&(Le=T.getState(Pe.sourceLayer||"_geojsonTileLayer",fe));const ze=$e({},y[Me]);ze.paint=W2(ze.paint,Pe.paint,ae,Le,p),ze.layout=W2(ze.layout,Pe.layout,ae,Le,p);const Je=!b||b(ae,Pe,Le,N);if(!Je)continue;const et=new M2(ae,this.z,this.x,this.y,fe);et.layer=ze;let st=t[Me];st===void 0&&(st=t[Me]=[]),st.push({featureIndex:C,feature:et,intersectionZ:Je})}}lookupSymbolFeatures(t,s,c,f,p,g,y,T){const b={};this.loadVTLayers();const C=Ts(p);for(const M of t)this.loadMatchingFeature(b,{bucketIndex:c,sourceLayerIndex:f,featureIndex:M,layoutVertexArrayOffset:0},C,g,y,T,s);return b}loadFeature(t){const{featureIndex:s,sourceLayerIndex:c}=t;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),p=this.vtFeatures[f];if(p[s])return p[s];const g=this.vtLayers[f].feature(s);return p[s]=g,g}hasLayer(t){for(const s of this.bucketLayerIDs)for(const c of s)if(t===c)return!0;return!1}getId(t,s){let c=t.id;return this.promoteId&&(c=t.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof c=="boolean"&&(c=Number(c))),c}}function W2(a,t,s,c,f){return Be(a,(p,g)=>{const y=t instanceof w?t.get(g):null;return y&&y.evaluate?y.evaluate(s,c,f):y})}function B3(a,t){return t-a}It($2,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Z2{constructor(t){const s={},c=[];for(const y in t){const T=t[y],b=s[y]={};for(const C in T.glyphs){const M=T.glyphs[+C];if(!M||M.bitmap.width===0||M.bitmap.height===0)continue;const P=M.metrics.localGlyph?2:1,N={x:0,y:0,w:M.bitmap.width+2*P,h:M.bitmap.height+2*P};c.push(N),b[C]=N}}const{w:f,h:p}=gg(c),g=new so({width:f||1,height:p||1});for(const y in t){const T=t[y];for(const b in T.glyphs){const C=T.glyphs[+b];if(!C||C.bitmap.width===0||C.bitmap.height===0)continue;const M=s[y][b],P=C.metrics.localGlyph?2:1;so.copy(C.bitmap,g,{x:0,y:0},{x:M.x+P,y:M.y+P},C.bitmap)}}this.image=g,this.positions=s}}It(Z2,"GlyphAtlas");class N3{constructor(t){this.tileID=new oi(t.tileID.overscaledZ,t.tileID.wrap,t.tileID.canonical.z,t.tileID.canonical.x,t.tileID.canonical.y),this.tileZoom=t.tileZoom,this.uid=t.uid,this.zoom=t.zoom,this.canonical=t.tileID.canonical,this.pixelRatio=t.pixelRatio,this.tileSize=t.tileSize,this.source=t.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=t.showCollisionBoxes,this.collectResourceTiming=!!t.collectResourceTiming,this.returnDependencies=!!t.returnDependencies,this.promoteId=t.promoteId,this.enableTerrain=!!t.enableTerrain,this.isSymbolTile=t.isSymbolTile,this.tileTransform=lc(t.tileID.canonical,t.projection),this.projection=t.projection}parse(t,s,c,f,p){this.status="parsing",this.data=t,this.collisionBoxArray=new Qa;const g=new I2(Object.keys(t.layers).sort()),y=new $2(this.tileID,this.promoteId);y.bucketLayerIDs=[];const T={},b=new Dg(256,256),C={featureIndex:y,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:b,availableImages:c},M=s.familiesBySource[this.source];for(const Le in M){const ze=t.layers[Le];if(!ze)continue;let Je=!1,et=!1;for(const Ke of M[Le])Ke[0].type==="symbol"?Je=!0:et=!0;if(this.isSymbolTile===!0&&!Je||this.isSymbolTile===!1&&!et)continue;ze.version===1&&He(`Vector tile source "${this.source}" layer "${Le}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const st=g.encode(Le),ot=[];for(let Ke=0;Ke<ze.length;Ke++){const nt=ze.feature(Ke),ct=y.getId(nt,Le);ot.push({feature:nt,id:ct,index:Ke,sourceLayerIndex:st})}for(const Ke of M[Le]){const nt=Ke[0];this.isSymbolTile!==void 0&&nt.type==="symbol"!==this.isSymbolTile||nt.minzoom&&this.zoom<Math.floor(nt.minzoom)||nt.maxzoom&&this.zoom>=nt.maxzoom||nt.visibility!=="none"&&(Ug(Ke,this.zoom,c),(T[nt.id]=nt.createBucket({index:y.bucketLayerIDs.length,layers:Ke,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:st,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.name,availableImages:c})).populate(ot,C,this.tileID.canonical,this.tileTransform),y.bucketLayerIDs.push(Ke.map(ct=>ct.id)))}}let P,N,Z,ee;b.trim();const ae={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},fe=Be(C.glyphDependencies,Le=>Object.keys(Le).map(Number));Object.keys(fe).length?f.send("getGlyphs",{uid:this.uid,stacks:fe},(Le,ze)=>{P||(P=Le,N=ze,Pe.call(this))},void 0,!1,ae):N={};const be=Object.keys(C.iconDependencies);be.length?f.send("getImages",{icons:be,source:this.source,tileID:this.tileID,type:"icons"},(Le,ze)=>{P||(P=Le,Z=ze,Pe.call(this))},void 0,!1,ae):Z={};const Me=Object.keys(C.patternDependencies);function Pe(){if(P)return p(P);if(N&&Z&&ee){const Le=new Z2(N),ze=new Yv(Z,ee);for(const Je in T){const et=T[Je];et instanceof qo?(Ug(et.layers,this.zoom,c),d3(et,N,Le.positions,Z,ze.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):et.hasPattern&&(et instanceof p0||et instanceof f0||et instanceof Sf)&&(Ug(et.layers,this.zoom,c),et.addFeatures(C,this.tileID.canonical,ze.patternPositions,c,this.tileTransform))}this.status="done",p(null,{buckets:Xe(T).filter(Je=>!Je.isEmpty()),featureIndex:y,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Le.image,lineAtlas:b,imageAtlas:ze,glyphMap:this.returnDependencies?N:null,iconMap:this.returnDependencies?Z:null,glyphPositions:this.returnDependencies?Le.positions:null})}}Me.length?f.send("getImages",{icons:Me,source:this.source,tileID:this.tileID,type:"patterns"},(Le,ze)=>{P||(P=Le,ee=ze,Pe.call(this))},void 0,!1,ae):ee={},Pe.call(this)}}function Ug(a,t,s){const c=new Fr(t);for(const f of a)f.recalculate(c,s)}class H2{constructor(t){this.entries={},this.scheduler=t}request(t,s,c,f){const p=this.entries[t]=this.entries[t]||{callbacks:[]};if(p.result){const[g,y]=p.result;return this.scheduler?this.scheduler.add(()=>{f(g,y)},s):f(g,y),()=>{}}return p.callbacks.push(f),p.cancel||(p.cancel=c((g,y)=>{p.result=[g,y];for(const T of p.callbacks)this.scheduler?this.scheduler.add(()=>{T(g,y)},s):T(g,y);setTimeout(()=>delete this.entries[t],3e3)})),()=>{p.result||(p.callbacks=p.callbacks.filter(g=>g!==f),p.callbacks.length||(p.cancel(),delete this.entries[t]))}}}function X2(a,t,s){const c=JSON.stringify(a.request);return a.data&&(this.deduped.entries[c]={result:[null,a.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom},f=>{const p=we(a.request,(g,y,T,b)=>{g?f(g):y&&f(null,{vectorTile:s?void 0:new oc.VectorTile(new Cf(y)),rawData:y,cacheControl:T,expires:b})});return()=>{p.cancel(),f()}},t)}const U3=Is(new Float32Array(16));class Qo{constructor(t){this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,s){return{x:0,y:0,z:0}}unproject(t,s){return new Sr(0,0)}projectTilePoint(t,s,c){return{x:t,y:s,z:0}}locationPoint(t,s){return t._coordinatePoint(t.locationCoordinate(s),!1)}pixelsPerMeter(t,s){return wu(1,t)*s}farthestPixelDistance(t){return function(s,c){const f=s.fovAboveCenter,p=s.elevation?s.elevation.getMinElevationBelowMSL()*c:0,g=(s._camera.position[2]*s.worldSize-p)/Math.cos(s._pitch),y=Math.sin(f)*g/Math.sin(Math.max(Math.PI/2-s._pitch-f,.01)),T=Math.sin(s._pitch)*y+g;return Math.min(1.01*T,g*(1/s._horizonShift))}(t,t.pixelsPerMeter)}pointCoordinate(t,s,c,f){const p=t.horizonLineFromTop(!1),g=new D(s,Math.max(p,c));return t.rayIntersectionCoordinate(t.pointRayIntersection(g,f))}createInversionMatrix(t,s){return U3}createTileMatrix(t,s,c){let f,p,g;const y=c.canonical,T=Is(new Float64Array(16));if(this.isReprojectedInTileSpace){const b=lc(y,this);f=1,p=b.x+c.wrap*b.scale,g=b.y,Zo(T,T,[f/b.scale,f/b.scale,t.pixelsPerMeter/s])}else f=s/t.zoomScale(y.z),p=(y.x+Math.pow(2,y.z)*c.wrap)*f,g=y.y*f;return ac(T,T,[p,g,0]),Zo(T,T,[f/Jt,f/Jt,1]),T}upVector(t,s,c){return[0,0,1]}upVectorScale(t,s,c){return{metersToTile:1,metersToLabelSpace:1}}}class V3 extends Qo{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,s){return{x:df(t),y:vu(s),z:0}}unproject(t,s){const c=Ma(t),f=Zn(s);return new Sr(c,f)}}class j3 extends Qo{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[s,c]=this.parallels=t.parallels||[29.5,45.5],f=Math.sin(Y(s));this.n=(f+Math.sin(Y(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(t,s){const{n:c,c:f,r0:p}=this,g=Y(t-this.center[0]),y=Y(s),T=Math.sqrt(f-2*c*Math.sin(y))/c;return{x:T*Math.sin(g*c),y:T*Math.cos(g*c)-p,z:0}}unproject(t,s){const{n:c,c:f,r0:p}=this,g=p+s;let y=Math.atan2(t,Math.abs(g))*Math.sign(g);g*c<0&&(y-=Math.PI*Math.sign(t)*Math.sign(g));const T=Y(this.center[0])*c;y=ke(y,-Math.PI-T,Math.PI-T);const b=X(y/c)+this.center[0],C=Math.asin(ge((f-(t*t+g*g)*c*c)/(2*c),-1,1)),M=ge(X(C),-85.051129,Cs);return new Sr(b,M)}}const Rf=1.340264,zf=-.081106,Of=893e-6,Bf=.003796,C0=Math.sqrt(3)/2;class G3 extends Qo{project(t,s){s=s/180*Math.PI,t=t/180*Math.PI;const c=Math.asin(C0*Math.sin(s)),f=c*c,p=f*f*f;return{x:.5*(t*Math.cos(c)/(C0*(Rf+3*zf*f+p*(7*Of+9*Bf*f)))/Math.PI+.5),y:1-.5*(c*(Rf+zf*f+p*(Of+Bf*f))/Math.PI+1),z:0}}unproject(t,s){t=(2*t-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,f=c*c,p=f*f*f;for(let C,M,P,N=0;N<12&&(M=c*(Rf+zf*f+p*(Of+Bf*f))-s,P=Rf+3*zf*f+p*(7*Of+9*Bf*f),C=M/P,c=ge(c-C,-Math.PI/3,Math.PI/3),f=c*c,p=f*f*f,!(Math.abs(C)<1e-12));++N);const g=C0*t*(Rf+3*zf*f+p*(7*Of+9*Bf*f))/Math.cos(c),y=Math.asin(Math.sin(c)/C0),T=ge(180*g/Math.PI,-180,180),b=ge(180*y/Math.PI,-85.051129,Cs);return new Sr(T,b)}}class $3 extends Qo{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,s){return{x:.5+t/360,y:.5-s/360,z:0}}unproject(t,s){const c=360*(t-.5),f=ge(360*(.5-s),-85.051129,Cs);return new Sr(c,f)}}const zu=Math.PI/2;function I0(a){return Math.tan((zu+a)/2)}class W3 extends Qo{constructor(t){super(t),this.center=t.center||[0,30];const[s,c]=this.parallels=t.parallels||[30,30],f=Y(s),p=Y(c),g=Math.cos(f);this.n=f===p?Math.sin(f):Math.log(g/Math.cos(p))/Math.log(I0(p)/I0(f)),this.f=g*Math.pow(I0(f),this.n)/this.n}project(t,s){s=Y(s),t=Y(t-this.center[0]);const c=1e-6,{n:f,f:p}=this;p>0?s<-zu+c&&(s=-zu+c):s>zu-c&&(s=zu-c);const g=p/Math.pow(I0(s),f),y=g*Math.sin(f*t),T=p-g*Math.cos(f*t);return{x:.5*(y/Math.PI+.5),y:1-.5*(T/Math.PI+.5),z:0}}unproject(t,s){t=(2*t-.5)*Math.PI,s=(2*(1-s)-.5)*Math.PI;const{n:c,f}=this,p=f-s,g=Math.sign(p),y=Math.sign(c)*Math.sqrt(t*t+p*p);let T=Math.atan2(t,Math.abs(p))*g;p*c<0&&(T-=Math.PI*Math.sign(t)*g);const b=ge(X(T/c)+this.center[0],-180,180),C=ge(X(2*Math.atan(Math.pow(f/y,1/c))-zu),-85.051129,Cs);return new Sr(b,C)}}const q2=Y(Cs);class Z3 extends Qo{project(t,s){const c=(s=Y(s))*s,f=c*c;return{x:.5*((t=Y(t))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(t,s){t=(2*t-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,f=25,p=0,g=c*c;do{g=c*c;const b=g*g;p=(c*(1.007226+g*(.015085+b*(.028874*g-.044475-.005916*b)))-s)/(1.007226+g*(.045255+b*(.259866*g-.311325-.005916*11*b))),c=ge(c-p,-q2,q2)}while(Math.abs(p)>1e-6&&--f>0);g=c*c;const y=ge(X(t/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),T=X(c);return new Sr(y,T)}}const K2=Y(Cs);class H3 extends Qo{project(t,s){s=Y(s),t=Y(t);const c=Math.cos(s),f=2/Math.PI,p=Math.acos(c*Math.cos(t/2)),g=Math.sin(p)/p,y=.5*(t*f+2*c*Math.sin(t/2)/g)||0,T=.5*(s+Math.sin(s)/g)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(T/Math.PI+1),z:0}}unproject(t,s){let c=t=(2*t-.5)*Math.PI,f=s=(2*(1-s)-1)*Math.PI,p=25;const g=1e-6;let y=0,T=0;do{const b=Math.cos(f),C=Math.sin(f),M=2*C*b,P=C*C,N=b*b,Z=Math.cos(c/2),ee=Math.sin(c/2),ae=2*Z*ee,fe=ee*ee,be=1-N*Z*Z,Me=be?1/be:0,Pe=be?Math.acos(b*Z)*Math.sqrt(1/be):0,Le=.5*(2*Pe*b*ee+2*c/Math.PI)-t,ze=.5*(Pe*C+f)-s,Je=.5*Me*(N*fe+Pe*b*Z*P)+1/Math.PI,et=Me*(ae*M/4-Pe*C*ee),st=.125*Me*(M*ee-Pe*C*N*ae),ot=.5*Me*(P*Z+Pe*fe*b)+.5,Ke=et*st-ot*Je;y=(ze*et-Le*ot)/Ke,T=(Le*st-ze*Je)/Ke,c=ge(c-y,-Math.PI,Math.PI),f=ge(f-T,-K2,K2)}while((Math.abs(y)>g||Math.abs(T)>g)&&--p>0);return new Sr(X(c),X(f))}}class Y2 extends Qo{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Y(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,s){const{scale:c,cosPhi:f}=this;return{x:Y(t)*f*c+.5,y:-Math.sin(Y(s))/f*c+.5,z:0}}unproject(t,s){const{scale:c,cosPhi:f}=this,p=-(s-.5)/c,g=ge(X((t-.5)/c)/f,-180,180),y=Math.asin(ge(p*f,-1,1)),T=ge(X(y),-85.051129,Cs);return new Sr(g,T)}}o.ARRAY_TYPE=Ki,o.AUTH_ERR_MSG=On,o.Aabb=_a,o.Actor=class{constructor(a,t,s){this.target=a,this.parent=t,this.mapId=s,this.callbacks={},this.cancelCallbacks={},zt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=at()?a:B,this.scheduler=new A3}send(a,t,s,c,f=!1,p){const g=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=p,this.callbacks[g]=s);const y=Cr(this.globalScope)?void 0:[];return this.target.postMessage({id:g,type:a,hasCallback:!!s,targetMapId:c,mustQueue:f,sourceMapId:this.mapId,data:ql(t,y)},y),{cancel:()=>{s&&delete this.callbacks[g],this.target.postMessage({id:g,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(a){const t=a.data,s=t.id;if(s&&(!t.targetMapId||this.mapId===t.targetMapId))if(t.type==="<cancel>"){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(t.mustQueue||at()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add(()=>this.processTask(s,t),c&&c.metadata||{type:"message"})}else this.processTask(s,t)}processTask(a,t){if(t.type==="<response>"){const s=this.callbacks[a];delete this.callbacks[a],s&&(t.error?s(Bo(t.error)):s(null,Bo(t.data)))}else{const s=Cr(this.globalScope)?void 0:[],c=t.hasCallback?(p,g)=>{delete this.cancelCallbacks[a],this.target.postMessage({id:a,type:"<response>",sourceMapId:this.mapId,error:p?ql(p):null,data:ql(g,s)},s)}:p=>{},f=Bo(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,f,c);else if(this.parent.getWorkerSource){const p=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,p[0],f.source)[p[1]](f,c)}else c(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},o.CanonicalTileID=b0,o.Color=pr,o.ColorMode=Ps,o.CullFaceMode=ns,o.DEMData=k0,o.DataConstantProperty=E,o.DedupedRequest=H2,o.DepthMode=Ru,o.EXTENT=Jt,o.Elevation=class{isDataAvailableAtPoint(a){const t=this._source();if(!t||a.y<0||a.y>1)return!1;const s=t.getSource().maxzoom,c=1<<s,f=Math.floor(a.x),p=Math.floor((a.x-f)*c),g=Math.floor(a.y*c),y=this.findDEMTileFor(new oi(s,f,s,p,g));return!(!y||!y.dem)}getAtPointOrZero(a,t=0){return this.getAtPoint(a,t)||0}getAtPoint(a,t,s=!0){t==null&&(t=null);const c=this._source();if(!c||a.y<0||a.y>1)return t;const f=c.getSource().maxzoom,p=1<<f,g=Math.floor(a.x),y=a.x-g,T=new oi(f,g,f,Math.floor(y*p),Math.floor(a.y*p)),b=this.findDEMTileFor(T);if(!b||!b.dem)return t;const C=b.dem,M=1<<b.tileID.canonical.z,P=(y*M-b.tileID.canonical.x)*C.dim,N=(a.y*M-b.tileID.canonical.y)*C.dim,Z=Math.floor(P),ee=Math.floor(N);return(s?this.exaggeration():1)*Wt(Wt(C.get(Z,ee),C.get(Z,ee+1),N-ee),Wt(C.get(Z+1,ee),C.get(Z+1,ee+1),N-ee),P-Z)}getAtTileOffset(a,t,s){const c=1<<a.canonical.z;return this.getAtPointOrZero(new n0(a.wrap+(a.canonical.x+t/Jt)/c,(a.canonical.y+s/Jt)/c))}getAtTileOffsetFunc(a,t,s,c){return f=>{const p=this.getAtTileOffset(a,f.x,f.y),g=c.upVector(a.canonical,f.x,f.y);return mf(g,g,p*c.upVectorScale(a.canonical,t,s).metersToTile),g}}getForTilePoints(a,t,s,c){const f=A0.create(this,a,c);return!!f&&(t.forEach(p=>{p[2]=this.exaggeration()*f.getElevationAt(p[0],p[1],s)}),!0)}getMinMaxForTile(a){const t=this.findDEMTileFor(a);if(!t||!t.dem)return null;const s=t.dem.tree,c=t.tileID,f=1<<a.canonical.z-c.canonical.z;let p=a.canonical.x/f-c.canonical.x,g=a.canonical.y/f-c.canonical.y,y=0;for(let T=0;T<a.canonical.z-c.canonical.z&&!s.leaves[y];T++){p*=2,g*=2;const b=2*Math.floor(g)+Math.floor(p);y=s.childOffsets[y]+b,p%=1,g%=1}return{min:this.exaggeration()*s.minimums[y],max:this.exaggeration()*s.maximums[y]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(a,t,s){throw new Error("Pure virtual method called.")}pointCoordinate(a){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(a){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},o.ErrorEvent=Ne,o.EvaluationParameters=Fr,o.Event=De,o.Evented=Fe,o.FillExtrusionBucket=Sf,o.Frustum=sg,o.GLOBE_RADIUS=Lu,o.GlobeSharedBuffers=class{constructor(a){this._createGrid(a),this._createPoles(a),this._createAtmosphere(a)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const a of this._poleSegments)a.destroy();this._gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this._wireframeIndexBuffer&&(this._wireframeIndexBuffer.destroy(),this._wireframeSegments.destroy())}_createGrid(a){const t=new _e,s=new Ft,c=65;for(let f=0;f<c;f++)for(let p=0;p<c;p++)t.emplaceBack(p,f);for(let f=0;f<64;f++)for(let p=0;p<64;p++){const g=f*c+p;s.emplaceBack(g+1,g,g+c),s.emplaceBack(g+c,g+c+1,g+1)}this._gridBuffer=a.createVertexBuffer(t,Ff.members),this._gridIndexBuffer=a.createIndexBuffer(s,!0),this._gridSegments=Kr.simpleSegment(0,0,4225,8192)}_createPoles(a){const t=new Ft;for(let f=0;f<=64;f++)t.emplaceBack(0,f+1,f+2);this._poleIndexBuffer=a.createIndexBuffer(t,!0);const s=new Ht,c=new Ht;this._poleSegments=[];for(let f=0,p=0;f<5;f++){const g=1<<f,y=512*g/Math.PI/2,T=360/g;s.emplaceBack(0,-y,0,0,0,.5,0),c.emplaceBack(0,-y,0,0,0,.5,1);for(let b=0;b<=64;b++){const C=b/64,M=Wt(0,T,C),[P,N,Z]=w2(P3,L3,M,y);s.emplaceBack(P,N,Z,0,0,C,0),c.emplaceBack(P,N,Z,0,0,C,1)}this._poleSegments.push(Kr.simpleSegment(p,0,66,64)),p+=66}this._poleNorthVertexBuffer=a.createVertexBuffer(s,y2,!1),this._poleSouthVertexBuffer=a.createVertexBuffer(c,y2,!1)}_createAtmosphere(a){const t=new er;t.emplaceBack(-1,1,1,0,0),t.emplaceBack(1,1,1,1,0),t.emplaceBack(1,-1,1,1,1),t.emplaceBack(-1,-1,1,0,1);const s=new Ft;s.emplaceBack(0,1,2),s.emplaceBack(2,3,0),this.atmosphereVertexBuffer=a.createVertexBuffer(t,I3.members),this.atmosphereIndexBuffer=a.createIndexBuffer(s),this.atmosphereSegments=Kr.simpleSegment(0,0,4,2)}getGridBuffers(){return[this._gridBuffer,this._gridIndexBuffer,this._gridSegments]}getPoleBuffers(a){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[a]]}getWirefameBuffers(a){if(!this._wireframeSegments){const t=new qt,s=64,c=s+1;for(let f=0;f<s;f++)for(let p=0;p<s;p++){const g=f*c+p;t.emplaceBack(g,g+1),t.emplaceBack(g,g+c),t.emplaceBack(g,g+c+1)}this._wireframeIndexBuffer=a.createIndexBuffer(t),this._wireframeSegments=Kr.simpleSegment(0,0,s*s,t.length)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments]}},o.GlyphManager=Fu,o.ImagePosition=xg,o.LineAtlas=Dg,o.LngLat=Sr,o.LngLatBounds=Wo,o.LocalGlyphMode=Tg,o.MAX_MERCATOR_LATITUDE=Cs,o.MercatorCoordinate=n0,o.ONE_EM=Hn,o.OverscaledTileID=oi,o.Properties=W,o.RGBAImage=Yi,o.Ray=class{constructor(a,t){this.pos=a,this.dir=t}intersectsPlane(a,t,s){const c=gf(t,this.dir);if(Math.abs(c)<1e-6)return!1;const f=((a[0]-this.pos[0])*t[0]+(a[1]-this.pos[1])*t[1]+(a[2]-this.pos[2])*t[2])/c;return s[0]=this.pos[0]+this.dir[0]*f,s[1]=this.pos[1]+this.dir[1]*f,s[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(a,t,s){if(function(P,N){var Z=P[0],ee=P[1],ae=P[2],fe=N[0],be=N[1],Me=N[2];return Math.abs(Z-fe)<=J_*Math.max(1,Math.abs(Z),Math.abs(fe))&&Math.abs(ee-be)<=J_*Math.max(1,Math.abs(ee),Math.abs(be))&&Math.abs(ae-Me)<=J_*Math.max(1,Math.abs(ae),Math.abs(Me))}(this.pos,a)||t===0)return s[0]=s[1]=s[2]=0,!1;const[c,f,p]=this.dir,g=this.pos[0]-a[0],y=this.pos[1]-a[1],T=this.pos[2]-a[2],b=c*c+f*f+p*p,C=2*(g*c+y*f+T*p),M=C*C-4*b*(g*g+y*y+T*T-t*t);if(M<0){const P=Math.max(-C/2,0),N=g+c*P,Z=y+f*P,ee=T+p*P,ae=Math.hypot(N,Z,ee);return s[0]=N*t/ae,s[1]=Z*t/ae,s[2]=ee*t/ae,!1}{const P=(-C-Math.sqrt(M))/(2*b);if(P<0){const N=Math.hypot(g,y,T);return s[0]=g*t/N,s[1]=y*t/N,s[2]=T*t/N,!1}return s[0]=g+c*P,s[1]=y+f*P,s[2]=T+p*P,!0}}},o.RequestManager=class{constructor(a,t,s){this._transformRequestFn=a,this._customAccessToken=t,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const a=function(){let t="";for(let s=0;s<10;s++)t+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",fn,t].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=a.token,this._skuTokenExpiresAt=a.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(a,t){return this._transformRequestFn&&this._transformRequestFn(a,t)||{url:a}}normalizeStyleURL(a,t){if(!dn(a))return a;const s=en(a);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||t)}normalizeGlyphsURL(a,t){if(!dn(a))return a;const s=en(a);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||t)}normalizeSourceURL(a,t){if(!dn(a))return a;const s=en(a);return s.path=`/v4/${s.authority}.json`,s.params.push("secure"),this._makeAPIURL(s,this._customAccessToken||t)}normalizeSpriteURL(a,t,s,c){const f=en(a);return dn(a)?(f.path=`/styles/v1${f.path}/sprite${t}${s}`,this._makeAPIURL(f,this._customAccessToken||c)):(f.path+=`${t}${s}`,rr(f))}normalizeTileURL(a,t,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),a&&!dn(a))return a;const c=en(a);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||s&&c.authority!=="raster"&&s===512?"@2x":""}${Ir.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${ut.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${ut.TILE_URL_VERSION}${c.path}`);const f=this._customAccessToken||function(p){for(const g of p){const y=g.match(/^access_token=(.*)$/);if(y)return y[1]}return null}(c.params)||ut.ACCESS_TOKEN;return ut.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,f)}canonicalizeTileURL(a,t){const s=en(a);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return a;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${ut.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${ut.TILE_URL_VERSION}/`,"")}`;let f=s.params;return t&&(f=f.filter(p=>!p.match(/^access_token=/))),f.length&&(c+=`?${f.join("&")}`),c}canonicalizeTileset(a,t){const s=!!t&&dn(t),c=[];for(const f of a.tiles||[])Ti(f)?c.push(this.canonicalizeTileURL(f,s)):c.push(f);return c}_makeAPIURL(a,t){const s="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",c=en(ut.API_URL);if(a.protocol=c.protocol,a.authority=c.authority,a.protocol==="http"){const f=a.params.indexOf("secure");f>=0&&a.params.splice(f,1)}if(c.path!=="/"&&(a.path=`${c.path}${a.path}`),!ut.REQUIRE_ACCESS_TOKEN)return rr(a);if(t=t||ut.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(t[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return a.params=a.params.filter(f=>f.indexOf("access_token")===-1),a.params.push(`access_token=${t||""}`),rr(a)}},o.ResourceType=de,o.SegmentVector=Kr,o.SourceCache=cc,o.StencilMode=Og,o.StructArrayLayout1ui2=fr,o.StructArrayLayout2f1f2i16=Rt,o.StructArrayLayout2i4=_e,o.StructArrayLayout2ui4=qt,o.StructArrayLayout3f12=mt,o.StructArrayLayout3ui6=Ft,o.StructArrayLayout4i8=Te,o.Texture=Df,o.Tile=Rg,o.Transitionable=d,o.Uniform1f=t0,o.Uniform1i=class extends no{constructor(a,t){super(a,t),this.current=0}set(a){this.current!==a&&(this.current=a,this.gl.uniform1i(this.location,a))}},o.Uniform2f=class extends no{constructor(a,t){super(a,t),this.current=[0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]||(this.current=a,this.gl.uniform2f(this.location,a[0],a[1]))}},o.Uniform3f=class extends no{constructor(a,t){super(a,t),this.current=[0,0,0]}set(a){a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]||(this.current=a,this.gl.uniform3f(this.location,a[0],a[1],a[2]))}},o.Uniform4f=tv,o.UniformColor=rv,o.UniformMatrix2f=class extends no{constructor(a,t){super(a,t),this.current=IA}set(a){for(let t=0;t<4;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix2fv(this.location,!1,a);break}}},o.UniformMatrix3f=class extends no{constructor(a,t){super(a,t),this.current=CA}set(a){for(let t=0;t<9;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix3fv(this.location,!1,a);break}}},o.UniformMatrix4f=class extends no{constructor(a,t){super(a,t),this.current=AA}set(a){if(a[12]!==this.current[12]||a[0]!==this.current[0])return this.current=a,void this.gl.uniformMatrix4fv(this.location,!1,a);for(let t=1;t<16;t++)if(a[t]!==this.current[t]){this.current=a,this.gl.uniformMatrix4fv(this.location,!1,a);break}}},o.UnwrappedTileID=C2,o.ValidationError=St,o.VectorTileWorkerSource=class extends Fe{constructor(a,t,s,c,f){super(),this.actor=a,this.layerIndex=t,this.availableImages=s,this.loadVectorData=f||X2,this.loading={},this.loaded={},this.deduped=new H2(a.scheduler),this.isSpriteLoaded=c,this.scheduler=a.scheduler}loadTile(a,t){const s=a.uid,c=a&&a.request,f=c&&c.collectResourceTiming,p=this.loading[s]=new N3(a);p.abort=this.loadVectorData(a,(g,y)=>{const T=!this.loading[s];if(delete this.loading[s],T||g||!y)return p.status="done",T||(this.loaded[s]=p),t(g);const b=y.rawData,C={};y.expires&&(C.expires=y.expires),y.cacheControl&&(C.cacheControl=y.cacheControl),p.vectorTile=y.vectorTile||new oc.VectorTile(new Cf(b));const M=()=>{p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,(P,N)=>{if(P||!N)return t(P);const Z={};if(f){const ee=x2(c);ee.length>0&&(Z.resourceTiming=JSON.parse(JSON.stringify(ee)))}t(null,$e({rawTileData:b.slice(0)},N,C,Z))})};this.isSpriteLoaded?M():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(M,{type:"parseTile",isSymbolTile:a.isSymbolTile,zoom:a.tileZoom}):M()}),this.loaded=this.loaded||{},this.loaded[s]=p})}reloadTile(a,t){const s=this.loaded,c=a.uid,f=this;if(s&&s[c]){const p=s[c];p.showCollisionBoxes=a.showCollisionBoxes,p.enableTerrain=!!a.enableTerrain,p.projection=a.projection,p.tileTransform=lc(a.tileID.canonical,a.projection);const g=(y,T)=>{const b=p.reloadCallback;b&&(delete p.reloadCallback,p.parse(p.vectorTile,f.layerIndex,this.availableImages,f.actor,b)),t(y,T)};p.status==="parsing"?p.reloadCallback=g:p.status==="done"&&(p.vectorTile?p.parse(p.vectorTile,this.layerIndex,this.availableImages,this.actor,g):g())}}abortTile(a,t){const s=a.uid,c=this.loading[s];c&&(c.abort&&c.abort(),delete this.loading[s]),t()}removeTile(a,t){const s=this.loaded,c=a.uid;s&&s[c]&&delete s[c],t()}},o.WritingMode=ga,o.ZoomHistory=Jh,o.add=gv,o.addDynamicAttributes=kg,o.adjoint=function(a,t){var s=t[0],c=t[1],f=t[2],p=t[3],g=t[4],y=t[5],T=t[6],b=t[7],C=t[8];return a[0]=g*C-y*b,a[1]=f*b-c*C,a[2]=c*y-f*g,a[3]=y*T-p*C,a[4]=s*C-f*T,a[5]=f*p-s*y,a[6]=p*b-g*T,a[7]=c*T-s*b,a[8]=s*g-c*p,a},o.asyncAll=Ie,o.bezier=me,o.bindAll=zt,o.boundsAttributes=F2,o.bufferConvexPolygon=function(a,t){const s=[];for(let c=0;c<a.length;c++){const f=ke(c-1,-1,a.length-1),p=ke(c+1,-1,a.length-1),g=a[c],y=a[p],T=a[f].sub(g).unit(),b=y.sub(g).unit(),C=b.angleWithSep(T.x,T.y),M=T.add(b).unit().mult(-1*t/Math.sin(C/2));s.push(g.add(M))}return s},o.cacheEntryPossiblyAdded=function(a){_s++,_s>Ha&&(a.getActor().send("enforceCacheSizeLimit",Zi),_s=0)},o.calculateGlobeLabelMatrix=function(a,t){const{lng:s,lat:c}=a._center,f=b2(0,0,a.worldSize/a._projectionScaler,s,c);return Q_(f,f,function(p){const g=Is(new Float64Array(16)),y=1/Lg(p);return ac(g,g,p.min),Zo(g,g,[y,y,y]),g}(Pf(t)))},o.calculateGlobeMatrix=S2,o.calculateGlobeMercatorMatrix=function(a){const t=a.worldSize,s=a.point,c=wu(1,a.center.lat)*t,f=a.pixelsPerMeter,p=t/(c/a.pixelsPerMeter),g=Is(new Float64Array(16));return ac(g,g,[s.x,s.y,0]),Zo(g,g,[p,p,f]),Float32Array.from(g)},o.circumferenceAtLatitude=Z_,o.clamp=ge,o.clearTileCache=function(a){const t=B.caches.delete(Xs);a&&t.catch(a).then(()=>a())},o.clipLine=c2,o.clone=function(a){var t=new Ki(16);return t[0]=a[0],t[1]=a[1],t[2]=a[2],t[3]=a[3],t[4]=a[4],t[5]=a[5],t[6]=a[6],t[7]=a[7],t[8]=a[8],t[9]=a[9],t[10]=a[10],t[11]=a[11],t[12]=a[12],t[13]=a[13],t[14]=a[14],t[15]=a[15],t},o.clone$1=Dt,o.collisionCircleLayout=NC,o.config=ut,o.conjugate=function(a,t){return a[0]=-t[0],a[1]=-t[1],a[2]=-t[2],a[3]=t[3],a},o.create=function(){var a=new Ki(16);return Ki!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a},o.create$1=pv,o.createExpression=Vl,o.createLayout=ye,o.createStyleLayer=function(a){return a.type==="custom"?new T3(a):new b3[a.type](a)},o.cross=vv,o.degToRad=Y,o.div=function(a,t,s){return a[0]=t[0]/s[0],a[1]=t[1]/s[1],a[2]=t[2]/s[2],a},o.dot=gf,o.earthRadius=W_,o.ease=Ae,o.easeCubicInOut=G,o.emitValidationErrors=Rp,o.endsWith=gt,o.enforceCacheSizeLimit=function(a){ms(),Ei&&Ei.then(t=>{t.keys().then(s=>{for(let c=0;c<s.length-a;c++)t.delete(s[c])})})},o.evaluateSizeForFeature=m0,o.evaluateSizeForZoom=Cu,o.evaluateVariableOffset=p2,o.evented=cf,o.exactEquals=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]&&a[3]===t[3]},o.exactEquals$1=function(a,t){return a[0]===t[0]&&a[1]===t[1]&&a[2]===t[2]},o.exported=or,o.exported$1=Ir,o.extend=$e,o.extend$1=Ze,o.filterObject=Tt,o.fromMat4=function(a,t){return a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[4],a[4]=t[5],a[5]=t[6],a[6]=t[8],a[7]=t[9],a[8]=t[10],a},o.fromQuat=function(a,t){var s=t[0],c=t[1],f=t[2],p=t[3],g=s+s,y=c+c,T=f+f,b=s*g,C=c*g,M=c*y,P=f*g,N=f*y,Z=f*T,ee=p*g,ae=p*y,fe=p*T;return a[0]=1-M-Z,a[1]=C+fe,a[2]=P-ae,a[3]=0,a[4]=C-fe,a[5]=1-b-Z,a[6]=N+ee,a[7]=0,a[8]=P+ae,a[9]=N-ee,a[10]=1-b-M,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},o.fromRotation=function(a,t){var s=Math.sin(t),c=Math.cos(t);return a[0]=c,a[1]=s,a[2]=0,a[3]=-s,a[4]=c,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},o.fromScaling=function(a,t){return a[0]=t[0],a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t[1],a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=t[2],a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},o.furthestTileCorner=function(a){const t=Math.round((a+45+360)%360/90)%4;return K[t]},o.getAABBPointSquareDist=function(a,t,s){let c=0;for(let f=0;f<2;++f){const p=s?s[f]:0;a[f]>p&&(c+=(a[f]-p)*(a[f]-p)),t[f]<p&&(c+=(p-t[f])*(p-t[f]))}return c},o.getAnchorAlignment=wg,o.getAnchorJustification=bg,o.getBounds=function(a){let t=1/0,s=1/0,c=-1/0,f=-1/0;for(const p of a)t=Math.min(t,p.x),s=Math.min(s,p.y),c=Math.max(c,p.x),f=Math.max(f,p.y);return{min:new D(t,s),max:new D(c,f)}},o.getColumn=function(a,t){return[a[4*t],a[4*t+1],a[4*t+2],a[4*t+3]]},o.getGridMatrix=function(a,t){const[s,c]=t,f=.015625;return[0,(c[1]-s[1])*f,1<<a.z,(c[0]-s[0])*f,0,a.y,s[0],s[1],f]},o.getImage=ne,o.getJSON=function(a,t){return ue($e(a,{type:"json"}),t)},o.getMapSessionAPI=Hs,o.getPerformanceMeasurement=x2,o.getProjection=function(a){const t=a.parallels,s=!!t&&Math.abs(t[0]+t[1])<.01;switch(a.name){case"mercator":return new V3(a);case"equirectangular":return new $3(a);case"naturalEarth":return new Z3(a);case"equalEarth":return new G3(a);case"winkelTripel":return new H3(a);case"albers":return s?new Y2(a):new j3(a);case"lambertConformalConic":return s?new Y2(a):new W3(a)}throw new Error(`Invalid projection name: ${a.name}`)},o.getRTLTextPluginStatus=xu,o.getReferrer=J,o.getTilePoint=function(a,{x:t,y:s},c=0){return new D(((t-c)*a.scale-a.x)*Jt,(s*a.scale-a.y)*Jt)},o.getTileVec3=function(a,t,s=0){return pf(((t.x-s)*a.scale-a.x)*Jt,(t.y*a.scale-a.y)*Jt,av(t.z,t.y))},o.getVideo=function(a,t){const s=B.document.createElement("video");s.muted=!0,s.onloadstart=function(){t(null,s)};for(let c=0;c<a.length;c++){const f=B.document.createElement("source");Ue(a[c])||(s.crossOrigin="Anonymous"),f.src=a[c],s.appendChild(f)}return{cancel:()=>{}}},o.globeECEFOrigin=function(a,t){const s=[0,0,0];return sc(s,s,E2(Pf(t.canonical))),sc(s,s,a),s},o.globePixelsToTileUnits=function(a,t){return Jt/(512*Math.pow(2,a))*Lg(Pf(t))},o.globePoleMatrixForTile=function(a,t,s){const c=Is(new Float64Array(16)),f=1<<a,p=360*(t/f-.5),g=s.point,y=s.worldSize/(s.tileSize*f);return ac(c,c,[g.x,g.y,-s.worldSize/Math.PI/2]),Zo(c,c,[y,y,y]),eg(c,c,Y(-s._center.lat)),tg(c,c,Y(-s._center.lng+p)),Float32Array.from(c)},o.globeTileLatLngCorners=Pg,o.globeToMercatorTransition=function(a){return se(5,6,a)},o.identity=Is,o.identity$1=Ev,o.invert=function(a,t){var s=t[0],c=t[1],f=t[2],p=t[3],g=t[4],y=t[5],T=t[6],b=t[7],C=t[8],M=t[9],P=t[10],N=t[11],Z=t[12],ee=t[13],ae=t[14],fe=t[15],be=s*y-c*g,Me=s*T-f*g,Pe=s*b-p*g,Le=c*T-f*y,ze=c*b-p*y,Je=f*b-p*T,et=C*ee-M*Z,st=C*ae-P*Z,ot=C*fe-N*Z,Ke=M*ae-P*ee,nt=M*fe-N*ee,ct=P*fe-N*ae,vt=be*ct-Me*nt+Pe*Ke+Le*ot-ze*st+Je*et;return vt?(a[0]=(y*ct-T*nt+b*Ke)*(vt=1/vt),a[1]=(f*nt-c*ct-p*Ke)*vt,a[2]=(ee*Je-ae*ze+fe*Le)*vt,a[3]=(P*ze-M*Je-N*Le)*vt,a[4]=(T*ot-g*ct-b*st)*vt,a[5]=(s*ct-f*ot+p*st)*vt,a[6]=(ae*Pe-Z*Je-fe*Me)*vt,a[7]=(C*Je-P*Pe+N*Me)*vt,a[8]=(g*nt-y*ot+b*et)*vt,a[9]=(c*ot-s*nt-p*et)*vt,a[10]=(Z*ze-ee*Pe+fe*be)*vt,a[11]=(M*Pe-C*ze-N*be)*vt,a[12]=(y*st-g*Ke-T*et)*vt,a[13]=(s*Ke-c*st+f*et)*vt,a[14]=(ee*Me-Z*Le-ae*be)*vt,a[15]=(C*Le-M*Me+P*be)*vt,a):null},o.isMapAuthenticated=function(a){return Aa.has(a)},o.isMapboxURL=dn,o.isSafariWithAntialiasingBug=function(a){const t=a.navigator?a.navigator.userAgent:null;return!!Cr(a)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},o.latFromMercatorY=Zn,o.len=ZA,o.length=_v,o.length$1=function(a){return Math.hypot(a[0],a[1],a[2],a[3])},o.loadVectorTile=X2,o.makeRequest=ue,o.mercatorXfromLng=df,o.mercatorYfromLat=vu,o.mercatorZfromAltitude=wu,o.mul=$A,o.mul$1=WA,o.multiply=function(a,t,s){var c=t[0],f=t[1],p=t[2],g=t[3],y=t[4],T=t[5],b=t[6],C=t[7],M=t[8],P=s[0],N=s[1],Z=s[2],ee=s[3],ae=s[4],fe=s[5],be=s[6],Me=s[7],Pe=s[8];return a[0]=P*c+N*g+Z*b,a[1]=P*f+N*y+Z*C,a[2]=P*p+N*T+Z*M,a[3]=ee*c+ae*g+fe*b,a[4]=ee*f+ae*y+fe*C,a[5]=ee*p+ae*T+fe*M,a[6]=be*c+Me*g+Pe*b,a[7]=be*f+Me*y+Pe*C,a[8]=be*p+Me*T+Pe*M,a},o.multiply$1=Q_,o.multiply$2=yv,o.nextPowerOfTwo=kt,o.normalize=_f,o.normalize$1=function(a,t){var s=t[0],c=t[1],f=t[2],p=t[3],g=s*s+c*c+f*f+p*p;return g>0&&(g=1/Math.sqrt(g)),a[0]=s*g,a[1]=c*g,a[2]=f*g,a[3]=p*g,a},o.number=Wt,o.ortho=function(a,t,s,c,f,p,g){var y=1/(t-s),T=1/(c-f),b=1/(p-g);return a[0]=-2*y,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*T,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*b,a[11]=0,a[12]=(t+s)*y,a[13]=(f+c)*T,a[14]=(g+p)*b,a[15]=1,a},o.pbf=Cf,o.perspective=function(a,t,s,c,f){var p,g=1/Math.tan(t/2);return a[0]=g/s,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=g,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,f!=null&&f!==1/0?(a[10]=(f+c)*(p=1/(c-f)),a[14]=2*f*c*p):(a[10]=-1,a[14]=-2*c),a},o.pick=function(a,t){const s={};for(let c=0;c<t.length;c++){const f=t[c];f in a&&(s[f]=a[f])}return s},o.plugin=Xi,o.pointGeometry=D,o.polygonIntersectsBox=hv,o.polygonIntersectsPolygon=ov,o.polygonizeBounds=function(a,t,s=0,c=!0){const f=new D(s,s),p=a.sub(f),g=t.add(f),y=[p,new D(g.x,p.y),g,new D(p.x,g.y)];return c&&y.push(p),y},o.posAttributes=Ff,o.postMapLoadEvent=Ao,o.postTurnstileEvent=ha,o.potpack=gg,o.prevPowerOfTwo=function(a){return a<=1?1:Math.pow(2,Math.floor(Math.log(a)/Math.LN2))},o.radToDeg=X,o.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],o.registerForPluginStateChange=function(a){return a({pluginStatus:si,pluginURL:Mi}),cf.on("pluginStateChange",a),a},o.removeAuthState=function(a){Aa.delete(a)},o.renderColorRamp=lg,o.rotateX=eg,o.rotateX$1=bv,o.rotateY=tg,o.rotateZ=function(a,t,s){var c=Math.sin(s),f=Math.cos(s),p=t[0],g=t[1],y=t[2],T=t[3],b=t[4],C=t[5],M=t[6],P=t[7];return t!==a&&(a[8]=t[8],a[9]=t[9],a[10]=t[10],a[11]=t[11],a[12]=t[12],a[13]=t[13],a[14]=t[14],a[15]=t[15]),a[0]=p*f+b*c,a[1]=g*f+C*c,a[2]=y*f+M*c,a[3]=T*f+P*c,a[4]=b*f-p*c,a[5]=C*f-g*c,a[6]=M*f-y*c,a[7]=P*f-T*c,a},o.rotateZ$1=function(a,t,s){s*=.5;var c=t[0],f=t[1],p=t[2],g=t[3],y=Math.sin(s),T=Math.cos(s);return a[0]=c*T+f*y,a[1]=f*T-c*y,a[2]=p*T+g*y,a[3]=g*T-p*y,a},o.scale=Zo,o.scale$1=function(a,t,s){return a[0]=t[0]*s,a[1]=t[1]*s,a[2]=t[2]*s,a[3]=t[3]*s,a},o.scale$2=mf,o.scaleAndAdd=ag,o.setCacheLimits=function(a,t){Zi=a,Ha=t},o.setColumn=function(a,t,s){a[4*t+0]=s[0],a[4*t+1]=s[1],a[4*t+2]=s[2],a[4*t+3]=s[3]},o.setRTLTextPlugin=function(a,t,s=!1){if(si===sf||si===Ql||si===of)throw new Error("setRTLTextPlugin cannot be called multiple times.");Mi=or.resolveURL(a),si=sf,lf=t,to(),s||Uo()},o.smoothstep=se,o.spec=le,o.storeAuthState=function(a,t){t?Aa.add(a):Aa.delete(a)},o.sub=bu,o.subtract=xv,o.symbolSize=UC,o.tileAABB=function(a,t,s,c,f,p,g,y,T){if(T.name==="globe")return F3(a,t,new b0(s,c,f));const b=lc({z:s,x:c,y:f},T);return new _a([(p+b.x/b.scale)*t,t*(b.y/b.scale),g],[(p+b.x2/b.scale)*t,t*(b.y2/b.scale),y])},o.tileTransform=lc,o.transformMat3=function(a,t,s){var c=t[0],f=t[1],p=t[2];return a[0]=c*s[0]+f*s[3]+p*s[6],a[1]=c*s[1]+f*s[4]+p*s[7],a[2]=c*s[2]+f*s[5]+p*s[8],a},o.transformMat4=sc,o.transformMat4$1=Su,o.transformQuat=wv,o.translate=ac,o.transpose=function(a,t){if(a===t){var s=t[1],c=t[2],f=t[5];a[1]=t[3],a[2]=t[6],a[3]=s,a[5]=t[7],a[6]=c,a[7]=f}else a[0]=t[0],a[1]=t[3],a[2]=t[6],a[3]=t[1],a[4]=t[4],a[5]=t[7],a[6]=t[2],a[7]=t[5],a[8]=t[8];return a},o.triggerPluginCompletionEvent=ec,o.uniqueId=dt,o.validateCustomStyleLayer=function(a){const t=[],s=a.id;return s===void 0&&t.push({message:`layers.${s}: missing required property "id"`}),a.render===void 0&&t.push({message:`layers.${s}: missing required method "render"`}),a.renderingMode&&a.renderingMode!=="2d"&&a.renderingMode!=="3d"&&t.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),t},o.validateFilter=a=>Ja(bs(a)),o.validateFog=a=>Ja(Lp(a)),o.validateLayer=a=>Ja(Ip(a)),o.validateLight=a=>Ja(Fp(a)),o.validateSource=a=>Ja(Dp(a)),o.validateStyle=Xl,o.validateTerrain=a=>Ja(Pp(a)),o.values=Xe,o.vectorTile=oc,o.version=S,o.warnOnce=He,o.window=B,o.wrap=ke}),m(["./shared"],function(o){function S(de){if(typeof de=="number"||typeof de=="boolean"||typeof de=="string"||de==null)return JSON.stringify(de);if(Array.isArray(de)){let J="[";for(const ue of de)J+=`${S(ue)},`;return`${J}]`}let j="{";for(const J of Object.keys(de).sort())j+=`${J}:${S(de[J])},`;return`${j}}`}function A(de){let j="";for(const J of o.refProperties)j+=`/${S(de[J])}`;return j}class I{constructor(j){this.keyCache={},j&&this.replace(j)}replace(j){this._layerConfigs={},this._layers={},this.update(j,[])}update(j,J){for(const we of j)this._layerConfigs[we.id]=we,(this._layers[we.id]=o.createStyleLayer(we)).compileFilter(),this.keyCache[we.id]&&delete this.keyCache[we.id];for(const we of J)delete this.keyCache[we],delete this._layerConfigs[we],delete this._layers[we];this.familiesBySource={};const ue=function(we,Ce){const Ve={};for(let z=0;z<we.length;z++){const H=Ce&&Ce[we[z].id]||A(we[z]);Ce&&(Ce[we[z].id]=H);let q=Ve[H];q||(q=Ve[H]=[]),q.push(we[z])}const Ue=[];for(const z in Ve)Ue.push(Ve[z]);return Ue}(o.values(this._layerConfigs),this.keyCache);for(const we of ue){const Ce=we.map(ne=>this._layers[ne.id]),Ve=Ce[0];if(Ve.visibility==="none")continue;const Ue=Ve.source||"";let z=this.familiesBySource[Ue];z||(z=this.familiesBySource[Ue]={});const H=Ve.sourceLayer||"_geojsonTileLayer";let q=z[H];q||(q=z[H]=[]),q.push(Ce)}}}class D{loadTile(j,J){const{uid:ue,encoding:we,rawImageData:Ce,padding:Ve,buildQuadTree:Ue}=j,z=o.window.ImageBitmap&&Ce instanceof o.window.ImageBitmap?this.getImageData(Ce,Ve):Ce;J(null,new o.DEMData(ue,z,we,Ve<1,Ue))}getImageData(j,J){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(j.width,j.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=j.width,this.offscreenCanvas.height=j.height,this.offscreenCanvasContext.drawImage(j,0,0,j.width,j.height);const ue=this.offscreenCanvasContext.getImageData(-J,-J,j.width+2*J,j.height+2*J);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ue}}var L=function de(j,J){var ue,we=j&&j.type;if(we==="FeatureCollection")for(ue=0;ue<j.features.length;ue++)de(j.features[ue],J);else if(we==="GeometryCollection")for(ue=0;ue<j.geometries.length;ue++)de(j.geometries[ue],J);else if(we==="Feature")de(j.geometry,J);else if(we==="Polygon")B(j.coordinates,J);else if(we==="MultiPolygon")for(ue=0;ue<j.coordinates.length;ue++)B(j.coordinates[ue],J);return j};function B(de,j){if(de.length!==0){U(de[0],j);for(var J=1;J<de.length;J++)U(de[J],!j)}}function U(de,j){for(var J=0,ue=0,we=0,Ce=de.length,Ve=Ce-1;we<Ce;Ve=we++){var Ue=(de[we][0]-de[Ve][0])*(de[Ve][1]+de[we][1]),z=J+Ue;ue+=Math.abs(J)>=Math.abs(Ue)?J-z+Ue:Ue-z+J,J=z}J+ue>=0!=!!j&&de.reverse()}const V=o.vectorTile.VectorTileFeature.prototype.toGeoJSON;class Y{constructor(j){this._feature=j,this.extent=o.EXTENT,this.type=j.type,this.properties=j.tags,"id"in j&&!isNaN(j.id)&&(this.id=parseInt(j.id,10))}loadGeometry(){if(this._feature.type===1){const j=[];for(const J of this._feature.geometry)j.push([new o.pointGeometry(J[0],J[1])]);return j}{const j=[];for(const J of this._feature.geometry){const ue=[];for(const we of J)ue.push(new o.pointGeometry(we[0],we[1]));j.push(ue)}return j}}toGeoJSON(j,J,ue){return V.call(this,j,J,ue)}}class X{constructor(j){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=o.EXTENT,this.length=j.length,this._features=j}feature(j){return new Y(this._features[j])}}var K=o.vectorTile.VectorTileFeature,G=me;function me(de,j){this.options=j||{},this.features=de,this.length=de.length}function Ae(de,j){this.id=typeof de.id=="number"?de.id:void 0,this.type=de.type,this.rawGeometry=de.type===1?[de.geometry]:de.geometry,this.properties=de.tags,this.extent=j||4096}me.prototype.feature=function(de){return new Ae(this.features[de],this.options.extent)},Ae.prototype.loadGeometry=function(){var de=this.rawGeometry;this.geometry=[];for(var j=0;j<de.length;j++){for(var J=de[j],ue=[],we=0;we<J.length;we++)ue.push(new o.pointGeometry(J[we][0],J[we][1]));this.geometry.push(ue)}return this.geometry},Ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var de=this.geometry,j=1/0,J=-1/0,ue=1/0,we=-1/0,Ce=0;Ce<de.length;Ce++)for(var Ve=de[Ce],Ue=0;Ue<Ve.length;Ue++){var z=Ve[Ue];j=Math.min(j,z.x),J=Math.max(J,z.x),ue=Math.min(ue,z.y),we=Math.max(we,z.y)}return[j,ue,J,we]},Ae.prototype.toGeoJSON=K.prototype.toGeoJSON;var ge=ke,se=G;function ke(de){var j=new o.pbf;return function(J,ue){for(var we in J.layers)ue.writeMessage(3,Ie,J.layers[we])}(de,j),j.finish()}function Ie(de,j){var J;j.writeVarintField(15,de.version||1),j.writeStringField(1,de.name||""),j.writeVarintField(5,de.extent||4096);var ue={keys:[],values:[],keycache:{},valuecache:{}};for(J=0;J<de.length;J++)ue.feature=de.feature(J),j.writeMessage(2,Xe,ue);var we=ue.keys;for(J=0;J<we.length;J++)j.writeStringField(3,we[J]);var Ce=ue.values;for(J=0;J<Ce.length;J++)j.writeMessage(4,kt,Ce[J])}function Xe(de,j){var J=de.feature;J.id!==void 0&&j.writeVarintField(1,J.id),j.writeMessage(2,$e,de),j.writeVarintField(3,J.type),j.writeMessage(4,Ut,J)}function $e(de,j){var J=de.feature,ue=de.keys,we=de.values,Ce=de.keycache,Ve=de.valuecache;for(var Ue in J.properties){var z=J.properties[Ue],H=Ce[Ue];if(z!==null){H===void 0&&(ue.push(Ue),Ce[Ue]=H=ue.length-1),j.writeVarint(H);var q=typeof z;q!=="string"&&q!=="boolean"&&q!=="number"&&(z=JSON.stringify(z));var ne=q+":"+z,re=Ve[ne];re===void 0&&(we.push(z),Ve[ne]=re=we.length-1),j.writeVarint(re)}}}function We(de,j){return(j<<3)+(7&de)}function dt(de){return de<<1^de>>31}function Ut(de,j){for(var J=de.loadGeometry(),ue=de.type,we=0,Ce=0,Ve=J.length,Ue=0;Ue<Ve;Ue++){var z=J[Ue],H=1;ue===1&&(H=z.length),j.writeVarint(We(1,H));for(var q=ue===3?z.length-1:z.length,ne=0;ne<q;ne++){ne===1&&ue!==1&&j.writeVarint(We(2,q-1));var re=z[ne].x-we,ce=z[ne].y-Ce;j.writeVarint(dt(re)),j.writeVarint(dt(ce)),we+=re,Ce+=ce}ue===3&&j.writeVarint(We(7,1))}}function kt(de,j){var J=typeof de;J==="string"?j.writeStringField(1,de):J==="boolean"?j.writeBooleanField(7,de):J==="number"&&(de%1!=0?j.writeDoubleField(3,de):de<0?j.writeSVarintField(6,de):j.writeVarintField(5,de))}function Bt(de,j,J,ue,we,Ce){if(we-ue<=J)return;const Ve=ue+we>>1;zt(de,j,Ve,ue,we,Ce%2),Bt(de,j,J,ue,Ve-1,Ce+1),Bt(de,j,J,Ve+1,we,Ce+1)}function zt(de,j,J,ue,we,Ce){for(;we>ue;){if(we-ue>600){const H=we-ue+1,q=J-ue+1,ne=Math.log(H),re=.5*Math.exp(2*ne/3),ce=.5*Math.sqrt(ne*re*(H-re)/H)*(q-H/2<0?-1:1);zt(de,j,J,Math.max(ue,Math.floor(J-q*re/H+ce)),Math.min(we,Math.floor(J+(H-q)*re/H+ce)),Ce)}const Ve=j[2*J+Ce];let Ue=ue,z=we;for(gt(de,j,ue,J),j[2*we+Ce]>Ve&&gt(de,j,ue,we);Ue<z;){for(gt(de,j,Ue,z),Ue++,z--;j[2*Ue+Ce]<Ve;)Ue++;for(;j[2*z+Ce]>Ve;)z--}j[2*ue+Ce]===Ve?gt(de,j,ue,z):(z++,gt(de,j,z,we)),z<=J&&(ue=z+1),J<=z&&(we=z-1)}}function gt(de,j,J,ue){Be(de,J,ue),Be(j,2*J,2*ue),Be(j,2*J+1,2*ue+1)}function Be(de,j,J){const ue=de[j];de[j]=de[J],de[J]=ue}function Tt(de,j,J,ue){const we=de-J,Ce=j-ue;return we*we+Ce*Ce}ge.fromVectorTileJs=ke,ge.fromGeojsonVt=function(de,j){j=j||{};var J={};for(var ue in de)J[ue]=new G(de[ue].features,j),J[ue].name=ue,J[ue].version=j.version,J[ue].extent=j.extent;return ke({layers:J})},ge.GeoJSONWrapper=se;const Dt=de=>de[0],Ee=de=>de[1];class He{constructor(j,J=Dt,ue=Ee,we=64,Ce=Float64Array){this.nodeSize=we,this.points=j;const Ve=j.length<65536?Uint16Array:Uint32Array,Ue=this.ids=new Ve(j.length),z=this.coords=new Ce(2*j.length);for(let H=0;H<j.length;H++)Ue[H]=H,z[2*H]=J(j[H]),z[2*H+1]=ue(j[H]);Bt(Ue,z,we,0,Ue.length-1,0)}range(j,J,ue,we){return function(Ce,Ve,Ue,z,H,q,ne){const re=[0,Ce.length-1,0],ce=[];let De,Ne;for(;re.length;){const Fe=re.pop(),le=re.pop(),Ze=re.pop();if(le-Ze<=ne){for(let pt=Ze;pt<=le;pt++)De=Ve[2*pt],Ne=Ve[2*pt+1],De>=Ue&&De<=H&&Ne>=z&&Ne<=q&&ce.push(Ce[pt]);continue}const qe=Math.floor((Ze+le)/2);De=Ve[2*qe],Ne=Ve[2*qe+1],De>=Ue&&De<=H&&Ne>=z&&Ne<=q&&ce.push(Ce[qe]);const lt=(Fe+1)%2;(Fe===0?Ue<=De:z<=Ne)&&(re.push(Ze),re.push(qe-1),re.push(lt)),(Fe===0?H>=De:q>=Ne)&&(re.push(qe+1),re.push(le),re.push(lt))}return ce}(this.ids,this.coords,j,J,ue,we,this.nodeSize)}within(j,J,ue){return function(we,Ce,Ve,Ue,z,H){const q=[0,we.length-1,0],ne=[],re=z*z;for(;q.length;){const ce=q.pop(),De=q.pop(),Ne=q.pop();if(De-Ne<=H){for(let lt=Ne;lt<=De;lt++)Tt(Ce[2*lt],Ce[2*lt+1],Ve,Ue)<=re&&ne.push(we[lt]);continue}const Fe=Math.floor((Ne+De)/2),le=Ce[2*Fe],Ze=Ce[2*Fe+1];Tt(le,Ze,Ve,Ue)<=re&&ne.push(we[Fe]);const qe=(ce+1)%2;(ce===0?Ve-z<=le:Ue-z<=Ze)&&(q.push(Ne),q.push(Fe-1),q.push(qe)),(ce===0?Ve+z>=le:Ue+z>=Ze)&&(q.push(Fe+1),q.push(De),q.push(qe))}return ne}(this.ids,this.coords,j,J,ue,this.nodeSize)}}const Re={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:de=>de},Oe=Math.fround||(at=new Float32Array(1),de=>(at[0]=+de,at[0]));var at;class bt{constructor(j){this.options=or(Object.create(Re),j),this.trees=new Array(this.options.maxZoom+1)}load(j){const{log:J,minZoom:ue,maxZoom:we,nodeSize:Ce}=this.options;J&&console.time("total time");const Ve=`prepare ${j.length} points`;J&&console.time(Ve),this.points=j;let Ue=[];for(let z=0;z<j.length;z++)j[z].geometry&&Ue.push(At(j[z],z));this.trees[we+1]=new He(Ue,ir,ut,Ce,Float32Array),J&&console.timeEnd(Ve);for(let z=we;z>=ue;z--){const H=+Date.now();Ue=this._cluster(Ue,z),this.trees[z]=new He(Ue,ir,ut,Ce,Float32Array),J&&console.log("z%d: %d clusters in %dms",z,Ue.length,+Date.now()-H)}return J&&console.timeEnd("total time"),this}getClusters(j,J){let ue=((j[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,j[1]));let Ce=j[2]===180?180:((j[2]+180)%360+360)%360-180;const Ve=Math.max(-90,Math.min(90,j[3]));if(j[2]-j[0]>=360)ue=-180,Ce=180;else if(ue>Ce){const q=this.getClusters([ue,we,180,Ve],J),ne=this.getClusters([-180,we,Ce,Ve],J);return q.concat(ne)}const Ue=this.trees[this._limitZoom(J)],z=Ue.range(ve(ue),Cr(Ve),ve(Ce),Cr(we)),H=[];for(const q of z){const ne=Ue.points[q];H.push(ne.numPoints?yt(ne):this.points[ne.index])}return H}getChildren(j){const J=this._getOriginId(j),ue=this._getOriginZoom(j),we="No cluster with the specified id.",Ce=this.trees[ue];if(!Ce)throw new Error(we);const Ve=Ce.points[J];if(!Ve)throw new Error(we);const Ue=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),z=Ce.within(Ve.x,Ve.y,Ue),H=[];for(const q of z){const ne=Ce.points[q];ne.parentId===j&&H.push(ne.numPoints?yt(ne):this.points[ne.index])}if(H.length===0)throw new Error(we);return H}getLeaves(j,J,ue){const we=[];return this._appendLeaves(we,j,J=J||10,ue=ue||0,0),we}getTile(j,J,ue){const we=this.trees[this._limitZoom(j)],Ce=Math.pow(2,j),{extent:Ve,radius:Ue}=this.options,z=Ue/Ve,H=(ue-z)/Ce,q=(ue+1+z)/Ce,ne={features:[]};return this._addTileFeatures(we.range((J-z)/Ce,H,(J+1+z)/Ce,q),we.points,J,ue,Ce,ne),J===0&&this._addTileFeatures(we.range(1-z/Ce,H,1,q),we.points,Ce,ue,Ce,ne),J===Ce-1&&this._addTileFeatures(we.range(0,H,z/Ce,q),we.points,-1,ue,Ce,ne),ne.features.length?ne:null}getClusterExpansionZoom(j){let J=this._getOriginZoom(j)-1;for(;J<=this.options.maxZoom;){const ue=this.getChildren(j);if(J++,ue.length!==1)break;j=ue[0].properties.cluster_id}return J}_appendLeaves(j,J,ue,we,Ce){const Ve=this.getChildren(J);for(const Ue of Ve){const z=Ue.properties;if(z&&z.cluster?Ce+z.point_count<=we?Ce+=z.point_count:Ce=this._appendLeaves(j,z.cluster_id,ue,we,Ce):Ce<we?Ce++:j.push(Ue),j.length===ue)break}return Ce}_addTileFeatures(j,J,ue,we,Ce,Ve){for(const Ue of j){const z=J[Ue],H=z.numPoints;let q,ne,re;if(H)q=ar(z),ne=z.x,re=z.y;else{const Ne=this.points[z.index];q=Ne.properties,ne=ve(Ne.geometry.coordinates[0]),re=Cr(Ne.geometry.coordinates[1])}const ce={type:1,geometry:[[Math.round(this.options.extent*(ne*Ce-ue)),Math.round(this.options.extent*(re*Ce-we))]],tags:q};let De;H?De=z.id:this.options.generateId?De=z.index:this.points[z.index].id&&(De=this.points[z.index].id),De!==void 0&&(ce.id=De),Ve.features.push(ce)}}_limitZoom(j){return Math.max(this.options.minZoom,Math.min(+j,this.options.maxZoom+1))}_cluster(j,J){const ue=[],{radius:we,extent:Ce,reduce:Ve,minPoints:Ue}=this.options,z=we/(Ce*Math.pow(2,J));for(let H=0;H<j.length;H++){const q=j[H];if(q.zoom<=J)continue;q.zoom=J;const ne=this.trees[J+1],re=ne.within(q.x,q.y,z),ce=q.numPoints||1;let De=ce;for(const Ne of re){const Fe=ne.points[Ne];Fe.zoom>J&&(De+=Fe.numPoints||1)}if(De>ce&&De>=Ue){let Ne=q.x*ce,Fe=q.y*ce,le=Ve&&ce>1?this._map(q,!0):null;const Ze=(H<<5)+(J+1)+this.points.length;for(const qe of re){const lt=ne.points[qe];if(lt.zoom<=J)continue;lt.zoom=J;const pt=lt.numPoints||1;Ne+=lt.x*pt,Fe+=lt.y*pt,lt.parentId=Ze,Ve&&(le||(le=this._map(q,!0)),Ve(le,this._map(lt)))}q.parentId=Ze,ue.push(Ot(Ne/De,Fe/De,Ze,De,le))}else if(ue.push(q),De>1)for(const Ne of re){const Fe=ne.points[Ne];Fe.zoom<=J||(Fe.zoom=J,ue.push(Fe))}}return ue}_getOriginId(j){return j-this.points.length>>5}_getOriginZoom(j){return(j-this.points.length)%32}_map(j,J){if(j.numPoints)return J?or({},j.properties):j.properties;const ue=this.points[j.index].properties,we=this.options.map(ue);return J&&we===ue?or({},we):we}}function Ot(de,j,J,ue,we){return{x:Oe(de),y:Oe(j),zoom:1/0,id:J,parentId:-1,numPoints:ue,properties:we}}function At(de,j){const[J,ue]=de.geometry.coordinates;return{x:Oe(ve(J)),y:Oe(Cr(ue)),zoom:1/0,index:j,parentId:-1}}function yt(de){return{type:"Feature",id:de.id,properties:ar(de),geometry:{type:"Point",coordinates:[(j=de.x,360*(j-.5)),dr(de.y)]}};var j}function ar(de){const j=de.numPoints,J=j>=1e4?`${Math.round(j/1e3)}k`:j>=1e3?Math.round(j/100)/10+"k":j;return or(or({},de.properties),{cluster:!0,cluster_id:de.id,point_count:j,point_count_abbreviated:J})}function ve(de){return de/360+.5}function Cr(de){const j=Math.sin(de*Math.PI/180),J=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return J<0?0:J>1?1:J}function dr(de){const j=(180-360*de)*Math.PI/180;return 360*Math.atan(Math.exp(j))/Math.PI-90}function or(de,j){for(const J in j)de[J]=j[J];return de}function ir(de){return de.x}function ut(de){return de.y}function Ir(de,j,J,ue){for(var we,Ce=ue,Ve=J-j>>1,Ue=J-j,z=de[j],H=de[j+1],q=de[J],ne=de[J+1],re=j+3;re<J;re+=3){var ce=hn(de[re],de[re+1],z,H,q,ne);if(ce>Ce)we=re,Ce=ce;else if(ce===Ce){var De=Math.abs(re-Ve);De<Ue&&(we=re,Ue=De)}}Ce>ue&&(we-j>3&&Ir(de,j,we,ue),de[we+2]=Ce,J-we>3&&Ir(de,we,J,ue))}function hn(de,j,J,ue,we,Ce){var Ve=we-J,Ue=Ce-ue;if(Ve!==0||Ue!==0){var z=((de-J)*Ve+(j-ue)*Ue)/(Ve*Ve+Ue*Ue);z>1?(J=we,ue=Ce):z>0&&(J+=Ve*z,ue+=Ue*z)}return(Ve=de-J)*Ve+(Ue=j-ue)*Ue}function Xr(de,j,J,ue){var we={id:de===void 0?null:de,type:j,geometry:J,tags:ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Ce){var Ve=Ce.geometry,Ue=Ce.type;if(Ue==="Point"||Ue==="MultiPoint"||Ue==="LineString")zn(Ce,Ve);else if(Ue==="Polygon"||Ue==="MultiLineString")for(var z=0;z<Ve.length;z++)zn(Ce,Ve[z]);else if(Ue==="MultiPolygon")for(z=0;z<Ve.length;z++)for(var H=0;H<Ve[z].length;H++)zn(Ce,Ve[z][H])}(we),we}function zn(de,j){for(var J=0;J<j.length;J+=3)de.minX=Math.min(de.minX,j[J]),de.minY=Math.min(de.minY,j[J+1]),de.maxX=Math.max(de.maxX,j[J]),de.maxY=Math.max(de.maxY,j[J+1])}function Wi(de,j,J,ue){if(j.geometry){var we=j.geometry.coordinates,Ce=j.geometry.type,Ve=Math.pow(J.tolerance/((1<<J.maxZoom)*J.extent),2),Ue=[],z=j.id;if(J.promoteId?z=j.properties[J.promoteId]:J.generateId&&(z=ue||0),Ce==="Point")ni(we,Ue);else if(Ce==="MultiPoint")for(var H=0;H<we.length;H++)ni(we[H],Ue);else if(Ce==="LineString")fn(we,Ue,Ve,!1);else if(Ce==="MultiLineString"){if(J.lineMetrics){for(H=0;H<we.length;H++)fn(we[H],Ue=[],Ve,!1),de.push(Xr(z,"LineString",Ue,j.properties));return}On(we,Ue,Ve,!1)}else if(Ce==="Polygon")On(we,Ue,Ve,!0);else{if(Ce!=="MultiPolygon"){if(Ce==="GeometryCollection"){for(H=0;H<j.geometry.geometries.length;H++)Wi(de,{id:z,geometry:j.geometry.geometries[H],properties:j.properties},J,ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(H=0;H<we.length;H++){var q=[];On(we[H],q,Ve,!0),Ue.push(q)}}de.push(Xr(z,Ce,Ue,j.properties))}}function ni(de,j){j.push(dn(de[0])),j.push(Ti(de[1])),j.push(0)}function fn(de,j,J,ue){for(var we,Ce,Ve=0,Ue=0;Ue<de.length;Ue++){var z=dn(de[Ue][0]),H=Ti(de[Ue][1]);j.push(z),j.push(H),j.push(0),Ue>0&&(Ve+=ue?(we*H-z*Ce)/2:Math.sqrt(Math.pow(z-we,2)+Math.pow(H-Ce,2))),we=z,Ce=H}var q=j.length-3;j[2]=1,Ir(j,0,q,J),j[q+2]=1,j.size=Math.abs(Ve),j.start=0,j.end=j.size}function On(de,j,J,ue){for(var we=0;we<de.length;we++){var Ce=[];fn(de[we],Ce,J,ue),j.push(Ce)}}function dn(de){return de/360+.5}function Ti(de){var j=Math.sin(de*Math.PI/180),J=.5-.25*Math.log((1+j)/(1-j))/Math.PI;return J<0?0:J>1?1:J}function Rr(de,j,J,ue,we,Ce,Ve,Ue){if(ue/=j,Ce>=(J/=j)&&Ve<ue)return de;if(Ve<J||Ce>=ue)return null;for(var z=[],H=0;H<de.length;H++){var q=de[H],ne=q.geometry,re=q.type,ce=we===0?q.minX:q.minY,De=we===0?q.maxX:q.maxY;if(ce>=J&&De<ue)z.push(q);else if(!(De<J||ce>=ue)){var Ne=[];if(re==="Point"||re==="MultiPoint")en(ne,Ne,J,ue,we);else if(re==="LineString")rr(ne,Ne,J,ue,we,!1,Ue.lineMetrics);else if(re==="MultiLineString")pn(ne,Ne,J,ue,we,!1);else if(re==="Polygon")pn(ne,Ne,J,ue,we,!0);else if(re==="MultiPolygon")for(var Fe=0;Fe<ne.length;Fe++){var le=[];pn(ne[Fe],le,J,ue,we,!0),le.length&&Ne.push(le)}if(Ne.length){if(Ue.lineMetrics&&re==="LineString"){for(Fe=0;Fe<Ne.length;Fe++)z.push(Xr(q.id,re,Ne[Fe],q.tags));continue}re!=="LineString"&&re!=="MultiLineString"||(Ne.length===1?(re="LineString",Ne=Ne[0]):re="MultiLineString"),re!=="Point"&&re!=="MultiPoint"||(re=Ne.length===3?"Point":"MultiPoint"),z.push(Xr(q.id,re,Ne,q.tags))}}}return z.length?z:null}function en(de,j,J,ue,we){for(var Ce=0;Ce<de.length;Ce+=3){var Ve=de[Ce+we];Ve>=J&&Ve<=ue&&(j.push(de[Ce]),j.push(de[Ce+1]),j.push(de[Ce+2]))}}function rr(de,j,J,ue,we,Ce,Ve){for(var Ue,z,H=zr(de),q=we===0?ha:Zs,ne=de.start,re=0;re<de.length-3;re+=3){var ce=de[re],De=de[re+1],Ne=de[re+2],Fe=de[re+3],le=de[re+4],Ze=we===0?ce:De,qe=we===0?Fe:le,lt=!1;Ve&&(Ue=Math.sqrt(Math.pow(ce-Fe,2)+Math.pow(De-le,2))),Ze<J?qe>J&&(z=q(H,ce,De,Fe,le,J),Ve&&(H.start=ne+Ue*z)):Ze>ue?qe<ue&&(z=q(H,ce,De,Fe,le,ue),Ve&&(H.start=ne+Ue*z)):Nr(H,ce,De,Ne),qe<J&&Ze>=J&&(z=q(H,ce,De,Fe,le,J),lt=!0),qe>ue&&Ze<=ue&&(z=q(H,ce,De,Fe,le,ue),lt=!0),!Ce&&lt&&(Ve&&(H.end=ne+Ue*z),j.push(H),H=zr(de)),Ve&&(ne+=Ue)}var pt=de.length-3;ce=de[pt],De=de[pt+1],Ne=de[pt+2],(Ze=we===0?ce:De)>=J&&Ze<=ue&&Nr(H,ce,De,Ne),pt=H.length-3,Ce&&pt>=3&&(H[pt]!==H[0]||H[pt+1]!==H[1])&&Nr(H,H[0],H[1],H[2]),H.length&&j.push(H)}function zr(de){var j=[];return j.size=de.size,j.start=de.start,j.end=de.end,j}function pn(de,j,J,ue,we,Ce){for(var Ve=0;Ve<de.length;Ve++)rr(de[Ve],j,J,ue,we,Ce,!1)}function Nr(de,j,J,ue){de.push(j),de.push(J),de.push(ue)}function ha(de,j,J,ue,we,Ce){var Ve=(Ce-j)/(ue-j);return de.push(Ce),de.push(J+(we-J)*Ve),de.push(1),Ve}function Zs(de,j,J,ue,we,Ce){var Ve=(Ce-J)/(we-J);return de.push(j+(ue-j)*Ve),de.push(Ce),de.push(1),Ve}function Ao(de,j){for(var J=[],ue=0;ue<de.length;ue++){var we,Ce=de[ue],Ve=Ce.type;if(Ve==="Point"||Ve==="MultiPoint"||Ve==="LineString")we=ps(Ce.geometry,j);else if(Ve==="MultiLineString"||Ve==="Polygon"){we=[];for(var Ue=0;Ue<Ce.geometry.length;Ue++)we.push(ps(Ce.geometry[Ue],j))}else if(Ve==="MultiPolygon")for(we=[],Ue=0;Ue<Ce.geometry.length;Ue++){for(var z=[],H=0;H<Ce.geometry[Ue].length;H++)z.push(ps(Ce.geometry[Ue][H],j));we.push(z)}J.push(Xr(Ce.id,Ve,we,Ce.tags))}return J}function ps(de,j){var J=[];J.size=de.size,de.start!==void 0&&(J.start=de.start,J.end=de.end);for(var ue=0;ue<de.length;ue+=3)J.push(de[ue]+j,de[ue+1],de[ue+2]);return J}function Hs(de,j){if(de.transformed)return de;var J,ue,we,Ce=1<<de.z,Ve=de.x,Ue=de.y;for(J=0;J<de.features.length;J++){var z=de.features[J],H=z.geometry,q=z.type;if(z.geometry=[],q===1)for(ue=0;ue<H.length;ue+=2)z.geometry.push(Aa(H[ue],H[ue+1],j,Ce,Ve,Ue));else for(ue=0;ue<H.length;ue++){var ne=[];for(we=0;we<H[ue].length;we+=2)ne.push(Aa(H[ue][we],H[ue][we+1],j,Ce,Ve,Ue));z.geometry.push(ne)}}return de.transformed=!0,de}function Aa(de,j,J,ue,we,Ce){return[Math.round(J*(de*ue-we)),Math.round(J*(j*ue-Ce))]}function Xs(de,j,J,ue,we){for(var Ce=j===we.maxZoom?0:we.tolerance/((1<<j)*we.extent),Ve={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:J,y:ue,z:j,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ue=0;Ue<de.length;Ue++){Ve.numFeatures++,Ei(Ve,de[Ue],Ce,we);var z=de[Ue].minX,H=de[Ue].minY,q=de[Ue].maxX,ne=de[Ue].maxY;z<Ve.minX&&(Ve.minX=z),H<Ve.minY&&(Ve.minY=H),q>Ve.maxX&&(Ve.maxX=q),ne>Ve.maxY&&(Ve.maxY=ne)}return Ve}function Ei(de,j,J,ue){var we=j.geometry,Ce=j.type,Ve=[];if(Ce==="Point"||Ce==="MultiPoint")for(var Ue=0;Ue<we.length;Ue+=3)Ve.push(we[Ue]),Ve.push(we[Ue+1]),de.numPoints++,de.numSimplified++;else if(Ce==="LineString")Ca(Ve,we,de,J,!1,!1);else if(Ce==="MultiLineString"||Ce==="Polygon")for(Ue=0;Ue<we.length;Ue++)Ca(Ve,we[Ue],de,J,Ce==="Polygon",Ue===0);else if(Ce==="MultiPolygon")for(var z=0;z<we.length;z++){var H=we[z];for(Ue=0;Ue<H.length;Ue++)Ca(Ve,H[Ue],de,J,!0,Ue===0)}if(Ve.length){var q=j.tags||null;if(Ce==="LineString"&&ue.lineMetrics){for(var ne in q={},j.tags)q[ne]=j.tags[ne];q.mapbox_clip_start=we.start/we.size,q.mapbox_clip_end=we.end/we.size}var re={geometry:Ve,type:Ce==="Polygon"||Ce==="MultiPolygon"?3:Ce==="LineString"||Ce==="MultiLineString"?2:1,tags:q};j.id!==null&&(re.id=j.id),de.features.push(re)}}function Ca(de,j,J,ue,we,Ce){var Ve=ue*ue;if(ue>0&&j.size<(we?Ve:ue))J.numPoints+=j.length/3;else{for(var Ue=[],z=0;z<j.length;z+=3)(ue===0||j[z+2]>Ve)&&(J.numSimplified++,Ue.push(j[z]),Ue.push(j[z+1])),J.numPoints++;we&&function(H,q){for(var ne=0,re=0,ce=H.length,De=ce-2;re<ce;De=re,re+=2)ne+=(H[re]-H[De])*(H[re+1]+H[De+1]);if(ne>0===q)for(re=0,ce=H.length;re<ce/2;re+=2){var Ne=H[re],Fe=H[re+1];H[re]=H[ce-2-re],H[re+1]=H[ce-1-re],H[ce-2-re]=Ne,H[ce-1-re]=Fe}}(Ue,Ce),de.push(Ue)}}function Zi(de,j){var J=(j=this.options=function(we,Ce){for(var Ve in Ce)we[Ve]=Ce[Ve];return we}(Object.create(this.options),j)).debug;if(J&&console.time("preprocess data"),j.maxZoom<0||j.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(j.promoteId&&j.generateId)throw new Error("promoteId and generateId cannot be used together.");var ue=function(we,Ce){var Ve=[];if(we.type==="FeatureCollection")for(var Ue=0;Ue<we.features.length;Ue++)Wi(Ve,we.features[Ue],Ce,Ue);else Wi(Ve,we.type==="Feature"?we:{geometry:we},Ce);return Ve}(de,j);this.tiles={},this.tileCoords=[],J&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",j.indexMaxZoom,j.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(ue=function(we,Ce){var Ve=Ce.buffer/Ce.extent,Ue=we,z=Rr(we,1,-1-Ve,Ve,0,-1,2,Ce),H=Rr(we,1,1-Ve,2+Ve,0,-1,2,Ce);return(z||H)&&(Ue=Rr(we,1,-Ve,1+Ve,0,-1,2,Ce)||[],z&&(Ue=Ao(z,1).concat(Ue)),H&&(Ue=Ue.concat(Ao(H,-1)))),Ue}(ue,j)).length&&this.splitTile(ue,0,0,0),J&&(ue.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Ha(de,j,J){return 32*((1<<de)*J+j)+de}function ms(de,j){const J=de.tileID.canonical;if(!this._geoJSONIndex)return j(null,null);const ue=this._geoJSONIndex.getTile(J.z,J.x,J.y);if(!ue)return j(null,null);const we=new X(ue.features);let Ce=ge(we);Ce.byteOffset===0&&Ce.byteLength===Ce.buffer.byteLength||(Ce=new Uint8Array(Ce)),j(null,{vectorTile:we,rawData:Ce.buffer})}Zi.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Zi.prototype.splitTile=function(de,j,J,ue,we,Ce,Ve){for(var Ue=[de,j,J,ue],z=this.options,H=z.debug;Ue.length;){ue=Ue.pop(),J=Ue.pop(),j=Ue.pop(),de=Ue.pop();var q=1<<j,ne=Ha(j,J,ue),re=this.tiles[ne];if(!re&&(H>1&&console.time("creation"),re=this.tiles[ne]=Xs(de,j,J,ue,z),this.tileCoords.push({z:j,x:J,y:ue}),H)){H>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",j,J,ue,re.numFeatures,re.numPoints,re.numSimplified),console.timeEnd("creation"));var ce="z"+j;this.stats[ce]=(this.stats[ce]||0)+1,this.total++}if(re.source=de,we){if(j===z.maxZoom||j===we)continue;var De=1<<we-j;if(J!==Math.floor(Ce/De)||ue!==Math.floor(Ve/De))continue}else if(j===z.indexMaxZoom||re.numPoints<=z.indexMaxPoints)continue;if(re.source=null,de.length!==0){H>1&&console.time("clipping");var Ne,Fe,le,Ze,qe,lt,pt=.5*z.buffer/z.extent,wt=.5-pt,Mt=.5+pt,it=1+pt;Ne=Fe=le=Ze=null,qe=Rr(de,q,J-pt,J+Mt,0,re.minX,re.maxX,z),lt=Rr(de,q,J+wt,J+it,0,re.minX,re.maxX,z),de=null,qe&&(Ne=Rr(qe,q,ue-pt,ue+Mt,1,re.minY,re.maxY,z),Fe=Rr(qe,q,ue+wt,ue+it,1,re.minY,re.maxY,z),qe=null),lt&&(le=Rr(lt,q,ue-pt,ue+Mt,1,re.minY,re.maxY,z),Ze=Rr(lt,q,ue+wt,ue+it,1,re.minY,re.maxY,z),lt=null),H>1&&console.timeEnd("clipping"),Ue.push(Ne||[],j+1,2*J,2*ue),Ue.push(Fe||[],j+1,2*J,2*ue+1),Ue.push(le||[],j+1,2*J+1,2*ue),Ue.push(Ze||[],j+1,2*J+1,2*ue+1)}}},Zi.prototype.getTile=function(de,j,J){var ue=this.options,we=ue.extent,Ce=ue.debug;if(de<0||de>24)return null;var Ve=1<<de,Ue=Ha(de,j=(j%Ve+Ve)%Ve,J);if(this.tiles[Ue])return Hs(this.tiles[Ue],we);Ce>1&&console.log("drilling down to z%d-%d-%d",de,j,J);for(var z,H=de,q=j,ne=J;!z&&H>0;)H--,q=Math.floor(q/2),ne=Math.floor(ne/2),z=this.tiles[Ha(H,q,ne)];return z&&z.source?(Ce>1&&console.log("found parent tile z%d-%d-%d",H,q,ne),Ce>1&&console.time("drilling down"),this.splitTile(z.source,H,q,ne,de,j,J),Ce>1&&console.timeEnd("drilling down"),this.tiles[Ue]?Hs(this.tiles[Ue],we):null):null};class qs extends o.VectorTileWorkerSource{constructor(j,J,ue,we,Ce){super(j,J,ue,we,ms),Ce&&(this.loadGeoJSON=Ce)}loadData(j,J){const ue=j&&j.request,we=ue&&ue.collectResourceTiming;this.loadGeoJSON(j,(Ce,Ve)=>{if(Ce||!Ve)return J(Ce);if(typeof Ve!="object")return J(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));{L(Ve,!0);try{if(j.filter){const z=o.createExpression(j.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(z.result==="error")throw new Error(z.value.map(q=>`${q.key}: ${q.message}`).join(", "));const H=Ve.features.filter(q=>z.value.evaluate({zoom:0},q));Ve={type:"FeatureCollection",features:H}}this._geoJSONIndex=j.cluster?new bt(function({superclusterOptions:z,clusterProperties:H}){if(!H||!z)return z;const q={},ne={},re={accumulated:null,zoom:0},ce={properties:null},De=Object.keys(H);for(const Ne of De){const[Fe,le]=H[Ne],Ze=o.createExpression(le),qe=o.createExpression(typeof Fe=="string"?[Fe,["accumulated"],["get",Ne]]:Fe);q[Ne]=Ze.value,ne[Ne]=qe.value}return z.map=Ne=>{ce.properties=Ne;const Fe={};for(const le of De)Fe[le]=q[le].evaluate(re,ce);return Fe},z.reduce=(Ne,Fe)=>{ce.properties=Fe;for(const le of De)re.accumulated=Ne[le],Ne[le]=ne[le].evaluate(re,ce)},z}(j)).load(Ve.features):function(z,H){return new Zi(z,H)}(Ve,j.geojsonVtOptions)}catch(z){return J(z)}this.loaded={};const Ue={};if(we){const z=o.getPerformanceMeasurement(ue);z&&(Ue.resourceTiming={},Ue.resourceTiming[j.source]=JSON.parse(JSON.stringify(z)))}J(null,Ue)}})}reloadTile(j,J){const ue=this.loaded;return ue&&ue[j.uid]?super.reloadTile(j,J):this.loadTile(j,J)}loadGeoJSON(j,J){if(j.request)o.getJSON(j.request,J);else{if(typeof j.data!="string")return J(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`));try{return J(null,JSON.parse(j.data))}catch{return J(new Error(`Input data given to '${j.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(j,J){try{J(null,this._geoJSONIndex.getClusterExpansionZoom(j.clusterId))}catch(ue){J(ue)}}getClusterChildren(j,J){try{J(null,this._geoJSONIndex.getChildren(j.clusterId))}catch(ue){J(ue)}}getClusterLeaves(j,J){try{J(null,this._geoJSONIndex.getLeaves(j.clusterId,j.limit,j.offset))}catch(ue){J(ue)}}}class _s{constructor(j){this.self=j,this.actor=new o.Actor(j,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=o.getProjection({name:"mercator"}),this.workerSourceTypes={vector:o.VectorTileWorkerSource,geojson:qs},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(J,ue)=>{if(this.workerSourceTypes[J])throw new Error(`Worker source with name "${J}" already registered.`);this.workerSourceTypes[J]=ue},this.self.registerRTLTextPlugin=J=>{if(o.plugin.isParsed())throw new Error("RTL text plugin already registered.");o.plugin.applyArabicShaping=J.applyArabicShaping,o.plugin.processBidirectionalText=J.processBidirectionalText,o.plugin.processStyledBidirectionalText=J.processStyledBidirectionalText}}clearCaches(j,J,ue){delete this.layerIndexes[j],delete this.availableImages[j],delete this.workerSources[j],delete this.demWorkerSources[j],ue()}checkIfReady(j,J,ue){ue()}setReferrer(j,J){this.referrer=J}spriteLoaded(j,J){this.isSpriteLoaded[j]=J;for(const ue in this.workerSources[j]){const we=this.workerSources[j][ue];for(const Ce in we)we[Ce]instanceof o.VectorTileWorkerSource&&(we[Ce].isSpriteLoaded=J,we[Ce].fire(new o.Event("isSpriteLoaded")))}}setImages(j,J,ue){this.availableImages[j]=J;for(const we in this.workerSources[j]){const Ce=this.workerSources[j][we];for(const Ve in Ce)Ce[Ve].availableImages=J}ue()}enableTerrain(j,J,ue){this.terrain=J,ue()}setProjection(j,J){this.projections[j]=o.getProjection(J)}setLayers(j,J,ue){this.getLayerIndex(j).replace(J),ue()}updateLayers(j,J,ue){this.getLayerIndex(j).update(J.layers,J.removedIds),ue()}loadTile(j,J,ue){const we=this.enableTerrain?o.extend({enableTerrain:this.terrain},J):J;we.projection=this.projections[j]||this.defaultProjection,this.getWorkerSource(j,J.type,J.source).loadTile(we,ue)}loadDEMTile(j,J,ue){const we=this.enableTerrain?o.extend({buildQuadTree:this.terrain},J):J;this.getDEMWorkerSource(j,J.source).loadTile(we,ue)}reloadTile(j,J,ue){const we=this.enableTerrain?o.extend({enableTerrain:this.terrain},J):J;we.projection=this.projections[j]||this.defaultProjection,this.getWorkerSource(j,J.type,J.source).reloadTile(we,ue)}abortTile(j,J,ue){this.getWorkerSource(j,J.type,J.source).abortTile(J,ue)}removeTile(j,J,ue){this.getWorkerSource(j,J.type,J.source).removeTile(J,ue)}removeSource(j,J,ue){if(!this.workerSources[j]||!this.workerSources[j][J.type]||!this.workerSources[j][J.type][J.source])return;const we=this.workerSources[j][J.type][J.source];delete this.workerSources[j][J.type][J.source],we.removeSource!==void 0?we.removeSource(J,ue):ue()}loadWorkerSource(j,J,ue){try{this.self.importScripts(J.url),ue()}catch(we){ue(we.toString())}}syncRTLPluginState(j,J,ue){try{o.plugin.setState(J);const we=o.plugin.getPluginURL();if(o.plugin.isLoaded()&&!o.plugin.isParsed()&&we!=null){this.self.importScripts(we);const Ce=o.plugin.isParsed();ue(Ce?void 0:new Error(`RTL Text Plugin failed to import scripts from ${we}`),Ce)}}catch(we){ue(we.toString())}}getAvailableImages(j){let J=this.availableImages[j];return J||(J=[]),J}getLayerIndex(j){let J=this.layerIndexes[j];return J||(J=this.layerIndexes[j]=new I),J}getWorkerSource(j,J,ue){return this.workerSources[j]||(this.workerSources[j]={}),this.workerSources[j][J]||(this.workerSources[j][J]={}),this.workerSources[j][J][ue]||(this.workerSources[j][J][ue]=new this.workerSourceTypes[J]({send:(we,Ce,Ve,Ue,z,H)=>{this.actor.send(we,Ce,Ve,j,z,H)},scheduler:this.actor.scheduler},this.getLayerIndex(j),this.getAvailableImages(j),this.isSpriteLoaded[j])),this.workerSources[j][J][ue]}getDEMWorkerSource(j,J){return this.demWorkerSources[j]||(this.demWorkerSources[j]={}),this.demWorkerSources[j][J]||(this.demWorkerSources[j][J]=new D),this.demWorkerSources[j][J]}enforceCacheSizeLimit(j,J){o.enforceCacheSizeLimit(J)}getWorkerPerformanceMetrics(j,J,ue){ue(void 0,void 0)}}return typeof WorkerGlobalScope!="undefined"&&typeof self!="undefined"&&self instanceof WorkerGlobalScope&&(self.worker=new _s(self)),_s}),m(["./shared"],function(o){var S=A;function A(d){return!function(i){return typeof window=="undefined"||typeof document=="undefined"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,v,w=new Blob([""],{type:"text/javascript"}),E=URL.createObjectURL(w);try{v=new Worker(E),_=!0}catch{_=!1}return v&&v.terminate(),URL.revokeObjectURL(E),_}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var _=document.createElement("canvas");_.width=_.height=1;var v=_.getContext("2d");if(!v)return!1;var w=v.getImageData(0,0,1,1);return w&&w.width===_.width}()?(I[h=i&&i.failIfMajorPerformanceCaveat]===void 0&&(I[h]=function(_){var v,w=function(E){var k=document.createElement("canvas"),F=Object.create(A.webGLContextAttributes);return F.failIfMajorPerformanceCaveat=E,k.getContext("webgl",F)||k.getContext("experimental-webgl",F)}(_);if(!w)return!1;try{v=w.createShader(w.VERTEX_SHADER)}catch{return!1}return!(!v||w.isContextLost())&&(w.shaderSource(v,"void main() {}"),w.compileShader(v),w.getShaderParameter(v,w.COMPILE_STATUS)===!0)}(h)),I[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h}(d)}var I={};function D(d,i){if(Array.isArray(d)){if(!Array.isArray(i)||d.length!==i.length)return!1;for(let h=0;h<d.length;h++)if(!D(d[h],i[h]))return!1;return!0}if(typeof d=="object"&&d!==null&&i!==null){if(typeof i!="object"||Object.keys(d).length!==Object.keys(i).length)return!1;for(const h in d)if(!D(d[h],i[h]))return!1;return!0}return d===i}function L(d,i,h){const _=o.window.document.createElement(d);return i!==void 0&&(_.className=i),h&&h.appendChild(_),_}function B(d,i,h){const _=o.window.document.createElementNS("http://www.w3.org/2000/svg",d);for(const v of Object.keys(i))_.setAttributeNS(null,v,i[v]);return h&&h.appendChild(_),_}A.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const U=o.window.document&&o.window.document.documentElement.style,V=U&&U.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Y;function X(){U&&V&&(Y=U[V],U[V]="none")}function K(){U&&V&&(U[V]=Y)}function G(d){d.preventDefault(),d.stopPropagation(),o.window.removeEventListener("click",G,!0)}function me(){o.window.addEventListener("click",G,!0),o.window.setTimeout(()=>{o.window.removeEventListener("click",G,!0)},0)}function Ae(d,i){const h=d.getBoundingClientRect();return ke(d,h,i)}function ge(d,i){const h=d.getBoundingClientRect(),_=[];for(let v=0;v<i.length;v++)_.push(ke(d,h,i[v]));return _}function se(d){return o.window.InstallTrigger!==void 0&&d.button===2&&d.ctrlKey&&o.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:d.button}function ke(d,i,h){const _=d.offsetWidth===i.width?1:d.offsetWidth/i.width;return new o.pointGeometry((h.clientX-i.left)*_,(h.clientY-i.top)*_)}function Ie(d,i){var h=i[0],_=i[1],v=i[2],w=i[3],E=h*w-v*_;return E?(d[0]=w*(E=1/E),d[1]=-_*E,d[2]=-v*E,d[3]=h*E,d):null}function Xe(d){const{userImage:i}=d;return!!(i&&i.render&&i.render())&&(d.data.replace(new Uint8Array(i.data.buffer)),!0)}class $e extends o.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new o.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:h,callback:_}of this.requestors)this._notify(h,_);this.requestors=[]}}hasImage(i){return!!this.getImage(i)}getImage(i){return this.images[i]}addImage(i,h){this._validate(i,h)&&(this.images[i]=h)}_validate(i,h){let _=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new o.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),_=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new o.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),_=!1),this._validateContent(h.content,h)||(this.fire(new o.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),_=!1),_}_validateStretch(i,h){if(!i)return!0;let _=0;for(const v of i){if(v[0]<_||v[1]<v[0]||h<v[1])return!1;_=v[1]}return!0}_validateContent(i,h){return!(i&&(i.length!==4||i[0]<0||h.data.width<i[0]||i[1]<0||h.data.height<i[1]||i[2]<0||h.data.width<i[2]||i[3]<0||h.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,h){h.version=this.images[i].version+1,this.images[i]=h,this.updatedImages[i]=!0}removeImage(i){const h=this.images[i];delete this.images[i],delete this.patterns[i],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,h){let _=!0;if(!this.isLoaded())for(const v of i)this.images[v]||(_=!1);this.isLoaded()||_?this._notify(i,h):this.requestors.push({ids:i,callback:h})}_notify(i,h){const _={};for(const v of i){this.images[v]||this.fire(new o.Event("styleimagemissing",{id:v}));const w=this.images[v];w?_[v]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:Boolean(w.userImage&&w.userImage.render)}:o.warnOnce(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,_)}getPixelSize(){const{width:i,height:h}=this.atlasImage;return{width:i,height:h}}getPattern(i){const h=this.patterns[i],_=this.getImage(i);if(!_)return null;if(h&&h.position.version===_.version)return h.position;if(h)h.position.version=_.version;else{const v={w:_.data.width+2,h:_.data.height+2,x:0,y:0},w=new o.ImagePosition(v,_);this.patterns[i]={bin:v,position:w}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const h=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new o.Texture(i,this.atlasImage,h.RGBA),this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const w in this.patterns)i.push(this.patterns[w].bin);const{w:h,h:_}=o.potpack(i),v=this.atlasImage;v.resize({width:h||1,height:_||1});for(const w in this.patterns){const{bin:E}=this.patterns[w],k=E.x+1,F=E.y+1,R=this.images[w].data,O=R.width,W=R.height;o.RGBAImage.copy(R,v,{x:0,y:0},{x:k,y:F},{width:O,height:W}),o.RGBAImage.copy(R,v,{x:0,y:W-1},{x:k,y:F-1},{width:O,height:1}),o.RGBAImage.copy(R,v,{x:0,y:0},{x:k,y:F+W},{width:O,height:1}),o.RGBAImage.copy(R,v,{x:O-1,y:0},{x:k-1,y:F},{width:1,height:W}),o.RGBAImage.copy(R,v,{x:0,y:0},{x:k+O,y:F},{width:1,height:W})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const h of i){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const _=this.images[h];Xe(_)&&this.updateImage(h,_)}}}const We=new o.Properties({anchor:new o.DataConstantProperty(o.spec.light.anchor),position:new class{constructor(){this.specification=o.spec.light.position}possiblyEvaluate(d,i){return function([h,_,v]){const w=o.degToRad(_+90),E=o.degToRad(v);return{x:h*Math.cos(w)*Math.sin(E),y:h*Math.sin(w)*Math.sin(E),z:h*Math.cos(E),azimuthal:_,polar:v}}(d.expression.evaluate(i))}interpolate(d,i,h){return{x:o.number(d.x,i.x,h),y:o.number(d.y,i.y,h),z:o.number(d.z,i.z,h),azimuthal:o.number(d.azimuthal,i.azimuthal,h),polar:o.number(d.polar,i.polar,h)}}},color:new o.DataConstantProperty(o.spec.light.color),intensity:new o.DataConstantProperty(o.spec.light.intensity)}),dt="-transition";class Ut extends o.Evented{constructor(i){super(),this._transitionable=new o.Transitionable(We),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,h={}){if(!this._validate(o.validateLight,i,h))for(const _ in i){const v=i[_];o.endsWith(_,dt)?this._transitionable.setTransition(_.slice(0,-dt.length),v):this._transitionable.setValue(_,v)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,h,_){return(!_||_.validate!==!1)&&o.emitValidationErrors(this,i.call(o.validateStyle,o.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}const kt=new o.Properties({source:new o.DataConstantProperty(o.spec.terrain.source),exaggeration:new o.DataConstantProperty(o.spec.terrain.exaggeration)}),Bt="-transition";class zt extends o.Evented{constructor(i,h){super(),this._transitionable=new o.Transitionable(kt),this.set(i),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=h}get(){return this._transitionable.serialize()}set(i){for(const h in i){const _=i[h];o.endsWith(h,Bt)?this._transitionable.setTransition(h.slice(0,-Bt.length),_):this._transitionable.setValue(h,_)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}}function gt(d,i,h,_){const v=o.smoothstep(45,65,h),[w,E]=Be(d,_),k=o.length(i);let F=1-Math.min(1,Math.exp((k-w)/(E-w)*-6));return F*=F*F,F=Math.min(1,1.00747*F),F*v*d.alpha}function Be(d,i){const h=.5/Math.tan(.5*i);return[d.range[0]+h,d.range[1]+h]}const Tt=new o.Properties({range:new o.DataConstantProperty(o.spec.fog.range),color:new o.DataConstantProperty(o.spec.fog.color),"horizon-blend":new o.DataConstantProperty(o.spec.fog["horizon-blend"])}),Dt="-transition";class Ee extends o.Evented{constructor(i,h){super(),this._transitionable=new o.Transitionable(Tt),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,h={}){if(!this._validate(o.validateFog,i,h))for(const _ in i){const v=i[_];o.endsWith(_,Dt)?this._transitionable.setTransition(_.slice(0,-Dt.length),v):this._transitionable.setValue(_,v)}}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return o.smoothstep(45,65,i)*h.a}getOpacityAtLatLng(i,h){return this._transform.projection.supportsFog?function(_,v,w){const E=o.MercatorCoordinate.fromLngLat(v),k=w.elevation?w.elevation.getAtPointOrZero(E):0,F=[E.x,E.y,k];return o.transformMat4(F,F,w.mercatorFogMatrix),gt(_,F,w.pitch,w._fov)}(this.state,i,h):0}getFovAdjustedRange(i){return this._transform.projection.supportsFog?Be(this.state,i):[0,1]}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,h,_){return(!_||_.validate!==!1)&&o.emitValidationErrors(this,i.call(o.validateStyle,o.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:o.spec})))}}class He{constructor(i,h){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=o.uniqueId();const _=this.workerPool.acquire(this.id);for(let v=0;v<_.length;v++){const w=new He.Actor(_[v],h,this.id);w.name=`Worker ${v}`,this.actors.push(w)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,h,_){o.asyncAll(this.actors,(v,w)=>{v.send(i,h,w)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function Re(d,i,h){return i*(o.EXTENT/(d.tileSize*Math.pow(2,h-d.tileID.overscaledZ)))}He.Actor=o.Actor;class Oe{constructor(i,h,_,v){this.screenBounds=i,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(w=>v.pointCoordinate3D(w)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(i,h){let _,v;if(i instanceof o.pointGeometry||typeof i[0]=="number"){const w=o.pointGeometry.convert(i);_=[o.pointGeometry.convert(i)],v=h.isPointAboveHorizon(w)}else{const w=o.pointGeometry.convert(i[0]),E=o.pointGeometry.convert(i[1]);_=[w,E],v=o.polygonizeBounds(w,E).every(k=>h.isPointAboveHorizon(k))}return new Oe(_,h.getCameraPoint(),v,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(i){return o.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new o.pointGeometry(1,1)):this.screenBounds[1],v=o.polygonizeBounds(h,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<_.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?v[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(v[3]=this.cameraPoint)),o.bufferConvexPolygon(v,i)}containsTile(i,h,_){const v=i.queryPadding+1,w=i.tileID.wrap,E=_?this._bufferedCameraMercator(v,h).map(ie=>o.getTilePoint(i.tileTransform,ie,w)):this._bufferedScreenMercator(v,h).map(ie=>o.getTilePoint(i.tileTransform,ie,w)),k=this.screenGeometryMercator.map(ie=>o.getTileVec3(i.tileTransform,ie,w)),F=k.map(ie=>new o.pointGeometry(ie[0],ie[1])),R=h.getFreeCameraOptions().position||new o.MercatorCoordinate(0,0,0),O=o.getTileVec3(i.tileTransform,R,w),W=k.map(ie=>{const Q=o.sub(ie,ie,O);return o.normalize(Q,Q),new o.Ray(O,Q)}),te=Re(i,1,h.zoom);if(o.polygonIntersectsBox(E,0,0,o.EXTENT,o.EXTENT))return{queryGeometry:this,tilespaceGeometry:F,tilespaceRays:W,bufferedTilespaceGeometry:E,bufferedTilespaceBounds:(oe=o.getBounds(E),oe.min.x=o.clamp(oe.min.x,0,o.EXTENT),oe.min.y=o.clamp(oe.min.y,0,o.EXTENT),oe.max.x=o.clamp(oe.max.x,0,o.EXTENT),oe.max.y=o.clamp(oe.max.y,0,o.EXTENT),oe),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:te};var oe}_bufferedScreenMercator(i,h){const _=at(i);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{const v=this.bufferedScreenGeometry(i).map(w=>h.pointCoordinate3D(w));return this._screenRaycastCache[_]=v,v}}_bufferedCameraMercator(i,h){const _=at(i);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{const v=this.bufferedCameraGeometry(i).map(w=>h.pointCoordinate3D(w));return this._cameraRaycastCache[_]=v,v}}}function at(d){return 100*d|0}function bt(d,i,h){const _=function(v,w){if(v)return h(v);if(w){const E=o.pick(o.extend(w,d),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(E.vectorLayers=w.vector_layers,E.vectorLayerIds=E.vectorLayers.map(k=>k.id)),E.tiles=i.canonicalizeTileset(E,d.url),h(null,E)}};return d.url?o.getJSON(i.transformRequest(i.normalizeSourceURL(d.url),o.ResourceType.Source),_):o.exported.frame(()=>_(null,d))}class Ot{constructor(i,h,_){this.bounds=o.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=h||0,this.maxzoom=_||24}validateBounds(i){return Array.isArray(i)&&i.length===4?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const h=Math.pow(2,i.z),_=Math.floor(o.mercatorXfromLng(this.bounds.getWest())*h),v=Math.floor(o.mercatorYfromLat(this.bounds.getNorth())*h),w=Math.ceil(o.mercatorXfromLng(this.bounds.getEast())*h),E=Math.ceil(o.mercatorYfromLat(this.bounds.getSouth())*h);return i.x>=_&&i.x<w&&i.y>=v&&i.y<E}}class At{constructor(i,h,_){this.context=i;const v=i.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const yt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ar{constructor(i,h,_,v){this.length=h.length,this.attributes=_,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=i;const w=i.gl;this.buffer=w.createBuffer(),i.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,h){for(let _=0;_<this.attributes.length;_++){const v=h.attributes[this.attributes[_].name];v!==void 0&&i.enableVertexAttribArray(v)}}setVertexAttribPointers(i,h,_){for(let v=0;v<this.attributes.length;v++){const w=this.attributes[v],E=h.attributes[w.name];E!==void 0&&i.vertexAttribPointer(E,w.components,i[yt[w.type]],!1,this.itemSize,w.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ve{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Cr extends ve{getDefault(){return o.Color.transparent}set(i){const h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class dr extends ve{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class or extends ve{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class ir extends ve{getDefault(){return[!0,!0,!0,!0]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class ut extends ve{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Ir extends ve{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class hn extends ve{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const h=this.current;(i.func!==h.func||i.ref!==h.ref||i.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class Xr extends ve{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class zn extends ve{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=i,this.dirty=!1}}class Wi extends ve{getDefault(){return[0,1]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class ni extends ve{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=i,this.dirty=!1}}class fn extends ve{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class On extends ve{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.BLEND):h.disable(h.BLEND),this.current=i,this.dirty=!1}}class dn extends ve{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Ti extends ve{getDefault(){return o.Color.transparent}set(i){const h=this.current;(i.r!==h.r||i.g!==h.g||i.b!==h.b||i.a!==h.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Rr extends ve{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class en extends ve{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;i?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=i,this.dirty=!1}}class rr extends ve{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class zr extends ve{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class pn extends ve{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class Nr extends ve{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class ha extends ve{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const h=this.current;(i[0]!==h[0]||i[1]!==h[1]||i[2]!==h[2]||i[3]!==h[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class Zs extends ve{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class Ao extends ve{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class ps extends ve{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Hs extends ve{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Aa extends ve{getDefault(){return null}set(i){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class Xs extends ve{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class Ei extends ve{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class Ca extends ve{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Zi extends ve{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Ha extends ve{constructor(i,h){super(i),this.context=i,this.parent=h}getDefault(){return null}}class ms extends Ha{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class qs extends Ha{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class _s extends qs{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class de{constructor(i,h,_,v){this.context=i,this.width=h,this.height=_;const w=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new ms(i,w),v&&(this.depthAttachment=new qs(i,w))}destroy(){const i=this.context.gl,h=this.colorAttachment.get();if(h&&i.deleteTexture(h),this.depthAttachment){const _=this.depthAttachment.get();_&&i.deleteRenderbuffer(_)}i.deleteFramebuffer(this.framebuffer)}}class j{constructor(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Cr(this),this.clearDepth=new dr(this),this.clearStencil=new or(this),this.colorMask=new ir(this),this.depthMask=new ut(this),this.stencilMask=new Ir(this),this.stencilFunc=new hn(this),this.stencilOp=new Xr(this),this.stencilTest=new zn(this),this.depthRange=new Wi(this),this.depthTest=new ni(this),this.depthFunc=new fn(this),this.blend=new On(this),this.blendFunc=new dn(this),this.blendColor=new Ti(this),this.blendEquation=new Rr(this),this.cullFace=new en(this),this.cullFaceSide=new rr(this),this.frontFace=new zr(this),this.program=new pn(this),this.activeTexture=new Nr(this),this.viewport=new ha(this),this.bindFramebuffer=new Zs(this),this.bindRenderbuffer=new Ao(this),this.bindTexture=new ps(this),this.bindVertexBuffer=new Hs(this),this.bindElementBuffer=new Aa(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Xs(this),this.pixelStoreUnpack=new Ei(this),this.pixelStoreUnpackPremultiplyAlpha=new Ca(this),this.pixelStoreUnpackFlipY=new Zi(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,h){return new At(this,i,h)}createVertexBuffer(i,h,_){return new ar(this,i,h,_)}createRenderbuffer(i,h,_){const v=this.gl,w=v.createRenderbuffer();return this.bindRenderbuffer.set(w),v.renderbufferStorage(v.RENDERBUFFER,i,h,_),this.bindRenderbuffer.set(null),w}createFramebuffer(i,h,_){return new de(this,i,h,_)}clear({color:i,depth:h,stencil:_}){const v=this.gl;let w=0;i&&(w|=v.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(w|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),_!==void 0&&(w|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),v.clear(w)}setCullFace(i){i.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){D(i.blendFunction,o.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class J extends o.Evented{constructor(i,h,_,v){super(),this.id=i,this.dispatcher=_,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=o.extend({type:"raster"},h),o.extend(this,o.pick(h,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=bt(this._options,this.map._requestManager,(i,h)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new o.ErrorEvent(i)):h&&(o.extend(this,h),h.bounds&&(this.tileBounds=new Ot(h.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(h.tiles),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,h){const _=o.exported.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);i.request=o.getImage(this.map._requestManager.transformRequest(v,o.ResourceType.Tile),(w,E,k,F)=>(delete i.request,i.aborted?(i.state="unloaded",h(null)):w?(i.state="errored",h(w)):E?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:k,expires:F}),i.setTexture(E,this.map.painter),i.state="loaded",o.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null)))}static loadTileData(i,h,_){i.setTexture(h,_)}static unloadTileData(i,h){i.texture&&h.saveTileTexture(i.texture)}abortTile(i,h){i.request&&(i.request.cancel(),delete i.request),h()}unloadTile(i,h){i.texture&&this.map.painter.saveTileTexture(i.texture),h()}hasTransition(){return!1}}let ue;function we(d,i,h,_,v,w,E,k){const F=[d,h,v,i,_,w,1,1,1],R=[E,k,1],O=o.adjoint([],F),[W,te,oe]=o.transformMat3(R,R,o.transpose(O,O));return o.multiply(F,[W,0,0,0,te,0,0,0,oe],F)}class Ce extends o.Evented{constructor(i,h,_,v){super(),this.id=i,this.dispatcher=_,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h}load(i){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this.url=this.options.url,o.getImage(this.map._requestManager.transformRequest(this.url,o.ResourceType.Image),(h,_)=>{if(this._loaded=!0,h)this.fire(new o.ErrorEvent(h));else if(_){const{HTMLImageElement:v}=o.window;this.image=_ instanceof v?o.exported.getImageData(_):_,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading()}})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this.texture&&this.texture.destroy()}setCoordinates(i){this.coordinates=i,this._boundsArray=void 0;const h=i.map(o.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let v=1/0,w=1/0,E=-1/0,k=-1/0;for(const W of _)v=Math.min(v,W.x),w=Math.min(w,W.y),E=Math.max(E,W.x),k=Math.max(k,W.y);const F=Math.max(E-v,k-w),R=Math.max(0,Math.floor(-Math.log(F)/Math.LN2)),O=Math.pow(2,R);return new o.CanonicalTileID(R,Math.floor((v+E)/2*O),Math.floor((w+k)/2*O))}(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(i){for(const F in this.tiles){const R=this.tiles[F];R.state!=="loaded"&&(R.state="loaded",R.texture=this.texture)}if(this._boundsArray)return;const h=o.tileTransform(this.tileID,this.map.transform.projection),[_,v,w,E]=this.coordinates.map(F=>{const R=h.projection.project(F[0],F[1]);return o.getTilePoint(h,R)._round()});this.perspectiveTransform=function(F,R,O,W,te,oe,ie,Q,ye,he){const _e=we(0,0,F,0,0,R,F,R),xe=we(O,W,te,oe,ie,Q,ye,he);return o.multiply(xe,o.adjoint(_e,_e),xe),[xe[6]/xe[8]*F/o.EXTENT,xe[7]/xe[8]*R/o.EXTENT]}(this.width,this.height,_.x,_.y,v.x,v.y,E.x,E.y,w.x,w.y);const k=this._boundsArray=new o.StructArrayLayout4i8;k.emplaceBack(_.x,_.y,0,0),k.emplaceBack(v.x,v.y,o.EXTENT,0),k.emplaceBack(E.x,E.y,0,o.EXTENT),k.emplaceBack(w.x,w.y,o.EXTENT,o.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=i.createVertexBuffer(k,o.boundsAttributes.members),this.boundsSegments=o.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const i=this.map.painter.context,h=i.gl;this.texture?this.texture.update(this.image):(this.texture=new o.Texture(i,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._prepareData(i)}loadTile(i,h){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},h(null)):(i.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ve={vector:class extends o.Evented{constructor(d,i,h,_){if(super(),this.id=d,this.dispatcher=h,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,o.extend(this,o.pick(i,["url","scheme","tileSize","promoteId"])),this._options=o.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new o.DedupedRequest}load(){this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=bt(this._options,this.map._requestManager,(d,i)=>{this._tileJSONRequest=null,this._loaded=!0,d?this.fire(new o.ErrorEvent(d)):i&&(o.extend(this,i),i.bounds&&(this.tileBounds=new Ot(i.bounds,this.minzoom,this.maxzoom)),o.postTurnstileEvent(i.tiles,this.map._requestManager._customAccessToken),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(d){return!this.tileBounds||this.tileBounds.contains(d.canonical)}onAdd(d){this.map=d,this.load()}setSourceProperty(d){this._tileJSONRequest&&this._tileJSONRequest.cancel(),d();const i=this.map.style._getSourceCaches(this.id);for(const h of i)h.clearTiles();this.load()}setTiles(d){return this.setSourceProperty(()=>{this._options.tiles=d}),this}setUrl(d){return this.setSourceProperty(()=>{this.url=d,this._options.url=d}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return o.extend({},this._options)}loadTile(d,i){const h=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(h,o.ResourceType.Tile),data:void 0,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,tileSize:this.tileSize*d.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:d.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,d.actor&&d.state!=="expired")d.state==="loading"?d.reloadCallback=i:d.request=d.actor.send("reloadTile",_,v.bind(this));else if(d.actor=this._tileWorkers[h]=this._tileWorkers[h]||this.dispatcher.getActor(),this.dispatcher.ready)d.request=d.actor.send("loadTile",_,v.bind(this),void 0,!0);else{const w=o.loadVectorTile.call({deduped:this._deduped},_,(E,k)=>{E||!k?v.call(this,E):(_.data={cacheControl:k.cacheControl,expires:k.expires,rawData:k.rawData.slice(0)},d.actor&&d.actor.send("loadTile",_,v.bind(this),void 0,!0))},!0);d.request={cancel:w}}function v(w,E){return delete d.request,d.aborted?i(null):w&&w.status!==404?i(w):(E&&E.resourceTiming&&(d.resourceTiming=E.resourceTiming),this.map._refreshExpiredTiles&&E&&d.setExpiryData(E),d.loadVectorData(E,this.map.painter),o.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(d.reloadCallback&&(this.loadTile(d,d.reloadCallback),d.reloadCallback=null)))}}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.actor&&d.actor.send("abortTile",{uid:d.uid,type:this.type,source:this.id})}unloadTile(d){d.unloadVectorData(),d.actor&&d.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:J,"raster-dem":class extends J{constructor(d,i,h,_){super(d,i,h,_),this.type="raster-dem",this.maxzoom=22,this._options=o.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(d,i){const h=this.map._requestManager.normalizeTileURL(d.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(v,w){v&&(d.state="errored",i(v)),w&&(d.dem=w,d.dem.onDeserialize(),d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0,d.state="loaded",i(null))}d.request=o.getImage(this.map._requestManager.transformRequest(h,o.ResourceType.Tile),function(v,w,E,k){if(delete d.request,d.aborted)d.state="unloaded",i(null);else if(v)d.state="errored",i(v);else if(w){this.map._refreshExpiredTiles&&d.setExpiryData({cacheControl:E,expires:k});const F=o.window.ImageBitmap&&w instanceof o.window.ImageBitmap&&(ue==null&&(ue=o.window.OffscreenCanvas&&new o.window.OffscreenCanvas(1,1).getContext("2d")&&typeof o.window.createImageBitmap=="function"),ue),R=1-(w.width-o.prevPowerOfTwo(w.width))/2;R<1||d.neighboringTiles||(d.neighboringTiles=this._getNeighboringTiles(d.tileID));const O=F?w:o.exported.getImageData(w,R),W={uid:d.uid,coord:d.tileID,source:this.id,rawImageData:O,encoding:this.encoding,padding:R};d.actor&&d.state!=="expired"||(d.actor=this.dispatcher.getActor(),d.actor.send("loadDEMTile",W,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(d){const i=d.canonical,h=Math.pow(2,i.z),_=(i.x-1+h)%h,v=i.x===0?d.wrap-1:d.wrap,w=(i.x+1+h)%h,E=i.x+1===h?d.wrap+1:d.wrap,k={};return k[new o.OverscaledTileID(d.overscaledZ,v,i.z,_,i.y).key]={backfilled:!1},k[new o.OverscaledTileID(d.overscaledZ,E,i.z,w,i.y).key]={backfilled:!1},i.y>0&&(k[new o.OverscaledTileID(d.overscaledZ,v,i.z,_,i.y-1).key]={backfilled:!1},k[new o.OverscaledTileID(d.overscaledZ,d.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},k[new o.OverscaledTileID(d.overscaledZ,E,i.z,w,i.y-1).key]={backfilled:!1}),i.y+1<h&&(k[new o.OverscaledTileID(d.overscaledZ,v,i.z,_,i.y+1).key]={backfilled:!1},k[new o.OverscaledTileID(d.overscaledZ,d.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},k[new o.OverscaledTileID(d.overscaledZ,E,i.z,w,i.y+1).key]={backfilled:!1}),k}unloadTile(d){d.demTexture&&this.map.painter.saveTileTexture(d.demTexture),d.fbo&&(d.fbo.destroy(),delete d.fbo),d.dem&&delete d.dem,delete d.neighboringTiles,d.state="unloaded"}},geojson:class extends o.Evented{constructor(d,i,h,_){super(),this.id=d,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(_),this._data=i.data,this._options=o.extend({},i),this._collectResourceTiming=i.collectResourceTiming,i.maxzoom!==void 0&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const v=o.EXTENT/this.tileSize;this.workerOptions=o.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(i.buffer!==void 0?i.buffer:128)*v,tolerance:(i.tolerance!==void 0?i.tolerance:.375)*v,extent:o.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:i.clusterMaxZoom!==void 0?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:o.EXTENT,radius:(i.clusterRadius!==void 0?i.clusterRadius:50)*v,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(d){this.map=d,this.setData(this._data)}setData(d){return this._data=d,this._updateWorkerData(),this}getClusterExpansionZoom(d,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:d,source:this.id},i),this}getClusterChildren(d,i){return this.actor.send("geojson.getClusterChildren",{clusterId:d,source:this.id},i),this}getClusterLeaves(d,i,h,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:d,limit:i,offset:h},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new o.Event("dataloading",{dataType:"source"})),this._loaded=!1;const d=o.extend({},this.workerOptions),i=this._data;typeof i=="string"?(d.request=this.map._requestManager.transformRequest(o.exported.resolveURL(i),o.ResourceType.Source),d.request.collectResourceTiming=this._collectResourceTiming):d.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,d,(h,_)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new o.ErrorEvent(h));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(v.resourceTiming=_.resourceTiming[this.id]),this.fire(new o.Event("data",v)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(d,i){const h=d.actor?"reloadTile":"loadTile";d.actor=this.actor,d.request=this.actor.send(h,{type:this.type,uid:d.uid,tileID:d.tileID,tileZoom:d.tileZoom,zoom:d.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:o.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,v)=>(delete d.request,d.unloadVectorData(),d.aborted?i(null):_?i(_):(d.loadVectorData(v,this.map.painter,h==="reloadTile"),i(null))),void 0,h==="loadTile")}abortTile(d){d.request&&(d.request.cancel(),delete d.request),d.aborted=!0}unloadTile(d){d.unloadVectorData(),this.actor.send("removeTile",{uid:d.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return o.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ce{constructor(d,i,h,_){super(d,i,h,_),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const d=this.options;this.urls=[];for(const i of d.urls)this.urls.push(this.map._requestManager.transformRequest(i,o.ResourceType.Source).url);o.getVideo(this.urls,(i,h)=>{this._loaded=!0,i?this.fire(new o.ErrorEvent(i)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(d){if(this.video){const i=this.video.seekable;d<i.start(0)||d>i.end(0)?this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=d}}getVideo(){return this.video}onAdd(d){this.map||(this.map=d,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const d=this.map.painter.context,i=d.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new o.Texture(d,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(d)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ce,canvas:class extends Ce{constructor(d,i,h,_){super(d,i,h,_),i.coordinates?Array.isArray(i.coordinates)&&i.coordinates.length===4&&!i.coordinates.some(v=>!Array.isArray(v)||v.length!==2||v.some(w=>typeof w!="number"))||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${d}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${d}`,null,'missing required property "coordinates"'))),i.animate&&typeof i.animate!="boolean"&&this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${d}`,null,'optional "animate" property must be a boolean value'))),i.canvas?typeof i.canvas=="string"||i.canvas instanceof o.window.HTMLCanvasElement||this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${d}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new o.ErrorEvent(new o.ValidationError(`sources.${d}`,null,'missing required property "canvas"'))),this.options=i,this.animate=i.animate===void 0||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof o.window.HTMLCanvasElement?this.options.canvas:o.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new o.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(d){this.map=d,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let d=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,d=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,d=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const i=this.map.painter.context;this.texture?(d||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new o.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const d of[this.canvas.width,this.canvas.height])if(isNaN(d)||d<=0)return!0;return!1}},custom:class extends o.Evented{constructor(d,i,h,_){super(),this.id=d,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=i,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new o.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new o.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ot(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.coveringTiles=this._coveringTiles.bind(this),o.extend(this,o.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return o.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new o.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(d){this._map=d,this._loaded=!1,this.fire(new o.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(d),this.load()}onRemove(d){this._implementation.onRemove&&this._implementation.onRemove(d)}hasTile(d){if(this._implementation.hasTile){const{x:i,y:h,z:_}=d.canonical;return this._implementation.hasTile({x:i,y:h,z:_})}return!this.tileBounds||this.tileBounds.contains(d.canonical)}loadTile(d,i){const{x:h,y:_,z:v}=d.tileID.canonical,w=new o.window.AbortController,E=this._implementation.loadTile({x:h,y:_,z:v},{signal:w.signal});if(!E)return this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",i(null);E.cancel=()=>w.abort(),d.request=E.then(function(k){return delete d.request,d.aborted?(d.state="unloaded",i(null)):k?function(F){return F instanceof o.window.ImageData||F instanceof o.window.ImageBitmap||F instanceof o.window.HTMLCanvasElement}(k)?(this.loadTileData(d,k),d.state="loaded",void i(null)):(d.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`))):(this.loadTileData(d,{width:this.tileSize,height:this.tileSize,data:null}),d.state="loaded",i(null))}.bind(this)).catch(k=>{k.code!==20&&(d.state="errored",i(k))})}loadTileData(d,i){J.loadTileData(d,i,this._map.painter)}unloadTileData(d){J.unloadTileData(d,this._map.painter)}prepareTile(d){if(!this._implementation.prepareTile)return null;const{x:i,y:h,z:_}=d.tileID.canonical,v=this._implementation.prepareTile({x:i,y:h,z:_});return v?(this.loadTileData(d,v),d.state="loaded",v):null}unloadTile(d,i){if(this.unloadTileData(d),this._implementation.unloadTile){const{x:h,y:_,z:v}=d.tileID.canonical;this._implementation.unloadTile({x:h,y:_,z:v})}i()}abortTile(d,i){d.request&&d.request.cancel&&(d.request.cancel(),delete d.request),i()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(d=>({x:d.canonical.x,y:d.canonical.y,z:d.canonical.z}))}_update(){this.fire(new o.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Ue=function(d,i,h,_){const v=new Ve[i.type](d,i,h,_);if(v.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${v.id}`);return o.bindAll(["load","abort","unload","serialize","prepare"],v),v};function z(d,i){const h=o.identity([]);return o.scale(h,h,[.5*d.width,.5*-d.height,1]),o.translate(h,h,[1,-1,0]),o.multiply$1(h,h,d.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(h)}function H(d,i,h,_,v,w,E,k=!1){const F=d.tilesIn(_,E,k);F.sort(ne);const R=[];for(const W of F)R.push({wrappedTileID:W.tile.tileID.wrapped().key,queryResults:W.tile.queryRenderedFeatures(i,h,d._state,W,v,w,z(d.transform,W.tile.tileID),k)});const O=function(W){const te={},oe={};for(const ie of W){const Q=ie.queryResults,ye=ie.wrappedTileID,he=oe[ye]=oe[ye]||{};for(const _e in Q){const xe=Q[_e],Te=he[_e]=he[_e]||{},pe=te[_e]=te[_e]||[];for(const Se of xe)Te[Se.featureIndex]||(Te[Se.featureIndex]=!0,pe.push(Se))}}return te}(R);for(const W in O)O[W].forEach(te=>{const oe=te.feature,ie=oe.layer;ie&&ie.type!=="background"&&ie.type!=="sky"&&(oe.source=ie.source,ie["source-layer"]&&(oe.sourceLayer=ie["source-layer"]),oe.state=oe.id!==void 0?d.getFeatureState(ie["source-layer"],oe.id):{})});return O}function q(d,i){const h=d.getRenderableIds().map(w=>d.getTileByID(w)),_=[],v={};for(let w=0;w<h.length;w++){const E=h[w],k=E.tileID.canonical.key;v[k]||(v[k]=!0,E.querySourceFeatures(_,i))}return _}function ne(d,i){const h=d.tileID,_=i.tileID;return h.overscaledZ-_.overscaledZ||h.canonical.y-_.canonical.y||h.wrap-_.wrap||h.canonical.x-_.canonical.x}function re(){return Vo.workerClass!=null?new Vo.workerClass:new o.window.Worker(Vo.workerUrl)}const ce="mapboxgl_preloaded_worker_pool";class De{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<De.workerCount;)this.workers.push(new re);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.numActive()===0&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[ce]}numActive(){return Object.keys(this.active).length}}let Ne;function Fe(){return Ne||(Ne=new De),Ne}function le(d,i){const h={};for(const _ in d)_!=="ref"&&(h[_]=d[_]);return o.refProperties.forEach(_=>{_ in i&&(h[_]=i[_])}),h}function Ze(d){d=d.slice();const i=Object.create(null);for(let h=0;h<d.length;h++)i[d[h].id]=d[h];for(let h=0;h<d.length;h++)"ref"in d[h]&&(d[h]=le(d[h],i[d[h].ref]));return d}De.workerCount=2;const qe={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function lt(d,i,h){h.push({command:qe.addSource,args:[d,i[d]]})}function pt(d,i,h){i.push({command:qe.removeSource,args:[d]}),h[d]=!0}function wt(d,i,h,_){pt(d,h,_),lt(d,i,h)}function Mt(d,i,h){let _;for(_ in d[h])if(d[h].hasOwnProperty(_)&&_!=="data"&&!D(d[h][_],i[h][_]))return!1;for(_ in i[h])if(i[h].hasOwnProperty(_)&&_!=="data"&&!D(d[h][_],i[h][_]))return!1;return!0}function it(d,i,h,_,v,w){let E;for(E in i=i||{},d=d||{})d.hasOwnProperty(E)&&(D(d[E],i[E])||h.push({command:w,args:[_,E,i[E],v]}));for(E in i)i.hasOwnProperty(E)&&!d.hasOwnProperty(E)&&(D(d[E],i[E])||h.push({command:w,args:[_,E,i[E],v]}))}function Zt(d){return d.id}function Gt(d,i){return d[i.id]=i,d}class Or{constructor(i,h){this.reset(i,h)}reset(i,h){this.points=i||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(this.points.length===1)return this.points[0];i=o.clamp(i,0,1);let h=1,_=this._distances[h];const v=i*this.paddedLength+this.padding;for(;_<v&&h<this._distances.length;)_=this._distances[++h];const w=h-1,E=this._distances[w],k=_-E,F=k>0?(v-E)/k:0;return this.points[w].mult(1-F).add(this.points[h].mult(F))}}class bi{constructor(i,h,_){const v=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(i/_),this.yCellCount=Math.ceil(h/_);for(let E=0;E<this.xCellCount*this.yCellCount;E++)v.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=h,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,h,_,v,w){this._forEachCell(h,_,v,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(v),this.bboxes.push(w)}insertCircle(i,h,_,v){this._forEachCell(h-v,_-v,h+v,_+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(h),this.circles.push(_),this.circles.push(v)}_insertBoxCell(i,h,_,v,w,E){this.boxCells[w].push(E)}_insertCircleCell(i,h,_,v,w,E){this.circleCells[w].push(E)}_query(i,h,_,v,w,E){if(_<0||i>this.width||v<0||h>this.height)return!w&&[];const k=[];if(i<=0&&h<=0&&this.width<=_&&this.height<=v){if(w)return!0;for(let F=0;F<this.boxKeys.length;F++)k.push({key:this.boxKeys[F],x1:this.bboxes[4*F],y1:this.bboxes[4*F+1],x2:this.bboxes[4*F+2],y2:this.bboxes[4*F+3]});for(let F=0;F<this.circleKeys.length;F++){const R=this.circles[3*F],O=this.circles[3*F+1],W=this.circles[3*F+2];k.push({key:this.circleKeys[F],x1:R-W,y1:O-W,x2:R+W,y2:O+W})}return E?k.filter(E):k}return this._forEachCell(i,h,_,v,this._queryCell,k,{hitTest:w,seenUids:{box:{},circle:{}}},E),w?k.length>0:k}_queryCircle(i,h,_,v,w){const E=i-_,k=i+_,F=h-_,R=h+_;if(k<0||E>this.width||R<0||F>this.height)return!v&&[];const O=[];return this._forEachCell(E,F,k,R,this._queryCellCircle,O,{hitTest:v,circle:{x:i,y:h,radius:_},seenUids:{box:{},circle:{}}},w),v?O.length>0:O}query(i,h,_,v,w){return this._query(i,h,_,v,!1,w)}hitTest(i,h,_,v,w){return this._query(i,h,_,v,!0,w)}hitTestCircle(i,h,_,v){return this._queryCircle(i,h,_,!0,v)}_queryCell(i,h,_,v,w,E,k,F){const R=k.seenUids,O=this.boxCells[w];if(O!==null){const te=this.bboxes;for(const oe of O)if(!R.box[oe]){R.box[oe]=!0;const ie=4*oe;if(i<=te[ie+2]&&h<=te[ie+3]&&_>=te[ie+0]&&v>=te[ie+1]&&(!F||F(this.boxKeys[oe]))){if(k.hitTest)return E.push(!0),!0;E.push({key:this.boxKeys[oe],x1:te[ie],y1:te[ie+1],x2:te[ie+2],y2:te[ie+3]})}}}const W=this.circleCells[w];if(W!==null){const te=this.circles;for(const oe of W)if(!R.circle[oe]){R.circle[oe]=!0;const ie=3*oe;if(this._circleAndRectCollide(te[ie],te[ie+1],te[ie+2],i,h,_,v)&&(!F||F(this.circleKeys[oe]))){if(k.hitTest)return E.push(!0),!0;{const Q=te[ie],ye=te[ie+1],he=te[ie+2];E.push({key:this.circleKeys[oe],x1:Q-he,y1:ye-he,x2:Q+he,y2:ye+he})}}}}}_queryCellCircle(i,h,_,v,w,E,k,F){const R=k.circle,O=k.seenUids,W=this.boxCells[w];if(W!==null){const oe=this.bboxes;for(const ie of W)if(!O.box[ie]){O.box[ie]=!0;const Q=4*ie;if(this._circleAndRectCollide(R.x,R.y,R.radius,oe[Q+0],oe[Q+1],oe[Q+2],oe[Q+3])&&(!F||F(this.boxKeys[ie])))return E.push(!0),!0}}const te=this.circleCells[w];if(te!==null){const oe=this.circles;for(const ie of te)if(!O.circle[ie]){O.circle[ie]=!0;const Q=3*ie;if(this._circlesCollide(oe[Q],oe[Q+1],oe[Q+2],R.x,R.y,R.radius)&&(!F||F(this.circleKeys[ie])))return E.push(!0),!0}}}_forEachCell(i,h,_,v,w,E,k,F){const R=this._convertToXCellCoord(i),O=this._convertToYCellCoord(h),W=this._convertToXCellCoord(_),te=this._convertToYCellCoord(v);for(let oe=R;oe<=W;oe++)for(let ie=O;ie<=te;ie++)if(w.call(this,i,h,_,v,this.xCellCount*ie+oe,E,k,F))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,h,_,v,w,E){const k=v-i,F=w-h,R=_+E;return R*R>k*k+F*F}_circleAndRectCollide(i,h,_,v,w,E,k){const F=(E-v)/2,R=Math.abs(i-(v+F));if(R>F+_)return!1;const O=(k-w)/2,W=Math.abs(h-(w+O));if(W>O+_)return!1;if(R<=F||W<=O)return!0;const te=R-F,oe=W-O;return te*te+oe*oe<=_*_}}const Qt=Math.tan(85*Math.PI/180);function Si(d,i,h,_,v,w){const E=o.create();if(h){if(v.projection.name==="globe")o.multiply$1(E,E,o.calculateGlobeLabelMatrix(v,i));else{const k=Ie([],w);E[0]=k[0],E[1]=k[1],E[4]=k[2],E[5]=k[3]}_||o.rotateZ(E,E,v.angle)}else o.multiply$1(E,v.labelPlaneMatrix,d);return E}function ii(d,i,h,_,v,w){if(h){if(v.projection.name==="globe"){const E=Si(d,i,h,_,v,w);return o.invert(E,E),o.multiply$1(E,d,E),E}{const E=o.clone(d),k=o.identity([]);return k[0]=w[0],k[1]=w[1],k[4]=w[2],k[5]=w[3],o.multiply$1(E,E,k),_||o.rotateZ(E,E,-v.angle),E}}return v.glCoordMatrix}function Tn(d,i,h=0){const _=[d.x,d.y,h,1];h?o.transformMat4$1(_,_,i):ki(_,_,i);const v=_[3];return{point:new o.pointGeometry(_[0]/v,_[1]/v),signedDistanceFromCamera:v}}function tn(d,i){const h=[d[0],d[1],d[2],1];o.transformMat4$1(h,h,i);const _=h[3];return{point:new o.pointGeometry(h[0]/_,h[1]/_),signedDistanceFromCamera:_}}function Vr(d,i){return Math.min(.5+d/i*.5,1.5)}function b_(d,i){const h=d[0]/d[3],_=d[1]/d[3];return h>=-i[0]&&h<=i[0]&&_>=-i[1]&&_<=i[1]}function Ml(d,i,h,_,v,w,E,k,F,R){const O=h.transform,W=_?d.textSizeData:d.iconSizeData,te=o.evaluateSizeForZoom(W,h.transform.zoom),oe=[256/h.width*2+1,256/h.height*2+1],ie=_?d.text.dynamicLayoutVertexArray:d.icon.dynamicLayoutVertexArray;ie.clear();const Q=d.lineVertexArray,ye=_?d.text.placedSymbolArray:d.icon.placedSymbolArray,he=h.transform.width/h.transform.height;let _e=!1;for(let xe=0;xe<ye.length;xe++){const Te=ye.get(xe);if(Te.writingMode!==o.WritingMode.vertical||_e||xe!==0&&ye.get(xe-1).writingMode===o.WritingMode.horizontal||(_e=!0),(Te.hidden||Te.writingMode===o.WritingMode.vertical)&&!_e){mn(Te.numGlyphs,ie);continue}_e=!1;const pe=new o.pointGeometry(Te.tileAnchorX,Te.tileAnchorY),Se=F?F(pe):[0,0,0],je=O.projection.projectTilePoint(pe.x,pe.y,R.canonical),Ye=[je.x+Se[0],je.y+Se[1],je.z+Se[2]],tt=[...Ye,1];if(o.transformMat4$1(tt,tt,i),!b_(tt,oe)){mn(Te.numGlyphs,ie);continue}const Qe=Vr(h.transform.cameraToCenterDistance,tt[3]),mt=o.evaluateSizeForFeature(W,te,Te),Ge=E?mt/Qe:mt*Qe,_t=Tn(new o.pointGeometry(Ye[0],Ye[1]),v,Ye[2]);if(_t.signedDistanceFromCamera<=0){mn(Te.numGlyphs,ie);continue}let ht={};const Rt=E?null:F,rt=Vc(Te,Ge,!1,k,i,v,w,d.glyphOffsetArray,Q,ie,_t.point,pe,ht,he,Rt,O.projection,R);_e=rt.useVertical,Rt&&rt.needsFlipping&&(ht={}),(rt.notEnoughRoom||_e||rt.needsFlipping&&Vc(Te,Ge,!0,k,i,v,w,d.glyphOffsetArray,Q,ie,_t.point,pe,ht,he,Rt,O.projection,R).notEnoughRoom)&&mn(Te.numGlyphs,ie)}_?d.text.dynamicLayoutVertexBuffer.updateData(ie):d.icon.dynamicLayoutVertexBuffer.updateData(ie)}function Uc(d,i,h,_,v,w,E,k,F,R,O,W,te,oe,ie){const Q=k.glyphStartIndex+k.numGlyphs,ye=k.lineStartIndex,he=k.lineStartIndex+k.lineLength,_e=i.getoffsetX(k.glyphStartIndex),xe=i.getoffsetX(Q-1),Te=Io(d*_e,h,_,v,w,E,k.segment,ye,he,F,R,O,W,te,!0,oe,ie);if(!Te)return null;const pe=Io(d*xe,h,_,v,w,E,k.segment,ye,he,F,R,O,W,te,!0,oe,ie);return pe?{first:Te,last:pe}:null}function Co(d,i,h,_){return d.writingMode===o.WritingMode.horizontal&&Math.abs(h.y-i.y)>Math.abs(h.x-i.x)*_?{useVertical:!0}:d.writingMode===o.WritingMode.vertical?i.y<h.y?{needsFlipping:!0}:null:d.flipState!==0&&function(v,w,E){const k=(w.x-v.x)*E;return k===0||Math.abs((w.y-v.y)/k)>Qt}(i,h,_)?d.flipState===1?{needsFlipping:!0}:null:i.x>h.x?{needsFlipping:!0}:null}function Vc(d,i,h,_,v,w,E,k,F,R,O,W,te,oe,ie,Q,ye){const he=i/24,_e=d.lineOffsetX*he,xe=d.lineOffsetY*he;let Te;if(d.numGlyphs>1){const pe=d.glyphStartIndex+d.numGlyphs,Se=d.lineStartIndex,je=d.lineStartIndex+d.lineLength,Ye=Uc(he,k,_e,xe,h,O,W,d,F,w,te,ie,!1,Q,ye);if(!Ye)return{notEnoughRoom:!0};const tt=Tn(Ye.first.point,E).point,Qe=Tn(Ye.last.point,E).point;if(_&&!h){const mt=Co(d,tt,Qe,oe);if(d.flipState=mt&&mt.needsFlipping?1:2,mt)return mt}Te=[Ye.first];for(let mt=d.glyphStartIndex+1;mt<pe-1;mt++)Te.push(Io(he*k.getoffsetX(mt),_e,xe,h,O,W,d.segment,Se,je,F,w,te,ie,!1,!1,Q,ye));Te.push(Ye.last)}else{if(_&&!h){const Se=Tn(W,v).point,je=d.lineStartIndex+d.segment+1,Ye=new o.pointGeometry(F.getx(je),F.gety(je)),tt=Tn(Ye,v),Qe=Co(d,Se,tt.signedDistanceFromCamera>0?tt.point:pr(W,Ye,Se,1,v,void 0,Q,ye.canonical),oe);if(d.flipState=Qe&&Qe.needsFlipping?1:2,Qe)return Qe}const pe=Io(he*k.getoffsetX(d.glyphStartIndex),_e,xe,h,O,W,d.segment,d.lineStartIndex,d.lineStartIndex+d.lineLength,F,w,te,ie,!1,!1,Q,ye);if(!pe)return{notEnoughRoom:!0};Te=[pe]}for(const pe of Te)o.addDynamicAttributes(R,pe.point,pe.angle);return{}}function bh(d,i,h,_,v){const w=_.projectTilePoint(d.x,d.y,i);if(!v)return Tn(w,h,w.z);const E=v(d);return Tn(new o.pointGeometry(w.x+E[0],w.y+E[1]),h,w.z+E[2])}function pr(d,i,h,_,v,w,E,k){const F=bh(d.add(d.sub(i)._unit()),k,v,E,w).point,R=h.sub(F);return h.add(R._mult(_/R.mag()))}function Io(d,i,h,_,v,w,E,k,F,R,O,W,te,oe,ie,Q,ye){const he=_?d-i:d+i;let _e=he>0?1:-1,xe=0;_&&(_e*=-1,xe=Math.PI),_e<0&&(xe+=Math.PI);let Te=_e>0?k+E:k+E+1,pe=v,Se=v,je=0,Ye=0;const tt=Math.abs(he),Qe=[],mt=[];let Ge=w;const _t=()=>{const Pt=Te-_e;return je===0?w:new o.pointGeometry(R.getx(Pt),R.gety(Pt))},ht=()=>pr(_t(),Ge,Se,tt-je+1,O,te,Q,ye.canonical);for(;je+Ye<=tt;){if(Te+=_e,Te<k||Te>=F)return null;if(Se=pe,Qe.push(pe),oe&&mt.push(Ge||_t()),pe=W[Te],pe===void 0){Ge=new o.pointGeometry(R.getx(Te),R.gety(Te));const Pt=bh(Ge,ye.canonical,O,Q,te);pe=Pt.signedDistanceFromCamera>0?W[Te]=Pt.point:ht()}else Ge=null;je+=Ye,Ye=Se.dist(pe)}ie&&te&&(Ge=Ge||new o.pointGeometry(R.getx(Te),R.gety(Te)),W[Te]=pe=W[Te]===void 0?pe:ht(),Ye=Se.dist(pe));const Rt=(tt-je)/Ye,rt=pe.sub(Se),Ft=rt.mult(Rt)._add(Se);h&&Ft._add(rt._unit()._perp()._mult(h*_e));const $t=xe+Math.atan2(pe.y-Se.y,pe.x-Se.x);return Qe.push(Ft),oe&&(Ge=Ge||new o.pointGeometry(R.getx(Te),R.gety(Te)),mt.push(function(Pt,Lt,Ht){const er=1-Ht;return new o.pointGeometry(Pt.x*er+Lt.x*Ht,Pt.y*er+Lt.y*Ht)}(mt.length>0?mt[mt.length-1]:Ge,Ge,Rt))),{point:Ft,angle:$t,path:Qe,tilePath:mt}}const Sh=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function mn(d,i){for(let h=0;h<d;h++){const _=i.length;i.resize(_+4),i.float32.set(Sh,3*_)}}function ki(d,i,h){const _=i[0],v=i[1];return d[0]=h[0]*_+h[4]*v+h[12],d[1]=h[1]*_+h[5]*v+h[13],d[3]=h[3]*_+h[7]*v+h[15],d}const fa=100;class jc{constructor(i,h,_=new bi(i.width+200,i.height+200,25),v=new bi(i.width+200,i.height+200,25)){this.transform=i,this.grid=_,this.ignoredGrid=v,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+fa,this.screenBottomBoundary=i.height+fa,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=h}placeCollisionBox(i,h,_,v,w,E,k){let F=h.projectedAnchorX,R=h.projectedAnchorY,O=h.projectedAnchorZ;const W=h.elevation,te=h.tileID;if(W&&te){const Te=this.transform.projection.upVector(te.canonical,h.tileAnchorX,h.tileAnchorY),pe=this.transform.projection.upVectorScale(te.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;F+=Te[0]*W*pe,R+=Te[1]*W*pe,O+=Te[2]*W*pe}const oe=this.projectAndGetPerspectiveRatio(E,[F,R,O],h.tileID,this.transform.projection.name==="globe"||!!W||this.transform.pitch>0),ie=w*oe.perspectiveRatio,Q=(h.x1*i+_.x-h.padding)*ie+oe.point.x,ye=(h.y1*i+_.y-h.padding)*ie+oe.point.y,he=(h.x2*i+_.x+h.padding)*ie+oe.point.x,_e=(h.y2*i+_.y+h.padding)*ie+oe.point.y,xe=oe.perspectiveRatio<=.55||oe.occluded;return!this.isInsideGrid(Q,ye,he,_e)||!v&&this.grid.hitTest(Q,ye,he,_e,k)||xe?{box:[],offscreen:!1,occluded:oe.occluded}:{box:[Q,ye,he,_e],offscreen:this.isOffscreen(Q,ye,he,_e),occluded:!1}}placeCollisionCircles(i,h,_,v,w,E,k,F,R,O,W,te,oe,ie){const Q=[],ye=this.transform.elevation,he=ye?ye.getAtTileOffsetFunc(ie,this.transform.center.lat,this.transform.worldSize,this.transform.projection):ht=>[0,0,0],_e=new o.pointGeometry(h.tileAnchorX,h.tileAnchorY),xe=this.transform.projection.projectTilePoint(h.tileAnchorX,h.tileAnchorY,ie.canonical),Te=he(_e),pe=[xe.x+Te[0],xe.y+Te[1],xe.z+Te[2]],Se=this.projectAndGetPerspectiveRatio(E,[pe[0],pe[1],pe[2]],ie,this.transform.projection.name==="globe"||!!ye||this.transform.pitch>0),{perspectiveRatio:je}=Se,Ye=(O?w/je:w*je)/o.ONE_EM,tt=Tn(new o.pointGeometry(pe[0],pe[1]),k,pe[2]).point,Qe=Se.signedDistanceFromCamera>0?Uc(Ye,v,h.lineOffsetX*Ye,h.lineOffsetY*Ye,!1,tt,_e,h,_,k,{},ye&&!O?he:null,O&&!!ye,this.transform.projection,ie):null;let mt=!1,Ge=!1,_t=!0;if(Qe&&!Se.occluded){const ht=.5*te*je+oe,Rt=new o.pointGeometry(-100,-100),rt=new o.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Ft=new Or,$t=Qe.first,Pt=Qe.last;let Lt=[];for(let jt=$t.path.length-1;jt>=1;jt--)Lt.push($t.path[jt]);for(let jt=1;jt<Pt.path.length;jt++)Lt.push(Pt.path[jt]);const Ht=2.5*ht;if(F){const jt=Lt.map(ye?(qt,fr)=>{const jr=he(fr<$t.path.length-1?$t.tilePath[$t.path.length-1-fr]:Pt.tilePath[fr-$t.path.length+2]);return Tn(qt,F,jr[2])}:qt=>Tn(qt,F));Lt=jt.some(qt=>qt.signedDistanceFromCamera<=0)?[]:jt.map(qt=>qt.point)}let er=[];if(Lt.length>0){const jt=Lt[0].clone(),qt=Lt[0].clone();for(let fr=1;fr<Lt.length;fr++)jt.x=Math.min(jt.x,Lt[fr].x),jt.y=Math.min(jt.y,Lt[fr].y),qt.x=Math.max(qt.x,Lt[fr].x),qt.y=Math.max(qt.y,Lt[fr].y);er=jt.x>=Rt.x&&qt.x<=rt.x&&jt.y>=Rt.y&&qt.y<=rt.y?[Lt]:qt.x<Rt.x||jt.x>rt.x||qt.y<Rt.y||jt.y>rt.y?[]:o.clipLine([Lt],Rt.x,Rt.y,rt.x,rt.y)}for(const jt of er){Ft.reset(jt,.25*ht);let qt=0;qt=Ft.length<=.5*ht?1:Math.ceil(Ft.paddedLength/Ht)+1;for(let fr=0;fr<qt;fr++){const jr=fr/Math.max(qt-1,1),$n=Ft.lerp(jr),Wn=$n.x+fa,Di=$n.y+fa;Q.push(Wn,Di,ht,0);const ma=Wn-ht,Qa=Di-ht,ks=Wn+ht,es=Di+ht;if(_t=_t&&this.isOffscreen(ma,Qa,ks,es),Ge=Ge||this.isInsideGrid(ma,Qa,ks,es),!i&&this.grid.hitTestCircle(Wn,Di,ht,W)&&(mt=!0,!R))return{circles:[],offscreen:!1,collisionDetected:mt,occluded:!1}}}}return{circles:!R&&mt||!Ge?[]:Q,offscreen:_t,collisionDetected:mt,occluded:Se.occluded}}queryRenderedSymbols(i){if(i.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let _=1/0,v=1/0,w=-1/0,E=-1/0;for(const O of i){const W=new o.pointGeometry(O.x+fa,O.y+fa);_=Math.min(_,W.x),v=Math.min(v,W.y),w=Math.max(w,W.x),E=Math.max(E,W.y),h.push(W)}const k=this.grid.query(_,v,w,E).concat(this.ignoredGrid.query(_,v,w,E)),F={},R={};for(const O of k){const W=O.key;if(F[W.bucketInstanceId]===void 0&&(F[W.bucketInstanceId]={}),F[W.bucketInstanceId][W.featureIndex])continue;const te=[new o.pointGeometry(O.x1,O.y1),new o.pointGeometry(O.x2,O.y1),new o.pointGeometry(O.x2,O.y2),new o.pointGeometry(O.x1,O.y2)];o.polygonIntersectsPolygon(h,te)&&(F[W.bucketInstanceId][W.featureIndex]=!0,R[W.bucketInstanceId]===void 0&&(R[W.bucketInstanceId]=[]),R[W.bucketInstanceId].push(W.featureIndex))}return R}insertCollisionBox(i,h,_,v,w){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:v,collisionGroupID:w},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,h,_,v,w){const E=h?this.ignoredGrid:this.grid,k={bucketInstanceId:_,featureIndex:v,collisionGroupID:w};for(let F=0;F<i.length;F+=4)E.insertCircle(k,i[F],i[F+1],i[F+2])}projectAndGetPerspectiveRatio(i,h,_,v){const w=[h[0],h[1],h[2],1];let E=!1;return h[2]||this.transform.pitch>0?(o.transformMat4$1(w,w,i),this.fogState&&_&&(E=function(k,F,R,O,W,te){const oe=te.calculateFogTileMatrix(W),ie=[F,R,O];return o.transformMat4(ie,ie,oe),gt(k,ie,te.pitch,te._fov)}(this.fogState,h[0],h[1],h[2],_.toUnwrapped(),this.transform)>.9)):ki(w,w,i),{point:new o.pointGeometry((w[0]/w[3]+1)/2*this.transform.width+fa,(-w[1]/w[3]+1)/2*this.transform.height+fa),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/w[3]*.5,1.5),signedDistanceFromCamera:w[3],occluded:v&&w[2]>w[3]||E}}isOffscreen(i,h,_,v){return _<fa||i>=this.screenRightBoundary||v<fa||h>this.screenBottomBoundary}isInsideGrid(i,h,_,v){return _>=0&&i<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const i=o.identity([]);return o.translate(i,i,[-100,-100,0]),i}}class an{constructor(i,h,_,v){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?h:-h))):v&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class Xa{constructor(i,h,_,v,w,E=!1){this.text=new an(i?i.text:null,h,_,w),this.icon=new an(i?i.icon:null,h,v,w),this.clipped=E}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class qa{constructor(i,h,_,v=!1){this.text=i,this.icon=h,this.skipFade=_,this.clipped=v}}class Bn{constructor(){this.invProjMatrix=o.create(),this.viewportMatrix=o.create(),this.circles=[]}}class kh{constructor(i,h,_,v,w){this.bucketInstanceId=i,this.featureIndex=h,this.sourceLayerIndex=_,this.bucketIndex=v,this.tileID=w}}class da{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const h=++this.maxGroupID;this.collisionGroups[i]={ID:h,predicate:_=>_.collisionGroupID===h}}return this.collisionGroups[i]}}function Mo(d,i,h,_,v){const{horizontalAlign:w,verticalAlign:E}=o.getAnchorAlignment(d),k=-(w-.5)*i,F=-(E-.5)*h,R=o.evaluateVariableOffset(d,_);return new o.pointGeometry(k+R[0]*v,F+R[1]*v)}function Do(d,i,h,_,v){const w=new o.pointGeometry(d,i);return h&&w._rotate(_?v:-v),w}class S_{constructor(i,h,_,v,w){this.transform=i.clone(),this.collisionIndex=new jc(this.transform,w),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new da(_),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,h,_,v){const w=_.getBucket(h),E=_.latestFeatureIndex;if(!w||!E||h.id!==w.layerIds[0])return;const k=w.layers[0].layout,F=_.collisionBoxArray,R=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),O=_.tileSize/o.EXTENT,W=_.tileID.toUnwrapped(),te=this.transform.calculateProjMatrix(W),oe=k.get("text-pitch-alignment")==="map",ie=k.get("text-rotation-alignment")==="map";h.compileFilter();const Q=h.dynamicFilter(),ye=h.dynamicFilterNeedsFeature(),he=this.transform.calculatePixelsToTileUnitsMatrix(_),_e=Si(te,_.tileID.canonical,oe,ie,this.transform,he);let xe=null;if(oe){const Se=ii(te,_.tileID.canonical,oe,ie,this.transform,he);xe=o.multiply$1([],this.transform.labelPlaneMatrix,Se)}let Te=null;Q&&_.latestFeatureIndex&&(Te={unwrappedTileID:W,dynamicFilter:Q,dynamicFilterNeedsFeature:ye,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[w.bucketInstanceId]=new kh(w.bucketInstanceId,E,w.sourceLayerIndex,w.index,_.tileID);const pe={bucket:w,layout:k,posMatrix:te,textLabelPlaneMatrix:_e,labelToScreenMatrix:xe,clippingData:Te,scale:R,textPixelRatio:O,holdingForFade:_.holdingForFade(),collisionBoxArray:F,partiallyEvaluatedTextSize:o.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:o.evaluateSizeForZoom(w.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(v)for(const Se of w.sortKeyRanges){const{sortKey:je,symbolInstanceStart:Ye,symbolInstanceEnd:tt}=Se;i.push({sortKey:je,symbolInstanceStart:Ye,symbolInstanceEnd:tt,parameters:pe})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:pe})}attemptAnchorPlacement(i,h,_,v,w,E,k,F,R,O,W,te,oe,ie,Q,ye,he,_e){const xe=[te.textOffset0,te.textOffset1],Te=Mo(i,_,v,xe,w),pe=this.collisionIndex.placeCollisionBox(w,h,Do(Te.x,Te.y,E,k,this.transform.angle),W,F,R,O.predicate);if((!ye||this.collisionIndex.placeCollisionBox(ie.getSymbolInstanceIconSize(_e,this.transform.zoom,oe),ye,Do(Te.x,Te.y,E,k,this.transform.angle),W,F,R,O.predicate).box.length!==0)&&pe.box.length>0){let Se;return this.prevPlacement&&this.prevPlacement.variableOffsets[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID]&&this.prevPlacement.placements[te.crossTileID].text&&(Se=this.prevPlacement.variableOffsets[te.crossTileID].anchor),this.variableOffsets[te.crossTileID]={textOffset:xe,width:_,height:v,anchor:i,textScale:w,prevAnchor:Se},this.markUsedJustification(ie,i,te,Q),ie.allowVerticalPlacement&&(this.markUsedOrientation(ie,Q,te),this.placedOrientations[te.crossTileID]=Q),{shift:Te,placedGlyphBoxes:pe}}}placeLayerBucketPart(i,h,_,v){const{bucket:w,layout:E,posMatrix:k,textLabelPlaneMatrix:F,labelToScreenMatrix:R,clippingData:O,textPixelRatio:W,holdingForFade:te,collisionBoxArray:oe,partiallyEvaluatedTextSize:ie,partiallyEvaluatedIconSize:Q,collisionGroup:ye}=i.parameters,he=E.get("text-optional"),_e=E.get("icon-optional"),xe=E.get("text-allow-overlap"),Te=E.get("icon-allow-overlap"),pe=E.get("text-rotation-alignment")==="map",Se=E.get("text-pitch-alignment")==="map",je=E.get("icon-text-fit")!=="none",Ye=E.get("symbol-z-order")==="viewport-y";let tt=xe&&(Te||!w.hasIconData()||_e),Qe=Te&&(xe||!w.hasTextData()||he);!w.collisionArrays&&oe&&w.deserializeCollisionBoxes(oe),_&&v&&w.updateCollisionDebugBuffers(this.transform.zoom,oe);const mt=(Ge,_t,ht)=>{if(O){const $r={zoom:this.transform.zoom,pitch:this.transform.pitch};let qr=null;if(O.dynamicFilterNeedsFeature){const mr=this.retainedQueryData[w.bucketInstanceId];qr=O.featureIndex.loadFeature({featureIndex:Ge.featureIndex,bucketIndex:mr.bucketIndex,sourceLayerIndex:mr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)($r,qr,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new o.pointGeometry(Ge.tileAnchorX,Ge.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[Ge.crossTileID]=new qa(!1,!1,!1,!0),void(h[Ge.crossTileID]=!0)}if(h[Ge.crossTileID])return;if(te)return void(this.placements[Ge.crossTileID]=new qa(!1,!1,!1));let Rt=!1,rt=!1,Ft=!0,$t=!1,Pt=!1,Lt=null,Ht={box:null,offscreen:null,occluded:null},er={box:null,offscreen:null,occluded:null},jt=null,qt=null,fr=null,jr=0,$n=0,Wn=0;ht.textFeatureIndex?jr=ht.textFeatureIndex:Ge.useRuntimeCollisionCircles&&(jr=Ge.featureIndex),ht.verticalTextFeatureIndex&&($n=ht.verticalTextFeatureIndex);const Di=$r=>{$r.tileID=this.retainedQueryData[w.bucketInstanceId].tileID,(this.transform.elevation||$r.elevation)&&($r.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[w.bucketInstanceId].tileID,$r.tileAnchorX,$r.tileAnchorY):0)},ma=ht.textBox;if(ma){Di(ma);const $r=mr=>{let sn=o.WritingMode.horizontal;if(w.allowVerticalPlacement&&!mr&&this.prevPlacement){const Fi=this.prevPlacement.placedOrientations[Ge.crossTileID];Fi&&(this.placedOrientations[Ge.crossTileID]=Fi,sn=Fi,this.markUsedOrientation(w,sn,Ge))}return sn},qr=(mr,sn)=>{if(w.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&ht.verticalTextBox){for(const Fi of w.writingModes)if(Fi===o.WritingMode.vertical?(Ht=sn(),er=Ht):Ht=mr(),Ht&&Ht.box&&Ht.box.length)break}else Ht=mr()};if(E.get("text-variable-anchor")){let mr=E.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ge.crossTileID]){const Gr=this.prevPlacement.variableOffsets[Ge.crossTileID];mr.indexOf(Gr.anchor)>0&&(mr=mr.filter(qi=>qi!==Gr.anchor),mr.unshift(Gr.anchor))}const sn=(Gr,qi,rc)=>{const Pi=w.getSymbolInstanceTextSize(ie,Ge,this.transform.zoom,_t),ro=(Gr.x2-Gr.x1)*Pi+2*Gr.padding,Jp=(Gr.y2-Gr.y1)*Pi+2*Gr.padding,uf=je&&!Te?qi:null;uf&&Di(uf);let jo={box:[],offscreen:!1,occluded:!1};const j_=xe?2*mr.length:mr.length;for(let As=0;As<j_;++As){const hf=this.attemptAnchorPlacement(mr[As%mr.length],Gr,ro,Jp,Pi,pe,Se,W,k,ye,As>=mr.length,Ge,_t,w,rc,uf,ie,Q);if(hf&&(jo=hf.placedGlyphBoxes,jo&&jo.box&&jo.box.length)){Rt=!0,Lt=hf.shift;break}}return jo};qr(()=>sn(ma,ht.iconBox,o.WritingMode.horizontal),()=>{const Gr=ht.verticalTextBox;return Gr&&Di(Gr),w.allowVerticalPlacement&&!(Ht&&Ht.box&&Ht.box.length)&&Ge.numVerticalGlyphVertices>0&&Gr?sn(Gr,ht.verticalIconBox,o.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),Ht&&(Rt=Ht.box,Ft=Ht.offscreen,$t=Ht.occluded);const Fi=$r(Ht&&Ht.box);if(!Rt&&this.prevPlacement){const Gr=this.prevPlacement.variableOffsets[Ge.crossTileID];Gr&&(this.variableOffsets[Ge.crossTileID]=Gr,this.markUsedJustification(w,Gr.anchor,Ge,Fi))}}else{const mr=(sn,Fi)=>{const Gr=w.getSymbolInstanceTextSize(ie,Ge,this.transform.zoom,_t),qi=this.collisionIndex.placeCollisionBox(Gr,sn,new o.pointGeometry(0,0),xe,W,k,ye.predicate);return qi&&qi.box&&qi.box.length&&(this.markUsedOrientation(w,Fi,Ge),this.placedOrientations[Ge.crossTileID]=Fi),qi};qr(()=>mr(ma,o.WritingMode.horizontal),()=>{const sn=ht.verticalTextBox;return w.allowVerticalPlacement&&Ge.numVerticalGlyphVertices>0&&sn?(Di(sn),mr(sn,o.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),$r(Ht&&Ht.box&&Ht.box.length)}}if(jt=Ht,Rt=jt&&jt.box&&jt.box.length>0,Ft=jt&&jt.offscreen,$t=jt&&jt.occluded,Ge.useRuntimeCollisionCircles){const $r=w.text.placedSymbolArray.get(Ge.centerJustifiedTextSymbolIndex>=0?Ge.centerJustifiedTextSymbolIndex:Ge.verticalPlacedTextSymbolIndex),qr=o.evaluateSizeForFeature(w.textSizeData,ie,$r),mr=E.get("text-padding");qt=this.collisionIndex.placeCollisionCircles(xe,$r,w.lineVertexArray,w.glyphOffsetArray,qr,k,F,R,_,Se,ye.predicate,Ge.collisionCircleDiameter*qr/o.ONE_EM,mr,this.retainedQueryData[w.bucketInstanceId].tileID),Rt=xe||qt.circles.length>0&&!qt.collisionDetected,Ft=Ft&&qt.offscreen,$t=qt.occluded}if(ht.iconFeatureIndex&&(Wn=ht.iconFeatureIndex),ht.iconBox){const $r=qr=>{Di(qr);const mr=je&&Lt?Do(Lt.x,Lt.y,pe,Se,this.transform.angle):new o.pointGeometry(0,0),sn=w.getSymbolInstanceIconSize(Q,this.transform.zoom,_t);return this.collisionIndex.placeCollisionBox(sn,qr,mr,Te,W,k,ye.predicate)};er&&er.box&&er.box.length&&ht.verticalIconBox?(fr=$r(ht.verticalIconBox),rt=fr.box.length>0):(fr=$r(ht.iconBox),rt=fr.box.length>0),Ft=Ft&&fr.offscreen,Pt=fr.occluded}const Qa=he||Ge.numHorizontalGlyphVertices===0&&Ge.numVerticalGlyphVertices===0,ks=_e||Ge.numIconVertices===0;if(Qa||ks?ks?Qa||(rt=rt&&Rt):Rt=rt&&Rt:rt=Rt=rt&&Rt,Rt&&jt&&jt.box&&this.collisionIndex.insertCollisionBox(jt.box,E.get("text-ignore-placement"),w.bucketInstanceId,er&&er.box&&$n?$n:jr,ye.ID),rt&&fr&&this.collisionIndex.insertCollisionBox(fr.box,E.get("icon-ignore-placement"),w.bucketInstanceId,Wn,ye.ID),qt&&(Rt&&this.collisionIndex.insertCollisionCircles(qt.circles,E.get("text-ignore-placement"),w.bucketInstanceId,jr,ye.ID),_)){const $r=w.bucketInstanceId;let qr=this.collisionCircleArrays[$r];qr===void 0&&(qr=this.collisionCircleArrays[$r]=new Bn);for(let mr=0;mr<qt.circles.length;mr+=4)qr.circles.push(qt.circles[mr+0]),qr.circles.push(qt.circles[mr+1]),qr.circles.push(qt.circles[mr+2]),qr.circles.push(qt.collisionDetected?1:0)}const es=this.transform.projection.name!=="globe";tt=tt&&(es||!$t),Qe=Qe&&(es||!Pt),this.placements[Ge.crossTileID]=new qa(Rt||tt,rt||Qe,Ft||w.justReloaded),h[Ge.crossTileID]=!0};if(Ye){const Ge=w.getSortedSymbolIndexes(this.transform.angle);for(let _t=Ge.length-1;_t>=0;--_t){const ht=Ge[_t];mt(w.symbolInstances.get(ht),ht,w.collisionArrays[ht])}}else for(let Ge=i.symbolInstanceStart;Ge<i.symbolInstanceEnd;Ge++)mt(w.symbolInstances.get(Ge),Ge,w.collisionArrays[Ge]);if(_&&w.bucketInstanceId in this.collisionCircleArrays){const Ge=this.collisionCircleArrays[w.bucketInstanceId];o.invert(Ge.invProjMatrix,k),Ge.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(i,h,_,v){let w;w=v===o.WritingMode.vertical?_.verticalPlacedTextSymbolIndex:{left:_.leftJustifiedTextSymbolIndex,center:_.centerJustifiedTextSymbolIndex,right:_.rightJustifiedTextSymbolIndex}[o.getAnchorJustification(h)];const E=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex,_.verticalPlacedTextSymbolIndex];for(const k of E)k>=0&&(i.text.placedSymbolArray.get(k).crossTileID=w>=0&&k!==w?0:_.crossTileID)}markUsedOrientation(i,h,_){const v=h===o.WritingMode.horizontal||h===o.WritingMode.horizontalOnly?h:0,w=h===o.WritingMode.vertical?h:0,E=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex];for(const k of E)i.text.placedSymbolArray.get(k).placedOrientation=v;_.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(_.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let _=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(i):1,w=h?h.opacities:{},E=h?h.variableOffsets:{},k=h?h.placedOrientations:{};for(const F in this.placements){const R=this.placements[F],O=w[F];O?(this.opacities[F]=new Xa(O,v,R.text,R.icon,null,R.clipped),_=_||R.text!==O.text.placed||R.icon!==O.icon.placed):(this.opacities[F]=new Xa(null,v,R.text,R.icon,R.skipFade,R.clipped),_=_||R.text||R.icon)}for(const F in w){const R=w[F];if(!this.opacities[F]){const O=new Xa(R,v,!1,!1);O.isHidden()||(this.opacities[F]=O,_=_||R.text.placed||R.icon.placed)}}for(const F in E)this.variableOffsets[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.variableOffsets[F]=E[F]);for(const F in k)this.placedOrientations[F]||!this.opacities[F]||this.opacities[F].isHidden()||(this.placedOrientations[F]=k[F]);_?this.lastPlacementChangeTime=i:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:i)}updateLayerOpacities(i,h){const _={};for(const v of h){const w=v.getBucket(i);w&&v.latestFeatureIndex&&i.id===w.layerIds[0]&&this.updateBucketOpacities(w,_,v.collisionBoxArray)}}updateBucketOpacities(i,h,_){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const v=i.layers[0].layout,w=!!i.layers[0].dynamicFilter(),E=new Xa(null,0,!1,!1,!0),k=v.get("text-allow-overlap"),F=v.get("icon-allow-overlap"),R=v.get("text-variable-anchor"),O=v.get("text-rotation-alignment")==="map",W=v.get("text-pitch-alignment")==="map",te=v.get("icon-text-fit")!=="none",oe=new Xa(null,0,k&&(F||!i.hasIconData()||v.get("icon-optional")),F&&(k||!i.hasTextData()||v.get("text-optional")),!0);!i.collisionArrays&&_&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(_);const ie=(ye,he,_e)=>{for(let xe=0;xe<he/4;xe++)ye.opacityVertexArray.emplaceBack(_e)};let Q=0;for(let ye=0;ye<i.symbolInstances.length;ye++){const he=i.symbolInstances.get(ye),{numHorizontalGlyphVertices:_e,numVerticalGlyphVertices:xe,crossTileID:Te}=he;let pe=this.opacities[Te];h[Te]?pe=E:pe||(pe=oe,this.opacities[Te]=pe),h[Te]=!0;const Se=_e>0||xe>0,je=he.numIconVertices>0,Ye=this.placedOrientations[he.crossTileID],tt=Ye===o.WritingMode.vertical,Qe=Ye===o.WritingMode.horizontal||Ye===o.WritingMode.horizontalOnly;if(!Se&&!je||pe.isHidden()||Q++,Se){const mt=op(pe.text);ie(i.text,_e,tt?Wc:mt),ie(i.text,xe,Qe?Wc:mt);const Ge=pe.text.isHidden();[he.rightJustifiedTextSymbolIndex,he.centerJustifiedTextSymbolIndex,he.leftJustifiedTextSymbolIndex].forEach(Rt=>{Rt>=0&&(i.text.placedSymbolArray.get(Rt).hidden=Ge||tt?1:0)}),he.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(he.verticalPlacedTextSymbolIndex).hidden=Ge||Qe?1:0);const _t=this.variableOffsets[he.crossTileID];_t&&this.markUsedJustification(i,_t.anchor,he,Ye);const ht=this.placedOrientations[he.crossTileID];ht&&(this.markUsedJustification(i,"left",he,ht),this.markUsedOrientation(i,ht,he))}if(je){const mt=op(pe.icon);he.placedIconSymbolIndex>=0&&(ie(i.icon,he.numIconVertices,tt?Wc:mt),i.icon.placedSymbolArray.get(he.placedIconSymbolIndex).hidden=pe.icon.isHidden()),he.verticalPlacedIconSymbolIndex>=0&&(ie(i.icon,he.numVerticalIconVertices,Qe?Wc:mt),i.icon.placedSymbolArray.get(he.verticalPlacedIconSymbolIndex).hidden=pe.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const mt=i.collisionArrays[ye];if(mt){let Ge=new o.pointGeometry(0,0),_t=!0;if(mt.textBox||mt.verticalTextBox){if(R){const Rt=this.variableOffsets[Te];Rt?(Ge=Mo(Rt.anchor,Rt.width,Rt.height,Rt.textOffset,Rt.textScale),O&&Ge._rotate(W?this.transform.angle:-this.transform.angle)):_t=!1}w&&(_t=!pe.clipped),mt.textBox&&pa(i.textCollisionBox.collisionVertexArray,pe.text.placed,!_t||tt,Ge.x,Ge.y),mt.verticalTextBox&&pa(i.textCollisionBox.collisionVertexArray,pe.text.placed,!_t||Qe,Ge.x,Ge.y)}const ht=_t&&Boolean(!Qe&&mt.verticalIconBox);mt.iconBox&&pa(i.iconCollisionBox.collisionVertexArray,pe.icon.placed,ht,te?Ge.x:0,te?Ge.y:0),mt.verticalIconBox&&pa(i.iconCollisionBox.collisionVertexArray,pe.icon.placed,!ht,te?Ge.x:0,te?Ge.y:0)}}}if(i.fullyClipped=Q===0,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const ye=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=ye.invProjMatrix,i.placementViewportMatrix=ye.viewportMatrix,i.collisionCircleArray=ye.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return this.fadeDuration===0?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,h){const _=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*_>i}setStale(){this.stale=!0}}function pa(d,i,h,_,v){d.emplaceBack(i?1:0,h?1:0,_||0,v||0),d.emplaceBack(i?1:0,h?1:0,_||0,v||0),d.emplaceBack(i?1:0,h?1:0,_||0,v||0),d.emplaceBack(i?1:0,h?1:0,_||0,v||0)}const k_=Math.pow(2,25),sp=Math.pow(2,24),Ai=Math.pow(2,17),Gc=Math.pow(2,16),gs=Math.pow(2,9),Ah=Math.pow(2,8),$c=Math.pow(2,1);function op(d){if(d.opacity===0&&!d.placed)return 0;if(d.opacity===1&&d.placed)return 4294967295;const i=d.placed?1:0,h=Math.floor(127*d.opacity);return h*k_+i*sp+h*Ai+i*Gc+h*gs+i*Ah+h*$c+i}const Wc=0;class Ch{constructor(i){this._sortAcrossTiles=i.layout.get("symbol-z-order")!=="viewport-y"&&i.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,h,_,v,w){const E=this._bucketParts;for(;this._currentTileIndex<i.length;)if(h.getBucketParts(E,v,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,E.sort((k,F)=>k.sortKey-F.sortKey));this._currentPartIndex<E.length;){const k=E[this._currentPartIndex];if(h.placeLayerBucketPart(k,this._seenCrossTileIDs,_,k.symbolInstanceStart===0),this._currentPartIndex++,w())return!0}return!1}}class A_{constructor(i,h,_,v,w,E,k,F){this.placement=new S_(i,w,E,k,F),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(i,h,_){const v=o.exported.now(),w=()=>{const E=o.exported.now()-v;return!this._forceFullPlacement&&E>2};for(;this._currentPlacementIndex>=0;){const E=h[i[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(E.type==="symbol"&&(!E.minzoom||E.minzoom<=k)&&(!E.maxzoom||E.maxzoom>k)){if(this._inProgressLayer||(this._inProgressLayer=new Ch(E)),this._inProgressLayer.continuePlacement(_[E.source],this.placement,this._showCollisionBoxes,E,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const lp=512/o.EXTENT/2;class C_{constructor(i,h,_){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(let v=0;v<h.length;v++){const w=h.get(v),E=w.key;this.indexedSymbolInstances[E]||(this.indexedSymbolInstances[E]=[]),this.indexedSymbolInstances[E].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,i)})}}getScaledCoordinates(i,h){const _=lp/Math.pow(2,h.canonical.z-this.tileID.canonical.z);return{x:Math.floor((h.canonical.x*o.EXTENT+i.tileAnchorX)*_),y:Math.floor((h.canonical.y*o.EXTENT+i.tileAnchorY)*_)}}findMatches(i,h,_){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z);for(let w=0;w<i.length;w++){const E=i.get(w);if(E.crossTileID)continue;const k=this.indexedSymbolInstances[E.key];if(!k)continue;const F=this.getScaledCoordinates(E,h);for(const R of k)if(Math.abs(R.coord.x-F.x)<=v&&Math.abs(R.coord.y-F.y)<=v&&!_[R.crossTileID]){_[R.crossTileID]=!0,E.crossTileID=R.crossTileID;break}}}}class cp{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class I_{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const h=Math.round((i-this.lng)/360);if(h!==0)for(const _ in this.indexes){const v=this.indexes[_],w={};for(const E in v){const k=v[E];k.tileID=k.tileID.unwrapTo(k.tileID.wrap+h),w[k.tileID.key]=k}this.indexes[_]=w}this.lng=i}addBucket(i,h,_){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let w=0;w<h.symbolInstances.length;w++)h.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const v=this.usedCrossTileIDs[i.overscaledZ];for(const w in this.indexes){const E=this.indexes[w];if(Number(w)>i.overscaledZ)for(const k in E){const F=E[k];F.tileID.isChildOf(i)&&F.findMatches(h.symbolInstances,i,v)}else{const k=E[i.scaledTo(Number(w)).key];k&&k.findMatches(h.symbolInstances,i,v)}}for(let w=0;w<h.symbolInstances.length;w++){const E=h.symbolInstances.get(w);E.crossTileID||(E.crossTileID=_.generate(),v[E.crossTileID]=!0)}return this.indexes[i.overscaledZ]===void 0&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new C_(i,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(i,h){for(const _ in h.indexedSymbolInstances)for(const v of h.indexedSymbolInstances[_])delete this.usedCrossTileIDs[i][v.crossTileID]}removeStaleBuckets(i){let h=!1;for(const _ in this.indexes){const v=this.indexes[_];for(const w in v)i[v[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,v[w]),delete v[w],h=!0)}return h}}class Zc{constructor(){this.layerIndexes={},this.crossTileIDs=new cp,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,h,_,v){let w=this.layerIndexes[i.id];w===void 0&&(w=this.layerIndexes[i.id]=new I_);let E=!1;const k={};v.name!=="globe"&&w.handleWrapJump(_);for(const F of h){const R=F.getBucket(i);R&&i.id===R.layerIds[0]&&(R.bucketInstanceId||(R.bucketInstanceId=++this.maxBucketInstanceId),w.addBucket(F.tileID,R,this.crossTileIDs)&&(E=!0),k[R.bucketInstanceId]=!0)}return w.removeStaleBuckets(k)&&(E=!0),E}pruneUnusedLayers(i){const h={};i.forEach(_=>{h[_]=!0});for(const _ in this.layerIndexes)h[_]||delete this.layerIndexes[_]}}const Dl=(d,i)=>o.emitValidationErrors(d,i&&i.filter(h=>h.identifier!=="source.canvas")),up=o.pick(qe,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),hp=o.pick(qe,["setCenter","setZoom","setBearing","setPitch"]),fp={version:8,layers:[],sources:{}},Ks={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ai extends o.Evented{constructor(i,h={}){super(),this.map=i,this.dispatcher=new He(Fe(),this),this.imageManager=new $e,this.imageManager.setEventedParent(this),this.glyphManager=new o.GlyphManager(i._requestManager,h.localFontFamily?o.LocalGlyphMode.all:h.localIdeographFontFamily?o.LocalGlyphMode.ideographs:o.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.lineAtlas=new o.LineAtlas(256,512),this.crossTileSymbolIndex=new Zc,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new o.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",o.getReferrer());const _=this;this._rtlTextPluginCallback=ai.registerForPluginStateChange(v=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(w,E)=>{if(o.triggerPluginCompletionEvent(w),E&&E.every(k=>k))for(const k in _._sourceCaches){const F=_._sourceCaches[k],R=F.getSource().type;R!=="vector"&&R!=="geojson"||F.reload()}})}),this.on("data",v=>{if(v.dataType!=="source"||v.sourceDataType!=="metadata")return;const w=this.getSource(v.sourceId);if(w&&w.vectorLayerIds)for(const E in this._layers){const k=this._layers[E];k.source===w.id&&this._validateLayer(k)}})}loadURL(i,h={}){this.fire(new o.Event("dataloading",{dataType:"style"}));const _=typeof h.validate=="boolean"?h.validate:!o.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,h.accessToken);const v=this.map._requestManager.transformRequest(i,o.ResourceType.Style);this._request=o.getJSON(v,(w,E)=>{this._request=null,w?this.fire(new o.ErrorEvent(w)):E&&this._load(E,_)})}loadJSON(i,h={}){this.fire(new o.Event("dataloading",{dataType:"style"})),this._request=o.exported.frame(()=>{this._request=null,this._load(i,h.validate!==!1)})}loadEmpty(){this.fire(new o.Event("dataloading",{dataType:"style"})),this._load(fp,!1)}_updateLayerCount(i,h){const _=h?1:-1;i.is3D()&&(this._num3DLayers+=_),i.type==="circle"&&(this._numCircleLayers+=_),i.type==="symbol"&&(this._numSymbolLayers+=_)}_load(i,h){if(h&&Dl(this,o.validateStyle(i)))return;this._loaded=!0,this.stylesheet=i,this._updateMapProjection();for(const v in i.sources)this.addSource(v,i.sources[v],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const _=Ze(this.stylesheet.layers);this._order=_.map(v=>v.id),this._layers={},this._serializedLayers={};for(let v of _)v=o.createStyleLayer(v),v.setEventedParent(this,{layer:{id:v.id}}),this._layers[v.id]=v,this._serializedLayers[v.id]=v.serialize(),this._updateLayerCount(v,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ut(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new o.Event("data",{dataType:"style"})),this.fire(new o.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this.map._explicitProjection||this.map._updateProjection()}_updateMapProjection(){this.map._explicitProjection?this.applyProjectionUpdate():this.map._updateProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_loadSprite(i){this._spriteRequest=function(h,_,v){let w,E,k;const F=o.exported.devicePixelRatio>1?"@2x":"";let R=o.getJSON(_.transformRequest(_.normalizeSpriteURL(h,F,".json"),o.ResourceType.SpriteJSON),(te,oe)=>{R=null,k||(k=te,w=oe,W())}),O=o.getImage(_.transformRequest(_.normalizeSpriteURL(h,F,".png"),o.ResourceType.SpriteImage),(te,oe)=>{O=null,k||(k=te,E=oe,W())});function W(){if(k)v(k);else if(w&&E){const te=o.exported.getImageData(E),oe={};for(const ie in w){const{width:Q,height:ye,x:he,y:_e,sdf:xe,pixelRatio:Te,stretchX:pe,stretchY:Se,content:je}=w[ie],Ye=new o.RGBAImage({width:Q,height:ye});o.RGBAImage.copy(te,Ye,{x:he,y:_e},{x:0,y:0},{width:Q,height:ye}),oe[ie]={data:Ye,pixelRatio:Te,sdf:xe,stretchX:pe,stretchY:Se,content:je}}v(null,oe)}}return{cancel(){R&&(R.cancel(),R=null),O&&(O.cancel(),O=null)}}}(i,this.map._requestManager,(h,_)=>{if(this._spriteRequest=null,h)this.fire(new o.ErrorEvent(h));else if(_)for(const v in _)this.imageManager.addImage(v,_[v]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new o.Event("data",{dataType:"style"}))})}_validateLayer(i){const h=this.getSource(i.source);if(!h)return;const _=i.sourceLayer;_&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(_)===-1)&&this.fire(new o.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${h.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const h=[];for(const _ of i){const v=this._layers[_];v.type!=="custom"&&h.push(v.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&Ks[i.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const h=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(v.length||w.length)&&this._updateWorkerLayers(v,w);for(const E in this._updatedSources){const k=this._updatedSources[E];k==="reload"?this._reloadSource(E):k==="clear"&&this._clearSource(E)}this._updateTilesForChangedImages();for(const E in this._updatedPaintProps)this._layers[E].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const _={};for(const v in this._sourceCaches){const w=this._sourceCaches[v];_[v]=w.used,w.used=!1}for(const v of this._order){const w=this._layers[v];if(w.recalculate(i,this._availableImages),!w.isHidden(i.zoom)){const k=this._getLayerSourceCache(w);k&&(k.used=!0)}const E=this.map.painter;if(E){const k=w.getProgramIds();if(!k)continue;const F=w.getProgramConfiguration(i.zoom);for(const R of k)E.useProgram(R,F)}}for(const v in _){const w=this._sourceCaches[v];_[v]!==w.used&&w.getSource().fire(new o.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new o.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Dl(this,o.validateStyle(i)))return!1;(i=o.clone$1(i)).layers=Ze(i.layers);const h=function(v,w){if(!v)return[{command:qe.setStyle,args:[w]}];let E=[];try{if(!D(v.version,w.version))return[{command:qe.setStyle,args:[w]}];D(v.center,w.center)||E.push({command:qe.setCenter,args:[w.center]}),D(v.zoom,w.zoom)||E.push({command:qe.setZoom,args:[w.zoom]}),D(v.bearing,w.bearing)||E.push({command:qe.setBearing,args:[w.bearing]}),D(v.pitch,w.pitch)||E.push({command:qe.setPitch,args:[w.pitch]}),D(v.sprite,w.sprite)||E.push({command:qe.setSprite,args:[w.sprite]}),D(v.glyphs,w.glyphs)||E.push({command:qe.setGlyphs,args:[w.glyphs]}),D(v.transition,w.transition)||E.push({command:qe.setTransition,args:[w.transition]}),D(v.light,w.light)||E.push({command:qe.setLight,args:[w.light]}),D(v.fog,w.fog)||E.push({command:qe.setFog,args:[w.fog]}),D(v.projection,w.projection)||E.push({command:qe.setProjection,args:[w.projection]});const k={},F=[];(function(W,te,oe,ie){let Q;for(Q in te=te||{},W=W||{})W.hasOwnProperty(Q)&&(te.hasOwnProperty(Q)||pt(Q,oe,ie));for(Q in te)te.hasOwnProperty(Q)&&(W.hasOwnProperty(Q)?D(W[Q],te[Q])||(W[Q].type==="geojson"&&te[Q].type==="geojson"&&Mt(W,te,Q)?oe.push({command:qe.setGeoJSONSourceData,args:[Q,te[Q].data]}):wt(Q,te,oe,ie)):lt(Q,te,oe))})(v.sources,w.sources,F,k);const R=[];v.layers&&v.layers.forEach(W=>{W.source&&k[W.source]?E.push({command:qe.removeLayer,args:[W.id]}):R.push(W)});let O=v.terrain;O&&k[O.source]&&(E.push({command:qe.setTerrain,args:[void 0]}),O=void 0),E=E.concat(F),D(O,w.terrain)||E.push({command:qe.setTerrain,args:[w.terrain]}),function(W,te,oe){te=te||[];const ie=(W=W||[]).map(Zt),Q=te.map(Zt),ye=W.reduce(Gt,{}),he=te.reduce(Gt,{}),_e=ie.slice(),xe=Object.create(null);let Te,pe,Se,je,Ye,tt,Qe;for(Te=0,pe=0;Te<ie.length;Te++)Se=ie[Te],he.hasOwnProperty(Se)?pe++:(oe.push({command:qe.removeLayer,args:[Se]}),_e.splice(_e.indexOf(Se,pe),1));for(Te=0,pe=0;Te<Q.length;Te++)Se=Q[Q.length-1-Te],_e[_e.length-1-Te]!==Se&&(ye.hasOwnProperty(Se)?(oe.push({command:qe.removeLayer,args:[Se]}),_e.splice(_e.lastIndexOf(Se,_e.length-pe),1)):pe++,tt=_e[_e.length-Te],oe.push({command:qe.addLayer,args:[he[Se],tt]}),_e.splice(_e.length-Te,0,Se),xe[Se]=!0);for(Te=0;Te<Q.length;Te++)if(Se=Q[Te],je=ye[Se],Ye=he[Se],!xe[Se]&&!D(je,Ye))if(D(je.source,Ye.source)&&D(je["source-layer"],Ye["source-layer"])&&D(je.type,Ye.type)){for(Qe in it(je.layout,Ye.layout,oe,Se,null,qe.setLayoutProperty),it(je.paint,Ye.paint,oe,Se,null,qe.setPaintProperty),D(je.filter,Ye.filter)||oe.push({command:qe.setFilter,args:[Se,Ye.filter]}),D(je.minzoom,Ye.minzoom)&&D(je.maxzoom,Ye.maxzoom)||oe.push({command:qe.setLayerZoomRange,args:[Se,Ye.minzoom,Ye.maxzoom]}),je)je.hasOwnProperty(Qe)&&Qe!=="layout"&&Qe!=="paint"&&Qe!=="filter"&&Qe!=="metadata"&&Qe!=="minzoom"&&Qe!=="maxzoom"&&(Qe.indexOf("paint.")===0?it(je[Qe],Ye[Qe],oe,Se,Qe.slice(6),qe.setPaintProperty):D(je[Qe],Ye[Qe])||oe.push({command:qe.setLayerProperty,args:[Se,Qe,Ye[Qe]]}));for(Qe in Ye)Ye.hasOwnProperty(Qe)&&!je.hasOwnProperty(Qe)&&Qe!=="layout"&&Qe!=="paint"&&Qe!=="filter"&&Qe!=="metadata"&&Qe!=="minzoom"&&Qe!=="maxzoom"&&(Qe.indexOf("paint.")===0?it(je[Qe],Ye[Qe],oe,Se,Qe.slice(6),qe.setPaintProperty):D(je[Qe],Ye[Qe])||oe.push({command:qe.setLayerProperty,args:[Se,Qe,Ye[Qe]]}))}else oe.push({command:qe.removeLayer,args:[Se]}),tt=_e[_e.lastIndexOf(Se)+1],oe.push({command:qe.addLayer,args:[Ye,tt]})}(R,w.layers,E)}catch(k){console.warn("Unable to compute style diff:",k),E=[{command:qe.setStyle,args:[w]}]}return E}(this.serialize(),i).filter(v=>!(v.command in hp));if(h.length===0)return!1;const _=h.filter(v=>!(v.command in up));if(_.length>0)throw new Error(`Unimplemented: ${_.map(v=>v.command).join(", ")}.`);return h.forEach(v=>{v.command!=="setTransition"&&this[v.command].apply(this,v.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(i,h){return this.getImage(i)?this.fire(new o.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,h),this._afterImageUpdated(i),this)}updateImage(i,h){this.imageManager.updateImage(i,h)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i),this._afterImageUpdated(i),this):this.fire(new o.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new o.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(i,h,_={}){if(this._checkLoaded(),this.getSource(i)!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(o.validateSource,`sources.${i}`,h,null,_))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=Ue(i,h,this.dispatcher,this);v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(i),source:v.serialize(),sourceId:i}));const w=E=>{const k=(E?"symbol:":"other:")+i,F=this._sourceCaches[k]=new o.SourceCache(k,v,E);(E?this._symbolSourceCaches:this._otherSourceCaches)[i]=F,F.style=this,F.onAdd(this.map)};w(!1),h.type!=="vector"&&h.type!=="geojson"||w(!0),v.onAdd&&v.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const h=this.getSource(i);if(!h)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===i)return this.fire(new o.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new o.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(i);for(const v of _)delete this._sourceCaches[v.id],delete this._updatedSources[v.id],v.fire(new o.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles();return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(i,h){this._checkLoaded(),this.getSource(i).setData(h),this._changed=!0}getSource(i){const h=this._getSourceCache(i);return h&&h.getSource()}addLayer(i,h,_={}){this._checkLoaded();const v=i.id;if(this.getLayer(v))return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${v}" already exists on this map`)));let w;if(i.type==="custom"){if(Dl(this,o.validateCustomStyleLayer(i)))return;w=o.createStyleLayer(i)}else{if(typeof i.source=="object"&&(this.addSource(v,i.source),i=o.clone$1(i),i=o.extend(i,{source:v})),this._validate(o.validateLayer,`layers.${v}`,i,{arrayIndex:-1},_))return;w=o.createStyleLayer(i),this._validateLayer(w),w.setEventedParent(this,{layer:{id:v}}),this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}const E=h?this._order.indexOf(h):this._order.length;if(h&&E===-1)return void this.fire(new o.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(E,0,v),this._layerOrderChanged=!0,this._layers[v]=w;const k=this._getLayerSourceCache(w);if(this._removedLayers[v]&&w.source&&k&&w.type!=="custom"){const F=this._removedLayers[v];delete this._removedLayers[v],F.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",k.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,h){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new o.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===h)return;const _=this._order.indexOf(i);this._order.splice(_,1);const v=h?this._order.indexOf(h):this._order.length;h&&v===-1?this.fire(new o.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(v,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const h=this._layers[i];if(!h)return void this.fire(new o.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const _=this._order.indexOf(i);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=h,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const h in this._layers)if(this._layers[h].type===i)return!0;return!1}setLayerZoomRange(i,h,_){this._checkLoaded();const v=this.getLayer(i);v?v.minzoom===h&&v.maxzoom===_||(h!=null&&(v.minzoom=h),_!=null&&(v.maxzoom=_),this._updateLayer(v)):this.fire(new o.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,h,_={}){this._checkLoaded();const v=this.getLayer(i);if(v){if(!D(v.filter,h))return h==null?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(o.validateFilter,`layers.${v.id}.filter`,h,{layerType:v.type},_)||(v.filter=o.clone$1(h),this._updateLayer(v)))}else this.fire(new o.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){const h=this.getLayer(i);return h&&o.clone$1(h.filter)}setLayoutProperty(i,h,_,v={}){this._checkLoaded();const w=this.getLayer(i);w?D(w.getLayoutProperty(h),_)||(w.setLayoutProperty(h,_,v),this._updateLayer(w)):this.fire(new o.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,h){const _=this.getLayer(i);if(_)return _.getLayoutProperty(h);this.fire(new o.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,h,_,v={}){this._checkLoaded();const w=this.getLayer(i);w?D(w.getPaintProperty(h),_)||(w.setPaintProperty(h,_,v)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new o.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,h){const _=this.getLayer(i);return _&&_.getPaintProperty(h)}setFeatureState(i,h){this._checkLoaded();const _=i.source,v=i.sourceLayer,w=this.getSource(_);if(!w)return void this.fire(new o.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const E=w.type;if(E==="geojson"&&v)return void this.fire(new o.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(E==="vector"&&!v)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));i.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided.")));const k=this._getSourceCaches(_);for(const F of k)F.setFeatureState(v,i.id,h)}removeFeatureState(i,h){this._checkLoaded();const _=i.source,v=this.getSource(_);if(!v)return void this.fire(new o.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const w=v.type,E=w==="vector"?i.sourceLayer:void 0;if(w==="vector"&&!E)return void this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof i.id!="string"&&typeof i.id!="number")return void this.fire(new o.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const k=this._getSourceCaches(_);for(const F of k)F.removeFeatureState(E,i.id,h)}getFeatureState(i){this._checkLoaded();const h=i.source,_=i.sourceLayer,v=this.getSource(h);if(v){if(v.type!=="vector"||_)return i.id===void 0&&this.fire(new o.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(_,i.id);this.fire(new o.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new o.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return o.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const h in this._sourceCaches){const _=this._sourceCaches[h].getSource();i[_.id]||(i[_.id]=_.serialize())}return o.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:i,layers:this._serializeLayers(this._order)},h=>h!==void 0)}_updateLayer(i){this._updatedLayers[i.id]=!0;const h=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&h&&h.getSource().type!=="raster"&&(this._updatedSources[i.source]="reload",h.pause()),this._changed=!0,i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const h=E=>this._layers[E].type==="fill-extrusion",_={},v=[];for(let E=this._order.length-1;E>=0;E--){const k=this._order[E];if(h(k)){_[k]=E;for(const F of i){const R=F[k];if(R)for(const O of R)v.push(O)}}}v.sort((E,k)=>k.intersectionZ-E.intersectionZ);const w=[];for(let E=this._order.length-1;E>=0;E--){const k=this._order[E];if(h(k))for(let F=v.length-1;F>=0;F--){const R=v[F].feature;if(_[R.layer.id]<E)break;w.push(R),v.pop()}else for(const F of i){const R=F[k];if(R)for(const O of R)w.push(O.feature)}}return w}queryRenderedFeatures(i,h,_){h&&h.filter&&this._validate(o.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new o.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const F of h.layers){const R=this._layers[F];if(!R)return this.fire(new o.ErrorEvent(new Error(`The layer '${F}' does not exist in the map's style and cannot be queried for features.`))),[];v[R.source]=!0}}const w=[];h.availableImages=this._availableImages;const E=h&&h.layers?h.layers.some(F=>{const R=this.getLayer(F);return R&&R.is3D()}):this.has3DLayers(),k=Oe.createFromScreenPoints(i,_);for(const F in this._sourceCaches){const R=this._sourceCaches[F].getSource().id;h.layers&&!v[R]||w.push(H(this._sourceCaches[F],this._layers,this._serializedLayers,k,h,_,E,!!this.map._showQueryGeometry))}return this.placement&&w.push(function(F,R,O,W,te,oe,ie){const Q={},ye=oe.queryRenderedSymbols(W),he=[];for(const _e of Object.keys(ye).map(Number))he.push(ie[_e]);he.sort(ne);for(const _e of he){const xe=_e.featureIndex.lookupSymbolFeatures(ye[_e.bucketInstanceId],R,_e.bucketIndex,_e.sourceLayerIndex,te.filter,te.layers,te.availableImages,F);for(const Te in xe){const pe=Q[Te]=Q[Te]||[],Se=xe[Te];Se.sort((je,Ye)=>{const tt=_e.featureSortOrder;if(tt){const Qe=tt.indexOf(je.featureIndex);return tt.indexOf(Ye.featureIndex)-Qe}return Ye.featureIndex-je.featureIndex});for(const je of Se)pe.push(je)}}for(const _e in Q)Q[_e].forEach(xe=>{const Te=xe.feature,pe=O(F[_e]).getFeatureState(Te.layer["source-layer"],Te.id);Te.source=Te.layer.source,Te.layer["source-layer"]&&(Te.sourceLayer=Te.layer["source-layer"]),Te.state=pe});return Q}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),k.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(i,h){h&&h.filter&&this._validate(o.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const _=this._getSourceCaches(i);let v=[];for(const w of _)v=v.concat(q(w,h));return v}addSourceType(i,h,_){return ai.getSourceType(i)?_(new Error(`A source type called "${i}" already exists.`)):(ai.setSourceType(i,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:h.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(i,h={}){this._checkLoaded();const _=this.light.getLight();let v=!1;for(const E in i)if(!D(i[E],_[E])){v=!0;break}if(!v)return;const w={now:o.exported.now(),transition:o.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,h),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,h=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(h===1){if(typeof i.source=="object"){const _="terrain-dem-src";this.addSource(_,i.source),i=o.clone$1(i),i=o.extend(i,{source:_})}if(this._validate(o.validateTerrain,"terrain",i))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode)this._createTerrain(i,h);else{const _=this.terrain,v=_.get();for(const w in i)if(!D(i[w],v[w])){_.set(i),this.stylesheet.terrain=i;const E={now:o.exported.now(),transition:o.extend({duration:0},this.stylesheet.transition)};_.updateTransitions(E);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const h=this.fog=new Ee(i,this.map.transform);this.stylesheet.fog=i;const _={now:o.exported.now(),transition:o.extend({duration:0},this.stylesheet.transition)};h.updateTransitions(_)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,_=h.get();for(const v in i)if(!D(i[v],_[v])){h.set(i),this.stylesheet.fog=i;const w={now:o.exported.now(),transition:o.extend({duration:0},this.stylesheet.transition)};h.updateTransitions(w);break}}else this._createFog(i);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(_=>this.isLayerDraped(this._layers[_])),h=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...h)}_createTerrain(i,h){const _=this.terrain=new zt(i,h);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const v={now:o.exported.now(),transition:o.extend({duration:0},this.stylesheet.transition)};_.updateTransitions(v)}_force3DLayerUpdate(){for(const i in this._layers){const h=this._layers[i];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const h=this._layers[i];h.type==="symbol"&&this._updateLayer(h)}}_validate(i,h,_,v,w={}){return(!w||w.validate!==!1)&&Dl(this,i.call(o.validateStyle,o.extend({key:h,style:this.serialize(),value:_,styleSpec:o.spec},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),o.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const h=this._getSourceCaches(i);for(const _ of h)_.clearTiles()}_reloadSource(i){const h=this._getSourceCaches(i);for(const _ of h)_.resume(),_.reload()}_updateSources(i){for(const h in this._sourceCaches)this._sourceCaches[h].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const h=this._sourceCaches[i];h.resume(),h.reload()}}_updatePlacement(i,h,_,v,w=!1){let E=!1,k=!1;const F={};for(const R of this._order){const O=this._layers[R];if(O.type!=="symbol")continue;if(!F[O.source]){const te=this._getLayerSourceCache(O);if(!te)continue;F[O.source]=te.getRenderableIds(!0).map(oe=>te.getTileByID(oe)).sort((oe,ie)=>ie.tileID.overscaledZ-oe.tileID.overscaledZ||(oe.tileID.isLessThan(ie.tileID)?-1:1))}const W=this.crossTileSymbolIndex.addLayer(O,F[O.source],i.center.lng,i.projection);E=E||W}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),w=w||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new o.Event("neworder")),(w||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(o.exported.now(),i.zoom))&&(this.pauseablePlacement=new A_(i,this._order,w,h,_,v,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,F),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(o.exported.now()),k=!0),E&&this.pauseablePlacement.placement.setStale()),k||E)for(const R of this._order){const O=this._layers[R];O.type==="symbol"&&this.placement.updateLayerOpacities(O,F[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(o.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,h,_){this.imageManager.getImages(h.icons,_),this._updateTilesForChangedImages();const v=w=>{w&&w.setDependencies(h.tileID.key,h.type,h.icons)};v(this._otherSourceCaches[h.source]),v(this._symbolSourceCaches[h.source])}getGlyphs(i,h,_){this.glyphManager.getGlyphs(h.stacks,_)}getResource(i,h,_){return o.makeRequest(h,_)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return i.type==="symbol"?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const h=[];return this._otherSourceCaches[i]&&h.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&h.push(this._symbolSourceCaches[i]),h}_isSourceCacheLoaded(i){const h=this._getSourceCaches(i);return h.length===0?(this.fire(new o.ErrorEvent(new Error(`There is no source with ID '${i}'`))),!1):h.every(_=>_.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ai.getSourceType=function(d){return Ve[d]},ai.setSourceType=function(d,i){Ve[d]=i},ai.registerForPluginStateChange=o.registerForPluginStateChange;var Fl=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}
#endif`,Pl="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Ys={},xs={};Ys=Wt("",`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {return currentElevation(apos);}
#endif
float unpack_depth(vec4 rgba_depth)
{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,!0),xs=Wt(`#ifdef FOG
uniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,`#ifdef FOG
uniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,!0);const Hc=Wt(`
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef TERRAIN
highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#endif`,`
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),Ll=Fl;var Rl={background:Wt(`uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Wt(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Wt(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
vec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);
#else 
mat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)
view_scale*=a_scale;
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;
#else
vec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Wt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wt(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);
#ifdef PROJECTION_GLOBE_VIEW
extrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
vec3 pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Wt(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Wt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Wt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Wt(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Wt(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Wt(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Wt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Wt(`varying vec4 v_color;void main() {vec4 color=v_color;
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);
#else
vec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Wt(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);
#else
vec3 p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Wt(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wt(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Wt(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
#ifdef RENDER_LINE_GRADIENT
vec4 out_color=texture2D(u_gradient_image,v_uv);
#else
vec4 out_color=color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#ifdef RENDER_LINE_GRADIENT
attribute vec3 a_packed;
#else
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;varying highp vec2 v_uv;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash_from
#pragma mapbox: define lowp vec4 dash_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash_from
#pragma mapbox: initialize lowp vec4 dash_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_GRADIENT
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);
#endif
#ifdef RENDER_LINE_DASH
float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Wt(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Wt(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Wt(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Wt(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Wt(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchor_z=a_z_tile_anchor.x;vec2 tile_anchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchor_z)+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;float globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
vec3 world_pos=vec3(a_pos,anchor_z)+h;float globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),anchor_z,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchor_z),mercator_pos,u_zoom_transition);
#else
vec3 proj_pos=vec3(a_projected_pos.xy,anchor_z);
#endif
#ifdef PROJECTED_POS_ON_VIEWPORT
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);
#else
vec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Wt(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef FOG
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
const float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=u_skirt_height*u_skirt_height*wireframeOffset;
#endif
vec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
}`),terrainDepth:Wt(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Wt(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pl),skyboxGradient:Wt(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Pl),skyboxCapture:Wt(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wt(`uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 merc_pos=a_merc_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idy=u_grid_matrix[1][2];float S=u_grid_matrix[2][2];vec3 latLng=u_grid_matrix*vec3(a_pos,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=a_pos[0]*S;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;uv=uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
vec4 globe=u_globe_matrix*vec4(globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}`),globeAtmosphere:Wt(`uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;varying highp vec3 v_ray_dir;void main() {highp vec3 dir=normalize(v_ray_dir);highp vec3 closest_point=abs(dot(u_globe_pos,dir))*dir;float norm_dist_from_center=length(closest_point-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 1.0)
discard;float t=clamp(1.0-sqrt(norm_dist_from_center-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}`,"attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;varying highp vec3 v_ray_dir;void main() {v_ray_dir=mix(mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);gl_Position=vec4(a_pos,1.0);}")};function Wt(d,i,h){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,v=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,w=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),E=d.match(v),k=i.match(v),F=Fl.match(v);let R=k?k.concat(E):E;h||(Ys.staticUniforms&&(R=Ys.staticUniforms.concat(R)),xs.staticUniforms&&(R=xs.staticUniforms.concat(R))),R&&(R=R.concat(F));const O={};return{fragmentSource:d=d.replace(_,(W,te,oe,ie,Q)=>(O[Q]=!0,te==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
varying ${oe} ${ie} ${Q};
#else
uniform ${oe} ${ie} u_${Q};
#endif
`:`
#ifdef HAS_UNIFORM_u_${Q}
    ${oe} ${ie} ${Q} = u_${Q};
#endif
`)),vertexSource:i=i.replace(_,(W,te,oe,ie,Q)=>{const ye=ie==="float"?"vec2":"vec4",he=Q.match(/color/)?"color":ye;return O[Q]?te==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
attribute ${oe} ${ye} a_${Q};
varying ${oe} ${ie} ${Q};
#else
uniform ${oe} ${ie} u_${Q};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${oe} ${ie} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${he}(a_${Q}, u_${Q}_t);
#else
    ${oe} ${ie} ${Q} = u_${Q};
#endif
`:te==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
attribute ${oe} ${ye} a_${Q};
#else
uniform ${oe} ${ie} u_${Q};
#endif
`:he==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${oe} ${ie} ${Q} = a_${Q};
#else
    ${oe} ${ie} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${oe} ${ie} ${Q} = unpack_mix_${he}(a_${Q}, u_${Q}_t);
#else
    ${oe} ${ie} ${Q} = u_${Q};
#endif
`}),staticAttributes:w,staticUniforms:R}}class Xc{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,h,_,v,w,E,k,F){this.context=i;let R=this.boundPaintVertexBuffers.length!==v.length;for(let O=0;!R&&O<v.length;O++)this.boundPaintVertexBuffers[O]!==v[O]&&(R=!0);i.extVertexArrayObject&&this.vao&&this.boundProgram===h&&this.boundLayoutVertexBuffer===_&&!R&&this.boundIndexBuffer===w&&this.boundVertexOffset===E&&this.boundDynamicVertexBuffer===k&&this.boundDynamicVertexBuffer2===F?(i.bindVertexArrayOES.set(this.vao),k&&k.bind(),w&&w.dynamicDraw&&w.bind(),F&&F.bind()):this.freshBind(h,_,v,w,E,k,F)}freshBind(i,h,_,v,w,E,k){let F;const R=i.numAttributes,O=this.context,W=O.gl;if(O.extVertexArrayObject)this.vao&&this.destroy(),this.vao=O.extVertexArrayObject.createVertexArrayOES(),O.bindVertexArrayOES.set(this.vao),F=0,this.boundProgram=i,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=v,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=E,this.boundDynamicVertexBuffer2=k;else{F=O.currentNumAttributes||0;for(let te=R;te<F;te++)W.disableVertexAttribArray(te)}h.enableAttributes(W,i);for(const te of _)te.enableAttributes(W,i);E&&E.enableAttributes(W,i),k&&k.enableAttributes(W,i),h.bind(),h.setVertexAttribPointers(W,i,w);for(const te of _)te.bind(),te.setVertexAttribPointers(W,i,w);E&&(E.bind(),E.setVertexAttribPointers(W,i,w)),v&&v.bind(),k&&(k.bind(),k.setVertexAttribPointers(W,i,w)),O.currentNumAttributes=R}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function dp(d,i){const h=Math.pow(2,i.canonical.z),_=i.canonical.y;return[new o.MercatorCoordinate(0,_/h).toLngLat().lat,new o.MercatorCoordinate(0,(_+1)/h).toLngLat().lat]}function pp(d,i,h,_,v,w,E){const k=d.context,F=k.gl,R=h.fbo;if(!R)return;d.prepareDrawTile();const O=d.useProgram("hillshade");k.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,R.colorAttachment.get());const W=((Q,ye,he,_e)=>{const xe=he.paint.get("hillshade-shadow-color"),Te=he.paint.get("hillshade-highlight-color"),pe=he.paint.get("hillshade-accent-color");let Se=he.paint.get("hillshade-illumination-direction")*(Math.PI/180);he.paint.get("hillshade-illumination-anchor")==="viewport"&&(Se-=Q.transform.angle);const je=!Q.options.moving;return{u_matrix:_e||Q.transform.calculateProjMatrix(ye.tileID.toUnwrapped(),je),u_image:0,u_latrange:dp(0,ye.tileID),u_light:[he.paint.get("hillshade-exaggeration"),Se],u_shadow:xe,u_highlight:Te,u_accent:pe}})(d,h,_,d.terrain?i.projMatrix:null);d.prepareDrawProgram(k,O,i.toUnwrapped());const{tileBoundsBuffer:te,tileBoundsIndexBuffer:oe,tileBoundsSegments:ie}=d.getTileBoundsBuffers(h);O.draw(k,F.TRIANGLES,v,w,E,o.CullFaceMode.disabled,W,_.id,te,oe,ie)}function Ih(d,i,h){if(!i.needsDEMTextureUpload)return;const _=d.context,v=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||d.getTileTexture(h.stride);const w=h.getPixels();i.demTexture?i.demTexture.update(w,{premultiply:!1}):i.demTexture=new o.Texture(_,w,v.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function Mh(d,i,h,_,v,w){const E=d.context,k=E.gl;if(!i.dem)return;const F=i.dem;if(E.activeTexture.set(k.TEXTURE1),Ih(d,i,F),!i.demTexture)return;i.demTexture.bind(k.NEAREST,k.CLAMP_TO_EDGE);const R=F.dim;E.activeTexture.set(k.TEXTURE0);let O=i.fbo;if(!O){const ie=new o.Texture(E,{width:R,height:R,data:null},k.RGBA);ie.bind(k.LINEAR,k.CLAMP_TO_EDGE),O=i.fbo=E.createFramebuffer(R,R,!0),O.colorAttachment.set(ie.texture)}E.bindFramebuffer.set(O.framebuffer),E.viewport.set([0,0,R,R]);const{tileBoundsBuffer:W,tileBoundsIndexBuffer:te,tileBoundsSegments:oe}=d.getMercatorTileBoundsBuffers();d.useProgram("hillshadePrepare").draw(E,k.TRIANGLES,_,v,w,o.CullFaceMode.disabled,((ie,Q)=>{const ye=Q.stride,he=o.create();return o.ortho(he,0,o.EXTENT,-o.EXTENT,0,0,1),o.translate(he,he,[0,-o.EXTENT,0]),{u_matrix:he,u_image:1,u_dimension:[ye,ye],u_zoom:ie.overscaledZ,u_unpack:Q.unpackVector}})(i.tileID,F),h.id,W,te,oe),i.needsHillshadePrepare=!1}const Dh=(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_image0:new o.Uniform1i(d,i.u_image0),u_skirt_height:new o.Uniform1f(d,i.u_skirt_height)}),mp=(d,i)=>({u_matrix:d,u_image0:0,u_skirt_height:i}),_p=(d,i,h,_,v,w)=>({u_proj_matrix:Float32Array.from(d),u_globe_matrix:i,u_merc_matrix:h,u_zoom_transition:_,u_merc_center:v,u_image0:0,u_grid_matrix:w?Float32Array.from(w):new Float32Array(9)});function qc(d,i){return d!=null&&i!=null&&!(!d.hasData()||!i.hasData())&&d.demTexture!=null&&i.demTexture!=null&&d.tileID.key!==i.tileID.key}const ys=new class{constructor(){this.operations={}}newMorphing(d,i,h,_,v){if(d in this.operations){const w=this.operations[d];w.to.tileID.key!==h.tileID.key&&(w.queued=h)}else this.operations[d]={startTime:_,phase:0,duration:v,from:i,to:h,queued:null}}getMorphValuesForProxy(d){if(!(d in this.operations))return null;const i=this.operations[d];return{from:i.from,to:i.to,phase:i.phase}}update(d){for(const i in this.operations){const h=this.operations[i];for(h.phase=(d-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,d)){delete this.operations[i];break}}}_nextOp(d,i){return!!d.queued&&(d.from=d.to,d.to=d.queued,d.queued=null,d.phase=0,d.startTime=i,!0)}_validOp(d){return d.from.hasData()&&d.to.hasData()}},Fo={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Fh(d,i){const h=1<<d.z;return!i&&(d.x===0||d.x===h-1)||d.y===0||d.y===h-1}const Kc=d=>({u_matrix:d});function Ph(d,i,h,_,v){if(v>0){const w=o.exported.now(),E=(w-d.timeAdded)/v,k=i?(w-i.timeAdded)/v:-1,F=h.getSource(),R=_.coveringZoomLevel({tileSize:F.tileSize,roundZoom:F.roundZoom}),O=!i||Math.abs(i.tileID.overscaledZ-R)>Math.abs(d.tileID.overscaledZ-R),W=O&&d.refreshedUponExpiration?1:o.clamp(O?E:1-k,0,1);return d.refreshedUponExpiration&&E>=1&&(d.refreshedUponExpiration=!1),i?{opacity:1,mix:1-W}:{opacity:W,mix:0}}return{opacity:1,mix:0}}const M_=2*o.mercatorZfromAltitude(1,0)*o.GLOBE_RADIUS*Math.PI;class zl extends o.SourceCache{constructor(i){const h={type:"raster-dem",maxzoom:i.transform.maxZoom},_=new He(Fe(),null),v=Ue("mock-dem",h,_,i.style);super("mock-dem",v,!1),v.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,h){i.state="loaded",h(null)}}class Ol extends o.SourceCache{constructor(i){const h=Ue("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new He(Fe(),null),i.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,h,_){if(i.freezeTileCoverage)return;this.transform=i;const v=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,E)=>{if(w[E.key]="",!this._tiles[E.key]){const k=new o.Tile(E,this._source.tileSize*E.overscaleFactor(),i.tileZoom);k.state="loaded",this._tiles[E.key]=k}return w},{});for(const w in this._tiles)w in v||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(i){const h=this.proxyCachedFBO[i];if(h!==void 0){const _=Object.values(h);this.renderCachePool.push(..._),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Lh extends o.OverscaledTileID{constructor(i,h,_){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=h,this.projMatrix=_}}class Ci extends o.Elevation{constructor(i,h){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,v,w]=function(F){const R=new o.StructArrayLayout4i8,O=new o.StructArrayLayout3ui6,W=131;R.reserve(17161),O.reserve(33800);const te=o.EXTENT/128,oe=o.EXTENT+te/2,ie=oe+te;for(let ye=-te;ye<ie;ye+=te)for(let he=-te;he<ie;he+=te){const _e=he<0||he>oe||ye<0||ye>oe?24575:0,xe=o.clamp(Math.round(he),0,o.EXTENT),Te=o.clamp(Math.round(ye),0,o.EXTENT);R.emplaceBack(xe+_e,Te,xe,Te)}const Q=(ye,he)=>{const _e=he*W+ye;O.emplaceBack(_e+1,_e,_e+W),O.emplaceBack(_e+W,_e+W+1,_e+1)};for(let ye=1;ye<129;ye++)for(let he=1;he<129;he++)Q(he,ye);return[0,129].forEach(ye=>{for(let he=0;he<130;he++)Q(he,ye),Q(ye,he)}),[R,O,32768]}(),E=i.context;this.gridBuffer=E.createVertexBuffer(_,o.boundsAttributes.members),this.gridIndexBuffer=E.createIndexBuffer(v),this.gridSegments=o.SegmentVector.simpleSegment(0,0,_.length,v.length),this.gridNoSkirtSegments=o.SegmentVector.simpleSegment(0,0,_.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ol(h.map),this.orthoMatrix=o.create(),o.ortho(this.orthoMatrix,0,o.EXTENT,0,o.EXTENT,0,1);const k=E.gl;this._overlapStencilMode=new o.StencilMode({func:k.GEQUAL,mask:255},0,255,k.KEEP,k.KEEP,k.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new zl(h.map)}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency()}update(i,h,_){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const v=i.terrain.properties;this.sourceCache=i.terrain.drapeRenderMode===0?this._mockSourceCache:i._getSourceCache(v.get("source")),this._exaggeration=v.get("exaggeration");const w=()=>{this.sourceCache.used&&o.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const E=this.getScaledDemTileSize();this.sourceCache.update(h,E,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),h.updateElevation(!_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||i.efficiency!==100&&o.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&i.dataType==="source"?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):i.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=_._centerAltitude===0&&this.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(_.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=h.getIds().map(F=>{const R=h.getTileByID(F).tileID;return R.projMatrix=_.calculateProjMatrix(R.toUnwrapped()),R});(function(F,R){const O=R.transform.pointCoordinate(R.transform.getCameraPoint()),W=new o.pointGeometry(O.x,O.y);F.sort((te,oe)=>{if(oe.overscaledZ-te.overscaledZ)return oe.overscaledZ-te.overscaledZ;const ie=new o.pointGeometry(te.canonical.x+(1<<te.canonical.z)*te.wrap,te.canonical.y),Q=new o.pointGeometry(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),ye=W.mult(1<<te.canonical.z);return ye.x-=.5,ye.y-=.5,ye.distSqr(ie)-ye.distSqr(Q)})})(v,this.painter),this._previousZoom=_.zoom;const w=this.proxyToSource||{};this.proxyToSource={},v.forEach(F=>{this.proxyToSource[F.key]={}}),this.terrainTileForTile={};const E=this._style._sourceCaches;for(const F in E){const R=E[F];if(!R.used||(R!==this.sourceCache&&this.resetTileLookupCache(R.id),this._setupProxiedCoordsForOrtho(R,i[F],w),R.usedForTerrain))continue;const O=i[F];R.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[h.id]=v.map(F=>new Lh(F,F.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1,this._updateTimestamp=o.exported.now();const k={};this._visibleDemTiles=[];for(const F of this.proxyCoords){const R=this.terrainTileForTile[F.key];if(!R)continue;const O=R.tileID.key;O in k||(this._visibleDemTiles.push(R),k[O]=O)}}_assignTerrainTiles(i){this._initializing||i.forEach(h=>{if(this.terrainTileForTile[h.key])return;const _=this._findTileCoveringTileID(h,this.sourceCache);_&&(this.terrainTileForTile[h.key]=_)})}_prepareDEMTextures(){const i=this.painter.context,h=i.gl;for(const _ in this.terrainTileForTile){const v=this.terrainTileForTile[_],w=v.dem;!w||v.demTexture&&!v.needsDEMTextureUpload||(i.activeTexture.set(h.TEXTURE1),Ih(this.painter,v,w))}}_prepareDemTileUniforms(i,h,_,v){if(!h||h.demTexture==null)return!1;const w=i.tileID.canonical,E=Math.pow(2,h.tileID.canonical.z-w.z),k=v||"";return _[`u_dem_tl${k}`]=[w.x*E%1,w.y*E%1],_[`u_dem_scale${k}`]=E,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,h=i.gl;if(!this._emptyDepthBufferTexture){const _=new o.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new o.Texture(i,_,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const h=this._visibleDemTiles.reduce((_,v)=>{if(!v.dem)return _;const w=v.dem.tree.minimums[0];return w>0&&i++,_+w},0);return i?h/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,h=i.gl;i.activeTexture.set(h.TEXTURE2);const _=this._getLoadedAreaMinimum(),v=new o.RGBAImage({width:1,height:1},new Uint8Array(o.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(v,{premultiply:!1}):w=this._emptyDEMTexture=new o.Texture(i,v,h.RGBA,{premultiply:!1}),w}setupElevationDraw(i,h,_){const v=this.painter.context,w=v.gl,E=(k=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:o.DEMData.getUnpackVector(k),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var k;E.u_dem_size=this.sourceCache.getSource().tileSize,E.u_exaggeration=this.exaggeration();const F=this.painter.transform,R=F.projection,O=i.tileID.canonical;E.u_tile_tl_up=R.upVector(O,0,0),E.u_tile_tr_up=R.upVector(O,o.EXTENT,0),E.u_tile_br_up=R.upVector(O,o.EXTENT,o.EXTENT),E.u_tile_bl_up=R.upVector(O,0,o.EXTENT),E.u_tile_up_scale=_&&_.useDenormalizedUpVectorScale?M_:R.upVectorScale(O,F.center.lat,F.worldSize).metersToTile;let W=null,te=null,oe=1;if(_&&_.morphing&&this._useVertexMorphing){const ie=_.morphing.srcDemTile,Q=_.morphing.dstDemTile;oe=_.morphing.phase,ie&&Q&&(this._prepareDemTileUniforms(i,ie,E,"_prev")&&(te=ie),this._prepareDemTileUniforms(i,Q,E)&&(W=Q))}if(te&&W?(v.activeTexture.set(w.TEXTURE2),W.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),v.activeTexture.set(w.TEXTURE4),te.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),E.u_dem_lerp=oe):(W=this.terrainTileForTile[i.tileID.key],v.activeTexture.set(w.TEXTURE2),(this._prepareDemTileUniforms(i,W,E)?W.demTexture:this.emptyDEMTexture).bind(w.NEAREST,w.CLAMP_TO_EDGE)),v.activeTexture.set(w.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),this._depthFBO&&(E.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE),E.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&W){const ie=(1<<W.tileID.canonical.z)*o.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;E.u_meter_to_dem=ie}_&&_.labelPlaneMatrixInv&&(E.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),h.setTerrainUniformValues(v,E)}renderToBackBuffer(i){const h=this.painter,_=this.painter.context;i.length!==0&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),this.renderingToTexture=!1,function(v,w,E,k,F){if(v.transform.projection.name==="globe")(function(R,O,W,te,oe){const ie=R.context,Q=ie.gl;let ye,he;const _e=R.options.showTerrainWireframe?2:0,xe=(Qe,mt)=>{if(he===Qe)return;const Ge=[Fo[Qe],"PROJECTION_GLOBE_VIEW"];mt&&Ge.push(Fo[_e]),ye=R.useProgram("globeRaster",null,Ge),he=Qe},Te=R.colorModeForRenderPass(),pe=new o.DepthMode(Q.LEQUAL,o.DepthMode.ReadWrite,R.depthRangeFor3D);ys.update(oe);const Se=R.transform,je=o.calculateGlobeMercatorMatrix(Se),Ye=[o.mercatorXfromLng(Se.center.lng),o.mercatorYfromLat(Se.center.lat)],tt=R.globeSharedBuffers;if((_e?[!1,!0]:[!1]).forEach(Qe=>{he=-1;const mt=Qe?Q.LINES:Q.TRIANGLES;for(const Ge of te){const _t=W.getTile(Ge),ht=o.StencilMode.disabled,Rt=O.prevTerrainTileForTile[Ge.key],rt=O.terrainTileForTile[Ge.key];qc(Rt,rt)&&ys.newMorphing(Ge.key,Rt,rt,oe,250),ie.activeTexture.set(Q.TEXTURE0),_t.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);const Ft=ys.getMorphValuesForProxy(Ge.key),$t=Ft?1:0,Pt={useDenormalizedUpVectorScale:!0};Ft&&o.extend$1(Pt,{morphing:{srcDemTile:Ft.from,dstDemTile:Ft.to,phase:o.easeCubicInOut(Ft.phase)}});const Lt=Float32Array.from(Se.globeMatrix),Ht=o.globeTileLatLngCorners(Ge.canonical),er=o.getGridMatrix(Ge.canonical,Ht),jt=_p(Se.projMatrix,Lt,je,o.globeToMercatorTransition(Se.zoom),Ye,er);if(xe($t,Qe),O.setupElevationDraw(_t,ye,Pt),R.prepareDrawProgram(ie,ye,Ge.toUnwrapped()),tt){const[qt,fr,jr]=Qe?tt.getWirefameBuffers(R.context):tt.getGridBuffers();ye.draw(ie,mt,pe,ht,Te,o.CullFaceMode.backCCW,jt,"globe_raster",qt,fr,jr)}}}),tt){ye=R.useProgram("globeRaster",null,["GLOBE_POLES","PROJECTION_GLOBE_VIEW"]);for(const Qe of te){const{x:mt,y:Ge,z:_t}=Qe.canonical,ht=Ge===0,Rt=Ge===(1<<_t)-1,[rt,Ft,$t,Pt]=tt.getPoleBuffers(_t);if(Pt&&(ht||Rt)){const Lt=W.getTile(Qe);ie.activeTexture.set(Q.TEXTURE0),Lt.texture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE);let Ht=o.globePoleMatrixForTile(_t,mt,Se);const er=(jt,qt)=>jt.draw(ie,Q.TRIANGLES,pe,o.StencilMode.disabled,Te,o.CullFaceMode.disabled,_p(Se.projMatrix,Ht,Ht,0,Ye),"globe_pole_raster",qt,$t,Pt);O.setupElevationDraw(Lt,ye,{}),R.prepareDrawProgram(ie,ye,Qe.toUnwrapped()),ht&&er(ye,rt),Rt&&(Ht=o.scale(o.create(),Ht,[1,-1,1]),er(ye,Ft))}}}})(v,w,E,k,F);else{const R=v.context,O=R.gl;let W,te;const oe=v.options.showTerrainWireframe?2:0,ie=(xe,Te)=>{if(te===xe)return;const pe=[Fo[xe]];Te&&pe.push(Fo[oe]),W=v.useProgram("terrainRaster",null,pe),te=xe},Q=v.colorModeForRenderPass(),ye=new o.DepthMode(O.LEQUAL,o.DepthMode.ReadWrite,v.depthRangeFor3D);ys.update(F);const he=v.transform,_e=6*Math.pow(1.5,22-he.zoom)*w.exaggeration();(oe?[!1,!0]:[!1]).forEach(xe=>{te=-1;const Te=xe?O.LINES:O.TRIANGLES,[pe,Se]=xe?w.getWirefameBuffer():[w.gridIndexBuffer,w.gridSegments];for(const je of k){const Ye=E.getTile(je),tt=o.StencilMode.disabled,Qe=w.prevTerrainTileForTile[je.key],mt=w.terrainTileForTile[je.key];qc(Qe,mt)&&ys.newMorphing(je.key,Qe,mt,F,250),R.activeTexture.set(O.TEXTURE0),Ye.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const Ge=ys.getMorphValuesForProxy(je.key),_t=Ge?1:0;let ht;Ge&&(ht={morphing:{srcDemTile:Ge.from,dstDemTile:Ge.to,phase:o.easeCubicInOut(Ge.phase)}});const Rt=mp(je.projMatrix,Fh(je.canonical,he.renderWorldCopies)?_e/10:_e);ie(_t,xe),w.setupElevationDraw(Ye,W,ht),v.prepareDrawProgram(R,W,je.toUnwrapped()),W.draw(R,Te,ye,tt,Q,o.CullFaceMode.backCCW,Rt,"terrain_raster",w.gridBuffer,pe,Se)}})}}(h,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,i.splice(0,i.length))}renderBatch(i){if(this._drapedRenderBatches.length===0)return i+1;this.renderingToTexture=!0;const h=this.painter,_=this.painter.context,v=this.proxySourceCache,w=this.proxiedCoords[v.id],E=this._drapedRenderBatches.shift(),k=[],F=h.style.order;let R=0;for(const O of w){const W=v.getTileByID(O.proxyTileKey),te=v.proxyCachedFBO[O.key]?v.proxyCachedFBO[O.key][i]:void 0,oe=te!==void 0?v.renderCache[te]:this.pool[R++],ie=te!==void 0;if(W.texture=oe.tex,ie&&!oe.dirty){k.push(W.tileID);continue}let Q;_.bindFramebuffer.set(oe.fb.framebuffer),this.renderedToTile=!1,oe.dirty&&(_.clear({color:o.Color.transparent,stencil:0}),oe.dirty=!1);for(let ye=E.start;ye<=E.end;++ye){const he=h.style._layers[F[ye]];if(he.isHidden(h.transform.zoom))continue;const _e=h.style._getLayerSourceCache(he),xe=_e?this.proxyToSource[O.key][_e.id]:[O];if(!xe)continue;const Te=xe;_.viewport.set([0,0,oe.fb.width,oe.fb.height]),Q!==(_e?_e.id:null)&&(this._setupStencil(oe,xe,he,_e),Q=_e?_e.id:null),h.renderLayer(h,_e,he,Te)}this.renderedToTile?(oe.dirty=!0,k.push(W.tileID)):ie||--R,R===5&&(R=0,this.renderToBackBuffer(k))}return this.renderToBackBuffer(k),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),E.end+1}postRender(){}renderCacheEfficiency(i){const h=i.order.length;if(h===0)return{efficiency:100};let _,v=0,w=0,E=!1;for(let k=0;k<h;++k){const F=i._layers[i.order[k]];this._style.isLayerDraped(F)?(E&&++v,++w):E||(E=!0,_=F.id)}return w===0?{efficiency:100}:{efficiency:100*(1-v/w),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{i=Math.min(i,h.dem.tree.minimums[0])}),i===0?i:(i-30)*this._exaggeration}raycast(i,h,_){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const E=w.tileID,k=Math.pow(2,E.overscaledZ),{x:F,y:R}=E.canonical,O=F/k,W=(F+1)/k,te=R/k,oe=(R+1)/k;return{minx:O,miny:te,maxx:W,maxy:oe,t:w.dem.tree.raycastRoot(O,te,W,oe,i,h,_),tile:w}});v.sort((w,E)=>(w.t!==null?w.t:Number.MAX_VALUE)-(E.t!==null?E.t:Number.MAX_VALUE));for(const w of v){if(w.t==null)return null;const E=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,i,h,_);if(E!=null)return E}return null}_createFBO(){const i=this.painter.context,h=i.gl,_=this.drapeBufferSize;i.activeTexture.set(h.TEXTURE0);const v=new o.Texture(i,{width:_[0],height:_[1],data:null},h.RGBA);v.bind(h.LINEAR,h.CLAMP_TO_EDGE);const w=i.createFramebuffer(_[0],_[1],!1);return w.colorAttachment.set(v.texture),w.depthAttachment=new _s(i,w.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:w,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const h=this._style._layers[i],_=h.isHidden(this.painter.transform.zoom),v=h.getCrossfadeParameters(),w=!!v&&v.t!==1,E=h.hasTransition();return h.type!=="custom"&&!_&&(w||E)})}_clearRasterFadeFromRenderCache(){let i=!1;for(const h in this._style._sourceCaches)if(this._style._sourceCaches[h]._source instanceof J){i=!0;break}if(i)for(let h=0;h<this._style.order.length;++h){const _=this._style._layers[this._style.order[h]],v=_.isHidden(this.painter.transform.zoom),w=this._style._getLayerSourceCache(_);if(_.type!=="raster"||v||!w)continue;const E=_.paint.get("raster-fade-duration");for(const k of this.proxyCoords){const F=this.proxyToSource[k.key][w.id];if(F)for(const R of F){const O=Ph(w.getTile(R),w.findLoadedParent(R,0),w,this.painter.transform,E);(O.opacity!==1||O.mix!==0)&&this._clearRenderCacheForTile(w.id,R)}}}}_setupDrapedRenderBatches(){const i=this._style.order,h=i.length;if(h===0)return;const _=[];let v,w=0,E=this._style._layers[i[w]];for(;!this._style.isLayerDraped(E)&&E.isHidden(this.painter.transform.zoom)&&++w<h;)E=this._style._layers[i[w]];for(;w<h;++w){const k=this._style._layers[i[w]];k.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(k)?v===void 0&&(v=w):v!==void 0&&(_.push({start:v,end:w-1}),v=void 0))}v!==void 0&&_.push({start:v,end:w-1}),this._drapedRenderBatches=_}_setupRenderCache(i){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const E=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let k=0;k<E.length;++k){const F=Object.values(E[k]);h.renderCachePool.push(...F)}}return}this._clearRasterFadeFromRenderCache();const _=this.proxyCoords,v=this._tilesDirty;for(let E=_.length-1;E>=0;E--){const k=_[E];if(h.getTileByID(k.key),h.proxyCachedFBO[k.key]!==void 0){const F=i[k.key],R=this.proxyToSource[k.key];let O=0;for(const W in R){const te=R[W],oe=F[W];if(!oe||oe.length!==te.length||te.some((ie,Q)=>ie!==oe[Q]||v[W]&&v[W].hasOwnProperty(ie.key))){O=-1;break}++O}for(const W in h.proxyCachedFBO[k.key])h.renderCache[h.proxyCachedFBO[k.key][W]].dirty=O<0||O!==Object.values(F).length}}const w=[...this._drapedRenderBatches];w.sort((E,k)=>k.end-k.start-(E.end-E.start));for(const E of w)for(const k of _){if(h.proxyCachedFBO[k.key])continue;let F=h.renderCachePool.pop();F===void 0&&h.renderCache.length<50&&(F=h.renderCache.length,h.renderCache.push(this._createFBO())),F!==void 0&&(h.proxyCachedFBO[k.key]={},h.proxyCachedFBO[k.key][E.start]=F,h.renderCache[F].dirty=!0)}this._tilesDirty={}}_setupStencil(i,h,_,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,E=w.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let k;if(_.isTileClipped())k=h.length,this._overlapStencilMode.test={func:E.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);k=1,this._overlapStencilMode.test={func:E.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+k>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=k,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs.get(i.key)||0),this._overlapStencilMode):o.StencilMode.disabled}_renderTileClippingMasks(i,h){const _=this.painter,v=this.painter.context,w=v.gl;_._tileClippingMaskIDs.clear(),v.setColorMode(o.ColorMode.disabled),v.setDepthMode(o.DepthMode.disabled);const E=_.useProgram("clippingMask");for(const k of i){const F=--h;_._tileClippingMaskIDs.set(k.key,F),E.draw(v,w.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:w.ALWAYS,mask:0},F,255,w.KEEP,w.KEEP,w.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Kc(k.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(i){const h=this.painter.transform;if(i.x<0||i.x>h.width||i.y<0||i.y>h.height)return null;const _=[i.x,i.y,1,1];o.transformMat4$1(_,_,h.pixelMatrixInverse),o.scale$1(_,_,1/_[3]),_[0]/=h.worldSize,_[1]/=h.worldSize;const v=h._camera.position,w=o.mercatorZfromAltitude(1,h.center.lat),E=[v[0],v[1],v[2]/w,0],k=o.subtract([],_.slice(0,3),E);o.normalize(k,k);const F=this.raycast(E,k,this._exaggeration);return F!==null&&F?(o.scaleAndAdd(E,E,k,F),E[3]=E[2],E[2]*=w,E):null}drawDepth(){const i=this.painter,h=i.context,_=this.proxySourceCache,v=Math.ceil(i.width),w=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===v&&this._depthFBO.height===w||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const E=h.gl,k=h.createFramebuffer(v,w,!0);h.activeTexture.set(E.TEXTURE0);const F=new o.Texture(h,{width:v,height:w,data:null},E.RGBA);F.bind(E.NEAREST,E.CLAMP_TO_EDGE),k.colorAttachment.set(F.texture);const R=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,v,w);k.depthAttachment.set(R),this._depthFBO=k,this._depthTexture=F}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,v,w]),function(E,k,F,R){if(E.transform.projection.name==="globe")return;const O=E.context,W=O.gl;O.clear({depth:1});const te=E.useProgram("terrainDepth"),oe=new o.DepthMode(W.LESS,o.DepthMode.ReadWrite,E.depthRangeFor3D);for(const ie of R){const Q=F.getTile(ie),ye=mp(ie.projMatrix,0);k.setupElevationDraw(Q,te),te.draw(O,W.TRIANGLES,oe,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.backCCW,ye,"terrain_depth",k.gridBuffer,k.gridIndexBuffer,k.gridNoSkirtSegments)}}(i,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,h,_){if(i.getSource()instanceof Ce)return this._setupProxiedCoordsForImageSource(i,h,_);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const v=this.proxiedCoords[i.id]=[],w=this.proxyCoords;for(let k=0;k<w.length;k++){const F=w[k],R=this._findTileCoveringTileID(F,i);if(R){const O=this._createProxiedId(F,R,_[F.key]&&_[F.key][i.id]);v.push(O),this.proxyToSource[F.key][i.id]=[O]}}let E=!1;for(let k=0;k<h.length;k++){const F=i.getTile(h[k]);if(!F||!F.hasData())continue;const R=this._findTileCoveringTileID(F.tileID,this.proxySourceCache);if(R&&R.tileID.canonical.z!==F.tileID.canonical.z){const O=this.proxyToSource[R.tileID.key][i.id],W=this._createProxiedId(R.tileID,F,_[R.tileID.key]&&_[R.tileID.key][i.id]);O?O.splice(O.length-1,0,W):this.proxyToSource[R.tileID.key][i.id]=[W],v.push(W),E=!0}}this._sourceTilesOverlap[i.id]=E}_setupProxiedCoordsForImageSource(i,h,_){if(!i.getSource().loaded())return;const v=this.proxiedCoords[i.id]=[],w=this.proxyCoords,E=i.getSource(),k=new o.pointGeometry(E.tileID.x,E.tileID.y)._div(1<<E.tileID.z),F=E.coordinates.map(o.MercatorCoordinate.fromLngLat).reduce((O,W)=>(O.min.x=Math.min(O.min.x,W.x-k.x),O.min.y=Math.min(O.min.y,W.y-k.y),O.max.x=Math.max(O.max.x,W.x-k.x),O.max.y=Math.max(O.max.y,W.y-k.y),O),{min:new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new o.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),R=(O,W)=>{const te=O.wrap+O.canonical.x/(1<<O.canonical.z),oe=O.canonical.y/(1<<O.canonical.z),ie=o.EXTENT/(1<<O.canonical.z),Q=W.wrap+W.canonical.x/(1<<W.canonical.z),ye=W.canonical.y/(1<<W.canonical.z);return te+ie<Q+F.min.x||te>Q+F.max.x||oe+ie<ye+F.min.y||oe>ye+F.max.y};for(let O=0;O<w.length;O++){const W=w[O];for(let te=0;te<h.length;te++){const oe=i.getTile(h[te]);if(!oe||!oe.hasData()||R(W,oe.tileID))continue;const ie=this._createProxiedId(W,oe,_[W.key]&&_[W.key][i.id]),Q=this.proxyToSource[W.key][i.id];Q?Q.push(ie):this.proxyToSource[W.key][i.id]=[ie],v.push(ie)}}}_createProxiedId(i,h,_){let v=this.orthoMatrix;if(_){const w=_.find(E=>E.key===h.tileID.key);if(w)return w}if(h.tileID.key!==i.key){const w=i.canonical.z-h.tileID.canonical.z;let E,k,F;v=o.create();const R=h.tileID.wrap-i.wrap<<i.overscaledZ;w>0?(E=o.EXTENT>>w,k=E*((h.tileID.canonical.x<<w)-i.canonical.x+R),F=E*((h.tileID.canonical.y<<w)-i.canonical.y)):(E=o.EXTENT<<-w,k=o.EXTENT*(h.tileID.canonical.x-(i.canonical.x+R<<-w)),F=o.EXTENT*(h.tileID.canonical.y-(i.canonical.y<<-w))),o.ortho(v,0,E,0,E,0,1),o.translate(v,v,[k,F,0])}return new Lh(h.tileID,i.key,v)}_findTileCoveringTileID(i,h){let _=h.getTile(i);if(_&&_.hasData())return _;const v=this._findCoveringTileCache[h.id],w=v[i.key];if(_=w?h.getTileByID(w):null,_&&_.hasData()||w===null)return _;let E=_?_.tileID:i,k=E.overscaledZ;const F=h.getSource().minzoom,R=[];if(!w){const W=h.getSource().maxzoom;if(i.canonical.z>=W){const te=i.canonical.z-W;h.getSource().reparseOverscaled?(k=Math.max(i.canonical.z+2,h.transform.tileZoom),E=new o.OverscaledTileID(k,i.wrap,W,i.canonical.x>>te,i.canonical.y>>te)):te!==0&&(k=W,E=new o.OverscaledTileID(k,i.wrap,W,i.canonical.x>>te,i.canonical.y>>te))}E.key!==i.key&&(R.push(E.key),_=h.getTile(E))}const O=W=>{R.forEach(te=>{v[te]=W}),R.length=0};for(k-=1;k>=F&&(!_||!_.hasData());k--){_&&O(_.tileID.key);const W=E.calculateScaledKey(k);if(_=h.getTileByID(W),_&&_.hasData())break;const te=v[W];if(te===null)break;te===void 0?R.push(W):_=h.getTileByID(te)}return O(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,h){let _=this._tilesDirty[i];_||(_=this._tilesDirty[i]={}),_[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(h){let _=0;const v=new o.StructArrayLayout2ui4,w=131;for(let E=1;E<129;E++){for(let k=1;k<129;k++)_=E*w+k,v.emplaceBack(_,_+1),v.emplaceBack(_,_+w),v.emplaceBack(_+1,_+w),E===128&&v.emplaceBack(_+w,_+w+1);v.emplaceBack(_+1,_+1+w)}return v}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=o.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function Yc(d){const i=[];for(let h=0;h<d.length;h++){if(d[h]===null)continue;const _=d[h].split(" ");i.push(_.pop())}return i}class Bl{static cacheKey(i,h,_){let v=`${i}${_?_.cacheKey:""}`;for(const w of h)v+=`/${w}`;return v}constructor(i,h,_,v,w,E){const k=i.gl;this.program=k.createProgram();const F=Yc(_.staticAttributes),R=v?v.getBinderAttributes():[],O=F.concat(R),W=_.staticUniforms?Yc(_.staticUniforms):[],te=v?v.getBinderUniforms():[],oe=W.concat(te),ie=[];for(const pe of oe)ie.indexOf(pe)<0&&ie.push(pe);let Q=v?v.defines():[];Q=Q.concat(E.map(pe=>`#define ${pe}`));const ye=Q.concat(`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Ll,Hc.fragmentSource,xs.fragmentSource,_.fragmentSource).join(`
`),he=Q.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,Ll,Hc.vertexSource,xs.vertexSource,Ys.vertexSource,_.vertexSource).join(`
`),_e=k.createShader(k.FRAGMENT_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(_e,ye),k.compileShader(_e),k.attachShader(this.program,_e);const xe=k.createShader(k.VERTEX_SHADER);if(k.isContextLost())return void(this.failedToCreate=!0);k.shaderSource(xe,he),k.compileShader(xe),k.attachShader(this.program,xe),this.attributes={};const Te={};this.numAttributes=O.length;for(let pe=0;pe<this.numAttributes;pe++)O[pe]&&(k.bindAttribLocation(this.program,pe,O[pe]),this.attributes[O[pe]]=pe);k.linkProgram(this.program),k.deleteShader(xe),k.deleteShader(_e);for(let pe=0;pe<ie.length;pe++){const Se=ie[pe];if(Se&&!Te[Se]){const je=k.getUniformLocation(this.program,Se);je&&(Te[Se]=je)}}this.fixedUniforms=w(i,Te),this.binderUniforms=v?v.getUniforms(i,Te):[],E.indexOf("TERRAIN")!==-1&&(this.terrainUniforms=((pe,Se)=>({u_dem:new o.Uniform1i(pe,Se.u_dem),u_dem_prev:new o.Uniform1i(pe,Se.u_dem_prev),u_dem_unpack:new o.Uniform4f(pe,Se.u_dem_unpack),u_dem_tl:new o.Uniform2f(pe,Se.u_dem_tl),u_dem_scale:new o.Uniform1f(pe,Se.u_dem_scale),u_dem_tl_prev:new o.Uniform2f(pe,Se.u_dem_tl_prev),u_dem_scale_prev:new o.Uniform1f(pe,Se.u_dem_scale_prev),u_dem_size:new o.Uniform1f(pe,Se.u_dem_size),u_dem_lerp:new o.Uniform1f(pe,Se.u_dem_lerp),u_exaggeration:new o.Uniform1f(pe,Se.u_exaggeration),u_depth:new o.Uniform1i(pe,Se.u_depth),u_depth_size_inv:new o.Uniform2f(pe,Se.u_depth_size_inv),u_meter_to_dem:new o.Uniform1f(pe,Se.u_meter_to_dem),u_label_plane_matrix_inv:new o.UniformMatrix4f(pe,Se.u_label_plane_matrix_inv),u_tile_tl_up:new o.Uniform3f(pe,Se.u_tile_tl_up),u_tile_tr_up:new o.Uniform3f(pe,Se.u_tile_tr_up),u_tile_br_up:new o.Uniform3f(pe,Se.u_tile_br_up),u_tile_bl_up:new o.Uniform3f(pe,Se.u_tile_bl_up),u_tile_up_scale:new o.Uniform1f(pe,Se.u_tile_up_scale)}))(i,Te)),E.indexOf("FOG")!==-1&&(this.fogUniforms=((pe,Se)=>({u_fog_matrix:new o.UniformMatrix4f(pe,Se.u_fog_matrix),u_fog_range:new o.Uniform2f(pe,Se.u_fog_range),u_fog_color:new o.Uniform4f(pe,Se.u_fog_color),u_fog_horizon_blend:new o.Uniform1f(pe,Se.u_fog_horizon_blend),u_fog_temporal_offset:new o.Uniform1f(pe,Se.u_fog_temporal_offset)}))(i,Te))}setTerrainUniformValues(i,h){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const v in h)_[v].set(h[v])}}setFogUniformValues(i,h){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const v in h)_[v].location&&_[v].set(h[v])}}draw(i,h,_,v,w,E,k,F,R,O,W,te,oe,ie,Q,ye){const he=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(_),i.setStencilMode(v),i.setColorMode(w),i.setCullFace(E);for(const xe of Object.keys(this.fixedUniforms))this.fixedUniforms[xe].set(k[xe]);ie&&ie.setUniforms(i,this.binderUniforms,te,{zoom:oe});const _e={[he.LINES]:2,[he.TRIANGLES]:3,[he.LINE_STRIP]:1}[h];for(const xe of W.get()){const Te=xe.vaos||(xe.vaos={});(Te[F]||(Te[F]=new Xc)).bind(i,this,R,ie?ie.getPaintVertexBuffers():[],O,xe.vertexOffset,Q,ye),he.drawElements(h,xe.primitiveLength*_e,he.UNSIGNED_SHORT,xe.primitiveOffset*_e*2)}}}function Nl(d,i,h){const _=1/Re(h,1,i.transform.tileZoom),v=Math.pow(2,h.tileID.overscaledZ),w=h.tileSize*Math.pow(2,i.transform.tileZoom)/v,E=w*(h.tileID.canonical.x+h.tileID.wrap*v),k=w*h.tileID.canonical.y;return{u_image:0,u_texsize:h.imageAtlasTexture.size,u_scale:[_,d.fromScale,d.toScale],u_fade:d.t,u_pixel_coord_upper:[E>>16,k>>16],u_pixel_coord_lower:[65535&E,65535&k]}}const Rh=o.create(),Jc=(d,i,h,_,v,w,E,k,F)=>{const R=i.style.light,O=R.properties.get("position"),W=[O.x,O.y,O.z],te=o.create$1();R.properties.get("anchor")==="viewport"&&(o.fromRotation(te,-i.transform.angle),o.transformMat3(W,W,te));const oe=R.properties.get("color"),ie=i.transform,Q={u_matrix:d,u_lightpos:W,u_lightintensity:R.properties.get("intensity"),u_lightcolor:[oe.r,oe.g,oe.b],u_vertical_gradient:+h,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Rh,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0};return ie.projection.name==="globe"&&(Q.u_tile_id=[v.canonical.x,v.canonical.y,1<<v.canonical.z],Q.u_zoom_transition=E,Q.u_inv_rot_matrix=F,Q.u_merc_center=k,Q.u_up_dir=ie.projection.upVector(new o.CanonicalTileID(0,0,0),k[0]*o.EXTENT,k[1]*o.EXTENT),Q.u_height_lift=w),Q},Qc=(d,i,h,_,v,w,E,k,F,R,O)=>{const W=Jc(d,i,h,_,v,k,F,R,O),te={u_height_factor:-Math.pow(2,v.overscaledZ)/E.tileSize/8};return o.extend(W,Nl(w,i,E),te)},eu=d=>({u_matrix:d}),tu=(d,i,h,_)=>o.extend(eu(d),Nl(h,i,_)),ru=(d,i)=>({u_matrix:d,u_world:i}),gp=(d,i,h,_,v)=>o.extend(tu(d,i,h,_),{u_world:v}),xp=o.create(),Po=(d,i,h,_,v,w)=>{const E=d.transform,k=E.projection.name==="globe";let F;if(w.paint.get("circle-pitch-alignment")==="map")if(k){const O=o.globePixelsToTileUnits(E.zoom,i.canonical);F=Float32Array.from([O,0,0,O])}else F=E.calculatePixelsToTileUnitsMatrix(h);else F=new Float32Array([E.pixelsToGLUnits[0],0,0,E.pixelsToGLUnits[1]]);const R={u_camera_to_center_distance:E.cameraToCenterDistance,u_matrix:d.translatePosMatrix(i.projMatrix,h,w.paint.get("circle-translate"),w.paint.get("circle-translate-anchor")),u_device_pixel_ratio:o.exported.devicePixelRatio,u_extrude_scale:F,u_inv_rot_matrix:xp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return k&&(R.u_inv_rot_matrix=_,R.u_merc_center=v,R.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],R.u_zoom_transition=o.globeToMercatorTransition(E.zoom),R.u_up_dir=E.projection.upVector(i.canonical,v[0],v[1])),R},D_=d=>{const i=[];return d.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),d.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i},F_=(d,i,h)=>{const _=o.EXTENT/h.tileSize;return{u_matrix:d,u_camera_to_center_distance:i.cameraToCenterDistance,u_extrude_scale:[i.pixelsToGLUnits[0]/_,i.pixelsToGLUnits[1]/_]}},yp=(d,i,h=1)=>({u_matrix:d,u_color:i,u_overlay:0,u_overlay_scale:h}),P_=o.create(),L_=(d,i,h,_,v,w,E)=>{const k=d.transform,F=k.projection.name==="globe",R=F?o.globePixelsToTileUnits(k.zoom,i.canonical):Re(h,1,w),O={u_matrix:i.projMatrix,u_extrude_scale:R,u_intensity:E,u_inv_rot_matrix:P_,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};return F&&(O.u_inv_rot_matrix=_,O.u_merc_center=v,O.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],O.u_zoom_transition=o.globeToMercatorTransition(k.zoom),O.u_up_dir=k.projection.upVector(i.canonical,v[0],v[1])),O},R_=(d,i,h,_,v,w,E)=>{const k=d.transform,F=k.calculatePixelsToTileUnitsMatrix(i),R={u_matrix:Js(d,i,h,v),u_pixels_to_tile_units:F,u_device_pixel_ratio:E,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:w,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if(Oh(h)){const O=nu(i,d.transform);R.u_texsize=i.lineAtlasTexture.size,R.u_scale=[O,_.fromScale,_.toScale],R.u_mix=_.t}return R},zh=(d,i,h,_,v,w)=>{const E=d.transform,k=nu(i,E);return{u_matrix:Js(d,i,h,v),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:w,u_image:0,u_scale:[k,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function nu(d,i){return 1/Re(d,1,i.tileZoom)}function Js(d,i,h,_){return d.translatePosMatrix(_||i.tileID.projMatrix,i,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function Oh(d){const i=d.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}const vp=(d,i,h,_,v,w)=>{return{u_matrix:d,u_tl_parent:i,u_scale_parent:h,u_fade_t:_.mix,u_opacity:_.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(k=v.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(E=v.paint.get("raster-contrast"),E>0?1/(1-E):1+E),u_spin_weights:Bh(v.paint.get("raster-hue-rotate")),u_perspective_transform:w};var E,k};function Bh(d){d*=Math.PI/180;const i=Math.sin(d),h=Math.cos(d);return[(2*h+1)/3,(-Math.sqrt(3)*i-h+1)/3,(Math.sqrt(3)*i-h+1)/3]}const vs=o.create(),Nh=(d,i,h,_,v,w,E,k,F,R,O,W,te,oe)=>{const ie=v.transform,Q={u_is_size_zoom_constant:+(d==="constant"||d==="source"),u_is_size_feature_constant:+(d==="constant"||d==="camera"),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:ie.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:ie.width/ie.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:E,u_coord_matrix:k,u_is_text:+F,u_pitch_with_map:+_,u_texsize:R,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:vs,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:vs};return ie.projection.name==="globe"&&(Q.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],Q.u_zoom_transition=W,Q.u_inv_rot_matrix=oe,Q.u_merc_center=te,Q.u_camera_forward=ie._camera.forward(),Q.u_ecef_origin=o.globeECEFOrigin(ie.globeMatrix,O.toUnwrapped()),Q.u_tile_matrix=Float32Array.from(ie.globeMatrix)),Q},Qs=(d,i,h,_,v,w,E,k,F,R,O,W,te,oe,ie)=>{const{cameraToCenterDistance:Q,_pitch:ye}=v.transform;return o.extend(Nh(d,i,h,_,v,w,E,k,F,R,W,te,oe,ie),{u_gamma_scale:_?Q*Math.cos(v.terrain?0:ye):1,u_device_pixel_ratio:o.exported.devicePixelRatio,u_is_halo:+O})},Lo=(d,i,h,_,v,w,E,k,F,R,O,W,te,oe)=>o.extend(Qs(d,i,h,_,v,w,E,k,!0,F,!0,O,W,te,oe),{u_texsize_icon:R,u_texture_icon:1}),wp=(d,i,h)=>({u_matrix:d,u_opacity:i,u_color:h}),Uh=(d,i,h,_,v,w)=>o.extend(function(E,k,F,R){const O=F.imageManager.getPattern(E.from.toString()),W=F.imageManager.getPattern(E.to.toString()),{width:te,height:oe}=F.imageManager.getPixelSize(),ie=Math.pow(2,R.tileID.overscaledZ),Q=R.tileSize*Math.pow(2,F.transform.tileZoom)/ie,ye=Q*(R.tileID.canonical.x+R.tileID.wrap*ie),he=Q*R.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:O.tl,u_pattern_br_a:O.br,u_pattern_tl_b:W.tl,u_pattern_br_b:W.br,u_texsize:[te,oe],u_mix:k.t,u_pattern_size_a:O.displaySize,u_pattern_size_b:W.displaySize,u_scale_a:k.fromScale,u_scale_b:k.toScale,u_tile_units_to_pixels:1/Re(R,1,F.transform.tileZoom),u_pixel_coord_upper:[ye>>16,he>>16],u_pixel_coord_lower:[65535&ye,65535&he]}}(_,w,h,v),{u_matrix:d,u_opacity:i}),xr={fillExtrusion:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_lightpos:new o.Uniform3f(d,i.u_lightpos),u_lightintensity:new o.Uniform1f(d,i.u_lightintensity),u_lightcolor:new o.Uniform3f(d,i.u_lightcolor),u_vertical_gradient:new o.Uniform1f(d,i.u_vertical_gradient),u_opacity:new o.Uniform1f(d,i.u_opacity),u_tile_id:new o.Uniform3f(d,i.u_tile_id),u_zoom_transition:new o.Uniform1f(d,i.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(d,i.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(d,i.u_merc_center),u_up_dir:new o.Uniform3f(d,i.u_up_dir),u_height_lift:new o.Uniform1f(d,i.u_height_lift)}),fillExtrusionPattern:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_lightpos:new o.Uniform3f(d,i.u_lightpos),u_lightintensity:new o.Uniform1f(d,i.u_lightintensity),u_lightcolor:new o.Uniform3f(d,i.u_lightcolor),u_vertical_gradient:new o.Uniform1f(d,i.u_vertical_gradient),u_height_factor:new o.Uniform1f(d,i.u_height_factor),u_tile_id:new o.Uniform3f(d,i.u_tile_id),u_zoom_transition:new o.Uniform1f(d,i.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(d,i.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(d,i.u_merc_center),u_up_dir:new o.Uniform3f(d,i.u_up_dir),u_height_lift:new o.Uniform1f(d,i.u_height_lift),u_image:new o.Uniform1i(d,i.u_image),u_texsize:new o.Uniform2f(d,i.u_texsize),u_pixel_coord_upper:new o.Uniform2f(d,i.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(d,i.u_pixel_coord_lower),u_scale:new o.Uniform3f(d,i.u_scale),u_fade:new o.Uniform1f(d,i.u_fade),u_opacity:new o.Uniform1f(d,i.u_opacity)}),fill:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix)}),fillPattern:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_image:new o.Uniform1i(d,i.u_image),u_texsize:new o.Uniform2f(d,i.u_texsize),u_pixel_coord_upper:new o.Uniform2f(d,i.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(d,i.u_pixel_coord_lower),u_scale:new o.Uniform3f(d,i.u_scale),u_fade:new o.Uniform1f(d,i.u_fade)}),fillOutline:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_world:new o.Uniform2f(d,i.u_world)}),fillOutlinePattern:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_world:new o.Uniform2f(d,i.u_world),u_image:new o.Uniform1i(d,i.u_image),u_texsize:new o.Uniform2f(d,i.u_texsize),u_pixel_coord_upper:new o.Uniform2f(d,i.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(d,i.u_pixel_coord_lower),u_scale:new o.Uniform3f(d,i.u_scale),u_fade:new o.Uniform1f(d,i.u_fade)}),circle:(d,i)=>({u_camera_to_center_distance:new o.Uniform1f(d,i.u_camera_to_center_distance),u_extrude_scale:new o.UniformMatrix2f(d,i.u_extrude_scale),u_device_pixel_ratio:new o.Uniform1f(d,i.u_device_pixel_ratio),u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_inv_rot_matrix:new o.UniformMatrix4f(d,i.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(d,i.u_merc_center),u_tile_id:new o.Uniform3f(d,i.u_tile_id),u_zoom_transition:new o.Uniform1f(d,i.u_zoom_transition),u_up_dir:new o.Uniform3f(d,i.u_up_dir)}),collisionBox:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_camera_to_center_distance:new o.Uniform1f(d,i.u_camera_to_center_distance),u_extrude_scale:new o.Uniform2f(d,i.u_extrude_scale)}),collisionCircle:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_inv_matrix:new o.UniformMatrix4f(d,i.u_inv_matrix),u_camera_to_center_distance:new o.Uniform1f(d,i.u_camera_to_center_distance),u_viewport_size:new o.Uniform2f(d,i.u_viewport_size)}),debug:(d,i)=>({u_color:new o.UniformColor(d,i.u_color),u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_overlay:new o.Uniform1i(d,i.u_overlay),u_overlay_scale:new o.Uniform1f(d,i.u_overlay_scale)}),clippingMask:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix)}),heatmap:(d,i)=>({u_extrude_scale:new o.Uniform1f(d,i.u_extrude_scale),u_intensity:new o.Uniform1f(d,i.u_intensity),u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_inv_rot_matrix:new o.UniformMatrix4f(d,i.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(d,i.u_merc_center),u_tile_id:new o.Uniform3f(d,i.u_tile_id),u_zoom_transition:new o.Uniform1f(d,i.u_zoom_transition),u_up_dir:new o.Uniform3f(d,i.u_up_dir)}),heatmapTexture:(d,i)=>({u_image:new o.Uniform1i(d,i.u_image),u_color_ramp:new o.Uniform1i(d,i.u_color_ramp),u_opacity:new o.Uniform1f(d,i.u_opacity)}),hillshade:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_image:new o.Uniform1i(d,i.u_image),u_latrange:new o.Uniform2f(d,i.u_latrange),u_light:new o.Uniform2f(d,i.u_light),u_shadow:new o.UniformColor(d,i.u_shadow),u_highlight:new o.UniformColor(d,i.u_highlight),u_accent:new o.UniformColor(d,i.u_accent)}),hillshadePrepare:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_image:new o.Uniform1i(d,i.u_image),u_dimension:new o.Uniform2f(d,i.u_dimension),u_zoom:new o.Uniform1f(d,i.u_zoom),u_unpack:new o.Uniform4f(d,i.u_unpack)}),line:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_pixels_to_tile_units:new o.UniformMatrix2f(d,i.u_pixels_to_tile_units),u_device_pixel_ratio:new o.Uniform1f(d,i.u_device_pixel_ratio),u_units_to_pixels:new o.Uniform2f(d,i.u_units_to_pixels),u_dash_image:new o.Uniform1i(d,i.u_dash_image),u_gradient_image:new o.Uniform1i(d,i.u_gradient_image),u_image_height:new o.Uniform1f(d,i.u_image_height),u_texsize:new o.Uniform2f(d,i.u_texsize),u_scale:new o.Uniform3f(d,i.u_scale),u_mix:new o.Uniform1f(d,i.u_mix),u_alpha_discard_threshold:new o.Uniform1f(d,i.u_alpha_discard_threshold)}),linePattern:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_texsize:new o.Uniform2f(d,i.u_texsize),u_pixels_to_tile_units:new o.UniformMatrix2f(d,i.u_pixels_to_tile_units),u_device_pixel_ratio:new o.Uniform1f(d,i.u_device_pixel_ratio),u_image:new o.Uniform1i(d,i.u_image),u_units_to_pixels:new o.Uniform2f(d,i.u_units_to_pixels),u_scale:new o.Uniform3f(d,i.u_scale),u_fade:new o.Uniform1f(d,i.u_fade),u_alpha_discard_threshold:new o.Uniform1f(d,i.u_alpha_discard_threshold)}),raster:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_tl_parent:new o.Uniform2f(d,i.u_tl_parent),u_scale_parent:new o.Uniform1f(d,i.u_scale_parent),u_fade_t:new o.Uniform1f(d,i.u_fade_t),u_opacity:new o.Uniform1f(d,i.u_opacity),u_image0:new o.Uniform1i(d,i.u_image0),u_image1:new o.Uniform1i(d,i.u_image1),u_brightness_low:new o.Uniform1f(d,i.u_brightness_low),u_brightness_high:new o.Uniform1f(d,i.u_brightness_high),u_saturation_factor:new o.Uniform1f(d,i.u_saturation_factor),u_contrast_factor:new o.Uniform1f(d,i.u_contrast_factor),u_spin_weights:new o.Uniform3f(d,i.u_spin_weights),u_perspective_transform:new o.Uniform2f(d,i.u_perspective_transform)}),symbolIcon:(d,i)=>({u_is_size_zoom_constant:new o.Uniform1i(d,i.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(d,i.u_is_size_feature_constant),u_size_t:new o.Uniform1f(d,i.u_size_t),u_size:new o.Uniform1f(d,i.u_size),u_camera_to_center_distance:new o.Uniform1f(d,i.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(d,i.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(d,i.u_aspect_ratio),u_fade_change:new o.Uniform1f(d,i.u_fade_change),u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(d,i.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(d,i.u_coord_matrix),u_is_text:new o.Uniform1i(d,i.u_is_text),u_pitch_with_map:new o.Uniform1i(d,i.u_pitch_with_map),u_texsize:new o.Uniform2f(d,i.u_texsize),u_tile_id:new o.Uniform3f(d,i.u_tile_id),u_zoom_transition:new o.Uniform1f(d,i.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(d,i.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(d,i.u_merc_center),u_camera_forward:new o.Uniform3f(d,i.u_camera_forward),u_tile_matrix:new o.UniformMatrix4f(d,i.u_tile_matrix),u_ecef_origin:new o.Uniform3f(d,i.u_ecef_origin),u_texture:new o.Uniform1i(d,i.u_texture)}),symbolSDF:(d,i)=>({u_is_size_zoom_constant:new o.Uniform1i(d,i.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(d,i.u_is_size_feature_constant),u_size_t:new o.Uniform1f(d,i.u_size_t),u_size:new o.Uniform1f(d,i.u_size),u_camera_to_center_distance:new o.Uniform1f(d,i.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(d,i.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(d,i.u_aspect_ratio),u_fade_change:new o.Uniform1f(d,i.u_fade_change),u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(d,i.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(d,i.u_coord_matrix),u_is_text:new o.Uniform1i(d,i.u_is_text),u_pitch_with_map:new o.Uniform1i(d,i.u_pitch_with_map),u_texsize:new o.Uniform2f(d,i.u_texsize),u_texture:new o.Uniform1i(d,i.u_texture),u_gamma_scale:new o.Uniform1f(d,i.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(d,i.u_device_pixel_ratio),u_tile_id:new o.Uniform3f(d,i.u_tile_id),u_zoom_transition:new o.Uniform1f(d,i.u_zoom_transition),u_inv_rot_matrix:new o.UniformMatrix4f(d,i.u_inv_rot_matrix),u_merc_center:new o.Uniform2f(d,i.u_merc_center),u_camera_forward:new o.Uniform3f(d,i.u_camera_forward),u_tile_matrix:new o.UniformMatrix4f(d,i.u_tile_matrix),u_ecef_origin:new o.Uniform3f(d,i.u_ecef_origin),u_is_halo:new o.Uniform1i(d,i.u_is_halo)}),symbolTextAndIcon:(d,i)=>({u_is_size_zoom_constant:new o.Uniform1i(d,i.u_is_size_zoom_constant),u_is_size_feature_constant:new o.Uniform1i(d,i.u_is_size_feature_constant),u_size_t:new o.Uniform1f(d,i.u_size_t),u_size:new o.Uniform1f(d,i.u_size),u_camera_to_center_distance:new o.Uniform1f(d,i.u_camera_to_center_distance),u_rotate_symbol:new o.Uniform1i(d,i.u_rotate_symbol),u_aspect_ratio:new o.Uniform1f(d,i.u_aspect_ratio),u_fade_change:new o.Uniform1f(d,i.u_fade_change),u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_label_plane_matrix:new o.UniformMatrix4f(d,i.u_label_plane_matrix),u_coord_matrix:new o.UniformMatrix4f(d,i.u_coord_matrix),u_is_text:new o.Uniform1i(d,i.u_is_text),u_pitch_with_map:new o.Uniform1i(d,i.u_pitch_with_map),u_texsize:new o.Uniform2f(d,i.u_texsize),u_texsize_icon:new o.Uniform2f(d,i.u_texsize_icon),u_texture:new o.Uniform1i(d,i.u_texture),u_texture_icon:new o.Uniform1i(d,i.u_texture_icon),u_gamma_scale:new o.Uniform1f(d,i.u_gamma_scale),u_device_pixel_ratio:new o.Uniform1f(d,i.u_device_pixel_ratio),u_is_halo:new o.Uniform1i(d,i.u_is_halo)}),background:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_opacity:new o.Uniform1f(d,i.u_opacity),u_color:new o.UniformColor(d,i.u_color)}),backgroundPattern:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_opacity:new o.Uniform1f(d,i.u_opacity),u_image:new o.Uniform1i(d,i.u_image),u_pattern_tl_a:new o.Uniform2f(d,i.u_pattern_tl_a),u_pattern_br_a:new o.Uniform2f(d,i.u_pattern_br_a),u_pattern_tl_b:new o.Uniform2f(d,i.u_pattern_tl_b),u_pattern_br_b:new o.Uniform2f(d,i.u_pattern_br_b),u_texsize:new o.Uniform2f(d,i.u_texsize),u_mix:new o.Uniform1f(d,i.u_mix),u_pattern_size_a:new o.Uniform2f(d,i.u_pattern_size_a),u_pattern_size_b:new o.Uniform2f(d,i.u_pattern_size_b),u_scale_a:new o.Uniform1f(d,i.u_scale_a),u_scale_b:new o.Uniform1f(d,i.u_scale_b),u_pixel_coord_upper:new o.Uniform2f(d,i.u_pixel_coord_upper),u_pixel_coord_lower:new o.Uniform2f(d,i.u_pixel_coord_lower),u_tile_units_to_pixels:new o.Uniform1f(d,i.u_tile_units_to_pixels)}),terrainRaster:Dh,terrainDepth:Dh,skybox:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_sun_direction:new o.Uniform3f(d,i.u_sun_direction),u_cubemap:new o.Uniform1i(d,i.u_cubemap),u_opacity:new o.Uniform1f(d,i.u_opacity),u_temporal_offset:new o.Uniform1f(d,i.u_temporal_offset)}),skyboxGradient:(d,i)=>({u_matrix:new o.UniformMatrix4f(d,i.u_matrix),u_color_ramp:new o.Uniform1i(d,i.u_color_ramp),u_center_direction:new o.Uniform3f(d,i.u_center_direction),u_radius:new o.Uniform1f(d,i.u_radius),u_opacity:new o.Uniform1f(d,i.u_opacity),u_temporal_offset:new o.Uniform1f(d,i.u_temporal_offset)}),skyboxCapture:(d,i)=>({u_matrix_3f:new o.UniformMatrix3f(d,i.u_matrix_3f),u_sun_direction:new o.Uniform3f(d,i.u_sun_direction),u_sun_intensity:new o.Uniform1f(d,i.u_sun_intensity),u_color_tint_r:new o.Uniform4f(d,i.u_color_tint_r),u_color_tint_m:new o.Uniform4f(d,i.u_color_tint_m),u_luminance:new o.Uniform1f(d,i.u_luminance)}),globeRaster:(d,i)=>({u_proj_matrix:new o.UniformMatrix4f(d,i.u_proj_matrix),u_globe_matrix:new o.UniformMatrix4f(d,i.u_globe_matrix),u_merc_matrix:new o.UniformMatrix4f(d,i.u_merc_matrix),u_zoom_transition:new o.Uniform1f(d,i.u_zoom_transition),u_merc_center:new o.Uniform2f(d,i.u_merc_center),u_image0:new o.Uniform1i(d,i.u_image0),u_grid_matrix:new o.UniformMatrix3f(d,i.u_grid_matrix)}),globeAtmosphere:(d,i)=>({u_frustum_tl:new o.Uniform3f(d,i.u_frustum_tl),u_frustum_tr:new o.Uniform3f(d,i.u_frustum_tr),u_frustum_br:new o.Uniform3f(d,i.u_frustum_br),u_frustum_bl:new o.Uniform3f(d,i.u_frustum_bl),u_globe_pos:new o.Uniform3f(d,i.u_globe_pos),u_globe_radius:new o.Uniform1f(d,i.u_globe_radius),u_opacity:new o.Uniform1f(d,i.u_opacity),u_fadeout_range:new o.Uniform1f(d,i.u_fadeout_range),u_start_color:new o.Uniform3f(d,i.u_start_color),u_end_color:new o.Uniform3f(d,i.u_end_color)})};let eo;function Tp(d,i,h,_,v,w,E){const k=d.context,F=k.gl,R=d.useProgram("collisionBox"),O=[];let W=0,te=0;for(let xe=0;xe<_.length;xe++){const Te=_[xe],pe=i.getTile(Te),Se=pe.getBucket(h);if(!Se)continue;let je=Te.projMatrix;v[0]===0&&v[1]===0||(je=d.translatePosMatrix(Te.projMatrix,pe,v,w));const Ye=E?Se.textCollisionBox:Se.iconCollisionBox,tt=Se.collisionCircleArray;if(tt.length>0){const Qe=o.create(),mt=je;o.mul(Qe,Se.placementInvProjMatrix,d.transform.glCoordMatrix),o.mul(Qe,Qe,Se.placementViewportMatrix),O.push({circleArray:tt,circleOffset:te,transform:mt,invTransform:Qe}),W+=tt.length/4,te=W}Ye&&(d.terrain&&d.terrain.setupElevationDraw(pe,R),R.draw(k,F.LINES,o.DepthMode.disabled,o.StencilMode.disabled,d.colorModeForRenderPass(),o.CullFaceMode.disabled,F_(je,d.transform,pe),h.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,null,d.transform.zoom,null,Ye.collisionVertexBuffer,Ye.collisionVertexBufferExt))}if(!E||!O.length)return;const oe=d.useProgram("collisionCircle"),ie=new o.StructArrayLayout2f1f2i16;ie.resize(4*W),ie._trim();let Q=0;for(const xe of O)for(let Te=0;Te<xe.circleArray.length/4;Te++){const pe=4*Te,Se=xe.circleArray[pe+0],je=xe.circleArray[pe+1],Ye=xe.circleArray[pe+2],tt=xe.circleArray[pe+3];ie.emplace(Q++,Se,je,Ye,tt,0),ie.emplace(Q++,Se,je,Ye,tt,1),ie.emplace(Q++,Se,je,Ye,tt,2),ie.emplace(Q++,Se,je,Ye,tt,3)}(!eo||eo.length<2*W)&&(eo=function(xe){const Te=2*xe,pe=new o.StructArrayLayout3ui6;pe.resize(Te),pe._trim();for(let Se=0;Se<Te;Se++){const je=6*Se;pe.uint16[je+0]=4*Se+0,pe.uint16[je+1]=4*Se+1,pe.uint16[je+2]=4*Se+2,pe.uint16[je+3]=4*Se+2,pe.uint16[je+4]=4*Se+3,pe.uint16[je+5]=4*Se+0}return pe}(W));const ye=k.createIndexBuffer(eo,!0),he=k.createVertexBuffer(ie,o.collisionCircleLayout.members,!0);for(const xe of O){const Te={u_matrix:xe.transform,u_inv_matrix:xe.invTransform,u_camera_to_center_distance:(_e=d.transform).cameraToCenterDistance,u_viewport_size:[_e.width,_e.height]};oe.draw(k,F.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,d.colorModeForRenderPass(),o.CullFaceMode.disabled,Te,h.id,he,ye,o.SegmentVector.simpleSegment(0,2*xe.circleOffset,xe.circleArray.length,xe.circleArray.length/2),null,d.transform.zoom,null,null,null)}var _e;he.destroy(),ye.destroy()}const Vh=o.create();function Ul(d,i,h,_,v,w){const{horizontalAlign:E,verticalAlign:k}=o.getAnchorAlignment(d),F=-(E-.5)*i,R=-(k-.5)*h,O=o.evaluateVariableOffset(d,_);return new o.pointGeometry((F/v+O[0])*w,(R/v+O[1])*w)}function z_(d,i,h,_,v,w,E,k,F,R,O,W){const te=d.text.placedSymbolArray,oe=d.text.dynamicLayoutVertexArray,ie=d.icon.dynamicLayoutVertexArray,Q={},ye=k.projMatrix,he=w.elevation,_e=W.upVectorScale(k.canonical,w.center.lat,w.worldSize);oe.clear();for(let xe=0;xe<te.length;xe++){const Te=te.get(xe),pe=d.allowVerticalPlacement&&!Te.placedOrientation,Se=Te.hidden||!Te.crossTileID||pe?null:_[Te.crossTileID];if(Se){const je=new o.pointGeometry(Te.tileAnchorX,Te.tileAnchorY),Ye=W.upVector(k.canonical,je.x,je.y),tt=he?he.getAtTileOffset(k,je.x,je.y):0,Qe=tn([Te.projectedAnchorX+tt*Ye[0]*_e.metersToTile,Te.projectedAnchorY+tt*Ye[1]*_e.metersToTile,Te.projectedAnchorZ+tt*Ye[2]*_e.metersToTile],h?ye:E),mt=Vr(w.cameraToCenterDistance,Qe.signedDistanceFromCamera);let Ge=v.evaluateSizeForFeature(d.textSizeData,R,Te)*mt/o.ONE_EM;h&&(Ge*=d.tilePixelRatio/F);const{width:_t,height:ht,anchor:Rt,textOffset:rt,textScale:Ft}=Se,$t=Ul(Rt,_t,ht,rt,Ft,Ge),Pt=h?Tn(je.add($t),E,tt*_e.metersToLabelSpace).point:Qe.point.add(i?$t.rotate(-w.angle):$t),Lt=d.allowVerticalPlacement&&Te.placedOrientation===o.WritingMode.vertical?Math.PI/2:0;for(let Ht=0;Ht<Te.numGlyphs;Ht++)o.addDynamicAttributes(oe,Pt,Lt);O&&Te.associatedIconIndex>=0&&(Q[Te.associatedIconIndex]={shiftedAnchor:Pt,angle:Lt})}else mn(Te.numGlyphs,oe)}if(O){ie.clear();const xe=d.icon.placedSymbolArray;for(let Te=0;Te<xe.length;Te++){const pe=xe.get(Te);if(pe.hidden)mn(pe.numGlyphs,ie);else{const Se=Q[Te];if(Se)for(let je=0;je<pe.numGlyphs;je++)o.addDynamicAttributes(ie,Se.shiftedAnchor,Se.angle);else mn(pe.numGlyphs,ie)}}d.icon.dynamicLayoutVertexBuffer.updateData(ie)}d.text.dynamicLayoutVertexBuffer.updateData(oe)}function O_(d,i,h){return h.iconsInText&&i?"symbolTextAndIcon":d?"symbolSDF":"symbolIcon"}function jh(d,i,h,_,v,w,E,k,F,R,O,W){const te=d.context,oe=te.gl,ie=d.transform,Q=k==="map",ye=F==="map",he=Q&&h.layout.get("symbol-placement")!=="point",_e=Q&&!ye&&!he,xe=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Te=!1;const pe=d.depthModeForSublayer(0,o.DepthMode.ReadOnly),Se=[o.mercatorXfromLng(ie.center.lng),o.mercatorYfromLat(ie.center.lat)],je=h.layout.get("text-variable-anchor"),Ye=ie.projection.name==="globe",tt=Ye?o.globeToMercatorTransition(ie.zoom):0,Qe=[],mt=[];d.terrain&&ye&&mt.push("PITCH_WITH_MAP_TERRAIN"),Ye&&mt.push("PROJECTION_GLOBE_VIEW");for(const Ge of _){const _t=i.getTile(Ge),ht=_t.getBucket(h);if(!ht||ht.projection!==ie.projection.name)continue;const Rt=v?ht.text:ht.icon;if(!Rt||ht.fullyClipped||!Rt.segments.get().length)continue;const rt=Rt.programConfigurations.get(h.id),Ft=v||ht.sdfIcons,$t=v?ht.textSizeData:ht.iconSizeData,Pt=ye||ie.pitch!==0,Lt=o.evaluateSizeForZoom($t,ie.zoom);let Ht,er,jt,qt,fr=[0,0],jr=null;if(v){if(er=_t.glyphAtlasTexture,jt=oe.LINEAR,Ht=_t.glyphAtlasTexture.size,ht.iconsInText){fr=_t.imageAtlasTexture.size,jr=_t.imageAtlasTexture;const Pi=$t.kind==="composite"||$t.kind==="camera";qt=Pt||d.options.rotating||d.options.zooming||Pi?oe.LINEAR:oe.NEAREST}}else{const Pi=h.layout.get("icon-size").constantOr(0)!==1||ht.iconsNeedLinear;er=_t.imageAtlasTexture,jt=Ft||d.options.rotating||d.options.zooming||Pi||Pt?oe.LINEAR:oe.NEAREST,Ht=_t.imageAtlasTexture.size}const $n=d.transform.calculatePixelsToTileUnitsMatrix(_t),Wn=Si(Ge.projMatrix,_t.tileID.canonical,ye,Q,d.transform,$n),Di=d.terrain&&ye&&he?o.invert(o.create(),Wn):Vh,ma=ii(Ge.projMatrix,_t.tileID.canonical,ye,Q,d.transform,$n),Qa=je&&ht.hasTextData(),ks=h.layout.get("icon-text-fit")!=="none"&&Qa&&ht.hasIconData();if(he){const Pi=ie.elevation,ro=Pi?Pi.getAtTileOffsetFunc(Ge,ie.center.lat,ie.worldSize,ie.projection):Jp=>[0,0,0];Ml(ht,Ge.projMatrix,d,v,Wn,ma,ye,R,ro,Ge)}const es=he||v&&je||ks,$r=d.translatePosMatrix(Ge.projMatrix,_t,w,E),qr=es?Vh:Wn,mr=d.translatePosMatrix(ma,_t,w,E,!0),sn=ie.projection.createInversionMatrix(ie,Ge.canonical),Fi=es?mt.concat(["PROJECTED_POS_ON_VIEWPORT"]):mt,Gr=Ft&&h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let qi;qi=Ft?ht.iconsInText?Lo($t.kind,Lt,_e,ye,d,$r,qr,mr,Ht,fr,Ge,tt,Se,sn):Qs($t.kind,Lt,_e,ye,d,$r,qr,mr,v,Ht,!0,Ge,tt,Se,sn):Nh($t.kind,Lt,_e,ye,d,$r,qr,mr,v,Ht,Ge,tt,Se,sn);const rc={program:d.useProgram(O_(Ft,v,ht),rt,Fi),buffers:Rt,uniformValues:qi,atlasTexture:er,atlasTextureIcon:jr,atlasInterpolation:jt,atlasInterpolationIcon:qt,isSDF:Ft,hasHalo:Gr,tile:_t,labelPlaneMatrixInv:Di};if(xe&&ht.canOverlap){Te=!0;const Pi=Rt.segments.get();for(const ro of Pi)Qe.push({segments:new o.SegmentVector([ro]),sortKey:ro.sortKey,state:rc})}else Qe.push({segments:Rt.segments,sortKey:0,state:rc})}Te&&Qe.sort((Ge,_t)=>Ge.sortKey-_t.sortKey);for(const Ge of Qe){const _t=Ge.state;if(d.terrain&&d.terrain.setupElevationDraw(_t.tile,_t.program,{useDepthForOcclusion:!Ye,labelPlaneMatrixInv:_t.labelPlaneMatrixInv}),te.activeTexture.set(oe.TEXTURE0),_t.atlasTexture.bind(_t.atlasInterpolation,oe.CLAMP_TO_EDGE),_t.atlasTextureIcon&&(te.activeTexture.set(oe.TEXTURE1),_t.atlasTextureIcon&&_t.atlasTextureIcon.bind(_t.atlasInterpolationIcon,oe.CLAMP_TO_EDGE)),_t.isSDF){const ht=_t.uniformValues;_t.hasHalo&&(ht.u_is_halo=1,Ep(_t.buffers,Ge.segments,h,d,_t.program,pe,O,W,ht)),ht.u_is_halo=0}Ep(_t.buffers,Ge.segments,h,d,_t.program,pe,O,W,_t.uniformValues)}}function Ep(d,i,h,_,v,w,E,k,F){const R=_.context;v.draw(R,R.gl.TRIANGLES,w,E,k,o.CullFaceMode.disabled,F,h.id,d.layoutVertexBuffer,d.indexBuffer,i,h.paint,_.transform.zoom,d.programConfigurations.get(h.id),d.dynamicLayoutVertexBuffer,d.opacityVertexBuffer)}function iu(d,i,h,_,v,w,E){const k=d.context.gl,F=h.paint.get("fill-pattern"),R=F&&F.constantOr(1),O=h.getCrossfadeParameters();let W,te,oe,ie,Q;E?(te=R&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",W=k.LINES):(te=R?"fillPattern":"fill",W=k.TRIANGLES);for(const ye of _){const he=i.getTile(ye);if(R&&!he.patternsLoaded())continue;const _e=he.getBucket(h);if(!_e)continue;d.prepareDrawTile();const xe=_e.programConfigurations.get(h.id),Te=d.useProgram(te,xe);R&&(d.context.activeTexture.set(k.TEXTURE0),he.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),xe.updatePaintBuffers(O));const pe=F.constantOr(null);if(pe&&he.imageAtlas){const je=he.imageAtlas,Ye=je.patternPositions[pe.to.toString()],tt=je.patternPositions[pe.from.toString()];Ye&&tt&&xe.setConstantPatternPositions(Ye,tt)}const Se=d.translatePosMatrix(ye.projMatrix,he,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(E){ie=_e.indexBuffer2,Q=_e.segments2;const je=d.terrain&&d.terrain.renderingToTexture?d.terrain.drapeBufferSize:[k.drawingBufferWidth,k.drawingBufferHeight];oe=te==="fillOutlinePattern"&&R?gp(Se,d,O,he,je):ru(Se,je)}else ie=_e.indexBuffer,Q=_e.segments,oe=R?tu(Se,d,O,he):eu(Se);d.prepareDrawProgram(d.context,Te,ye.toUnwrapped()),Te.draw(d.context,W,v,d.stencilModeForClipping(ye),w,o.CullFaceMode.disabled,oe,h.id,_e.layoutVertexBuffer,ie,Q,h.paint,d.transform.zoom,xe)}}function Ro(d,i,h,_,v,w,E){const k=d.context,F=k.gl,R=d.transform,O=h.paint.get("fill-extrusion-pattern"),W=O.constantOr(1),te=h.getCrossfadeParameters(),oe=h.paint.get("fill-extrusion-opacity"),ie=function(xe){if(xe.projection.name!=="globe")return 0;const Te=Math.PI/32,pe=Math.tan(Te),Se=o.earthRadius;return Se*Math.sqrt(1+2*pe*pe)-Se}(R),Q=R.projection.name==="globe",ye=Q?o.globeToMercatorTransition(R.zoom):0,he=[o.mercatorXfromLng(R.center.lng),o.mercatorYfromLat(R.center.lat)],_e=[];Q&&_e.push("PROJECTION_GLOBE_VIEW");for(const xe of _){const Te=i.getTile(xe),pe=Te.getBucket(h);if(!pe||pe.projection!==R.projection.name)continue;const Se=pe.programConfigurations.get(h.id),je=d.useProgram(W?"fillExtrusionPattern":"fillExtrusion",Se,_e);if(d.terrain){const _t=d.terrain;if(d.style.terrainSetForDrapingOnly())_t.setupElevationDraw(Te,je,{useMeterToDem:!0});else{if(!pe.enableTerrain)continue;if(_t.setupElevationDraw(Te,je,{useMeterToDem:!0}),Vl(k,i,xe,pe,h,_t),!pe.centroidVertexBuffer){const ht=je.attributes.a_centroid_pos;ht!==void 0&&F.vertexAttrib2f(ht,0,0)}}}W&&(d.context.activeTexture.set(F.TEXTURE0),Te.imageAtlasTexture.bind(F.LINEAR,F.CLAMP_TO_EDGE),Se.updatePaintBuffers(te));const Ye=O.constantOr(null);if(Ye&&Te.imageAtlas){const _t=Te.imageAtlas,ht=_t.patternPositions[Ye.to.toString()],Rt=_t.patternPositions[Ye.from.toString()];ht&&Rt&&Se.setConstantPatternPositions(ht,Rt)}const tt=d.translatePosMatrix(xe.projMatrix,Te,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Qe=R.projection.createInversionMatrix(R,xe.canonical),mt=h.paint.get("fill-extrusion-vertical-gradient"),Ge=W?Qc(tt,d,mt,oe,xe,te,Te,ie,ye,he,Qe):Jc(tt,d,mt,oe,xe,ie,ye,he,Qe);d.prepareDrawProgram(k,je,xe.toUnwrapped()),je.draw(k,k.gl.TRIANGLES,v,w,E,o.CullFaceMode.backCCW,Ge,h.id,pe.layoutVertexBuffer,pe.indexBuffer,pe.segments,h.paint,d.transform.zoom,Se,d.terrain?pe.centroidVertexBuffer:null,Q?pe.layoutVertexExtBuffer:null)}}function Vl(d,i,h,_,v,w){const E=[he=>{let _e=he.canonical.x-1,xe=he.wrap;return _e<0&&(_e=(1<<he.canonical.z)-1,xe--),new o.OverscaledTileID(he.overscaledZ,xe,he.canonical.z,_e,he.canonical.y)},he=>{let _e=he.canonical.x+1,xe=he.wrap;return _e===1<<he.canonical.z&&(_e=0,xe++),new o.OverscaledTileID(he.overscaledZ,xe,he.canonical.z,_e,he.canonical.y)},he=>new o.OverscaledTileID(he.overscaledZ,he.wrap,he.canonical.z,he.canonical.x,(he.canonical.y===0?1<<he.canonical.z:he.canonical.y)-1),he=>new o.OverscaledTileID(he.overscaledZ,he.wrap,he.canonical.z,he.canonical.x,he.canonical.y===(1<<he.canonical.z)-1?0:he.canonical.y+1)],k=he=>{const _e=i.getSource().minzoom,xe=pe=>{const Se=i.getTileByID(pe);if(Se&&Se.hasData())return Se.getBucket(v)},Te=[0,-1,1];for(const pe of Te){if(he.overscaledZ+pe<_e)continue;const Se=xe(he.calculateScaledKey(he.overscaledZ+pe));if(Se)return Se}},F=[0,0,0],R=(he,_e)=>(F[0]=Math.min(he.min.y,_e.min.y),F[1]=Math.max(he.max.y,_e.max.y),F[2]=o.EXTENT-_e.min.x>he.max.x?_e.min.x-o.EXTENT:he.max.x,F),O=(he,_e)=>(F[0]=Math.min(he.min.x,_e.min.x),F[1]=Math.max(he.max.x,_e.max.x),F[2]=o.EXTENT-_e.min.y>he.max.y?_e.min.y-o.EXTENT:he.max.y,F),W=[(he,_e)=>R(he,_e),(he,_e)=>R(_e,he),(he,_e)=>O(he,_e),(he,_e)=>O(_e,he)],te=new o.pointGeometry(0,0);let oe,ie,Q;const ye=(he,_e,xe,Te,pe)=>{const Se=[[Te?xe:he,Te?he:xe,0],[Te?xe:_e,Te?_e:xe,0]],je=pe<0?o.EXTENT+pe:pe,Ye=[Te?je:(he+_e)/2,Te?(he+_e)/2:je,0];return xe===0&&pe<0||xe!==0&&pe>0?w.getForTilePoints(Q,[Ye],!0,ie):Se.push(Ye),w.getForTilePoints(h,Se,!0,oe),Math.max(Se[0][2],Se[1][2],Ye[2])/w.exaggeration()};for(let he=0;he<4;he++){const _e=(he<2?1:5)-he,xe=_.borders[he];if(xe.length===0)continue;const Te=Q=E[he](h),pe=k(Te);if(!(pe&&pe instanceof o.FillExtrusionBucket&&pe.enableTerrain)||_.borderDoneWithNeighborZ[he]===pe.canonical.z&&pe.borderDoneWithNeighborZ[_e]===_.canonical.z||(ie=w.findDEMTileFor(Te),!ie||!ie.dem))continue;if(!oe){const tt=w.findDEMTileFor(h);if(!tt||!tt.dem)return;oe=tt}const Se=pe.borders[_e];let je=0;const Ye=pe.borderDoneWithNeighborZ[_e]!==_.canonical.z;if(_.canonical.z===pe.canonical.z){for(let tt=0;tt<xe.length;tt++){const Qe=_.featuresOnBorder[xe[tt]],mt=Qe.borders[he];let Ge;for(;je<Se.length&&(Ge=pe.featuresOnBorder[Se[je]],!(Ge.borders[_e][1]>mt[0]+3));)Ye&&pe.encodeCentroid(void 0,Ge,!1),je++;if(Ge&&je<Se.length){const _t=je;let ht=0;for(;!(Ge.borders[_e][0]>mt[1]-3)&&(ht++,++je!==Se.length);)Ge=pe.featuresOnBorder[Se[je]];if(Ge=pe.featuresOnBorder[Se[_t]],Qe.intersectsCount()>1||Ge.intersectsCount()>1||ht!==1){ht!==1&&(je=_t),_.encodeCentroid(void 0,Qe,!1),Ye&&pe.encodeCentroid(void 0,Ge,!1);continue}const Rt=W[he](Qe,Ge),rt=he%2?o.EXTENT-1:0;te.x=ye(Rt[0],Math.min(o.EXTENT-1,Rt[1]),rt,he<2,Rt[2]),te.y=0,_.encodeCentroid(te,Qe,!1),Ye&&pe.encodeCentroid(te,Ge,!1)}else _.encodeCentroid(void 0,Qe,!1)}_.borderDoneWithNeighborZ[he]=pe.canonical.z,_.needsCentroidUpdate=!0,Ye&&(pe.borderDoneWithNeighborZ[_e]=_.canonical.z,pe.needsCentroidUpdate=!0)}else{for(const tt of xe)_.encodeCentroid(void 0,_.featuresOnBorder[tt],!1);if(Ye){for(const tt of Se)pe.encodeCentroid(void 0,pe.featuresOnBorder[tt],!1);pe.borderDoneWithNeighborZ[_e]=_.canonical.z,pe.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[he]=pe.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&_.centroidVertexArray.length!==0)&&_.uploadCentroid(d)}const Gh=new o.Color(1,0,0,1),$h=new o.Color(0,1,0,1),bp=new o.Color(0,0,1,1),au=new o.Color(1,0,1,1),su=new o.Color(0,1,1,1);function St(d,i,h,_){jl(d,0,i+h/2,d.transform.width,h,_)}function Hi(d,i,h,_){jl(d,i-h/2,0,h,d.transform.height,_)}function jl(d,i,h,_,v,w){const E=d.context,k=E.gl;k.enable(k.SCISSOR_TEST),k.scissor(i*o.exported.devicePixelRatio,h*o.exported.devicePixelRatio,_*o.exported.devicePixelRatio,v*o.exported.devicePixelRatio),E.clear({color:w}),k.disable(k.SCISSOR_TEST)}function Sp(d,i,h){const _=d.context,v=_.gl,w=d.transform.projection.name==="globe",E=h.projMatrix,k=d.useProgram("debug",null,w?["PROJECTION_GLOBE_VIEW"]:null),F=i.getTileByID(h.key);d.terrain&&d.terrain.setupElevationDraw(F,k);const R=o.DepthMode.disabled,O=o.StencilMode.disabled,W=d.colorModeForRenderPass(),te="$debug";_.activeTexture.set(v.TEXTURE0),d.emptyTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),w?F._makeGlobeTileDebugBuffers(d.context,d.transform.projection):F._makeDebugTileBoundsBuffers(d.context,d.transform.projection);const oe=F._tileDebugBuffer||d.debugBuffer,ie=F._tileDebugIndexBuffer||d.debugIndexBuffer,Q=F._tileDebugSegments||d.debugSegments;k.draw(_,v.LINE_STRIP,R,O,W,o.CullFaceMode.disabled,yp(E,o.Color.red),te,oe,ie,Q,null,null,null,F._globeTileDebugBorderBuffer);const ye=F.latestRawTileData,he=Math.floor((ye&&ye.byteLength||0)/1024),_e=i.getTile(h).tileSize,xe=512/Math.min(_e,512)*(h.overscaledZ/d.transform.zoom)*.5;let Te=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Te+=` => ${h.overscaledZ}`),function(Ye,tt){Ye.initDebugOverlayCanvas();const Qe=Ye.debugOverlayCanvas,mt=Ye.context.gl,Ge=Ye.debugOverlayCanvas.getContext("2d");Ge.clearRect(0,0,Qe.width,Qe.height),Ge.shadowColor="white",Ge.shadowBlur=2,Ge.lineWidth=1.5,Ge.strokeStyle="white",Ge.textBaseline="top",Ge.font="bold 36px Open Sans, sans-serif",Ge.fillText(tt,5,5),Ge.strokeText(tt,5,5),Ye.debugOverlayTexture.update(Qe),Ye.debugOverlayTexture.bind(mt.LINEAR,mt.CLAMP_TO_EDGE)}(d,`${Te} ${he}kb`);const pe=F._tileDebugTextBuffer||d.debugBuffer,Se=F._tileDebugTextIndexBuffer||d.quadTriangleIndexBuffer,je=F._tileDebugTextSegments||d.debugSegments;k.draw(_,v.TRIANGLES,R,O,o.ColorMode.alphaBlended,o.CullFaceMode.disabled,yp(E,o.Color.transparent,xe),te,pe,Se,je,null,null,null,F._globeTileDebugTextBuffer)}const kp=o.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:zo}=kp;function Ka(d,i,h,_){d.emplaceBack(i,h,_)}class Gl{constructor(i){this.vertexArray=new o.StructArrayLayout3f12,this.indices=new o.StructArrayLayout3ui6,Ka(this.vertexArray,-1,-1,1),Ka(this.vertexArray,1,-1,1),Ka(this.vertexArray,-1,1,1),Ka(this.vertexArray,1,1,1),Ka(this.vertexArray,-1,-1,-1),Ka(this.vertexArray,1,-1,-1),Ka(this.vertexArray,-1,1,-1),Ka(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,zo),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=o.SegmentVector.simpleSegment(0,0,36,12)}}function ws(d,i,h,_,v,w){const E=d.gl,k=i.paint.get("sky-atmosphere-color"),F=i.paint.get("sky-atmosphere-halo-color"),R=i.paint.get("sky-atmosphere-sun-intensity"),O=((W,te,oe,ie,Q)=>({u_matrix_3f:W,u_sun_direction:te,u_sun_intensity:oe,u_color_tint_r:[ie.r,ie.g,ie.b,ie.a],u_color_tint_m:[Q.r,Q.g,Q.b,Q.a],u_luminance:5e-5}))(o.fromMat4(o.create$1(),_),v,R,k,F);E.framebufferTexture2D(E.FRAMEBUFFER,E.COLOR_ATTACHMENT0,E.TEXTURE_CUBE_MAP_POSITIVE_X+w,i.skyboxTexture,0),h.draw(d,E.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,o.ColorMode.unblended,o.CullFaceMode.frontCW,O,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}function Ts(d,i){return o.transformMat4(d,d,i)}const Wh={symbol:function(d,i,h,_,v){if(d.renderPass!=="translucent")return;const w=o.StencilMode.disabled,E=d.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(k,F,R,O,W,te,oe){const ie=F.transform,Q=W==="map",ye=te==="map";for(const he of k){const _e=O.getTile(he),xe=_e.getBucket(R);if(!xe||xe.projection!==ie.projection.name||!xe.text||!xe.text.segments.get().length)continue;const Te=o.evaluateSizeForZoom(xe.textSizeData,ie.zoom),pe=F.transform.calculatePixelsToTileUnitsMatrix(_e),Se=Si(he.projMatrix,_e.tileID.canonical,ye,Q,F.transform,pe),je=R.layout.get("icon-text-fit")!=="none"&&xe.hasIconData();if(Te){const Ye=Math.pow(2,ie.zoom-_e.tileID.overscaledZ);z_(xe,Q,ye,oe,o.symbolSize,ie,Se,he,Ye,Te,je,ie.projection)}}}(_,d,h,i,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),v),h.paint.get("icon-opacity").constantOr(1)!==0&&jh(d,i,h,_,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),w,E),h.paint.get("text-opacity").constantOr(1)!==0&&jh(d,i,h,_,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),w,E),i.map.showCollisionBoxes&&(Tp(d,i,h,_,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),Tp(d,i,h,_,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(d,i,h,_){if(d.renderPass!=="translucent")return;const v=h.paint.get("circle-opacity"),w=h.paint.get("circle-stroke-width"),E=h.paint.get("circle-stroke-opacity"),k=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(v.constantOr(1)===0&&(w.constantOr(1)===0||E.constantOr(1)===0))return;const F=d.context,R=F.gl,O=d.transform,W=d.depthModeForSublayer(0,o.DepthMode.ReadOnly),te=o.StencilMode.disabled,oe=d.colorModeForRenderPass(),ie=O.projection.name==="globe",Q=[o.mercatorXfromLng(O.center.lng),o.mercatorYfromLat(O.center.lat)],ye=[];for(let _e=0;_e<_.length;_e++){const xe=_[_e],Te=i.getTile(xe),pe=Te.getBucket(h);if(!pe)continue;const Se=pe.programConfigurations.get(h.id),je=D_(h);ie&&je.push("PROJECTION_GLOBE_VIEW");const Ye=d.useProgram("circle",Se,je),tt=pe.layoutVertexBuffer,Qe=pe.globeExtVertexBuffer,mt=pe.indexBuffer,Ge=O.projection.createInversionMatrix(O,xe.canonical),_t={programConfiguration:Se,program:Ye,layoutVertexBuffer:tt,globeExtVertexBuffer:Qe,indexBuffer:mt,uniformValues:Po(d,xe,Te,Ge,Q,h),tile:Te};if(k){const ht=pe.segments.get();for(const Rt of ht)ye.push({segments:new o.SegmentVector([Rt]),sortKey:Rt.sortKey,state:_t})}else ye.push({segments:pe.segments,sortKey:0,state:_t})}k&&ye.sort((_e,xe)=>_e.sortKey-xe.sortKey);const he={useDepthForOcclusion:!ie};for(const _e of ye){const{programConfiguration:xe,program:Te,layoutVertexBuffer:pe,globeExtVertexBuffer:Se,indexBuffer:je,uniformValues:Ye,tile:tt}=_e.state,Qe=_e.segments;d.terrain&&d.terrain.setupElevationDraw(tt,Te,he),d.prepareDrawProgram(F,Te,tt.tileID.toUnwrapped()),Te.draw(F,R.TRIANGLES,W,te,oe,o.CullFaceMode.disabled,Ye,h.id,pe,je,Qe,h.paint,O.zoom,xe,ie?Se:null)}},heatmap:function(d,i,h,_){if(h.paint.get("heatmap-opacity")!==0)if(d.renderPass==="offscreen"){const v=d.context,w=v.gl,E=o.StencilMode.disabled,k=new o.ColorMode([w.ONE,w.ONE],o.Color.transparent,[!0,!0,!0,!0]);(function(te,oe,ie){const Q=te.gl;te.activeTexture.set(Q.TEXTURE1),te.viewport.set([0,0,oe.width/4,oe.height/4]);let ye=ie.heatmapFbo;if(ye)Q.bindTexture(Q.TEXTURE_2D,ye.colorAttachment.get()),te.bindFramebuffer.set(ye.framebuffer);else{const he=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,he),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.LINEAR),ye=ie.heatmapFbo=te.createFramebuffer(oe.width/4,oe.height/4,!1),function(_e,xe,Te,pe){const Se=_e.gl;Se.texImage2D(Se.TEXTURE_2D,0,Se.RGBA,xe.width/4,xe.height/4,0,Se.RGBA,_e.extRenderToTextureHalfFloat?_e.extTextureHalfFloat.HALF_FLOAT_OES:Se.UNSIGNED_BYTE,null),pe.colorAttachment.set(Te)}(te,oe,he,ye)}})(v,d,h),v.clear({color:o.Color.transparent});const F=d.transform,R=F.projection.name==="globe",O=R?["PROJECTION_GLOBE_VIEW"]:null,W=[o.mercatorXfromLng(F.center.lng),o.mercatorYfromLat(F.center.lat)];for(let te=0;te<_.length;te++){const oe=_[te];if(i.hasRenderableParent(oe))continue;const ie=i.getTile(oe),Q=ie.getBucket(h);if(!Q)continue;const ye=Q.programConfigurations.get(h.id),he=d.useProgram("heatmap",ye,O),{zoom:_e}=d.transform;d.terrain&&d.terrain.setupElevationDraw(ie,he),d.prepareDrawProgram(v,he,oe.toUnwrapped());const xe=F.projection.createInversionMatrix(F,oe.canonical);he.draw(v,w.TRIANGLES,o.DepthMode.disabled,E,k,o.CullFaceMode.disabled,L_(d,oe,ie,xe,W,_e,h.paint.get("heatmap-intensity")),h.id,Q.layoutVertexBuffer,Q.indexBuffer,Q.segments,h.paint,d.transform.zoom,ye,R?Q.globeExtVertexBuffer:null)}v.viewport.set([0,0,d.width,d.height])}else d.renderPass==="translucent"&&(d.context.setColorMode(d.colorModeForRenderPass()),function(v,w){const E=v.context,k=E.gl,F=w.heatmapFbo;if(!F)return;E.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,F.colorAttachment.get()),E.activeTexture.set(k.TEXTURE1);let R=w.colorRampTexture;R||(R=w.colorRampTexture=new o.Texture(E,w.colorRamp,k.RGBA)),R.bind(k.LINEAR,k.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(E,k.TRIANGLES,o.DepthMode.disabled,o.StencilMode.disabled,v.colorModeForRenderPass(),o.CullFaceMode.disabled,((O,W,te,oe)=>({u_image:0,u_color_ramp:1,u_opacity:W.paint.get("heatmap-opacity")}))(0,w),w.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,w.paint,v.transform.zoom)}(d,h))},line:function(d,i,h,_){if(d.renderPass!=="translucent")return;const v=h.paint.get("line-opacity"),w=h.paint.get("line-width");if(v.constantOr(1)===0||w.constantOr(1)===0)return;const E=d.depthModeForSublayer(0,o.DepthMode.ReadOnly),k=d.colorModeForRenderPass(),F=d.terrain&&d.terrain.renderingToTexture?1:o.exported.devicePixelRatio,R=h.paint.get("line-dasharray"),O=R.constantOr(1),W=h.layout.get("line-cap"),te=h.paint.get("line-pattern"),oe=te.constantOr(1),ie=h.paint.get("line-gradient"),Q=h.getCrossfadeParameters(),ye=oe?"linePattern":"line",he=d.context,_e=he.gl,xe=(pe=>{const Se=[];Oh(pe)&&Se.push("RENDER_LINE_DASH"),pe.paint.get("line-gradient")&&Se.push("RENDER_LINE_GRADIENT");const je=pe.paint.get("line-pattern").constantOr(1),Ye=pe.paint.get("line-opacity").constantOr(1)!==1;return!je&&Ye&&Se.push("RENDER_LINE_ALPHA_DISCARD"),Se})(h);let Te=xe.includes("RENDER_LINE_ALPHA_DISCARD");d.terrain&&d.terrain.clipOrMaskOverlapStencilType()&&(Te=!1);for(const pe of _){const Se=i.getTile(pe);if(oe&&!Se.patternsLoaded())continue;const je=Se.getBucket(h);if(!je)continue;d.prepareDrawTile();const Ye=je.programConfigurations.get(h.id),tt=d.useProgram(ye,Ye,xe),Qe=te.constantOr(null);if(Qe&&Se.imageAtlas){const rt=Se.imageAtlas,Ft=rt.patternPositions[Qe.to.toString()],$t=rt.patternPositions[Qe.from.toString()];Ft&&$t&&Ye.setConstantPatternPositions(Ft,$t)}const mt=R.constantOr(null),Ge=W.constantOr(null);if(!oe&&mt&&Ge&&Se.lineAtlas){const rt=Se.lineAtlas,Ft=rt.getDash(mt.to,Ge),$t=rt.getDash(mt.from,Ge);Ft&&$t&&Ye.setConstantPatternPositions(Ft,$t)}const _t=d.terrain?pe.projMatrix:null,ht=oe?zh(d,Se,h,Q,_t,F):R_(d,Se,h,Q,_t,je.lineClipsArray.length,F);if(ie){const rt=je.gradients[h.id];let Ft=rt.texture;if(h.gradientVersion!==rt.version){let $t=256;if(h.stepInterpolant){const Pt=i.getSource().maxzoom,Lt=pe.canonical.z===Pt?Math.ceil(1<<d.transform.maxZoom-pe.canonical.z):1;$t=o.clamp(o.nextPowerOfTwo(je.maxLineLength/o.EXTENT*1024*Lt),256,he.maxTextureSize)}rt.gradient=o.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:$t,image:rt.gradient||void 0,clips:je.lineClipsArray}),rt.texture?rt.texture.update(rt.gradient):rt.texture=new o.Texture(he,rt.gradient,_e.RGBA),rt.version=h.gradientVersion,Ft=rt.texture}he.activeTexture.set(_e.TEXTURE1),Ft.bind(h.stepInterpolant?_e.NEAREST:_e.LINEAR,_e.CLAMP_TO_EDGE)}O&&(he.activeTexture.set(_e.TEXTURE0),Se.lineAtlasTexture.bind(_e.LINEAR,_e.REPEAT),Ye.updatePaintBuffers(Q)),oe&&(he.activeTexture.set(_e.TEXTURE0),Se.imageAtlasTexture.bind(_e.LINEAR,_e.CLAMP_TO_EDGE),Ye.updatePaintBuffers(Q)),d.prepareDrawProgram(he,tt,pe.toUnwrapped());const Rt=rt=>{tt.draw(he,_e.TRIANGLES,E,rt,k,o.CullFaceMode.disabled,ht,h.id,je.layoutVertexBuffer,je.indexBuffer,je.segments,h.paint,d.transform.zoom,Ye,je.layoutVertexBuffer2)};if(Te){const rt=d.stencilModeForClipping(pe).ref;rt===0&&d.terrain&&he.clear({stencil:0});const Ft={func:_e.EQUAL,mask:255};ht.u_alpha_discard_threshold=.8,Rt(new o.StencilMode(Ft,rt,255,_e.KEEP,_e.KEEP,_e.INVERT)),ht.u_alpha_discard_threshold=0,Rt(new o.StencilMode(Ft,rt,255,_e.KEEP,_e.KEEP,_e.KEEP))}else Rt(d.stencilModeForClipping(pe))}Te&&(d.resetStencilClippingMasks(),d.terrain&&he.clear({stencil:0}))},fill:function(d,i,h,_){const v=h.paint.get("fill-color"),w=h.paint.get("fill-opacity");if(w.constantOr(1)===0)return;const E=d.colorModeForRenderPass(),k=h.paint.get("fill-pattern"),F=d.opaquePassEnabledForLayer()&&!k.constantOr(1)&&v.constantOr(o.Color.transparent).a===1&&w.constantOr(0)===1?"opaque":"translucent";if(d.renderPass===F){const R=d.depthModeForSublayer(1,d.renderPass==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly);iu(d,i,h,_,R,E,!1)}if(d.renderPass==="translucent"&&h.paint.get("fill-antialias")){const R=d.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,o.DepthMode.ReadOnly);iu(d,i,h,_,R,E,!0)}},"fill-extrusion":function(d,i,h,_){const v=h.paint.get("fill-extrusion-opacity");if(v!==0&&d.renderPass==="translucent"){const w=new o.DepthMode(d.context.gl.LEQUAL,o.DepthMode.ReadWrite,d.depthRangeFor3D);if(v!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))Ro(d,i,h,_,w,o.StencilMode.disabled,o.ColorMode.disabled),Ro(d,i,h,_,w,d.stencilModeFor3D(),d.colorModeForRenderPass()),d.resetStencilClippingMasks();else{const E=d.colorModeForRenderPass();Ro(d,i,h,_,w,o.StencilMode.disabled,E)}}},hillshade:function(d,i,h,_){if(d.renderPass!=="offscreen"&&d.renderPass!=="translucent")return;const v=d.context,w=d.depthModeForSublayer(0,o.DepthMode.ReadOnly),E=d.colorModeForRenderPass(),k=d.terrain&&d.terrain.renderingToTexture,[F,R]=d.renderPass!=="translucent"||k?[{},_]:d.stencilConfigForOverlap(_);for(const O of R){const W=i.getTile(O);if(W.needsHillshadePrepare&&d.renderPass==="offscreen")Mh(d,W,h,w,o.StencilMode.disabled,E);else if(d.renderPass==="translucent"){const te=k&&d.terrain?d.terrain.stencilModeForRTTOverlap(O):F[O.overscaledZ];pp(d,O,W,h,w,te,E)}}v.viewport.set([0,0,d.width,d.height]),d.resetStencilClippingMasks()},raster:function(d,i,h,_,v,w){if(d.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!_.length)return;const E=d.context,k=E.gl,F=i.getSource(),R=d.useProgram("raster"),O=d.colorModeForRenderPass(),W=d.terrain&&d.terrain.renderingToTexture,[te,oe]=F instanceof Ce||W?[{},_]:d.stencilConfigForOverlap(_),ie=oe[oe.length-1].overscaledZ,Q=!d.options.moving;for(const ye of oe){const he=W?o.DepthMode.disabled:d.depthModeForSublayer(ye.overscaledZ-ie,h.paint.get("raster-opacity")===1?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly,k.LESS),_e=ye.toUnwrapped(),xe=i.getTile(ye);if(W&&(!xe||!xe.hasData()))continue;const Te=W?ye.projMatrix:d.transform.calculateProjMatrix(_e,Q),pe=d.terrain&&W?d.terrain.stencilModeForRTTOverlap(ye):te[ye.overscaledZ],Se=w?0:h.paint.get("raster-fade-duration");xe.registerFadeDuration(Se);const je=i.findLoadedParent(ye,0),Ye=Ph(xe,je,i,d.transform,Se);let tt,Qe;d.terrain&&d.terrain.prepareDrawTile();const mt=h.paint.get("raster-resampling")==="nearest"?k.NEAREST:k.LINEAR;E.activeTexture.set(k.TEXTURE0),xe.texture.bind(mt,k.CLAMP_TO_EDGE),E.activeTexture.set(k.TEXTURE1),je?(je.texture.bind(mt,k.CLAMP_TO_EDGE),tt=Math.pow(2,je.tileID.overscaledZ-xe.tileID.overscaledZ),Qe=[xe.tileID.canonical.x*tt%1,xe.tileID.canonical.y*tt%1]):xe.texture.bind(mt,k.CLAMP_TO_EDGE);const Ge=vp(Te,Qe||[0,0],tt||1,Ye,h,F instanceof Ce?F.perspectiveTransform:[0,0]);if(d.prepareDrawProgram(E,R,_e),F instanceof Ce)F.boundsBuffer&&F.boundsSegments&&R.draw(E,k.TRIANGLES,he,o.StencilMode.disabled,O,o.CullFaceMode.disabled,Ge,h.id,F.boundsBuffer,d.quadTriangleIndexBuffer,F.boundsSegments);else{const{tileBoundsBuffer:_t,tileBoundsIndexBuffer:ht,tileBoundsSegments:Rt}=d.getTileBoundsBuffers(xe);R.draw(E,k.TRIANGLES,he,pe,O,o.CullFaceMode.disabled,Ge,h.id,_t,ht,Rt)}}d.resetStencilClippingMasks()},background:function(d,i,h,_){const v=h.paint.get("background-color"),w=h.paint.get("background-opacity");if(w===0)return;const E=d.context,k=E.gl,F=d.transform,R=F.tileSize,O=h.paint.get("background-pattern");if(d.isPatternMissing(O))return;const W=!O&&v.a===1&&w===1&&d.opaquePassEnabledForLayer()?"opaque":"translucent";if(d.renderPass!==W)return;const te=o.StencilMode.disabled,oe=d.depthModeForSublayer(0,W==="opaque"?o.DepthMode.ReadWrite:o.DepthMode.ReadOnly),ie=d.colorModeForRenderPass(),Q=d.useProgram(O?"backgroundPattern":"background");let ye,he=_;he||(ye=d.getBackgroundTiles(),he=Object.values(ye).map(xe=>xe.tileID)),O&&(E.activeTexture.set(k.TEXTURE0),d.imageManager.bind(d.context));const _e=h.getCrossfadeParameters();for(const xe of he){const Te=xe.toUnwrapped(),pe=_?xe.projMatrix:d.transform.calculateProjMatrix(Te);d.prepareDrawTile();const Se=i?i.getTile(xe):ye?ye[xe.key]:new o.Tile(xe,R,F.zoom,d),je=O?Uh(pe,w,d,O,{tileID:xe,tileSize:R},_e):wp(pe,w,v);d.prepareDrawProgram(E,Q,Te);const{tileBoundsBuffer:Ye,tileBoundsIndexBuffer:tt,tileBoundsSegments:Qe}=d.getTileBoundsBuffers(Se);Q.draw(E,k.TRIANGLES,oe,te,ie,o.CullFaceMode.disabled,je,h.id,Ye,tt,Qe)}},sky:function(d,i,h){const _=d.transform,v=_.projection.name==="mercator"||_.projection.name==="globe"?1:o.smoothstep(7,8,_.zoom),w=h.paint.get("sky-opacity")*v;if(w===0)return;const E=d.context,k=h.paint.get("sky-type"),F=new o.DepthMode(E.gl.LEQUAL,o.DepthMode.ReadOnly,[0,1]),R=d.frameCounter/1e3%1;k==="atmosphere"?d.renderPass==="offscreen"?h.needsSkyboxCapture(d)&&(function(O,W,te,oe){const ie=O.context,Q=ie.gl;let ye=W.skyboxFbo;if(!ye){ye=W.skyboxFbo=ie.createFramebuffer(32,32,!1),W.skyboxGeometry=new Gl(ie),W.skyboxTexture=ie.gl.createTexture(),Q.bindTexture(Q.TEXTURE_CUBE_MAP,W.skyboxTexture),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MAG_FILTER,Q.LINEAR);for(let Te=0;Te<6;++Te)Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+Te,0,Q.RGBA,32,32,0,Q.RGBA,Q.UNSIGNED_BYTE,null)}ie.bindFramebuffer.set(ye.framebuffer),ie.viewport.set([0,0,32,32]);const he=W.getCenter(O,!0),_e=O.useProgram("skyboxCapture"),xe=new Float64Array(16);o.identity(xe),o.rotateY(xe,xe,.5*-Math.PI),ws(ie,W,_e,xe,he,0),o.identity(xe),o.rotateY(xe,xe,.5*Math.PI),ws(ie,W,_e,xe,he,1),o.identity(xe),o.rotateX(xe,xe,.5*-Math.PI),ws(ie,W,_e,xe,he,2),o.identity(xe),o.rotateX(xe,xe,.5*Math.PI),ws(ie,W,_e,xe,he,3),o.identity(xe),ws(ie,W,_e,xe,he,4),o.identity(xe),o.rotateY(xe,xe,Math.PI),ws(ie,W,_e,xe,he,5),ie.viewport.set([0,0,O.width,O.height])}(d,h),h.markSkyboxValid(d)):d.renderPass==="sky"&&function(O,W,te,oe,ie){const Q=O.context,ye=Q.gl,he=O.transform,_e=O.useProgram("skybox");Q.activeTexture.set(ye.TEXTURE0),ye.bindTexture(ye.TEXTURE_CUBE_MAP,W.skyboxTexture);const xe=((Te,pe,Se,je,Ye)=>({u_matrix:Te,u_sun_direction:pe,u_cubemap:0,u_opacity:je,u_temporal_offset:Ye}))(he.skyboxMatrix,W.getCenter(O,!1),0,oe,ie);O.prepareDrawProgram(Q,_e),_e.draw(Q,ye.TRIANGLES,te,o.StencilMode.disabled,O.colorModeForRenderPass(),o.CullFaceMode.backCW,xe,"skybox",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)}(d,h,F,w,R):k==="gradient"&&d.renderPass==="sky"&&function(O,W,te,oe,ie){const Q=O.context,ye=Q.gl,he=O.transform,_e=O.useProgram("skyboxGradient");W.skyboxGeometry||(W.skyboxGeometry=new Gl(Q)),Q.activeTexture.set(ye.TEXTURE0);let xe=W.colorRampTexture;xe||(xe=W.colorRampTexture=new o.Texture(Q,W.colorRamp,ye.RGBA)),xe.bind(ye.LINEAR,ye.CLAMP_TO_EDGE);const Te=((pe,Se,je,Ye,tt)=>({u_matrix:pe,u_color_ramp:0,u_center_direction:Se,u_radius:o.degToRad(je),u_opacity:Ye,u_temporal_offset:tt}))(he.skyboxMatrix,W.getCenter(O,!1),W.paint.get("sky-gradient-radius"),oe,ie);O.prepareDrawProgram(Q,_e),_e.draw(Q,ye.TRIANGLES,te,o.StencilMode.disabled,O.colorModeForRenderPass(),o.CullFaceMode.backCW,Te,"skyboxGradient",W.skyboxGeometry.vertexBuffer,W.skyboxGeometry.indexBuffer,W.skyboxGeometry.segment)}(d,h,F,w,R)},debug:function(d,i,h){for(let _=0;_<h.length;_++)Sp(d,i,h[_])},custom:function(d,i,h){const _=d.context,v=h.implementation;if(d.transform.projection.unsupportedLayers&&d.transform.projection.unsupportedLayers.includes("custom"))o.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if(d.renderPass==="offscreen"){const w=v.prerender;w&&(d.setCustomLayerDefaults(),_.setColorMode(d.colorModeForRenderPass()),w.call(v,_.gl,d.transform.customLayerMatrix()),_.setDirty(),d.setBaseState())}else if(d.renderPass==="translucent"){d.setCustomLayerDefaults(),_.setColorMode(d.colorModeForRenderPass()),_.setStencilMode(o.StencilMode.disabled);const w=v.renderingMode==="3d"?new o.DepthMode(d.context.gl.LEQUAL,o.DepthMode.ReadWrite,d.depthRangeFor3D):d.depthModeForSublayer(0,o.DepthMode.ReadOnly);_.setDepthMode(w),v.render(_.gl,d.transform.customLayerMatrix()),_.setDirty(),d.setBaseState(),_.bindFramebuffer.set(null)}}};class Ap{constructor(i,h){this.context=new j(i),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=o.SourceCache.maxUnderzooming+o.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Zc,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this._tileClippingMaskIDs=new Map,this._skippedStencilTileIDs=new Set}updateTerrain(i,h){const _=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ci(this,i));const v=this._terrain;this.transform.elevation=_?v:null,v.update(i,this.transform,h)}_updateFog(i){const h=i.fog;if(!h||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,v]=h.getFovAdjustedRange(this.transform._fov);if(_>v)return void(this.transform.fogCullDistSq=null);const w=_+.78*(v-_);this.transform.fogCullDistSq=w*w}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,h){if(this.width=i*o.exported.devicePixelRatio,this.height=h*o.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const i=this.context,h=new o.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(o.EXTENT,0),h.emplaceBack(0,o.EXTENT),h.emplaceBack(o.EXTENT,o.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(h,o.posAttributes.members),this.tileExtentSegments=o.SegmentVector.simpleSegment(0,0,4,2);const _=new o.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(o.EXTENT,0),_.emplaceBack(0,o.EXTENT),_.emplaceBack(o.EXTENT,o.EXTENT),this.debugBuffer=i.createVertexBuffer(_,o.posAttributes.members),this.debugSegments=o.SegmentVector.simpleSegment(0,0,4,5);const v=new o.StructArrayLayout2i4;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(v,o.posAttributes.members),this.viewportSegments=o.SegmentVector.simpleSegment(0,0,4,2);const w=new o.StructArrayLayout4i8;w.emplaceBack(0,0,0,0),w.emplaceBack(o.EXTENT,0,o.EXTENT,0),w.emplaceBack(0,o.EXTENT,0,o.EXTENT),w.emplaceBack(o.EXTENT,o.EXTENT,o.EXTENT,o.EXTENT),this.mercatorBoundsBuffer=i.createVertexBuffer(w,o.boundsAttributes.members),this.mercatorBoundsSegments=o.SegmentVector.simpleSegment(0,0,4,2);const E=new o.StructArrayLayout3ui6;E.emplaceBack(0,1,2),E.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(E);const k=new o.StructArrayLayout1ui2;for(const R of[0,1,3,2,0])k.emplaceBack(R);this.debugIndexBuffer=i.createIndexBuffer(k),this.emptyTexture=new o.Texture(i,new o.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA),this.identityMat=o.create();const F=this.context.gl;this.stencilClearMode=new o.StencilMode({func:F.ALWAYS,mask:0},0,255,F.ZERO,F.ZERO,F.ZERO),this.loadTimeStamps.push(o.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context,h=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear(),this.useProgram("clippingMask").draw(i,h.TRIANGLES,o.DepthMode.disabled,this.stencilClearMode,o.ColorMode.disabled,o.CullFaceMode.disabled,Kc(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear())}_renderTileClippingMasks(i,h,_){if(!h||this.currentStencilSource===h.id||!i.isTileClipped()||!_||_.length===0)return;const v=[];let w=!1;if(this._tileClippingMaskIDs&&!this.terrain){for(const O of _)if(this._tileClippingMaskIDs.has(O.key)||(w=!0),this._skippedStencilTileIDs.has(O.key)){if(!h.getTile(O).getBucket(i))continue;this._skippedStencilTileIDs.delete(O.key),v.push(O)}if(!w&&v.length===0)return}const E=this.context,k=E.gl;E.setColorMode(o.ColorMode.disabled),E.setDepthMode(o.DepthMode.disabled);const F=this.useProgram("clippingMask"),R=O=>{const W=h.getTile(O),{tileBoundsBuffer:te,tileBoundsIndexBuffer:oe,tileBoundsSegments:ie}=this.getTileBoundsBuffers(W);F.draw(E,k.TRIANGLES,o.DepthMode.disabled,new o.StencilMode({func:k.GREATER,mask:255},this._tileClippingMaskIDs.get(O.key)||0,255,k.KEEP,k.KEEP,k.REPLACE),o.ColorMode.disabled,o.CullFaceMode.disabled,Kc(O.projMatrix),"$clipping",te,oe,ie)};if(!w&&v.length>0)for(const O of v)R(O);else{(this._tileClippingMaskIDs.size===0||this.nextStencilID+_.length>256)&&this.clearStencil(),this._tileClippingMaskIDs.clear(),this._skippedStencilTileIDs.clear();for(const O of _)this._tileClippingMaskIDs.set(O.key,this.nextStencilID++),h.getTile(O).getBucket(i)?R(O):this._skippedStencilTileIDs.add(O.key)}this._skippedStencilTileIDs.size===0&&(this.currentStencilSource=h.id)}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,h=this.context.gl;return new o.StencilMode({func:h.NOTEQUAL,mask:255},i,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const h=this.context.gl;return new o.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs.get(i.key)||0,0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(i){const h=this.context.gl,_=i.sort((E,k)=>k.overscaledZ-E.overscaledZ),v=_[_.length-1].overscaledZ,w=_[0].overscaledZ-v+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const E={};for(let k=0;k<w;k++)E[k+v]=new o.StencilMode({func:h.GEQUAL,mask:255},k+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=w,[E,_]}return[{[v]:o.StencilMode.disabled},_]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new o.ColorMode([i.CONSTANT_COLOR,i.ONE],new o.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?o.ColorMode.unblended:o.ColorMode.alphaBlended}depthModeForSublayer(i,h,_){if(!this.opaquePassEnabledForLayer())return o.DepthMode.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new o.DepthMode(_||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,h){this.style=i,this.options=h,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(o.exported.now()),this.imageManager.beginFrame();const _=this.style.order,v=this.style._sourceCaches;for(const R in v){const O=v[R];O.used&&O.prepare(this.context)}const w={},E={},k={};for(const R in v){const O=v[R];w[R]=O.getVisibleCoordinates(),E[R]=w[R].slice().reverse(),k[R]=O.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let R=0;R<_.length;R++)if(this.style._layers[_[R]].is3D()){this.opaquePassCutoff=R;break}if(this.terrain&&(this.terrain.updateTileBinding(k),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new o.GlobeSharedBuffers(this.context)),!o.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const R of _){const O=this.style._layers[R],W=i._getLayerSourceCache(O);if(!O.hasOffscreenPass()||O.isHidden(this.transform.zoom))continue;const te=W?E[W.id]:void 0;(O.type==="custom"||O.isSky()||te&&te.length)&&this.renderLayer(this,W,O,te)}this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let F=o.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(F=this.style.fog.properties.get("color")),this.context.clear({color:h.showOverdrawInspector?o.Color.black:F,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const R=this.style._layers[_[this.currentLayer]],O=i._getLayerSourceCache(R);if(R.isSky())continue;const W=O?E[O.id]:void 0;this._renderTileClippingMasks(R,O,W),this.renderLayer(this,O,R,W)}if(this.renderPass="sky",(o.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const R=this.style._layers[_[this.currentLayer]],O=i._getLayerSourceCache(R);R.isSky()&&this.renderLayer(this,O,R,O?E[O.id]:void 0)}for(this.transform.projection.name==="globe"&&function(R){const O=R.context,W=O.gl,te=R.transform,oe=new o.DepthMode(W.LEQUAL,o.DepthMode.ReadOnly,[0,1]),ie=R.useProgram("globeAtmosphere"),Q=te.centerOffset,ye=te._camera.getCameraToClipPerspective(te._fov,te.width/te.height,te._nearZ,te._farZ);ye[8]=2*-Q.x/te.width,ye[9]=2*Q.y/te.height;const he=o.invert([],ye),_e=o.mul([],he,te.projMatrix),xe={u_frustum_tl:Ts([-1,1,1],he),u_frustum_tr:Ts([1,1,1],he),u_frustum_br:Ts([1,-1,1],he),u_frustum_bl:Ts([-1,-1,1],he),u_globe_pos:Ts([te.globeMatrix[12],te.globeMatrix[13],te.globeMatrix[14]],_e),u_globe_radius:te.worldSize/2/Math.PI-1,u_opacity:1-o.globeToMercatorTransition(te.zoom),u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};R.prepareDrawProgram(O,ie);const Te=R.globeSharedBuffers;Te&&ie.draw(O,W.TRIANGLES,oe,o.StencilMode.disabled,o.ColorMode.alphaBlended,o.CullFaceMode.backCW,xe,"skybox",Te.atmosphereVertexBuffer,Te.atmosphereIndexBuffer,Te.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const R=this.style._layers[_[this.currentLayer]],O=i._getLayerSourceCache(R);if(R.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(R)){if(R.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const W=O?(R.type==="symbol"?k:E)[O.id]:void 0;this._renderTileClippingMasks(R,O,O?w[O.id]:void 0),this.renderLayer(this,O,R,W),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let R=null;o.values(this.style._layers).forEach(O=>{const W=i._getLayerSourceCache(O);W&&!O.isHidden(this.transform.zoom)&&(!R||R.getSource().maxzoom<W.getSource().maxzoom)&&(R=W)}),R&&this.options.showTileBoundaries&&Wh.debug(this,R,R.getVisibleCoordinates())}this.options.showPadding&&function(R){const O=R.transform.padding;St(R,R.transform.height-(O.top||0),3,Gh),St(R,O.bottom||0,3,$h),Hi(R,O.left||0,3,bp),Hi(R,R.transform.width-(O.right||0),3,au);const W=R.transform.centerPoint;(function(te,oe,ie,Q){jl(te,oe-1,ie-10,2,20,Q),jl(te,oe-10,ie-1,20,2,Q)})(R,W.x,R.transform.height-W.y,su)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(o.window.performance.now()),this.saveCanvasCopy())}renderLayer(i,h,_,v){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="sky"||_.type==="custom"||v&&v.length)&&(this.id=_.id,this.gpuTimingStart(_),i.transform.projection.unsupportedLayers&&i.transform.projection.unsupportedLayers.includes(_.type)||Wh[_.type](i,h,_,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let _=this.gpuTimers[i.id];_||(_=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),_.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,_.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}queryGpuTimers(i){const h={};for(const _ in i){const v=i[_],w=this.context.extTimerQuery,E=w.getQueryObjectEXT(v.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(v.query),h[_]=E}return h}translatePosMatrix(i,h,_,v,w){if(!_[0]&&!_[1])return i;const E=w?v==="map"?this.transform.angle:0:v==="viewport"?-this.transform.angle:0;if(E){const R=Math.sin(E),O=Math.cos(E);_=[_[0]*O-_[1]*R,_[0]*R+_[1]*O]}const k=[w?_[0]:Re(h,_[0],this.transform.zoom),w?_[1]:Re(h,_[1],this.transform.zoom),0],F=new Float32Array(16);return o.translate(F,i,k),F}saveTileTexture(i){const h=this._tileTextures[i.size[0]];h?h.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const h=this._tileTextures[i];return h&&h.length>0?h.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const h=this.imageManager.getPattern(i.from.toString()),_=this.imageManager.getPattern(i.to.toString());return!h||!_}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,h=this.style&&this.style.fog,_=[];return this.terrain&&!this.terrain.renderingToTexture&&_.push("TERRAIN"),h&&!i&&h.getOpacity(this.transform.pitch)!==0&&_.push("FOG"),i&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(i,h,_){this.cache=this.cache||{};const v=_||[],w=this.currentGlobalDefines().concat(v),E=Bl.cacheKey(i,w,h);return this.cache[E]||(this.cache[E]=new Bl(this.context,i,Rl[i],h,xr[i],w)),this.cache[E]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=o.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new o.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(i,h,_){if(this.terrain&&this.terrain.renderingToTexture)return;const v=this.style.fog;if(v){const w=v.getOpacity(this.transform.pitch);w!==0&&h.setFogUniformValues(i,((E,k,F,R)=>{const O=k.properties.get("color"),W=E.frameCounter/1e3%1,te=[O.r/O.a,O.g/O.a,O.b/O.a,R];return{u_fog_matrix:F?E.transform.calculateFogTileMatrix(F):E.identityMat,u_fog_range:k.getFovAdjustedRange(E.transform._fov),u_fog_color:te,u_fog_horizon_blend:k.properties.get("horizon-blend"),u_fog_temporal_offset:W}})(this,v,_,w))}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const i=this.context.gl,h=i.createTexture();return i.bindTexture(i.TEXTURE_2D,h),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&i.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const i=this._backgroundTiles,h=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const v of _)h[v.key]=i[v.key]||new o.Tile(v,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class Es{constructor(i=0,h=0,_=0,v=0){if(isNaN(i)||i<0||isNaN(h)||h<0||isNaN(_)||_<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=h,this.left=_,this.right=v}interpolate(i,h,_){return h.top!=null&&i.top!=null&&(this.top=o.number(i.top,h.top,_)),h.bottom!=null&&i.bottom!=null&&(this.bottom=o.number(i.bottom,h.bottom,_)),h.left!=null&&i.left!=null&&(this.left=o.number(i.left,h.left,_)),h.right!=null&&i.right!=null&&(this.right=o.number(i.right,h.right,_)),this}getCenter(i,h){const _=o.clamp((this.left+i-this.right)/2,0,i),v=o.clamp((this.top+h-this.bottom)/2,0,h);return new o.pointGeometry(_,v)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Es(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Cp(d,i){const h=o.getColumn(d,3);o.fromQuat(d,i),o.setColumn(d,3,h)}function Zh(d,i){const h=o.identity$1([]);return o.rotateZ$1(h,h,-i),o.rotateX$1(h,h,-d),h}function ou(d,i){const h=[d[0],d[1],0],_=[i[0],i[1],0];if(o.length(h)>=1e-15){const E=o.normalize([],h);o.scale$2(_,E,o.dot(_,E)),i[0]=_[0],i[1]=_[1]}const v=o.cross([],i,d);if(o.len(v)<1e-15)return null;const w=Math.atan2(-v[1],v[0]);return Zh(Math.atan2(Math.sqrt(d[0]*d[0]+d[1]*d[1]),-d[2]),w)}class $l{constructor(i,h){this.position=i,this.orientation=h}get position(){return this._position}set position(i){if(i){const h=i instanceof o.MercatorCoordinate?i:new o.MercatorCoordinate(i[0],i[1],i[2]);this._renderWorldCopies&&(h.x=o.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(i,h){if(this.orientation=null,!this.position)return;const _=this._elevation?this._elevation.getAtPointOrZero(o.MercatorCoordinate.fromLngLat(i)):0,v=this.position,w=o.MercatorCoordinate.fromLngLat(i,_),E=[w.x-v.x,w.y-v.y,w.z-v.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=ou(E,h)}setPitchBearing(i,h){this.orientation=Zh(o.degToRad(i),o.degToRad(-h))}}class Wl{constructor(i,h){this._transform=o.identity([]),this.orientation=h,this.position=i}get mercatorPosition(){const i=this.position;return new o.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=o.getColumn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var h;i&&o.setColumn(this._transform,3,[(h=i)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||o.identity$1([]),i&&Cp(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,h){this._orientation=Zh(i,h),Cp(this._transform,this._orientation)}forward(){const i=o.getColumn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=o.getColumn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=o.getColumn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,h){const _=new Float64Array(16);return o.invert(_,this.getWorldToCamera(i,h)),_}getWorldToCameraPosition(i,h,_){const v=this.position;o.scale$2(v,v,-i);const w=new Float64Array(16);return o.fromScaling(w,[_,_,_]),o.translate(w,w,v),w[10]*=h,w}getWorldToCamera(i,h){const _=new Float64Array(16),v=new Float64Array(4),w=this.position;return o.conjugate(v,this._orientation),o.scale$2(w,w,-i),o.fromQuat(_,v),o.translate(_,_,w),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=h,_[9]*=h,_[10]*=h,_[11]*=h,_}getCameraToClipPerspective(i,h,_,v){const w=new Float64Array(16);return o.perspective(w,i,h,_,v),w}getDistanceToElevation(i){const h=i===0?0:o.mercatorZfromAltitude(i,this.position[1]),_=this.forward();return(h-this.position[2])/_[2]}clone(){return new Wl([...this.position],[...this.orientation])}}function Hh(d,i){const h=Zl(d),_=function(w,E,k,F,R){const O=new o.LngLat(k.lng-180*bs,k.lat),W=new o.LngLat(k.lng+180*bs,k.lat),te=w.project(O.lng,O.lat),oe=w.project(W.lng,W.lat),ie=-Math.atan2(oe.y-te.y,oe.x-te.x),Q=o.MercatorCoordinate.fromLngLat(k);Q.y=o.clamp(Q.y,-.999975,.999975);const ye=Q.toLngLat(),he=w.project(ye.lng,ye.lat),_e=o.MercatorCoordinate.fromLngLat(ye);_e.x+=bs;const xe=_e.toLngLat(),Te=w.project(xe.lng,xe.lat),pe=Kh(Te.x-he.x,Te.y-he.y,ie),Se=o.MercatorCoordinate.fromLngLat(ye);Se.y+=bs;const je=Se.toLngLat(),Ye=w.project(je.lng,je.lat),tt=Kh(Ye.x-he.x,Ye.y-he.y,ie),Qe=Math.abs(pe.x)/Math.abs(tt.y),mt=o.identity([]);o.rotateZ(mt,mt,-ie*(1-(R?0:F)));const Ge=o.identity([]);return o.scale(Ge,Ge,[1,1-(1-Qe)*F,1]),Ge[4]=-tt.x/tt.y*F,o.rotateZ(Ge,Ge,ie),o.multiply$1(Ge,mt,Ge),Ge}(d.projection,0,d.center,h,i),v=Xh(d);return o.scale(_,_,[v,v,1]),_}function Xh(d){const i=d.projection,h=Zl(d),_=qh(i,d.center),v=qh(i,o.LngLat.convert(i.center));return Math.pow(2,_*h+(1-h)*v)}function Zl(d){const i=d.projection.range;if(!i)return 0;const h=Math.max(d.width,d.height),_=Math.log(h/1024)/Math.LN2;return o.smoothstep(i[0]+_,i[1]+_,d.zoom)}const bs=1/4e4;function qh(d,i){const h=o.clamp(i.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),_=new o.LngLat(i.lng-180*bs,h),v=new o.LngLat(i.lng+180*bs,h),w=d.project(_.lng,h),E=d.project(v.lng,h),k=o.MercatorCoordinate.fromLngLat(_),F=o.MercatorCoordinate.fromLngLat(v),R=E.x-w.x,O=E.y-w.y,W=F.x-k.x,te=F.y-k.y,oe=Math.sqrt((W*W+te*te)/(R*R+O*O));return Math.log(oe)/Math.LN2}function Kh(d,i,h){const _=Math.cos(h),v=Math.sin(h);return{x:d*_-i*v,y:d*v+i*_}}class lu{constructor(i,h,_,v,w,E,k){this.tileSize=512,this._renderWorldCopies=w===void 0||w,this._minZoom=i||0,this._maxZoom=h||22,this._minPitch=_==null?0:_,this._maxPitch=v==null?60:v,this.setProjection(E),this.setMaxBounds(k),this.width=0,this.height=0,this._center=new o.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Es,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Wl,this._centerAltitude=0,this._centerAltitudeValidForExaggeration=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const i=new lu(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(i){const h=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||h)&&this._updateCameraOnTerrain(),(i||h)&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return o.pick(this.projection,["name","center","parallels"])}setProjection(i){i==null&&(i={name:"mercator"}),this.projectionOptions=i;const h=this.projection?this.getProjection():void 0;this.projection=o.getProjection(i);const _=this.getProjection();return D(h,_)?null:(this._calcMatrices(),_)}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(i){i===void 0?i=!0:i===null&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new o.pointGeometry(this.width,this.height)}get bearing(){return o.wrap(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const h=-i*Math.PI/180;var _;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(_=new o.ARRAY_TYPE(4),o.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),function(v,w,E){var k=w[0],F=w[1],R=w[2],O=w[3],W=Math.sin(E),te=Math.cos(E);v[0]=k*te+R*W,v[1]=F*te+O*W,v[2]=k*-W+R*te,v[3]=F*-W+O*te}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const h=o.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const h=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=0);const i=this._elevation;this._centerAltitude=i.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=i.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let v=0,w=0;for(let E=0;E<h.length;E++){const k=new o.pointGeometry(h[E][0]*this.width,_+h[E][1]*(this.height-_)),F=i.pointCoordinate(k);if(!F)continue;const R=1/Math.hypot(F[0]-this._camera.position[0],F[1]-this._camera.position[1]);v+=F[3]*R,w+=R}return w===0?NaN:v/w}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const i=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*h,v=this._mercatorZfromZoom(i),w=this._mercatorZfromZoom(this._maxZoom),E=Math.max(v-_,w);this._setZoom(this._zoomFromMercatorZ(E))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let _;_=i.z<this._camera.position[2]?[h.x,h.y,h.z]:[i.x,i.y,i.z];const v=o.length(o.sub([],this._camera.position,_));return o.clamp(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let h=!1;if(i.orientation&&!o.exactEquals(i.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(i.orientation)),i.position){const _=[i.position.x,i.position.y,i.position.z];o.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,h=new $l;return h.position=new o.MercatorCoordinate(i[0],i[1],i[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(i){if(!o.length$1(i))return!1;o.normalize$1(i,i);const h=o.transformQuat([],[0,0,-1],i),_=o.transformQuat([],[0,-1,0],i);if(_[2]<0)return!1;const v=ou(h,_);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(i){const h=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;i[2]=o.clamp(i[2],v/_,v/h),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,h,_){this._unmodified=!1,this._edgeInsets.interpolate(i,h,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const h=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(i){const h=[new o.UnwrappedTileID(0,i)];if(this.renderWorldCopies){const _=this.pointCoordinate(new o.pointGeometry(0,0)),v=this.pointCoordinate(new o.pointGeometry(this.width,0)),w=this.pointCoordinate(new o.pointGeometry(this.width,this.height)),E=this.pointCoordinate(new o.pointGeometry(0,this.height)),k=Math.floor(Math.min(_.x,v.x,w.x,E.x)),F=Math.floor(Math.max(_.x,v.x,w.x,E.x)),R=1;for(let O=k-R;O<=F+R;O++)O!==0&&h.push(new o.UnwrappedTileID(O,i))}return h}coveringTiles(i){let h=this.coveringZoomLevel(i);const _=h,v=this.elevation&&!i.isTerrainDEM,w=this.projection.name==="mercator";if(i.minzoom!==void 0&&h<i.minzoom)return[];i.maxzoom!==void 0&&h>i.maxzoom&&(h=i.maxzoom);const E=this.locationCoordinate(this.center),k=this.center.lat,F=1<<h,R=[F*E.x,F*E.y,0],O=this.projection.name==="globe",W=!O,te=o.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,W),oe=O?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),ie=F*o.mercatorZfromAltitude(1,this.center.lat),Q=this._camera.position[2]/o.mercatorZfromAltitude(1,this.center.lat),ye=[F*oe.x,F*oe.y,Q*(W?1:ie)],he=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),_e=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,xe=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Te=i.isTerrainDEM?-xe:this._elevation?this._elevation.getMinElevationBelowMSL():0,pe=this.projection.isReprojectedInTileSpace?Xh(this):1,Se=rt=>{const $t=new o.MercatorCoordinate(rt.x+25e-6,rt.y,rt.z),Pt=new o.MercatorCoordinate(rt.x,rt.y+25e-6,rt.z),Lt=rt.toLngLat(),Ht=$t.toLngLat(),er=Pt.toLngLat(),jt=this.locationCoordinate(Lt),qt=this.locationCoordinate(Ht),fr=this.locationCoordinate(er),jr=Math.hypot(qt.x-jt.x,qt.y-jt.y),$n=Math.hypot(fr.x-jt.x,fr.y-jt.y);return Math.sqrt(jr*$n)*pe/25e-6},je=rt=>{const Ft=xe,$t=Te;return{aabb:o.tileAABB(this,F,0,0,0,rt,$t,Ft,this.projection),zoom:0,x:0,y:0,minZ:$t,maxZ:Ft,wrap:rt,fullyVisible:!1}},Ye=[];let tt=[];const Qe=h,mt=i.reparseOverscaled?_:h,Ge=rt=>rt*rt,_t=Ge((Q-this._centerAltitude)*ie),ht=rt=>{if(!this._elevation||!rt.tileID||!w)return;const Ft=this._elevation.getMinMaxForTile(rt.tileID),$t=rt.aabb;Ft?($t.min[2]=Ft.min,$t.max[2]=Ft.max,$t.center[2]=($t.min[2]+$t.max[2])/2):(rt.shouldSplit=Rt(rt),rt.shouldSplit||($t.min[2]=$t.max[2]=$t.center[2]=this._centerAltitude))},Rt=rt=>{if(rt.zoom<_e)return!0;if(rt.zoom===Qe)return!1;if(rt.shouldSplit!=null)return rt.shouldSplit;const Ft=rt.aabb.distanceX(ye),$t=rt.aabb.distanceY(ye);let Pt=_t,Lt=1;if(O){Pt=Ge(rt.aabb.distanceZ(ye));const er=Math.pow(2,rt.zoom),jt=o.latFromMercatorY((rt.y+1)/er),qt=o.latFromMercatorY(rt.y/er),fr=Math.min(Math.max(k,jt),qt),jr=o.circumferenceAtLatitude(fr)/o.circumferenceAtLatitude(k);Lt=Math.min(jr,1)}else if(v&&(Pt=Ge(rt.aabb.distanceZ(ye)*ie)),this.projection.isReprojectedInTileSpace&&_<=5){const er=Math.pow(2,rt.zoom),jt=Se(new o.MercatorCoordinate((rt.x+.5)/er,(rt.y+.5)/er));Lt=jt>.85?1:jt}const Ht=Ft*Ft+$t*$t+Pt;return Ht<Ge((1<<Qe-rt.zoom)*he*Lt*((er,jt)=>{if(jt*Ge(.707)<er)return 1;const qt=Math.sqrt(jt/er);return qt/(1.4144271570014144+(Math.pow(1.1,qt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Pt,_t),Ht))};if(this.renderWorldCopies)for(let rt=1;rt<=3;rt++)Ye.push(je(-rt)),Ye.push(je(rt));for(Ye.push(je(0));Ye.length>0;){const rt=Ye.pop(),Ft=rt.x,$t=rt.y;let Pt=rt.fullyVisible;if(!Pt){const Lt=rt.aabb.intersects(te);if(Lt===0)continue;Pt=Lt===2}if(rt.zoom!==Qe&&Rt(rt))for(let Lt=0;Lt<4;Lt++){const Ht=(Ft<<1)+Lt%2,er=($t<<1)+(Lt>>1),jt={aabb:w?rt.aabb.quadrant(Lt):o.tileAABB(this,F,rt.zoom+1,Ht,er,rt.wrap,rt.minZ,rt.maxZ,this.projection),zoom:rt.zoom+1,x:Ht,y:er,wrap:rt.wrap,fullyVisible:Pt,tileID:void 0,shouldSplit:void 0,minZ:rt.minZ,maxZ:rt.maxZ};v&&!O&&(jt.tileID=new o.OverscaledTileID(rt.zoom+1===Qe?mt:rt.zoom+1,rt.wrap,rt.zoom+1,Ht,er),ht(jt)),Ye.push(jt)}else{const Lt=rt.zoom===Qe?mt:rt.zoom;if(i.minzoom&&i.minzoom>Lt)continue;const Ht=R[0]-(.5+Ft+(rt.wrap<<rt.zoom))*(1<<h-rt.zoom),er=R[1]-.5-$t,jt=rt.tileID?rt.tileID:new o.OverscaledTileID(Lt,rt.wrap,rt.zoom,Ft,$t);tt.push({tileID:jt,distanceSq:Ht*Ht+er*er})}}if(this.fogCullDistSq){const rt=this.fogCullDistSq,Ft=this.horizonLineFromTop();tt=tt.filter($t=>{const Pt=[0,0,0,1],Lt=[o.EXTENT,o.EXTENT,0,1],Ht=this.calculateFogTileMatrix($t.tileID.toUnwrapped());o.transformMat4$1(Pt,Pt,Ht),o.transformMat4$1(Lt,Lt,Ht);const er=o.getAABBPointSquareDist(Pt,Lt);if(er===0)return!0;let jt=!1;const qt=this._elevation;if(qt&&er>rt&&Ft!==0){const fr=this.calculateProjMatrix($t.tileID.toUnwrapped());let jr;i.isTerrainDEM||(jr=qt.getMinMaxForTile($t.tileID)),jr||(jr={min:Te,max:xe});const $n=o.furthestTileCorner(this.rotation),Wn=[$n[0]*o.EXTENT,$n[1]*o.EXTENT,jr.max];o.transformMat4(Wn,Wn,fr),jt=(1-Wn[1])*this.height*.5<Ft}return er<rt||jt})}return tt.sort((rt,Ft)=>rt.distanceSq-Ft.distanceSq).map(rt=>rt.tileID)}resize(i,h){this.width=i,this.height=h,this.pixelsToGLUnits=[2/i,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const h=o.clamp(i.lat,-o.MAX_MERCATOR_LATITUDE,o.MAX_MERCATOR_LATITUDE),_=this.projection.project(i.lng,h);return new o.pointGeometry(_.x*this.worldSize,_.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(i,h){let _,v;const w=this.centerPoint;if(this.projection.name==="globe"){const k=this.worldSize;_=(h.x-w.x)/k,v=(h.y-w.y)/k}else{const k=this.pointCoordinate(h),F=this.pointCoordinate(w);_=k.x-F.x,v=k.y-F.y}const E=this.locationCoordinate(i);this.setLocation(new o.MercatorCoordinate(E.x-_,E.y-v))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this._coordinatePoint(this.locationCoordinate(i),!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,h){const _=h?o.mercatorZfromAltitude(h,i.lat):void 0,v=this.projection.project(i.lng,i.lat);return new o.MercatorCoordinate(v.x,v.y,_)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,h){const _=h!=null?h:this._centerAltitude,v=[i.x,i.y,0,1],w=[i.x,i.y,1,1];o.transformMat4$1(v,v,this.pixelMatrixInverse),o.transformMat4$1(w,w,this.pixelMatrixInverse);const E=w[3];o.scale$1(v,v,1/v[3]),o.scale$1(w,w,1/E);const k=v[2],F=w[2];return{p0:v,p1:w,t:k===F?0:(_-k)/(F-k)}}screenPointToMercatorRay(i){const h=[i.x,i.y,0,1],_=[i.x,i.y,1,1];return o.transformMat4$1(h,h,this.pixelMatrixInverse),o.transformMat4$1(_,_,this.pixelMatrixInverse),o.scale$1(h,h,1/h[3]),o.scale$1(_,_,1/_[3]),h[2]=o.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,_[2]=o.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,o.scale$1(h,h,1/this.worldSize),o.scale$1(_,_,1/this.worldSize),new o.Ray([h[0],h[1],h[2]],o.normalize([],o.sub([],_,h)))}rayIntersectionCoordinate(i){const{p0:h,p1:_,t:v}=i,w=o.mercatorZfromAltitude(h[2],this._center.lat),E=o.mercatorZfromAltitude(_[2],this._center.lat);return new o.MercatorCoordinate(o.number(h[0],_[0],v)/this.worldSize,o.number(h[1],_[1],v)/this.worldSize,o.number(w,E,v))}pointCoordinate(i,h=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,h)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);const h=this.elevation;let _=this.elevation.pointCoordinate(i);if(_)return new o.MercatorCoordinate(_[0],_[1],_[2]);let v=0,w=this.horizonLineFromTop();if(i.y>w)return this.pointCoordinate(i);const E=.02*w,k=i.clone();for(let F=0;F<10&&w-v>E;F++){k.y=o.number(v,w,.66);const R=h.pointCoordinate(k);R?(w=k.y,_=R):v=k.y}return _?new o.MercatorCoordinate(_[0],_[1],_[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){if(this.elevation)return!this.elevation.pointCoordinate(i);{const h=this.horizonLineFromTop();return i.y<h}}_coordinatePoint(i,h){const _=h&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,v=[i.x*this.worldSize,i.y*this.worldSize,_+i.toAltitude(),1];return o.transformMat4$1(v,v,this.pixelMatrix),v[3]>0?new o.pointGeometry(v[0]/v[3],v[1]/v[3]):new o.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(i,h){const _=new o.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),v=new o.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),w=new o.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),E=new o.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let k=this.pointCoordinate(_,i),F=this.pointCoordinate(v,i);const R=this.pointCoordinate(w,h),O=this.pointCoordinate(E,h),W=(te,oe)=>(oe.y-te.y)/(oe.x-te.x);return k.y>1&&F.y>=0?k=new o.MercatorCoordinate((1-O.y)/W(O,k)+O.x,1):k.y<0&&F.y<=1&&(k=new o.MercatorCoordinate(-O.y/W(O,k)+O.x,0)),F.y>1&&k.y>=0?F=new o.MercatorCoordinate((1-R.y)/W(R,F)+R.x,1):F.y<0&&k.y<=1&&(F=new o.MercatorCoordinate(-R.y/W(R,F)+R.x,0)),new o.LngLatBounds().extend(this.coordinateLocation(k)).extend(this.coordinateLocation(F)).extend(this.coordinateLocation(O)).extend(this.coordinateLocation(R))}_getBounds3D(){const i=this.elevation;if(!i.visibleDemTiles.length)return this._getBounds(0,0);const h=i.visibleDemTiles.reduce((_,v)=>{if(v.dem){const w=v.dem.tree;_.min=Math.min(_.min,w.minimums[0]),_.max=Math.max(_.max,w.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBounds(h.min*i.exaggeration(),h.max*i.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(i=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-h*(1-this._horizonShift);return i?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-o.MAX_MERCATOR_LATITUDE,this.maxLat=o.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=o.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=o.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=o.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=o.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,h){return this.projection.createTileMatrix(this,h,i)}calculateDistanceTileData(i){const h=i.key,_=this._distanceTileDataCache;if(_[h])return _[h];const v=i.canonical,w=1/this.height,E=this.cameraWorldSize/this.zoomScale(v.z),k=(v.x+Math.pow(2,v.z)*i.wrap)*E,F=v.y*E,R=this.point,O=this.angle,W=Math.sin(-O),te=-Math.cos(-O);return _[h]={bearing:[W,te],center:[(R.x-k)*w,(R.y-F)*w],scale:E/o.EXTENT*w},_[h]}calculateFogTileMatrix(i){const h=i.key,_=this._fogTileMatrixCache;if(_[h])return _[h];const v=this.calculatePosMatrix(i,this.cameraWorldSize);return o.multiply$1(v,this.worldToFogMatrix,v),_[h]=new Float32Array(v),_[h]}calculateProjMatrix(i,h=!1){const _=i.key,v=h?this._alignedProjMatrixCache:this._projMatrixCache;if(v[_])return v[_];const w=this.calculatePosMatrix(i,this.worldSize);return o.multiply$1(w,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,w),v[_]=new Float32Array(w),v[_]}calculatePixelsToTileUnitsMatrix(i){const h=i.tileID.key,_=this._pixelsToTileUnitsCache;if(_[h])return _[h];const v=function(w,E){const{scale:k}=w.tileTransform,F=k*o.EXTENT/(w.tileSize*Math.pow(2,E.zoom-w.tileID.overscaledZ+w.tileID.canonical.z));return R=new Float32Array(4),te=(O=E.inverseAdjustmentMatrix)[1],oe=O[2],ie=O[3],ye=(W=[F,F])[1],R[0]=O[0]*(Q=W[0]),R[1]=te*Q,R[2]=oe*ye,R[3]=ie*ye,R;var R,O,W,te,oe,ie,Q,ye}(i,this);return _[h]=v,_[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const i=this._elevation;this._updateCameraState();const h=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(h),v=this._camera.forward(),w=o.mercatorZfromAltitude(1,this._center.lat);_[2]/=w,v[2]/=w,o.normalize(v,v);const E=i.raycast(_,v,i.exaggeration());if(E){const k=o.scaleAndAdd([],_,v,E),F=new o.MercatorCoordinate(k[0],k[1],o.mercatorZfromAltitude(k[2],o.latFromMercatorY(k[1]))),R=(F.z+o.length([F.x-_[0],F.y-_[1],F.z-_[2]*w]))*this._projectionScaler;this._seaLevelZoom=this._zoomFromMercatorZ(R),this._centerAltitude=F.toAltitude(),this._center=this.coordinateLocation(F),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const i=this._elevation;this._updateCameraState();const h=o.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(h),v=i.getAtPointOrZero(new o.MercatorCoordinate(..._)),w=this._minimumHeightOverTerrain()*Math.cos(o.degToRad(this._maxPitch)),E=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*v;if(E<w){const k=this.locationCoordinate(this._center,this._centerAltitude),F=[k.x-_[0],k.y-_[1],k.z-_[2]],R=o.length(F);F[2]-=(w-E)/this._projectionScaler;const O=o.length(F);if(O===0)return;o.scale$2(F,F,R/O*this._projectionScaler),this._camera.position=[k.x-F[0],k.y-F[1],k.z*this._projectionScaler-F[2]],this._camera.orientation=ou(F,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const W=this.center;return W.lat=o.clamp(W.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(W.lng=o.clamp(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const i=this._unmodified,{x:h,y:_}=this.point;let v=0,w=h,E=_;const k=this.width/2,F=this.height/2,R=this.worldMinY*this.scale,O=this.worldMaxY*this.scale;if(_-F<R&&(E=R+F),_+F>O&&(E=O-F),O-R<this.height&&(v=Math.max(v,this.height/(O-R)),E=(O+R)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,te=this.worldMaxX*this.scale,oe=this.worldSize/2-(W+te)/2;w=(h+oe+this.worldSize)%this.worldSize-oe,w-k<W&&(w=W+k),w+k>te&&(w=te-k),te-W<this.width&&(v=Math.max(v,this.width/(te-W)),w=(te+W)/2)}w===h&&E===_||(this.center=this.unproject(new o.pointGeometry(w,E))),v&&(this.zoom+=this.scaleZoom(v)),this._constrainCameraAltitude(),this._unmodified=i,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this._fov/2,h=this.centerOffset,_=this.pixelsPerMeter;this._projectionScaler=_/(o.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(i)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?_:1),w=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);w[8]=2*-h.x/this.width,w[9]=2*h.y/this.height;let E=o.mul([],w,v);if(this.projection.isReprojectedInTileSpace){const Te=this.locationCoordinate(this.center),pe=o.identity([]);o.translate(pe,pe,[Te.x*this.worldSize,Te.y*this.worldSize,0]),o.multiply$1(pe,pe,Hh(this)),o.translate(pe,pe,[-Te.x*this.worldSize,-Te.y*this.worldSize,0]),o.multiply$1(E,E,pe),this.inverseAdjustmentMatrix=function(Se){const je=Hh(Se,!0);return Ie([],[je[0],je[1],je[4],je[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=o.scale([],E,[this.worldSize,this.worldSize,this.worldSize/_,1]),this.projMatrix=E,this.invProjMatrix=o.invert(new Float64Array(16),this.projMatrix);const k=new Float32Array(16);o.identity(k),o.scale(k,k,[1,-1,1]),o.rotateX(k,k,this._pitch),o.rotateZ(k,k,this.angle);const F=o.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),R=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;F[8]=2*-h.x/this.width,F[9]=2*(h.y+R)/this.height,this.skyboxMatrix=o.multiply$1(k,F,k);const O=this.point,W=O.x,te=O.y,oe=this.width%2/2,ie=this.height%2/2,Q=Math.cos(this.angle),ye=Math.sin(this.angle),he=W-Math.round(W)+Q*oe+ye*ie,_e=te-Math.round(te)+Q*ie+ye*oe,xe=new Float64Array(E);if(o.translate(xe,xe,[he>.5?he-1:he,_e>.5?_e-1:_e,0]),this.alignedProjMatrix=xe,E=o.create(),o.scale(E,E,[this.width/2,-this.height/2,1]),o.translate(E,E,[1,-1,0]),this.labelPlaneMatrix=E,E=o.create(),o.scale(E,E,[1,-1,1]),o.translate(E,E,[-1,-1,0]),o.scale(E,E,[2/this.width,2/this.height,1]),this.glCoordMatrix=E,this.pixelMatrix=o.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},E=o.invert(new Float64Array(16),this.pixelMatrix),!E)throw new Error("failed to invert matrix");this.pixelMatrixInverse=E,this.globeMatrix=this.projection.name==="globe"?o.calculateGlobeMatrix(this):E,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSize,h=this.cameraPixelsPerMeter,_=this._camera.position,v=1/this.height,w=[i,i,h];o.scale$2(w,w,v),o.scale$2(_,_,-1),o.multiply$2(_,_,w);const E=o.create();o.translate(E,E,_),o.scale(E,E,w),this.mercatorFogMatrix=E,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,h,v)}_computeCameraPosition(i){const h=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),v=this.point,w=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-i/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-_[0]*w,v.y/this.worldSize-_[1]*w,i/this.worldSize*this._centerAltitude-_[2]*w]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=i[2];let v=1;_>0&&(v=Math.min((h-this._camera.position[2])/_,1)),this._camera.position=o.scaleAndAdd([],this._camera.position,i,v),this._updateStateFromCamera(),this.projection.wrap&&(this.center=this.center.wrap())}_updateStateFromCamera(){const i=this._camera.position,h=this._camera.forward(),{pitch:_,bearing:v}=this._camera.getPitchBearing(),w=o.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,E=this._mercatorZfromZoom(this._maxZoom)*Math.cos(o.degToRad(this._maxPitch)),k=Math.max((i[2]-w)/Math.cos(_),E),F=this._zoomFromMercatorZ(k);o.scaleAndAdd(i,i,h,k),this._pitch=o.clamp(_,o.degToRad(this.minPitch),o.degToRad(this.maxPitch)),this.angle=o.wrap(v,-Math.PI,Math.PI),this._setZoom(o.clamp(F,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new o.MercatorCoordinate(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(o.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(i,h){const _=Math.min(i.x,h.x),v=Math.max(i.x,h.x),w=Math.min(i.y,h.y),E=Math.max(i.y,h.y);if(w<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const k=[new o.pointGeometry(_,w),new o.pointGeometry(v,E),new o.pointGeometry(_,E),new o.pointGeometry(v,w)],F=this.renderWorldCopies?-3:0,R=this.renderWorldCopies?4:1;for(const O of k){const W=this.pointRayIntersection(O);if(W.t<0)return!0;const te=this.rayIntersectionCoordinate(W);if(te.x<F||te.y<0||te.x>R||te.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+o.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new o.pointGeometry(0,0),new o.pointGeometry(this.width,this.height))}zoomDeltaToMovement(i,h){const _=o.length(o.sub([],this._camera.position,i)),v=this._zoomFromMercatorZ(_)+h;return _-this._mercatorZfromZoom(v)}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new o.pointGeometry(0,i))}}function Yh(d,i){let h=!1,_=null;const v=()=>{_=null,h&&(d(),_=setTimeout(v,i),h=!1)};return()=>(h=!0,_||v(),_)}class Ip{constructor(i){this._hashName=i&&encodeURIComponent(i),o.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Yh(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,o.window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),o.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(i){const h=this._map;if(!h)return"";const _=h.getCenter(),v=Math.round(100*h.getZoom())/100,w=Math.ceil((v*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,w),k=Math.round(_.lng*E)/E,F=Math.round(_.lat*E)/E,R=h.getBearing(),O=h.getPitch();let W="";if(W+=i?`/${k}/${F}/${v}`:`${v}/${F}/${k}`,(R||O)&&(W+="/"+Math.round(10*R)/10),O&&(W+=`/${Math.round(O)}`),this._hashName){const te=this._hashName;let oe=!1;const ie=o.window.location.hash.slice(1).split("&").map(Q=>{const ye=Q.split("=")[0];return ye===te?(oe=!0,`${ye}=${W}`):Q}).filter(Q=>Q);return oe||ie.push(`${te}=${W}`),`#${ie.join("&")}`}return`#${W}`}_getCurrentHash(){const i=o.window.location.hash.replace("#","");if(this._hashName){let h;return i.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(h=_)}),(h&&h[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(_=>isNaN(_))){const _=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(h[3]||0):i.getBearing();return i.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:_,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=o.window.location.href.replace(/(#.+)?$/,this.getHashString());o.window.history.replaceState(o.window.history.state,null,i)}}const Ya={linearity:.3,easing:o.bezier(0,0,.3,1)},Mp=o.extend({deceleration:2500,maxSpeed:1400},Ya),Dp=o.extend({deceleration:20,maxSpeed:1400},Ya),Fp=o.extend({deceleration:1e3,maxSpeed:360},Ya),Pp=o.extend({deceleration:1e3,maxSpeed:90},Ya);class Lp{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:o.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,h=o.exported.now();for(;i.length>0&&h-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const h={zoom:0,bearing:0,pitch:0,pan:new o.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)h.zoom+=w.zoomDelta||0,h.bearing+=w.bearingDelta||0,h.pitch+=w.pitchDelta||0,w.panDelta&&h.pan._add(w.panDelta),w.around&&(h.around=w.around),w.pinchAround&&(h.pinchAround=w.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const w=En(h.pan.mag(),_,o.extend({},Mp,i||{}));v.offset=h.pan.mult(w.amount/h.pan.mag()),v.center=this._map.transform.center,Hl(v,w)}if(h.zoom){const w=En(h.zoom,_,Dp);v.zoom=this._map.transform.zoom+w.amount,Hl(v,w)}if(h.bearing){const w=En(h.bearing,_,Fp);v.bearing=this._map.transform.bearing+o.clamp(w.amount,-179,179),Hl(v,w)}if(h.pitch){const w=En(h.pitch,_,Pp);v.pitch=this._map.transform.pitch+w.amount,Hl(v,w)}if(v.zoom||v.bearing){const w=h.pinchAround===void 0?h.around:h.pinchAround;v.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Hl(d,i){(!d.duration||d.duration<i.duration)&&(d.duration=i.duration,d.easing=i.easing)}function En(d,i,h){const{maxSpeed:_,linearity:v,deceleration:w}=h,E=o.clamp(d*v/(i/1e3),-_,_),k=Math.abs(E)/(w*v);return{easing:h.easing,duration:1e3*k,amount:E*(k/2)}}class Ii extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,_,v={}){const w=Ae(h.getCanvasContainer(),_),E=h.unproject(w);super(i,o.extend({point:w,lngLat:E,originalEvent:_},v)),this._defaultPrevented=!1,this.target=h}}class Xl extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,_){const v=i==="touchend"?_.changedTouches:_.touches,w=ge(h.getCanvasContainer(),v),E=w.map(F=>h.unproject(F)),k=w.reduce((F,R,O,W)=>F.add(R.div(W.length)),new o.pointGeometry(0,0));super(i,{points:w,point:k,lngLats:E,lngLat:h.unproject(k),originalEvent:_}),this._defaultPrevented=!1}}class B_ extends o.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,h,_){super(i,{originalEvent:_}),this._defaultPrevented=!1}}class N_{constructor(i,h){this._map=i,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new B_(i.type,this._map,i))}mousedown(i,h){return this._mousedownPos=h,this._firePreventable(new Ii(i.type,this._map,i))}mouseup(i){this._map.fire(new Ii(i.type,this._map,i))}preclick(i){const h=o.extend({},i);h.type="preclick",this._map.fire(new Ii(h.type,this._map,h))}click(i,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(i),this._map.fire(new Ii(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new Ii(i.type,this._map,i))}mouseover(i){this._map.fire(new Ii(i.type,this._map,i))}mouseout(i){this._map.fire(new Ii(i.type,this._map,i))}touchstart(i){return this._firePreventable(new Xl(i.type,this._map,i))}touchmove(i){this._map.fire(new Xl(i.type,this._map,i))}touchend(i){this._map.fire(new Xl(i.type,this._map,i))}touchcancel(i){this._map.fire(new Xl(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ja{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new Ii(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ii("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new Ii(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Rp{constructor(i,h){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,h){this.isEnabled()&&i.shiftKey&&i.button===0&&(X(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(i,h){if(!this._active)return;const _=h;if(this._lastPos.equals(_)||!this._box&&_.dist(this._startPos)<this._clickTolerance)return;const v=this._startPos;this._lastPos=_,this._box||(this._box=L("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const w=Math.min(v.x,_.x),E=Math.max(v.x,_.x),k=Math.min(v.y,_.y),F=Math.max(v.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${w}px,${k}px)`,this._box.style.width=E-w+"px",this._box.style.height=F-k+"px")})}mouseupWindow(i,h){if(!this._active||i.button!==0)return;const _=this._startPos,v=h;if(this.reset(),me(),_.x!==v.x||_.y!==v.y)return this._map.fire(new o.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:w=>w.fitScreenCoordinates(_,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&i.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),K(),delete this._startPos,delete this._lastPos}_fireEvent(i,h){return this._map.fire(new o.Event(i,{originalEvent:h}))}}function Ss(d,i){const h={};for(let _=0;_<d.length;_++)h[d[_].identifier]=i[_];return h}class Ia{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,h,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=i.timeStamp),_.length===this.numTouches&&(this.centroid=function(v){const w=new o.pointGeometry(0,0);for(const E of v)w._add(E);return w.div(v.length)}(h),this.touches=Ss(_,h)))}touchmove(i,h,_){if(this.aborted||!this.centroid)return;const v=Ss(_,h);for(const w in this.touches){const E=this.touches[w],k=v[w];(!k||k.dist(E)>30)&&(this.aborted=!0)}}touchend(i,h,_){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Oo{constructor(i){this.singleTap=new Ia(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,h,_){this.singleTap.touchstart(i,h,_)}touchmove(i,h,_){this.singleTap.touchmove(i,h,_)}touchend(i,h,_){const v=this.singleTap.touchend(i,h,_);if(v){const w=i.timeStamp-this.lastTime<500,E=!this.lastTap||this.lastTap.dist(v)<30;if(w&&E||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class It{constructor(){this._zoomIn=new Oo({numTouches:1,numTaps:2}),this._zoomOut=new Oo({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,h,_){this._zoomIn.touchstart(i,h,_),this._zoomOut.touchstart(i,h,_)}touchmove(i,h,_){this._zoomIn.touchmove(i,h,_),this._zoomOut.touchmove(i,h,_)}touchend(i,h,_){const v=this._zoomIn.touchend(i,h,_),w=this._zoomOut.touchend(i,h,_);return v?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()+1,around:E.unproject(v)},{originalEvent:i})}):w?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:E=>E.easeTo({duration:300,zoom:E.getZoom()-1,around:E.unproject(w)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const zp={0:1,2:2};class cu{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,h){return!1}_move(i,h){return{}}mousedown(i,h){if(this._lastPoint)return;const _=se(i);this._correctButton(i,_)&&(this._lastPoint=h,this._eventButton=_)}mousemoveWindow(i,h){const _=this._lastPoint;if(_){if(i.preventDefault(),this._eventButton!=null&&function(v,w){const E=zp[w];return v.buttons===void 0||(v.buttons&E)!==E}(i,this._eventButton))this.reset();else if(this._moved||!(h.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(_,h)}}mouseupWindow(i){this._lastPoint&&se(i)===this._eventButton&&(this._moved&&me(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ql extends cu{mousedown(i,h){super.mousedown(i,h),this._lastPoint&&(this._active=!0)}_correctButton(i,h){return h===0&&!i.ctrlKey}_move(i,h){return{around:h,panDelta:h.sub(i)}}}class Bo extends cu{_correctButton(i,h){return h===0&&i.ctrlKey||h===2}_move(i,h){const _=.8*(h.x-i.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(i){i.preventDefault()}}class Jh extends cu{_correctButton(i,h){return h===0&&i.ctrlKey||h===2}_move(i,h){const _=-.5*(h.y-i.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(i){i.preventDefault()}}class Op{constructor(i,h){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),o.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new o.pointGeometry(0,0)}touchstart(i,h,_){return this._calculateTransform(i,h,_)}touchmove(i,h,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(_.length===1)return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.preventDefault(),this._calculateTransform(i,h,_)}}touchend(i,h,_){this._calculateTransform(i,h,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,h,_){_.length>0&&(this._active=!0);const v=Ss(_,h),w=new o.pointGeometry(0,0),E=new o.pointGeometry(0,0);let k=0;for(const R in v){const O=v[R],W=this._touches[R];W&&(w._add(O),E._add(O.sub(W)),k++,v[R]=O)}if(this._touches=v,k<this._minTouches||!E.mag())return;const F=E.div(k);return this._sum._add(F),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(k),panDelta:F}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class uu{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,h,_){return{}}touchstart(i,h,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([h[0],h[1]]))}touchmove(i,h,_){const v=this._firstTwoTouches;if(!v)return;i.preventDefault();const[w,E]=v,k=Kl(_,h,w),F=Kl(_,h,E);if(!k||!F)return;const R=this._aroundCenter?null:k.add(F).div(2);return this._move([k,F],R,i)}touchend(i,h,_){if(!this._firstTwoTouches)return;const[v,w]=this._firstTwoTouches,E=Kl(_,h,v),k=Kl(_,h,w);E&&k||(this._active&&me(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&i.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Kl(d,i,h){for(let _=0;_<d.length;_++)if(d[_].identifier===h)return i[_]}function Qh(d,i){return Math.log(d/i)/Math.LN2}class Bp extends uu{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,h){const _=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Qh(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Qh(this._distance,_),pinchAround:h}}}function ef(d,i){return 180*d.angleWith(i)/Math.PI}class hu extends uu{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,h){const _=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ef(this._vector,_),pinchAround:h}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const h=25/(Math.PI*this._minDiameter)*360,_=ef(i,this._startVector);return Math.abs(_)<h}}function Yl(d){return Math.abs(d.y)>Math.abs(d.x)}class fu extends uu{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,Yl(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,h,_){const v=this._lastPoints;if(!v)return;const w=i[0].sub(v[0]),E=i[1].sub(v[1]);return this._map._cooperativeGestures&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(w,E,_.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(w.y+E.y)/2*-.5})}gestureBeginsVertically(i,h,_){if(this._valid!==void 0)return this._valid;const v=i.mag()>=2,w=h.mag()>=2;if(!v&&!w)return;if(!v||!w)return this._firstMove==null&&(this._firstMove=_),_-this._firstMove<100&&void 0;const E=i.y>0==h.y>0;return Yl(i)&&Yl(h)&&E}}const Np={panStep:100,bearingStep:15,pitchStep:10};class Up{constructor(){const i=Np;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let h=0,_=0,v=0,w=0,E=0;switch(i.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:i.shiftKey?_=-1:(i.preventDefault(),w=-1);break;case 39:i.shiftKey?_=1:(i.preventDefault(),w=1);break;case 38:i.shiftKey?v=1:(i.preventDefault(),E=-1);break;case 40:i.shiftKey?v=-1:(i.preventDefault(),E=1);break;default:return}return this._rotationDisabled&&(_=0,v=0),{cameraAnimation:k=>{const F=k.getZoom();k.easeTo({duration:300,easeId:"keyboardHandler",easing:Vp,zoom:h?Math.round(F)+h*(i.shiftKey?2:1):F,bearing:k.getBearing()+_*this._bearingStep,pitch:k.getPitch()+v*this._pitchStep,offset:[-w*this._panStep,-E*this._panStep],center:k.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Vp(d){return d*(2-d)}const tf=4.000244140625;class jp{constructor(i,h){this._map=i,this._el=i.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,o.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&i.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=i.deltaMode===o.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const _=o.exported.now(),v=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,h!==0&&h%tf==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),i.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=i,this._delta-=h,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=Ae(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform,h=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(this._delta!==0){const F=this._type==="wheel"&&Math.abs(this._delta)>tf?this._wheelZoomRate:this._defaultZoomRate;let R=2/(1+Math.exp(-Math.abs(this._delta*F)));this._delta<0&&R!==0&&(R=1/R);const O=h(),W=Math.pow(2,O),te=typeof this._targetZoom=="number"?i.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(te*R))),this._type==="wheel"&&(this._startZoom=h(),this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:h(),v=this._startZoom,w=this._easing;let E,k=!1;if(this._type==="wheel"&&v&&w){const F=Math.min((o.exported.now()-this._lastWheelEventTime)/200,1),R=w(F);E=o.number(v,_,R),F<1?this._frameId||(this._frameId=!0):k=!0}else E=_,k=!0;return this._active=!0,k&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!k,zoomDelta:E-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let h=o.ease;if(this._prevEase){const _=this._prevEase,v=(o.exported.now()-_.start)/_.duration,w=_.easing(v+.01)-_.easing(v),E=.27/Math.sqrt(w*w+1e-4)*.01,k=Math.sqrt(.0729-E*E);h=o.bezier(E,k,.25,1)}return this._prevEase={start:o.exported.now(),duration:i,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=L("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(o.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!o.window.document.fullscreenElement||!!o.window.document.webkitFullscreenElement}_showBlockerAlert(){this._alertContainer.style.visibility==="hidden"&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class Gp{constructor(i,h){this._clickZoom=i,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class $p{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,h){return i.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(i.shiftKey?-1:1),around:_.unproject(h)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class rf{constructor(){this._tap=new Oo({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,h,_){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=h[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(i,h,_))}touchmove(i,h,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const v=h[0],w=v.y-this._swipePoint.y;return this._swipePoint=v,i.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(i,h,_)}touchend(i,h,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(i,h,_)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wp{constructor(i,h,_){this._el=i,this._mousePan=h,this._touchPan=_}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Zp{constructor(i,h,_){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=h,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Hp{constructor(i,h,_,v){this._el=i,this._touchZoom=h,this._touchRotate=_,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Jl=d=>d.zoom||d.drag||d.pitch||d.rotate;class nf extends o.Event{}class Xp{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,h){const _=o.sub([],h,i);this.radius=o.length(_[2]<0?o.div([],_,this.constants):[_[0],_[1],0])}projectRay(i){o.div(i,i,this.constants),o.normalize(i,i),o.mul$1(i,i,this.constants);const h=o.scale$2([],i,this.radius);if(h[2]>0){const _=o.scale$2([],[0,0,1],o.dot(h,[0,0,1])),v=o.scale$2([],o.normalize([],[h[0],h[1],0]),this.radius),w=o.add([],h,o.scale$2([],o.sub([],o.add([],v,_),h),2));h[0]=w[0],h[1]=w[1]}return h}}function No(d){return d.panDelta&&d.panDelta.mag()||d.zoomDelta||d.bearingDelta||d.pitchDelta}class qp{constructor(i,h){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Lp(i),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Xp,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),o.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[o.window.document,"mousemove",{capture:!0}],[o.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[o.window,"blur",void 0]];for(const[v,w,E]of this._listeners)v.addEventListener(w,v===o.window.document?this.handleWindowEvent:this.handleEvent,E)}destroy(){for(const[i,h,_]of this._listeners)i.removeEventListener(h,i===o.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(i){const h=this._map,_=h.getCanvasContainer();this._add("mapEvent",new N_(h,i));const v=h.boxZoom=new Rp(h,i);this._add("boxZoom",v);const w=new It,E=new $p;h.doubleClickZoom=new Gp(E,w),this._add("tapZoom",w),this._add("clickZoom",E);const k=new rf;this._add("tapDragZoom",k);const F=h.touchPitch=new fu(h);this._add("touchPitch",F);const R=new Bo(i),O=new Jh(i);h.dragRotate=new Zp(i,R,O),this._add("mouseRotate",R,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const W=new ql(i),te=new Op(h,i);h.dragPan=new Wp(_,W,te),this._add("mousePan",W),this._add("touchPan",te,["touchZoom","touchRotate"]);const oe=new hu,ie=new Bp;h.touchZoomRotate=new Hp(_,ie,oe,k),this._add("touchRotate",oe,["touchPan","touchZoom"]),this._add("touchZoom",ie,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ja(h));const Q=h.scrollZoom=new jp(h,this);this._add("scrollZoom",Q,["mousePan"]);const ye=h.keyboard=new Up;this._add("keyboard",ye);for(const he of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[he]&&h[he].enable(i[he])}_add(i,h,_){this._handlers.push({handlerName:i,handler:h,allowed:_}),this._handlersById[i]=h}stop(i){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Jl(this._eventsInProgress)||this.isZooming()}_blockedByActive(i,h,_){for(const v in i)if(v!==_&&(!h||h.indexOf(v)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const h=[];for(const _ of i)this._el.contains(_.target)&&h.push(_);return h}handleEvent(i,h){this._updatingCamera=!0;const _=i.type==="renderFrame",v=_?void 0:i,w={needsRenderFrame:!1},E={},k={},F=i.touches?this._getMapTouches(i.touches):void 0,R=F?ge(this._el,F):_?void 0:Ae(this._el,i);for(const{handlerName:te,handler:oe,allowed:ie}of this._handlers){if(!oe.isEnabled())continue;let Q;this._blockedByActive(k,ie,te)?oe.reset():oe[h||i.type]&&(Q=oe[h||i.type](i,R,F),this.mergeHandlerResult(w,E,Q,te,v),Q&&Q.needsRenderFrame&&this._triggerRenderFrame()),(Q||oe.isActive())&&(k[te]=oe)}const O={};for(const te in this._previousActiveHandlers)k[te]||(O[te]=v);this._previousActiveHandlers=k,(Object.keys(O).length||No(w))&&(this._changes.push([w,E,O]),this._triggerRenderFrame()),(Object.keys(k).length||No(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:W}=w;W&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],W(this._map))}mergeHandlerResult(i,h,_,v,w){if(!_)return;o.extend(i,_);const E={handlerName:v,originalEvent:_.originalEvent||w};_.zoomDelta!==void 0&&(h.zoom=E),_.panDelta!==void 0&&(h.drag=E),_.pitchDelta!==void 0&&(h.pitch=E),_.bearingDelta!==void 0&&(h.rotate=E)}_applyChanges(){const i={},h={},_={};for(const[v,w,E]of this._changes)v.panDelta&&(i.panDelta=(i.panDelta||new o.pointGeometry(0,0))._add(v.panDelta)),v.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+v.pitchDelta),v.around!==void 0&&(i.around=v.around),v.aroundCoord!==void 0&&(i.aroundCoord=v.aroundCoord),v.pinchAround!==void 0&&(i.pinchAround=v.pinchAround),v.noInertia&&(i.noInertia=v.noInertia),o.extend(h,w),o.extend(_,E);this._updateMapTransform(i,h,_),this._changes=[]}_updateMapTransform(i,h,_){const v=this._map,w=v.transform,E=_e=>[_e.x,_e.y,_e.z];if((_e=>{const xe=this._eventsInProgress.drag;return xe&&!this._handlersById[xe.handlerName].isActive()})()&&!No(i)){const _e=w.zoom;w.cameraElevationReference="sea",w.recenterOnTerrain(),w.cameraElevationReference="ground",_e!==w.zoom&&this._map._update(!0)}if(!No(i))return void this._fireEvents(h,_,!0);let{panDelta:k,zoomDelta:F,bearingDelta:R,pitchDelta:O,around:W,aroundCoord:te,pinchAround:oe}=i;oe!==void 0&&(W=oe),(_e=>h.drag&&!this._eventsInProgress.drag)()&&W&&(this._dragOrigin=E(w.pointCoordinate3D(W)),this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",v._stop(!0),W=W||v.transform.centerPoint,R&&(w.bearing+=R),O&&(w.pitch+=O),w._updateCameraState();const ie=[0,0,0];if(k){const _e=w.pointCoordinate(W);if(w.projection.name==="globe"){const xe=o.latFromMercatorY(_e.y),Te=w.center.lat,pe=Math.min(o.mercatorZfromAltitude(1,xe)/o.mercatorZfromAltitude(1,Te),2);k=k.rotate(-w.angle),ie[0]=-k.x/w.worldSize*pe,ie[1]=-k.y/w.worldSize*pe}else{const xe=w.pointCoordinate(W.sub(k));_e&&xe&&(ie[0]=xe.x-_e.x,ie[1]=xe.y-_e.y)}}const Q=w.zoom,ye=[0,0,0];if(F){const _e=E(te||w.pointCoordinate3D(W)),xe={dir:o.normalize([],o.sub([],_e,w._camera.position))};if(xe.dir[2]<0){const Te=w.zoomDeltaToMovement(_e,F);o.scale$2(ye,xe.dir,Te)}}const he=o.add(ie,ie,ye);w._translateCameraConstrained(he),F&&Math.abs(w.zoom-Q)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(h,_,!0)}_fireEvents(i,h,_){const v=Jl(this._eventsInProgress),w=Jl(i),E={};for(const O in i){const{originalEvent:W}=i[O];this._eventsInProgress[O]||(E[`${O}start`]=W),this._eventsInProgress[O]=i[O]}!v&&w&&this._fireEvent("movestart",w.originalEvent);for(const O in E)this._fireEvent(O,E[O]);w&&this._fireEvent("move",w.originalEvent);for(const O in i){const{originalEvent:W}=i[O];this._fireEvent(O,W)}const k={};let F;for(const O in this._eventsInProgress){const{handlerName:W,originalEvent:te}=this._eventsInProgress[O];this._handlersById[W].isActive()||(delete this._eventsInProgress[O],F=h[W]||te,k[`${O}end`]=F)}for(const O in k)this._fireEvent(O,k[O]);const R=Jl(this._eventsInProgress);if(_&&(v||w)&&!R){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),W=te=>te!==0&&-this._bearingSnap<te&&te<this._bearingSnap;O?(W(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:F})):(this._map.fire(new o.Event("moveend",{originalEvent:F})),W(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,h){this._map.fire(new o.Event(i,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new nf("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const du="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class af extends o.Evented{constructor(i,h){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=h.bearingSnap,o.bindAll(["_renderFrameCallback"],this)}getCenter(){return new o.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,h){return this.jumpTo({center:i},h)}panBy(i,h,_){return i=o.pointGeometry.convert(i).mult(-1),this.panTo(this.transform.center,o.extend({offset:i},h),_)}panTo(i,h,_){return this.easeTo(o.extend({center:i},h),_)}getZoom(){return this.transform.zoom}setZoom(i,h){return this.jumpTo({zoom:i},h),this}zoomTo(i,h,_){return this.easeTo(o.extend({zoom:i},h),_)}zoomIn(i,h){return this.zoomTo(this.getZoom()+1,i,h),this}zoomOut(i,h){return this.zoomTo(this.getZoom()-1,i,h),this}getBearing(){return this.transform.bearing}setBearing(i,h){return this.jumpTo({bearing:i},h),this}getPadding(){return this.transform.padding}setPadding(i,h){return this.jumpTo({padding:i},h),this}rotateTo(i,h,_){return this.easeTo(o.extend({bearing:i},h),_)}resetNorth(i,h){return this.rotateTo(0,o.extend({duration:1e3},i),h),this}resetNorthPitch(i,h){return this.easeTo(o.extend({bearing:0,pitch:0,duration:1e3},i),h),this}snapToNorth(i,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,h):this}getPitch(){return this.transform.pitch}setPitch(i,h){return this.jumpTo({pitch:i},h),this}cameraForBounds(i,h){i=o.LngLatBounds.convert(i);const _=h&&h.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),_,h)}_extendCameraOptions(i){const h={top:0,bottom:0,right:0,left:0};if(typeof(i=o.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding=="number"){const _=i.padding;i.padding={top:_,bottom:_,right:_,left:_}}return i.padding=o.extend(h,i.padding),i}_cameraForBoxAndBearing(i,h,_,v){const w=this._extendCameraOptions(v),E=this.transform,k=E.padding,F=E.project(o.LngLat.convert(i)),R=E.project(o.LngLat.convert(h)),O=new o.pointGeometry(F.x,R.y),W=new o.pointGeometry(R.x,F.y),te=-o.degToRad(_),oe=F.rotate(te),ie=R.rotate(te),Q=O.rotate(te),ye=W.rotate(te),he=new o.pointGeometry(Math.max(oe.x,ie.x,Q.x,ye.x),Math.max(oe.y,ie.y,Q.y,ye.y)),_e=new o.pointGeometry(Math.min(oe.x,ie.x,Q.x,ye.x),Math.min(oe.y,ie.y,Q.y,ye.y)),xe=he.sub(_e),Te=(E.width-((k.left||0)+(k.right||0)+w.padding.left+w.padding.right))/xe.x,pe=(E.height-((k.top||0)+(k.bottom||0)+w.padding.top+w.padding.bottom))/xe.y;if(pe<0||Te<0)return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Se=Math.min(E.scaleZoom(E.scale*Math.min(Te,pe)),w.maxZoom),je=typeof w.offset.x=="number"&&typeof w.offset.y=="number"?new o.pointGeometry(w.offset.x,w.offset.y):o.pointGeometry.convert(w.offset),Ye=new o.pointGeometry((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(_*Math.PI/180),tt=je.add(Ye).mult(E.scale/E.zoomScale(Se));return{center:E.unproject(F.add(R).div(2).sub(tt)),zoom:Se,bearing:_}}_cameraForBox(i,h,_,v,w){const E=this._extendCameraOptions(w);_=_||0,v=v||0,i=o.LngLat.convert(i),h=o.LngLat.convert(h);const k=this.transform.clone();k.padding=E.padding;const F=this.getFreeCameraOptions(),R=new o.LngLat(.5*(i.lng+h.lng),.5*(i.lat+h.lat)),O=.5*(_+v);if(k._camera.position[2]<o.mercatorZfromAltitude(O,R.lat))return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");F.lookAtPoint(R),k.setFreeCameraOptions(F);const W=o.MercatorCoordinate.fromLngLat(i),te=o.MercatorCoordinate.fromLngLat(h),oe=k.pointRayIntersection(k.centerPoint,O),ie=[(Q=k.rayIntersectionCoordinate(oe)).x,Q.y,Q.z];var Q;const ye=k.screenPointToMercatorRay(k.centerPoint),he=k.projection.name!=="globe";let _e,xe=0;do{const Te=Math.floor(k.zoom),pe=1<<Te,Se=Math.min(pe*W.x,pe*te.x),je=Math.min(pe*W.y,pe*te.y),Ye=Math.max(pe*W.x,pe*te.x),tt=Math.max(pe*W.y,pe*te.y),Qe=new o.Aabb([Se,je,_],[Ye,tt,v]),mt=o.Frustum.fromInvProjectionMatrix(k.invProjMatrix,k.worldSize,Te,he);if(Qe.intersects(mt)!==2){_e&&(k._camera.position=o.scaleAndAdd([],k._camera.position,ye.dir,-_e),k._updateStateFromCamera());break}const Ge=o.sub([],k._camera.position,ie);_e=.5*o.length(Ge),k._camera.position=o.scaleAndAdd([],k._camera.position,ye.dir,_e);try{k._updateStateFromCamera()}catch{return void o.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++xe<10);return{center:k.center,zoom:k.zoom,bearing:k.bearing,pitch:k.pitch}}fitBounds(i,h,_){return this._fitInternal(this.cameraForBounds(i,h),h,_)}_raycastElevationBox(i,h){const _=this.transform.elevation;if(!_)return;const v=new o.pointGeometry(i.x,h.y),w=new o.pointGeometry(h.x,i.y),E=_.pointCoordinate(i);if(!E)return;const k=_.pointCoordinate(h);if(!k)return;const F=_.pointCoordinate(v);if(!F)return;const R=_.pointCoordinate(w);if(!R)return;const O=new o.MercatorCoordinate(E[0],E[1]).toLngLat(),W=new o.MercatorCoordinate(k[0],k[1]).toLngLat(),te=new o.MercatorCoordinate(F[0],F[1]).toLngLat(),oe=new o.MercatorCoordinate(R[0],R[1]).toLngLat(),ie=Math.min(O.lng,Math.min(W.lng,Math.min(te.lng,oe.lng))),Q=Math.min(O.lat,Math.min(W.lat,Math.min(te.lat,oe.lat))),ye=Math.max(O.lng,Math.max(W.lng,Math.max(te.lng,oe.lng))),he=Math.max(O.lat,Math.max(W.lat,Math.max(te.lat,oe.lat))),_e=Math.min(E[3],Math.min(k[3],Math.min(F[3],R[3]))),xe=Math.max(E[3],Math.max(k[3],Math.max(F[3],R[3])));return{minLngLat:new o.LngLat(ie,Q),maxLngLat:new o.LngLat(ye,he),minAltitude:_e,maxAltitude:xe}}fitScreenCoordinates(i,h,_,v,w){let E,k,F,R;const O=o.pointGeometry.convert(i),W=o.pointGeometry.convert(h),te=this._raycastElevationBox(O,W);if(te)E=te.minLngLat,k=te.maxLngLat,F=te.minAltitude,R=te.maxAltitude;else{if(this.transform.anyCornerOffEdge(O,W))return this;E=this.transform.pointLocation(O),k=this.transform.pointLocation(W)}return this._fitInternal(this.transform.pitch===0?this._cameraForBoxAndBearing(this.transform.pointLocation(o.pointGeometry.convert(i)),this.transform.pointLocation(o.pointGeometry.convert(h)),_,v):this._cameraForBox(E,k,F,R,v),v,w)}_fitInternal(i,h,_){return i?(delete(h=o.extend(i,h)).padding,h.linear?this.easeTo(h,_):this.flyTo(h,_)):this}jumpTo(i,h){this.stop();const _=i.preloadOnly?this.transform.clone():this.transform;let v=!1,w=!1,E=!1;return"zoom"in i&&_.zoom!==+i.zoom&&(v=!0,_.zoom=+i.zoom),i.center!==void 0&&(_.center=o.LngLat.convert(i.center)),"bearing"in i&&_.bearing!==+i.bearing&&(w=!0,_.bearing=+i.bearing),"pitch"in i&&_.pitch!==+i.pitch&&(E=!0,_.pitch=+i.pitch),i.padding==null||_.isPaddingEqual(i.padding)||(_.padding=i.padding),i.preloadOnly?(this._preloadTiles(_),this):(this.fire(new o.Event("movestart",h)).fire(new o.Event("move",h)),v&&this.fire(new o.Event("zoomstart",h)).fire(new o.Event("zoom",h)).fire(new o.Event("zoomend",h)),w&&this.fire(new o.Event("rotatestart",h)).fire(new o.Event("rotate",h)).fire(new o.Event("rotateend",h)),E&&this.fire(new o.Event("pitchstart",h)).fire(new o.Event("pitch",h)).fire(new o.Event("pitchend",h)),this.fire(new o.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||o.warnOnce(du),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,h){const _=this.transform;if(!_.projection.supportsFreeCamera)return o.warnOnce(du),this;this.stop();const v=_.zoom,w=_.pitch,E=_.bearing;_.setFreeCameraOptions(i);const k=v!==_.zoom,F=w!==_.pitch,R=E!==_.bearing;return this.fire(new o.Event("movestart",h)).fire(new o.Event("move",h)),k&&this.fire(new o.Event("zoomstart",h)).fire(new o.Event("zoom",h)).fire(new o.Event("zoomend",h)),R&&this.fire(new o.Event("rotatestart",h)).fire(new o.Event("rotate",h)).fire(new o.Event("rotateend",h)),F&&this.fire(new o.Event("pitchstart",h)).fire(new o.Event("pitch",h)).fire(new o.Event("pitchend",h)),this.fire(new o.Event("moveend",h)),this}easeTo(i,h){this._stop(!1,i.easeId),((i=o.extend({offset:[0,0],duration:500,easing:o.ease},i)).animate===!1||!i.essential&&o.exported.prefersReducedMotion)&&(i.duration=0);const _=this.transform,v=this.getZoom(),w=this.getBearing(),E=this.getPitch(),k=this.getPadding(),F="zoom"in i?+i.zoom:v,R="bearing"in i?this._normalizeBearing(i.bearing,w):w,O="pitch"in i?+i.pitch:E,W="padding"in i?i.padding:_.padding,te=o.pointGeometry.convert(i.offset);let oe,ie,Q;if(_.projection.name==="globe"){const tt=o.MercatorCoordinate.fromLngLat(_.center),Qe=te.rotate(-_.angle);tt.x+=Qe.x/_.worldSize,tt.y+=Qe.y/_.worldSize;const mt=tt.toLngLat(),Ge=o.LngLat.convert(i.center||mt);this._normalizeCenter(Ge),oe=_.centerPoint.add(Qe),ie=new o.pointGeometry(tt.x,tt.y).mult(_.worldSize),Q=new o.pointGeometry(o.mercatorXfromLng(Ge.lng),o.mercatorYfromLat(Ge.lat)).mult(_.worldSize).sub(ie)}else{oe=_.centerPoint.add(te);const tt=_.pointLocation(oe),Qe=o.LngLat.convert(i.center||tt);this._normalizeCenter(Qe),ie=_.project(tt),Q=_.project(Qe).sub(ie)}const ye=_.zoomScale(F-v);let he,_e;i.around&&(he=o.LngLat.convert(i.around),_e=_.locationPoint(he));const xe=this._zooming||F!==v,Te=this._rotating||w!==R,pe=this._pitching||O!==E,Se=!_.isPaddingEqual(W),je=tt=>Qe=>{if(xe&&(tt.zoom=o.number(v,F,Qe)),Te&&(tt.bearing=o.number(w,R,Qe)),pe&&(tt.pitch=o.number(E,O,Qe)),Se&&(tt.interpolatePadding(k,W,Qe),oe=tt.centerPoint.add(te)),he)tt.setLocationAtPoint(he,_e);else{const mt=tt.zoomScale(tt.zoom-v),Ge=F>v?Math.min(2,ye):Math.max(.5,ye),_t=Math.pow(Ge,1-Qe),ht=tt.unproject(ie.add(Q.mult(Qe*_t)).mult(mt));tt.setLocationAtPoint(tt.renderWorldCopies?ht.wrap():ht,oe)}return i.preloadOnly||this._fireMoveEvents(h),tt};if(i.preloadOnly){const tt=this._emulate(je,i.duration,_);return this._preloadTiles(tt),this}const Ye={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=xe,this._rotating=Te,this._pitching=pe,this._padding=Se,this._easeId=i.easeId,this._prepareEase(h,i.noMoveStart,Ye),this._ease(je(_),tt=>{_.recenterOnTerrain(),this._afterEase(h,tt)},i),this}_prepareEase(i,h,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||_.moving||this.fire(new o.Event("movestart",i)),this._zooming&&!_.zooming&&this.fire(new o.Event("zoomstart",i)),this._rotating&&!_.rotating&&this.fire(new o.Event("rotatestart",i)),this._pitching&&!_.pitching&&this.fire(new o.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new o.Event("move",i)),this._zooming&&this.fire(new o.Event("zoom",i)),this._rotating&&this.fire(new o.Event("rotate",i)),this._pitching&&this.fire(new o.Event("pitch",i))}_afterEase(i,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,v=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new o.Event("zoomend",i)),v&&this.fire(new o.Event("rotateend",i)),w&&this.fire(new o.Event("pitchend",i)),this.fire(new o.Event("moveend",i))}flyTo(i,h){if(!i.essential&&o.exported.prefersReducedMotion){const Pt=o.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Pt,h)}this.stop(),i=o.extend({offset:[0,0],speed:1.2,curve:1.42,easing:o.ease},i);const _=this.transform,v=this.getZoom(),w=this.getBearing(),E=this.getPitch(),k=this.getPadding(),F="zoom"in i?o.clamp(+i.zoom,_.minZoom,_.maxZoom):v,R="bearing"in i?this._normalizeBearing(i.bearing,w):w,O="pitch"in i?+i.pitch:E,W="padding"in i?i.padding:_.padding,te=_.zoomScale(F-v),oe=o.pointGeometry.convert(i.offset);let ie=_.centerPoint.add(oe);const Q=_.pointLocation(ie),ye=o.LngLat.convert(i.center||Q);this._normalizeCenter(ye);const he=_.project(Q),_e=_.project(ye).sub(he);let xe=i.curve;const Te=Math.max(_.width,_.height),pe=Te/te,Se=_e.mag();if("minZoom"in i){const Pt=o.clamp(Math.min(i.minZoom,v,F),_.minZoom,_.maxZoom),Lt=Te/_.zoomScale(Pt-v);xe=Math.sqrt(Lt/Se*2)}const je=xe*xe;function Ye(Pt){const Lt=(pe*pe-Te*Te+(Pt?-1:1)*je*je*Se*Se)/(2*(Pt?pe:Te)*je*Se);return Math.log(Math.sqrt(Lt*Lt+1)-Lt)}function tt(Pt){return(Math.exp(Pt)-Math.exp(-Pt))/2}function Qe(Pt){return(Math.exp(Pt)+Math.exp(-Pt))/2}const mt=Ye(0);let Ge=function(Pt){return Qe(mt)/Qe(mt+xe*Pt)},_t=function(Pt){return Te*((Qe(mt)*(tt(Lt=mt+xe*Pt)/Qe(Lt))-tt(mt))/je)/Se;var Lt},ht=(Ye(1)-mt)/xe;if(Math.abs(Se)<1e-6||!isFinite(ht)){if(Math.abs(Te-pe)<1e-6)return this.easeTo(i,h);const Pt=pe<Te?-1:1;ht=Math.abs(Math.log(pe/Te))/xe,_t=function(){return 0},Ge=function(Lt){return Math.exp(Pt*xe*Lt)}}i.duration="duration"in i?+i.duration:1e3*ht/("screenSpeed"in i?+i.screenSpeed/xe:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const Rt=w!==R,rt=O!==E,Ft=!_.isPaddingEqual(W),$t=Pt=>Lt=>{const Ht=Lt*ht,er=1/Ge(Ht);Pt.zoom=Lt===1?F:v+Pt.scaleZoom(er),Rt&&(Pt.bearing=o.number(w,R,Lt)),rt&&(Pt.pitch=o.number(E,O,Lt)),Ft&&(Pt.interpolatePadding(k,W,Lt),ie=Pt.centerPoint.add(oe));const jt=Lt===1?ye:Pt.unproject(he.add(_e.mult(_t(Ht))).mult(er));return Pt.setLocationAtPoint(Pt.renderWorldCopies?jt.wrap():jt,ie),Pt._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(h),Pt};if(i.preloadOnly){const Pt=this._emulate($t,i.duration,_);return this._preloadTiles(Pt),this}return this._zooming=!0,this._rotating=Rt,this._pitching=rt,this._padding=Ft,this._prepareEase(h,!1),this._ease($t(_),()=>this._afterEase(h),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,h)}if(!i){const _=this.handlers;_&&_.stop(!1)}return this}_ease(i,h,_){_.animate===!1||_.duration===0?(i(1),h()):(this._easeStart=o.exported.now(),this._easeOptions=_,this._onEaseFrame=i,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((o.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,h){i=o.wrap(i,-180,180);const _=Math.abs(i-h);return Math.abs(i-360-h)<_&&(i-=360),Math.abs(i+360-h)<_&&(i+=360),i}_normalizeCenter(i){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const _=i.lng-h.center.lng;i.lng+=_>180?-360:_<-180?360:0}_emulate(i,h,_){const v=Math.ceil(15*h/1e3),w=[],E=i(_.clone());for(let k=0;k<=v;k++){const F=E(k/v);w.push(F.clone())}return w}}class pu{constructor(i={}){this.options=i,o.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const h=this.options&&this.options.compact;return this._map=i,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=L("button","mapboxgl-ctrl-attrib-button",this._container),L("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=L("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,h){const _=this._map._getUIString(`AttributionControl.${h}`);i.setAttribute("aria-label",_),i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||o.config.ACCESS_TOKEN}];if(i){const _=h.reduce((v,w,E)=>(w.value&&(v+=`${w.key}=${w.value}${E<h.length-1?"&":""}`),v),"?");i.href=`${o.config.FEEDBACK_URL}/${_}${this._map._hash?this._map._hash.getHashString(!0):""}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||i.sourceDataType!=="metadata"&&i.sourceDataType!=="visibility"&&i.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style._sourceCaches;for(const v in h){const w=h[v];if(w.used){const E=w.getSource();E.attribution&&i.indexOf(E.attribution)<0&&i.push(E.attribution)}}i.sort((v,w)=>v.length-w.length),i=i.filter((v,w)=>{for(let E=w+1;E<i.length;E++)if(i[E].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const _=i.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,i.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Kp{constructor(){o.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=L("div","mapboxgl-ctrl");const h=L("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&i.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(Object.entries(i).length===0)return!0;for(const h in i){const _=i[h].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const h=i[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Yp{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const h=++this._id;return this._queue.push({callback:i,id:h,cancelled:!1}),h}remove(i){const h=this._currentlyRunning,_=h?this._queue.concat(h):this._queue;for(const v of _)if(v.id===i)return void(v.cancelled=!0)}run(i=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const _ of h)if(!_.cancelled&&(_.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function mu(d,i,h){if(d=new o.LngLat(d.lng,d.lat),i){const _=new o.LngLat(d.lng-360,d.lat),v=new o.LngLat(d.lng+360,d.lat),w=360*Math.ceil(Math.abs(d.lng-h.center.lng)/360),E=h.locationPoint(d).distSqr(i),k=i.x<0||i.y<0||i.x>h.width||i.y>h.height;h.locationPoint(_).distSqr(i)<E&&(k||Math.abs(_.lng-h.center.lng)<w)?d=_:h.locationPoint(v).distSqr(i)<E&&(k||Math.abs(v.lng-h.center.lng)<w)&&(d=v)}for(;Math.abs(d.lng-h.center.lng)>180;){const _=h.locationPoint(d);if(_.x>=0&&_.y>=0&&_.x<=h.width&&_.y<=h.height)break;d.lng>h.center.lng?d.lng-=360:d.lng+=360}return d}const _u={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class gu extends o.Evented{constructor(i,h){if(super(),(i instanceof o.window.HTMLElement||h)&&(i=o.extend({element:i},h)),o.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment!=="auto"?i.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),i&&i.element)this._element=i.element,this._offset=o.pointGeometry.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=L("div");const v=41,w=27,E=B("svg",{display:"block",height:v*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${v}`},this._element),k=B("radialGradient",{id:"shadowGradient"},B("defs",{},E));B("stop",{offset:"10%","stop-opacity":.4},k),B("stop",{offset:"100%","stop-opacity":.05},k),B("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},E),B("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},E),B("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},E),B("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},E),this._offset=o.pointGeometry.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()});const _=this._element.classList;for(const v in _u)_.remove(`mapboxgl-marker-anchor-${v}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=o.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(38.1-13.5+v)],"bottom-right":[-v,-1*(38.1-13.5+v)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const h=i.code,_=i.charCode||i.keyCode;h!=="Space"&&h!=="Enter"&&_!==32&&_!==13||this.togglePopup()}_onMapClick(i){const h=i.originalEvent.target,_=this._element;this._popup&&(h===_||_.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const i=this._map;if(!i)return;const h=this._pos;if(!h||h.x<0||h.x>i.transform.width||h.y<0||h.y>i.transform.height)return void this._clearFadeTimer();const _=i.unproject(h);let v=!1;if(i.transform._terrainEnabled()&&i.getTerrain()){const E=i.getFreeCameraOptions();if(E.position){const k=E.position.toLngLat();v=k.distanceTo(_)<.9*k.distanceTo(this._lngLat)}}const w=(1-i._queryFogOpacity(_))*(v?.2:1);this._element.style.opacity=`${w}`,this._popup&&this._popup._setOpacity(`${w}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i)return;const h=this._offset.mult(this._scale),_=this._calculatePitch(),v=this._calculateRotation();this._element.style.transform=`
            translate(${i.x}px, ${i.y}px) ${_u[this._anchor]}
            rotateX(${_}deg) rotateZ(${v}deg)
            translate(${h.x}px, ${h.y}px)
        `}_calculatePitch(){return this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?0:this._map&&this._pitchAlignment==="map"?this._map.getPitch():0}_calculateRotation(){return this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?this._rotation:this._map&&this._rotationAlignment==="map"?this._rotation-this._map.getBearing():0}_update(i){o.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=mu(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),i===!0?this._updateFrameId=o.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!h.getTerrain()&&!h.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=o.pointGeometry.convert(i),this._update(),this}_onMove(i){const h=this._map;if(h){if(!this._isDragging){const _=this._clickTolerance||h._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=_}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new o.Event("dragstart"))),this.fire(new o.Event("drag")))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new o.Event("dragend")),this._state="inactive"}_addDragHandler(i){const h=this._map;h&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos),this._pointerdownPos=i.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const h=this._map;return h&&(i?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&i!=="auto"?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class U_{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const h=o.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,h,_){this._start=this.getValue(h),this._end=i,this._startTime=h,this._endTime=h+_}}const V_={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},sf={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Ql(d){d.parentNode&&d.parentNode.removeChild(d)}const of={showCompass:!0,showZoom:!0,visualizePitch:!1};class lf{constructor(i,h,_=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Bo({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,_&&(this.mousePitch=new Jh({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),o.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(i,h){this.mouseRotate.mousedown(i,h),this.mousePitch&&this.mousePitch.mousedown(i,h),X()}move(i,h){const _=this.map,v=this.mouseRotate.mousemoveWindow(i,h),w=v&&v.bearingDelta;if(w&&_.setBearing(_.getBearing()+w),this.mousePitch){const E=this.mousePitch.mousemoveWindow(i,h),k=E&&E.pitchDelta;k&&_.setPitch(_.getPitch()+k)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){K(),o.window.removeEventListener("mousemove",this.mousemove),o.window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(o.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),Ae(this.element,i)),o.window.addEventListener("mousemove",this.mousemove),o.window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,Ae(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){i.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ge(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){i.targetTouches.length!==1?this.reset():(this._lastPos=ge(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){i.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const si={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let Mi,ec=0,to=!1;const cf={maxWidth:100,unit:"metric"};function xu(d,i,h){const _=h&&h.maxWidth||100,v=d._containerHeight/2,w=d._containerWidth/2-_/2,E=d.unproject([w,v]),k=d.unproject([w+_,v]),F=E.distanceTo(k);if(h&&h.unit==="imperial"){const R=3.2808*F;R>5280?Uo(i,_,R/5280,d._getUIString("ScaleControl.Miles"),d):Uo(i,_,R,d._getUIString("ScaleControl.Feet"),d)}else h&&h.unit==="nautical"?Uo(i,_,F/1852,d._getUIString("ScaleControl.NauticalMiles"),d):F>=1e3?Uo(i,_,F/1e3,d._getUIString("ScaleControl.Kilometers"),d):Uo(i,_,F,d._getUIString("ScaleControl.Meters"),d)}function Uo(d,i,h,_,v){const w=function(k){const F=Math.pow(10,`${Math.floor(k)}`.length-1);let R=k/F;return R=R>=10?10:R>=5?5:R>=3?3:R>=2?2:R>=1?1:function(O){const W=Math.pow(10,Math.ceil(-Math.log(O)/Math.LN10));return Math.round(O*W)/W}(R),F*R}(h),E=w/h;v._requestDomTask(()=>{d.style.width=i*E+"px",d.innerHTML=`${w}&nbsp;${_}`})}const Xi={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Fr=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function tc(d=new o.pointGeometry(0,0),i="bottom"){if(typeof d=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(d,2)));switch(i){case"top":return new o.pointGeometry(0,d);case"top-left":return new o.pointGeometry(h,h);case"top-right":return new o.pointGeometry(-h,h);case"bottom":return new o.pointGeometry(0,-d);case"bottom-left":return new o.pointGeometry(h,-h);case"bottom-right":return new o.pointGeometry(-h,-h);case"left":return new o.pointGeometry(d,0);case"right":return new o.pointGeometry(-d,0)}return new o.pointGeometry(0,0)}return d instanceof o.pointGeometry||Array.isArray(d)?o.pointGeometry.convert(d):o.pointGeometry.convert(d[i]||[0,0])}const Vo={version:o.version,supported:S,setRTLTextPlugin:o.setRTLTextPlugin,getRTLTextPluginStatus:o.getRTLTextPluginStatus,Map:class extends af{constructor(d){if((d=o.extend({},sf,d)).minZoom!=null&&d.maxZoom!=null&&d.minZoom>d.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(d.minPitch!=null&&d.maxPitch!=null&&d.minPitch>d.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(d.minPitch!=null&&d.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(d.maxPitch!=null&&d.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(d.antialias&&o.isSafariWithAntialiasingBug(o.window)&&(d.antialias=!1,o.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new lu(d.minZoom,d.maxZoom,d.minPitch,d.maxPitch,d.renderWorldCopies),d),this._interactive=d.interactive,this._minTileCacheSize=d.minTileCacheSize,this._maxTileCacheSize=d.maxTileCacheSize,this._failIfMajorPerformanceCaveat=d.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=d.preserveDrawingBuffer,this._antialias=d.antialias,this._trackResize=d.trackResize,this._bearingSnap=d.bearingSnap,this._refreshExpiredTiles=d.refreshExpiredTiles,this._fadeDuration=d.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=d.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=d.collectResourceTiming,this._optimizeForTerrain=d.optimizeForTerrain,this._renderTaskQueue=new Yp,this._domRenderTaskQueue=new Yp,this._controls=[],this._markers=[],this._mapId=o.uniqueId(),this._locale=o.extend({},V_,d.locale),this._clickTolerance=d.clickTolerance,this._cooperativeGestures=d.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new U_(0),this._explicitProjection=null,this._requestManager=new o.RequestManager(d.transformRequest,d.accessToken,d.testMode),this._silenceAuthErrors=!!d.testMode,typeof d.container=="string"){if(this._container=o.window.document.getElementById(d.container),!this._container)throw new Error(`Container '${d.container}' not found.`)}else{if(!(d.container instanceof o.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=d.container}if(this._container.childNodes.length>0&&o.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),d.maxBounds&&this.setMaxBounds(d.maxBounds),o.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),o.window!==void 0&&(o.window.addEventListener("online",this._onWindowOnline,!1),o.window.addEventListener("resize",this._onWindowResize,!1),o.window.addEventListener("orientationchange",this._onWindowResize,!1),o.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new qp(this,d),this._localFontFamily=d.localFontFamily,this._localIdeographFontFamily=d.localIdeographFontFamily,d.style&&this.setStyle(d.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),d.projection&&this.setProjection(d.projection),this._hash=d.hash&&new Ip(typeof d.hash=="string"&&d.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch}),d.bounds&&(this.resize(),this.fitBounds(d.bounds,o.extend({},d.fitBoundsOptions,{duration:0})))),this.resize(),d.attributionControl&&this.addControl(new pu({customAttribution:d.customAttribution})),this._logoControl=new Kp,this.addControl(this._logoControl,d.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update(i.dataType==="style"),this.fire(new o.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new o.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(d,i){if(i===void 0&&(i=d.getDefaultPosition?d.getDefaultPosition():"top-right"),!d||!d.onAdd)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=d.onAdd(this);this._controls.push(d);const _=this._controlPositions[i];return i.indexOf("bottom")!==-1?_.insertBefore(h,_.firstChild):_.appendChild(h),this}removeControl(d){if(!d||!d.onRemove)return this.fire(new o.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(d);return i>-1&&this._controls.splice(i,1),d.onRemove(this),this}hasControl(d){return this._controls.indexOf(d)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(d){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new o.Event("movestart",d)).fire(new o.Event("move",d)),this.fire(new o.Event("resize",d)),i&&this.fire(new o.Event("moveend",d)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(d){return this.transform.setMaxBounds(o.LngLatBounds.convert(d)),this._update()}setMinZoom(d){if((d=d==null?-2:d)>=-2&&d<=this.transform.maxZoom)return this.transform.minZoom=d,this._update(),this.getZoom()<d?this.setZoom(d):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(d){if((d=d==null?22:d)>=this.transform.minZoom)return this.transform.maxZoom=d,this._update(),this.getZoom()>d?this.setZoom(d):this.fire(new o.Event("zoomstart")).fire(new o.Event("zoom")).fire(new o.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(d){if((d=d==null?0:d)<0)throw new Error("minPitch must be greater than or equal to 0");if(d>=0&&d<=this.transform.maxPitch)return this.transform.minPitch=d,this._update(),this.getPitch()<d?this.setPitch(d):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(d){if((d=d==null?85:d)>85)throw new Error("maxPitch must be less than or equal to 85");if(d>=this.transform.minPitch)return this.transform.maxPitch=d,this._update(),this.getPitch()>d?this.setPitch(d):this.fire(new o.Event("pitchstart")).fire(new o.Event("pitch")).fire(new o.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(d){return this.transform.renderWorldCopies=d,this._update()}getProjection(){return this._explicitProjection?this._explicitProjection:this.style&&this.style.stylesheet&&this.style.stylesheet.projection?this.style.stylesheet.projection:{name:"mercator",center:[0,0]}}setProjection(d){return this._lazyInitEmptyStyle(),d?typeof d=="string"&&(d={name:d}):d=null,this._updateProjection(d)}_updateProjection(d){d===null&&(this._explicitProjection=null);const i=d||this.getProjection(),h=this.transform.setProjection(i);if(d&&(this._explicitProjection=this.transform.getProjection()),h){this.painter.clearBackgroundTiles();for(const _ in this.style._sourceCaches)this.style._sourceCaches[_].clearTiles();this.style.applyProjectionUpdate(),this._update(!0)}return this}project(d){return this.transform.locationPoint3D(o.LngLat.convert(d))}unproject(d){return this.transform.pointLocation3D(o.pointGeometry.convert(d))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_createDelegatedListener(d,i,h){if(d==="mouseenter"||d==="mouseover"){let _=!1;const v=E=>{const k=i.filter(R=>this.getLayer(R)),F=k.length?this.queryRenderedFeatures(E.point,{layers:k}):[];F.length?_||(_=!0,h.call(this,new Ii(d,this,E.originalEvent,{features:F}))):_=!1},w=()=>{_=!1};return{layers:new Set(i),listener:h,delegates:{mousemove:v,mouseout:w}}}if(d==="mouseleave"||d==="mouseout"){let _=!1;const v=E=>{const k=i.filter(F=>this.getLayer(F));(k.length?this.queryRenderedFeatures(E.point,{layers:k}):[]).length?_=!0:_&&(_=!1,h.call(this,new Ii(d,this,E.originalEvent)))},w=E=>{_&&(_=!1,h.call(this,new Ii(d,this,E.originalEvent)))};return{layers:new Set(i),listener:h,delegates:{mousemove:v,mouseout:w}}}{const _=v=>{const w=i.filter(k=>this.getLayer(k)),E=w.length?this.queryRenderedFeatures(v.point,{layers:w}):[];E.length&&(v.features=E,h.call(this,v),delete v.features)};return{layers:new Set(i),listener:h,delegates:{[d]:_}}}}on(d,i,h){if(h===void 0)return super.on(d,i);Array.isArray(i)||(i=[i]);const _=this._createDelegatedListener(d,i,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[d]=this._delegatedListeners[d]||[],this._delegatedListeners[d].push(_);for(const v in _.delegates)this.on(v,_.delegates[v]);return this}once(d,i,h){if(h===void 0)return super.once(d,i);Array.isArray(i)||(i=[i]);const _=this._createDelegatedListener(d,i,h);for(const v in _.delegates)this.once(v,_.delegates[v]);return this}off(d,i,h){if(h===void 0)return super.off(d,i);i=new Set(Array.isArray(i)?i:[i]);const _=(w,E)=>{if(w.size!==E.size)return!1;for(const k of w)if(!E.has(k))return!1;return!0},v=this._delegatedListeners?this._delegatedListeners[d]:void 0;return v&&(w=>{for(let E=0;E<w.length;E++){const k=w[E];if(k.listener===h&&_(k.layers,i)){for(const F in k.delegates)this.off(F,k.delegates[F]);return w.splice(E,1),this}}})(v),this}queryRenderedFeatures(d,i){return this.style?(i!==void 0||d===void 0||d instanceof o.pointGeometry||Array.isArray(d)||(i=d,d=void 0),this.style.queryRenderedFeatures(d=d||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(d,i){return this.style.querySourceFeatures(d,i)}queryTerrainElevation(d,i){const h=this.transform.elevation;return h?(i=o.extend({},{exaggerated:!0},i),h.getAtPoint(o.MercatorCoordinate.fromLngLat(d),null,i.exaggerated)):null}setStyle(d,i){return(i=o.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff!==!1&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&d?(this._diffStyle(d,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(d,i))}_getUIString(d){const i=this._locale[d];if(i==null)throw new Error(`Missing UI string '${d}'`);return i}_updateStyle(d,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),d&&(this.style=new ai(this,i||{}),this.style.setEventedParent(this,{style:this.style}),typeof d=="string"?this.style.loadURL(d):this.style.loadJSON(d)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ai(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(d,i){if(typeof d=="string"){const h=this._requestManager.normalizeStyleURL(d),_=this._requestManager.transformRequest(h,o.ResourceType.Style);o.getJSON(_,(v,w)=>{v?this.fire(new o.ErrorEvent(v)):w&&this._updateDiff(w,i)})}else typeof d=="object"&&this._updateDiff(d,i)}_updateDiff(d,i){try{this.style.setState(d)&&this._update(!0)}catch(h){o.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(d,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(o.warnOnce("There is no style added to the map."),!1)}addSource(d,i){return this._lazyInitEmptyStyle(),this.style.addSource(d,i),this._update(!0)}isSourceLoaded(d){return!!this.style&&this.style._isSourceCacheLoaded(d)}areTilesLoaded(){const d=this.style&&this.style._sourceCaches;for(const i in d){const h=d[i]._tiles;for(const _ in h){const v=h[_];if(v.state!=="loaded"&&v.state!=="errored")return!1}}return!0}addSourceType(d,i,h){this._lazyInitEmptyStyle(),this.style.addSourceType(d,i,h)}removeSource(d){return this.style.removeSource(d),this._updateTerrain(),this._update(!0)}getSource(d){return this.style.getSource(d)}addImage(d,i,{pixelRatio:h=1,sdf:_=!1,stretchX:v,stretchY:w,content:E}={}){if(this._lazyInitEmptyStyle(),i instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&i instanceof o.window.ImageBitmap){const{width:k,height:F,data:R}=o.exported.getImageData(i);this.style.addImage(d,{data:new o.RGBAImage({width:k,height:F},R),pixelRatio:h,stretchX:v,stretchY:w,content:E,sdf:_,version:0})}else if(i.width===void 0||i.height===void 0)this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:k,height:F}=i,R=i;this.style.addImage(d,{data:new o.RGBAImage({width:k,height:F},new Uint8Array(R.data)),pixelRatio:h,stretchX:v,stretchY:w,content:E,sdf:_,version:0,userImage:R}),R.onAdd&&R.onAdd(this,d)}}updateImage(d,i){const h=this.style.getImage(d);if(!h)return void this.fire(new o.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=i instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&i instanceof o.window.ImageBitmap?o.exported.getImageData(i):i,{width:v,height:w}=_;v!==void 0&&w!==void 0?v===h.data.width&&w===h.data.height?(h.data.replace(_.data,!(i instanceof o.window.HTMLImageElement||o.window.ImageBitmap&&i instanceof o.window.ImageBitmap)),this.style.updateImage(d,h)):this.fire(new o.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):this.fire(new o.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(d){return d?!!this.style.getImage(d):(this.fire(new o.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(d){this.style.removeImage(d)}loadImage(d,i){o.getImage(this._requestManager.transformRequest(d,o.ResourceType.Image),(h,_)=>{i(h,_ instanceof o.window.HTMLImageElement?o.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(d,i){return this._lazyInitEmptyStyle(),this.style.addLayer(d,i),this._update(!0)}moveLayer(d,i){return this.style.moveLayer(d,i),this._update(!0)}removeLayer(d){return this.style.removeLayer(d),this._update(!0)}getLayer(d){return this.style.getLayer(d)}setLayerZoomRange(d,i,h){return this.style.setLayerZoomRange(d,i,h),this._update(!0)}setFilter(d,i,h={}){return this.style.setFilter(d,i,h),this._update(!0)}getFilter(d){return this.style.getFilter(d)}setPaintProperty(d,i,h,_={}){return this.style.setPaintProperty(d,i,h,_),this._update(!0)}getPaintProperty(d,i){return this.style.getPaintProperty(d,i)}setLayoutProperty(d,i,h,_={}){return this.style.setLayoutProperty(d,i,h,_),this._update(!0)}getLayoutProperty(d,i){return this.style.getLayoutProperty(d,i)}setLight(d,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(d,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(d){return this._lazyInitEmptyStyle(),!d&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(d),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(d){return this._lazyInitEmptyStyle(),this.style.setFog(d),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(d){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(o.LngLat.convert(d),this.transform):0}setFeatureState(d,i){return this.style.setFeatureState(d,i),this._update()}removeFeatureState(d,i){return this.style.removeFeatureState(d,i),this._update()}getFeatureState(d){return this.style.getFeatureState(d)}_updateContainerDimensions(){if(!this._container)return;const d=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let h,_,v,w=this._container;for(;w&&(!_||!v);){const E=o.window.getComputedStyle(w).transform;E&&E!=="none"&&(h=E.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(_=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(v=h[3])),w=w.parentElement}this._containerWidth=_?Math.abs(d/_):d,this._containerHeight=v?Math.abs(i/v):i}_detectMissingCSS(){o.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&o.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const d=this._container;d.classList.add("mapboxgl-map"),(this._missingCSSCanary=L("div","mapboxgl-canary",d)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=L("div","mapboxgl-canvas-container",d);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=L("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=L("div","mapboxgl-control-container",d),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{_[v]=L("div",`mapboxgl-ctrl-${v}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(d,i){const h=o.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(d),this._canvas.height=h*Math.ceil(i),this._canvas.style.width=`${d}px`,this._canvas.style.height=`${i}px`}_addMarker(d){this._markers.push(d)}_removeMarker(d){const i=this._markers.indexOf(d);i!==-1&&this._markers.splice(i,1)}_setupPainter(){const d=o.extend({},S.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",d)||this._canvas.getContext("experimental-webgl",d);i?(o.storeAuthState(i,!0),this.painter=new Ap(i,this.transform),this.on("data",h=>{h.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),o.exported$1.testSupport(i)):this.fire(new o.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(d){d.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new o.Event("webglcontextlost",{originalEvent:d}))}_contextRestored(d){this._setupPainter(),this.resize(),this._update(),this.fire(new o.Event("webglcontextrestored",{originalEvent:d}))}_onMapScroll(d){if(d.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(d){return this.style?(this._styleDirty=this._styleDirty||d,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(d){return this._update(),this._renderTaskQueue.add(d)}_cancelRenderFrame(d){this._renderTaskQueue.remove(d)}_requestDomTask(d){!this.loaded()||this.loaded()&&!this.isMoving()?d():this._domRenderTaskQueue.add(d)}_render(d){let i;const h=this.painter.context.extTimerQuery,_=o.exported.now();if(this.listens("gpu-timing-frame")&&(i=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(d),this._domRenderTaskQueue.run(d),this._removed)return;let v=!1;const w=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const F=this.transform.zoom,R=this.transform.pitch,O=o.exported.now();this.style.zoomHistory.update(F,O);const W=new o.EvaluationParameters(F,{now:O,fadeDuration:w,pitch:R,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),te=W.crossFadingFactor();te===1&&te===this._crossFadingFactor||(v=!0,this._crossFadingFactor=te),this.style.update(W)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let E=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),E=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerUpdate()):E=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,w,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:w,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new o.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new o.Event("load"))),this.style&&(this.style.hasTransitions()||v)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const F=o.exported.now()-_;h.endQueryEXT(h.TIME_ELAPSED_EXT,i),setTimeout(()=>{const R=h.getQueryObjectEXT(i,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(i),this.fire(new o.Event("gpu-timing-frame",{cpuTime:F,gpuTime:R}))},50)}if(this.listens("gpu-timing-layer")){const F=this.painter.collectGpuTimers();setTimeout(()=>{const R=this.painter.queryGpuTimers(F);this.fire(new o.Event("gpu-timing-layer",{layerTimes:R}))},50)}const k=this._sourcesDirty||this._styleDirty||this._placementDirty||E;if(k||this._repaint)this.triggerRepaint();else{const F=!this.isMoving()&&this.loaded();if(F&&(E=this._updateAverageElevation(_,!0)),E)this.triggerRepaint();else if(this._triggerFrame(!1),F&&(this.fire(new o.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const R=this._calculateSpeedIndex();this.fire(new o.Event("speedindexcompleted",{speedIndex:R})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||k||(this._fullyLoaded=!0,this._authenticate())}_forceMarkerUpdate(){for(const d of this._markers)d._update()}_updateAverageElevation(d,i=!1){const h=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);if((i||d-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(d)){const _=this.transform.averageElevation;let v=this.transform.sampleAverageElevation(),w=!1;this.transform.elevation&&(w=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=d;const E=Math.abs(_-v);if(E>1){if(this._isInitialLoad||w)return this._averageElevation.jumpTo(v),h(v);this._averageElevation.easeTo(v,d,300)}else if(E>1e-4)return this._averageElevation.jumpTo(v),h(v)}return!!this._averageElevation.isEasing(d)&&h(this._averageElevation.getValue(d))}_authenticate(){o.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,d=>{if(d&&(d.message===o.AUTH_ERR_MSG||d.status===401)){const i=this.painter.context.gl;o.storeAuthState(i,!1),this._logoControl instanceof Kp&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new o.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),o.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const d=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const h=this.painter.context.gl,_=h.createFramebuffer();function v(w){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,w,0);const E=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,E),E}return h.bindFramebuffer(h.FRAMEBUFFER,_),this._canvasPixelComparison(v(d),i.canvasCopies.map(v),i.timeStamps)}_canvasPixelComparison(d,i,h){let _=h[1]-h[0];const v=d.length/4;for(let w=0;w<i.length;w++){const E=i[w];let k=0;for(let F=0;F<E.length;F+=4)E[F]===d[F]&&E[F+1]===d[F+1]&&E[F+2]===d[F+2]&&E[F+3]===d[F+3]&&(k+=1);_+=(h[w+2]-h[w+1])*(1-k/v)}return _}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),o.window!==void 0&&(o.window.removeEventListener("resize",this._onWindowResize,!1),o.window.removeEventListener("orientationchange",this._onWindowResize,!1),o.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),o.window.removeEventListener("online",this._onWindowOnline,!1));const d=this.painter.context.gl.getExtension("WEBGL_lose_context");d&&d.loseContext(),Ql(this._canvasContainer),Ql(this._controlContainer),Ql(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),o.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new o.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(d){this._renderNextFrame=this._renderNextFrame||d,this.style&&!this._frame&&(this._frame=o.exported.frame(i=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(i)}))}_preloadTiles(d){const i=this.style?Object.values(this.style._sourceCaches):[];return o.asyncAll(i,(h,_)=>h._preloadTiles(d,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(d){this._trackResize&&this.resize({originalEvent:d})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(d){this._showTileBoundaries!==d&&(this._showTileBoundaries=d,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(d){this._showTerrainWireframe!==d&&(this._showTerrainWireframe=d,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(d){this._speedIndexTiming!==d&&(this._speedIndexTiming=d,this._update())}get showPadding(){return!!this._showPadding}set showPadding(d){this._showPadding!==d&&(this._showPadding=d,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(d){this._showCollisionBoxes!==d&&(this._showCollisionBoxes=d,d?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(d){this._showOverdrawInspector!==d&&(this._showOverdrawInspector=d,this._update())}get repaint(){return!!this._repaint}set repaint(d){this._repaint!==d&&(this._repaint=d,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(d){this._vertices=d,this._update()}_setCacheLimits(d,i){o.setCacheLimits(d,i)}get version(){return o.version}},NavigationControl:class{constructor(d){this.options=o.extend({},of,d),this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(o.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),L("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),L("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(o.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:i}):h.resetNorth({},{originalEvent:i}))}),this._compassIcon=L("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const d=this._map;if(!d)return;const i=d.getZoom(),h=i===d.getMaxZoom(),_=i===d.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const d=this._map;if(!d)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(d.transform.pitch*(Math.PI/180)),.5)}) rotateX(${d.transform.pitch}deg) rotateZ(${d.transform.angle*(180/Math.PI)}deg)`:`rotate(${d.transform.angle*(180/Math.PI)}deg)`;d._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(d){return this._map=d,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),d.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&d.on("pitch",this._rotateCompassArrow),d.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lf(d,this._compass,this.options.visualizePitch)),this._container}onRemove(){const d=this._map;d&&(this._container.remove(),this.options.showZoom&&d.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&d.off("pitch",this._rotateCompassArrow),d.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(d,i){const h=L("button",d,this._container);return h.type="button",h.addEventListener("click",i),h}_setButtonTitle(d,i){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${i}`);d.setAttribute("aria-label",h),d.firstElementChild&&d.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends o.Evented{constructor(d){super(),this.options=o.extend({},si,d),o.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Yh(this._updateMarkerRotation,20)}onAdd(d){var i;return this._map=d,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,Mi!==void 0?i(Mi):o.window.navigator.permissions!==void 0?o.window.navigator.permissions.query({name:"geolocation"}).then(h=>{Mi=h.state!=="denied",i(Mi)}):(Mi=!!o.window.navigator.geolocation,i(Mi)),this._container}onRemove(){this._geolocationWatchID!==void 0&&(o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,ec=0,to=!1}_isOutOfMapMaxBounds(d){const i=this._map.getMaxBounds(),h=d.coords;return!!i&&(h.longitude<i.getWest()||h.longitude>i.getEast()||h.latitude<i.getSouth()||h.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(d){if(this._map){if(this._isOutOfMapMaxBounds(d))return this._setErrorState(),this.fire(new o.Event("outofmaxbounds",d)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=d,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(d),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(d),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("geolocate",d)),this._finish()}}_updateCamera(d){const i=new o.LngLat(d.coords.longitude,d.coords.latitude),h=d.coords.accuracy,_=this._map.getBearing(),v=o.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(h),v,{geolocateSource:!0})}_updateMarker(d){if(d){const i=new o.LngLat(d.coords.longitude,d.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=d.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const d=this._map._containerHeight/2,i=this._map.unproject([0,d]),h=this._map.unproject([100,d]),_=i.distanceTo(h)/100,v=Math.ceil(2*this._accuracy/_);this._circleElement.style.width=`${v}px`,this._circleElement.style.height=`${v}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(d){if(this._map){if(this.options.trackUserLocation)if(d.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(d.code===3&&to)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new o.Event("error",d)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(d){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=L("button","mapboxgl-ctrl-geolocate",this._container),L("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",d===!1){o.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=L("div","mapboxgl-user-location"),this._dotElement.appendChild(L("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(L("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new gu({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=L("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new gu({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||this._watchState!=="ACTIVE_LOCK"||i.originalEvent&&i.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new o.Event("trackuserlocationend")))})}_onDeviceOrientation(d){this._userLocationDotMarker&&(d.webkitCompassHeading?this._heading=d.webkitCompassHeading:d.absolute===!0&&(this._heading=-1*d.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return o.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new o.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ec--,to=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new o.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new o.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let d;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ec++,ec>1?(d={maximumAge:6e5,timeout:0},to=!0):(d=this.options.positionOptions,to=!1),this._geolocationWatchID=o.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,d),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else o.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const d=()=>{o.window.addEventListener("ondeviceorientationabsolute"in o.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};o.window.DeviceMotionEvent!==void 0&&typeof o.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(i=>{i==="granted"&&d()}).catch(console.error):d()}_clearWatch(){o.window.navigator.geolocation.clearWatch(this._geolocationWatchID),o.window.removeEventListener("deviceorientation",this._onDeviceOrientation),o.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:pu,ScaleControl:class{constructor(d){this.options=o.extend({},cf,d),o.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){xu(this._map,this._container,this.options)}onAdd(d){return this._map=d,this._container=L("div","mapboxgl-ctrl mapboxgl-ctrl-scale",d.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(d){this.options.unit=d,xu(this._map,this._container,this.options)}},FullscreenControl:class{constructor(d){this._fullscreen=!1,d&&d.container&&(d.container instanceof o.window.HTMLElement?this._container=d.container:o.warnOnce("Full screen control 'container' must be a DOM element.")),o.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in o.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in o.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(d){return this._map=d,this._container||(this._container=this._map.getContainer()),this._controlContainer=L("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",o.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,o.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!o.window.document.fullscreenEnabled&&!o.window.document.webkitFullscreenEnabled)}_setupUI(){const d=this._fullscreenButton=L("button","mapboxgl-ctrl-fullscreen",this._controlContainer);L("span","mapboxgl-ctrl-icon",d).setAttribute("aria-hidden","true"),d.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),o.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const d=this._getTitle();this._fullscreenButton.setAttribute("aria-label",d),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",d)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(o.window.document.fullscreenElement||o.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?o.window.document.exitFullscreen?o.window.document.exitFullscreen():o.window.document.webkitCancelFullScreen&&o.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends o.Evented{constructor(d){super(),this.options=o.extend(Object.create(Xi),d),o.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(d&&d.className?d.className.trim().split(/\s+/):[])}addTo(d){return this._map&&this.remove(),this._map=d,this.options.closeOnClick&&d.on("preclick",this._onClose),this.options.closeOnMove&&d.on("move",this._onClose),d.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(d.on("mousemove",this._onMouseEvent),d.on("mouseup",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")):d.on("move",this._update),this.fire(new o.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const d=this._map;return d&&(d.off("move",this._update),d.off("move",this._onClose),d.off("preclick",this._onClose),d.off("click",this._onClose),d.off("remove",this.remove),d.off("mousemove",this._onMouseEvent),d.off("mouseup",this._onMouseEvent),d.off("drag",this._onMouseEvent),this._map=void 0),this.fire(new o.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(d){this._lngLat=o.LngLat.convert(d),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const d=this._map;return d&&(d.off("move",this._update),d.on("mousemove",this._onMouseEvent),d.on("drag",this._onMouseEvent),d._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(d){return this.setDOMContent(o.window.document.createTextNode(d))}setHTML(d){const i=o.window.document.createDocumentFragment(),h=o.window.document.createElement("body");let _;for(h.innerHTML=d;_=h.firstChild,_;)i.appendChild(_);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(d){return this.options.maxWidth=d,this._update(),this}setDOMContent(d){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=L("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(d),this.options.closeButton){const h=this._closeButton=L("button","mapboxgl-popup-close-button",i);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(d){return this._classList.add(d),this._updateClassList(),this}removeClassName(d){return this._classList.delete(d),this._updateClassList(),this}setOffset(d){return this.options.offset=d,this._update(),this}toggleClassName(d){let i;return this._classList.delete(d)?i=!1:(this._classList.add(d),i=!0),this._updateClassList(),i}_onMouseEvent(d){this._update(d.point)}_getAnchor(d){if(this.options.anchor)return this.options.anchor;const i=this._map,h=this._container,_=this._pos;if(!i||!h||!_)return"bottom";const v=h.offsetWidth,w=h.offsetHeight,E=_.x<v/2,k=_.x>i.transform.width-v/2;if(_.y+d<w)return E?"top-left":k?"top-right":"top";if(_.y>i.transform.height-w){if(E)return"bottom-left";if(k)return"bottom-right"}return E?"left":k?"right":"bottom"}_updateClassList(){const d=this._container;if(!d)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),d.className=i.join(" ")}_update(d){const i=this._map,h=this._content;if(!i||!this._lngLat&&!this._trackPointer||!h)return;let _=this._container;if(_||(_=this._container=L("div","mapboxgl-popup",i.getContainer()),this._tip=L("div","mapboxgl-popup-tip",_),_.appendChild(h)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=mu(this._lngLat,this._pos,i.transform)),!this._trackPointer||d){const v=this._pos=this._trackPointer&&d?d:i.project(this._lngLat),w=tc(this.options.offset),E=this._anchor=this._getAnchor(w.y),k=tc(this.options.offset,E),F=v.add(k).round();i._requestDomTask(()=>{this._container&&E&&(this._container.style.transform=`${_u[E]} translate(${F.x}px,${F.y}px)`)})}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const d=this._container.querySelector(Fr);d&&d.focus()}_onClose(){this.remove()}_setOpacity(d){this._content&&(this._content.style.opacity=d),this._tip&&(this._tip.style.opacity=d)}},Marker:gu,Style:ai,LngLat:o.LngLat,LngLatBounds:o.LngLatBounds,Point:o.pointGeometry,MercatorCoordinate:o.MercatorCoordinate,FreeCameraOptions:$l,Evented:o.Evented,config:o.config,prewarm:function(){Fe().acquire(ce)},clearPrewarmedResources:function(){const d=Ne;d&&(d.isPreloaded()&&d.numActive()===1?(d.release(ce),Ne=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return o.config.ACCESS_TOKEN},set accessToken(d){o.config.ACCESS_TOKEN=d},get baseApiUrl(){return o.config.API_URL},set baseApiUrl(d){o.config.API_URL=d},get workerCount(){return De.workerCount},set workerCount(d){De.workerCount=d},get maxParallelImageRequests(){return o.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(d){o.config.MAX_PARALLEL_IMAGE_REQUESTS=d},clearStorage(d){o.clearTileCache(d)},workerUrl:"",workerClass:null,setNow:o.exported.setNow,restoreNow:o.exported.restoreNow};return Vo});var x=u;return x})})(EA);var hc=EA.exports;function SA(){const{coordData:e,coordinatesRoute:r}=Ln.useContext(So),n=Ln.useRef(null);hc.accessToken="pk.eyJ1Ijoic2ViYXN0aWFuam9zZSIsImEiOiJjbDJjdDd2azgwc2RuM2pvMjF6YmsxYThoIn0.CS_kAa8atE7dyFWkz1X7Lw";const{setMap:l}=Ln.useContext(g_);return Ln.useLayoutEffect(()=>{const u=new hc.Map({container:n.current,style:"mapbox://styles/mapbox/streets-v11",center:[-74.0675838099721,4.69735139520819],zoom:14});if(e.length>0){const m=new hc.LngLatBounds([e[0].Longitud,e[0].Latitud],[e[0].Longitud,e[0].Latitud]);e.forEach(function(x,o){if(o===0){const S=new hc.Popup().setHTML(`
                        <h6>${x.Lugar}</h6>
                        <p>${x.Direcci\u00F3n}</p>
                    `);new hc.Marker({color:"red"}).setPopup(S).setLngLat([x.Longitud,x.Latitud]).addTo(u),m.extend([x.Longitud,x.Latitud])}else{const S=new hc.Popup().setHTML(`
                        <h6>${x.Lugar}</h6>
                        <p>${x.Direcci\u00F3n}</p>
                    `);new hc.Marker({color:"blue"}).setPopup(S).setLngLat([x.Longitud,x.Latitud]).addTo(u),m.extend([x.Longitud,x.Latitud])}}),u==null||u.fitBounds(m,{padding:50})}if(r){const m={type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:r}}]}};u.on("load",()=>{u==null||u.addSource("RouteString",m),u==null||u.addLayer({id:"RouteString",type:"line",source:"RouteString",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"black","line-width":3}})})}l(u)},[e]),Xt("div",{ref:n,style:{height:"500px",width:"90%",minWidth:"500px"}})}function kA(){return Xt("div",{style:{position:"fixed",width:"100%",height:"100%",top:0,left:0,display:"flex",justifyContent:"center",alignItems:"center",backgroundColor:"rgba(0, 0, 0, 0.8)",color:"white",fontWeight:"bolder",fontSize:"1.8rem"},children:"Resolviendo Modelo"})}function cB(){const{solvingModel:e,solutionCBC:r}=Ln.useContext(So);return Sn("div",{className:"container1",children:[Xt("div",{className:"container2",children:Xt("h1",{children:"Travelling Salesman Problem "})}),Sn("div",{className:"container3",children:[Xt("h2",{className:"file_title",children:"\u2022\u2022\u2022\u2022\u2022\u2022 Ingrese archivo coordenadas \u2022\u2022\u2022\u2022\u2022\u2022"}),Xt(TA,{})]}),Sn("div",{className:"container4",children:[Xt(US,{}),Xt(oD,{})]}),r&&Sn("div",{className:"container5",children:[Xt("h2",{children:"Soluci\xF3n del modelo"}),Sn("div",{className:"container51",children:[Sn("span",{className:"fo",children:["Distancia total recorrido: ",r.total_distance," kilometros"]}),Xt("div",{children:r.route.map((n,l)=>Sn("span",{children:[Xt("span",{className:"places",children:n}),l<r.route.length-1&&Xt("span",{className:"arrow",children:"\xBB"})]},l))})]})]}),Xt("div",{className:"container6",children:Xt(SA,{})}),e===!0&&Xt(kA,{})]})}function uB(){const{distanceMatrix:e,timeMatrix:r,coordData:n,setSolvingModel:l,setSolutionCplex:u,setCoordinatesRoute:m}=Ln.useContext(So),{map:x}=Ln.useContext(g_);async function o(){l(!0);try{const A=performance.now(),D=await(await fetch("https://optfastapi.herokuapp.com/cplex",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({Places:[...Array(r.length).keys()],Matrix:r}),mode:"cors"})).json(),L=performance.now();console.log(D),console.log("tiempo de ejecuci\xF3n: ",(L-A)/1e3),u(D),S(D)}catch(A){console.log(A),alert("Error en la ejecuci\xF3n del modelo")}l(!1)}async function S(A){const I=A.route.map(me=>`${n[me].Longitud}%2C${n[me].Latitud}`).join("%3B");console.log(I);const L=await(await fetch(`https://api.mapbox.com/directions/v5/mapbox/driving/${I}?alternatives=false&geometries=geojson&overview=simplified&steps=false&access_token=pk.eyJ1Ijoic2ViYXN0aWFuam9zZSIsImEiOiJjbDJjdDd2azgwc2RuM2pvMjF6YmsxYThoIn0.CS_kAa8atE7dyFWkz1X7Lw`)).json();console.log(L);const{distance:B,duration:U,geometry:V}=L.routes[0],{coordinates:Y}=V;m(Y);const X=Math.round(B/1e3*100)/100,K=Math.floor(U/60);console.log({kms:X,minutes:K});const G={type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:Y}}]}};x!=null&&x.getLayer("RouteString")&&(x.removeLayer("RouteString"),x.removeSource("RouteString")),x==null||x.addSource("RouteString",G),x==null||x.addLayer({id:"RouteString",type:"line",source:"RouteString",layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"black","line-width":3}})}return Xt("button",{onClick:o,disabled:r.length===0,children:"Ejecutar Modelo"})}function hB(){const{solvingModel:e,places:r,solutionCplex:n}=Ln.useContext(So);return Sn("div",{className:"container1",children:[Xt("div",{className:"container2",children:Xt("h1",{children:"Travelling Salesman Problem "})}),Sn("div",{className:"container3",children:[Xt("h2",{className:"file_title",children:"\u2022\u2022\u2022\u2022\u2022\u2022 Ingrese archivo coordenadas \u2022\u2022\u2022\u2022\u2022\u2022"}),Xt(TA,{})]}),Sn("div",{className:"container4",children:[Xt(US,{}),Xt(uB,{})]}),n&&Sn("div",{className:"container5",children:[Xt("h2",{children:"Soluci\xF3n del modelo"}),Sn("div",{className:"container51",children:[Sn("span",{className:"fo",children:["Tiempo total recorrido: ",n.total_distance," minutos"]}),Xt("div",{children:n.route.map((l,u)=>Sn("span",{children:[Xt("span",{className:"places",children:l}),u<n.route.length-1&&Xt("span",{className:"arrow",children:"\xBB"})]},u))})]})]}),Xt("div",{className:"container6",children:Xt(SA,{})}),e===!0&&Xt(kA,{})]})}function fB(){return Sn(_m,{children:[Xt("header",{className:"header",children:Sn("nav",{children:[Xt("span",{className:"header__tab",children:Xt(bT,{to:"/cplex",children:"CPLEX"})}),Xt("span",{className:"header__tab",children:Xt(bT,{to:"/cbc",children:"CBC"})})]})}),Sn(tD,{children:[Xt(td,{path:"/",element:Xt(ET,{to:"/cplex"})}),Xt(td,{path:"/*",element:Xt(ET,{to:"/cplex"})}),Xt(td,{path:"/cplex",element:Xt(hB,{})}),Xt(td,{path:"/cbc",element:Xt(cB,{})})]})]})}function dB(){return Xt(iD,{children:Xt(kM,{children:Xt(CM,{children:Xt(fB,{})})})})}Cx.createRoot(document.getElementById("root")).render(Xt(Ln.StrictMode,{children:Xt(dB,{})}));
